(function(Mt,ct){typeof exports=="object"&&typeof module<"u"?ct(exports):typeof define=="function"&&define.amd?define(["exports"],ct):(Mt=typeof globalThis<"u"?globalThis:Mt||self,ct(Mt["@walletconnect/ethereum-provider"]={}))})(this,function(Mt){"use strict";var ct=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ty(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Gh(t){var e=t.default;if(typeof e=="function"){var r=function(){return e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return t[n]}})}),r}var Ve={exports:{}},Hn=typeof Reflect=="object"?Reflect:null,Zh=Hn&&typeof Hn.apply=="function"?Hn.apply:function(e,r,n){return Function.prototype.apply.call(e,r,n)},mo;Hn&&typeof Hn.ownKeys=="function"?mo=Hn.ownKeys:Object.getOwnPropertySymbols?mo=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:mo=function(e){return Object.getOwnPropertyNames(e)};function ry(t){console&&console.warn&&console.warn(t)}var Yh=Number.isNaN||function(e){return e!==e};function de(){de.init.call(this)}Ve.exports=de,Ve.exports.once=oy,de.EventEmitter=de,de.prototype._events=void 0,de.prototype._eventsCount=0,de.prototype._maxListeners=void 0;var Jh=10;function wo(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(de,"defaultMaxListeners",{enumerable:!0,get:function(){return Jh},set:function(t){if(typeof t!="number"||t<0||Yh(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");Jh=t}}),de.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},de.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||Yh(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function Qh(t){return t._maxListeners===void 0?de.defaultMaxListeners:t._maxListeners}de.prototype.getMaxListeners=function(){return Qh(this)},de.prototype.emit=function(e){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);var i=e==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var o;if(r.length>0&&(o=r[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var c=s[e];if(c===void 0)return!1;if(typeof c=="function")Zh(c,this,r);else for(var l=c.length,u=nd(c,l),n=0;n<l;++n)Zh(u[n],this,r);return!0};function Xh(t,e,r,n){var i,s,o;if(wo(r),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),s=t._events),o=s[e]),o===void 0)o=s[e]=r,++t._eventsCount;else if(typeof o=="function"?o=s[e]=n?[r,o]:[o,r]:n?o.unshift(r):o.push(r),i=Qh(t),i>0&&o.length>i&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=o.length,ry(a)}return t}de.prototype.addListener=function(e,r){return Xh(this,e,r,!1)},de.prototype.on=de.prototype.addListener,de.prototype.prependListener=function(e,r){return Xh(this,e,r,!0)};function ny(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function ed(t,e,r){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},i=ny.bind(n);return i.listener=r,n.wrapFn=i,i}de.prototype.once=function(e,r){return wo(r),this.on(e,ed(this,e,r)),this},de.prototype.prependOnceListener=function(e,r){return wo(r),this.prependListener(e,ed(this,e,r)),this},de.prototype.removeListener=function(e,r){var n,i,s,o,a;if(wo(r),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===r||n.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||r));else if(typeof n!="function"){for(s=-1,o=n.length-1;o>=0;o--)if(n[o]===r||n[o].listener===r){a=n[o].listener,s=o;break}if(s<0)return this;s===0?n.shift():iy(n,s),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,a||r)}return this},de.prototype.off=de.prototype.removeListener,de.prototype.removeAllListeners=function(e){var r,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var s=Object.keys(n),o;for(i=0;i<s.length;++i)o=s[i],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=n[e],typeof r=="function")this.removeListener(e,r);else if(r!==void 0)for(i=r.length-1;i>=0;i--)this.removeListener(e,r[i]);return this};function td(t,e,r){var n=t._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?r?[i.listener||i]:[i]:r?sy(i):nd(i,i.length)}de.prototype.listeners=function(e){return td(this,e,!0)},de.prototype.rawListeners=function(e){return td(this,e,!1)},de.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):rd.call(t,e)},de.prototype.listenerCount=rd;function rd(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}de.prototype.eventNames=function(){return this._eventsCount>0?mo(this._events):[]};function nd(t,e){for(var r=new Array(e),n=0;n<e;++n)r[n]=t[n];return r}function iy(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function sy(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function oy(t,e){return new Promise(function(r,n){function i(o){t.removeListener(e,s),n(o)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",i),r([].slice.call(arguments))}id(t,e,s,{once:!0}),e!=="error"&&ay(t,i,{once:!0})})}function ay(t,e,r){typeof t.on=="function"&&id(t,"error",e,r)}function id(t,e,r,n){if(typeof t.on=="function")n.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function i(s){n.once&&t.removeEventListener(e,i),r(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var sd=function(t,e,r){if(r||arguments.length===2)for(var n=0,i=e.length,s;n<i;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))},cy=function(){function t(e,r,n){this.name=e,this.version=r,this.os=n,this.type="browser"}return t}(),ly=function(){function t(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return t}(),uy=function(){function t(e,r,n,i){this.name=e,this.version=r,this.os=n,this.bot=i,this.type="bot-device"}return t}(),hy=function(){function t(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return t}(),dy=function(){function t(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return t}(),fy=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,py=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,od=3,gy=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",fy]],ad=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function my(t){return t?cd(t):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new dy:typeof navigator<"u"?cd(navigator.userAgent):by()}function wy(t){return t!==""&&gy.reduce(function(e,r){var n=r[0],i=r[1];if(e)return e;var s=i.exec(t);return!!s&&[n,s]},!1)}function cd(t){var e=wy(t);if(!e)return null;var r=e[0],n=e[1];if(r==="searchbot")return new hy;var i=n[1]&&n[1].split(".").join("_").split("_").slice(0,3);i?i.length<od&&(i=sd(sd([],i,!0),vy(od-i.length),!0)):i=[];var s=i.join("."),o=yy(t),a=py.exec(t);return a&&a[1]?new uy(r,s,o,a[1]):new cy(r,s,o)}function yy(t){for(var e=0,r=ad.length;e<r;e++){var n=ad[e],i=n[0],s=n[1],o=s.exec(t);if(o)return i}return null}function by(){var t=typeof process<"u"&&process.version;return t?new ly(process.version.slice(1)):null}function vy(t){for(var e=[],r=0;r<t;r++)e.push("0");return e}var j={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var rc=function(t,e){return rc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},rc(t,e)};function Ey(t,e){rc(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var nc=function(){return nc=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},nc.apply(this,arguments)};function _y(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function $y(t,e,r,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,r,s):o(e,r))||s);return i>3&&s&&Object.defineProperty(e,r,s),s}function xy(t,e){return function(r,n){e(r,n,t)}}function Iy(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Oy(t,e,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(h){o(h)}}function c(u){try{l(n.throw(u))}catch(h){o(h)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})}function Sy(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(u){return c([l,u])}}function c(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=l[0]&2?i.return:l[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,l[1])).done)return s;switch(i=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,i=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){r.label=l[1];break}if(l[0]===6&&r.label<s[1]){r.label=s[1],s=l;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(l);break}s[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(u){l=[6,u],i=0}finally{n=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function Ay(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}function Cy(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function ic(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ld(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],o;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(a){o={error:a}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return s}function Py(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(ld(arguments[e]));return t}function Dy(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)n[i]=s[o];return n}function rs(t){return this instanceof rs?(this.v=t,this):new rs(t)}function Ty(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(d){n[d]&&(i[d]=function(p){return new Promise(function(f,g){s.push([d,p,f,g])>1||a(d,p)})})}function a(d,p){try{c(n[d](p))}catch(f){h(s[0][3],f)}}function c(d){d.value instanceof rs?Promise.resolve(d.value.v).then(l,u):h(s[0][2],d)}function l(d){a("next",d)}function u(d){a("throw",d)}function h(d,p){d(p),s.shift(),s.length&&a(s[0][0],s[0][1])}}function Ry(t){var e,r;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,s){e[i]=t[i]?function(o){return(r=!r)?{value:rs(t[i](o)),done:i==="return"}:s?s(o):o}:s}}function Ny(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof ic=="function"?ic(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=t[s]&&function(o){return new Promise(function(a,c){o=t[s](o),i(a,c,o.done,o.value)})}}function i(s,o,a,c){Promise.resolve(c).then(function(l){s({value:l,done:a})},o)}}function By(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function Ly(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function My(t){return t&&t.__esModule?t:{default:t}}function Uy(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function jy(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var Fy=Object.freeze({__proto__:null,__extends:Ey,get __assign(){return nc},__rest:_y,__decorate:$y,__param:xy,__metadata:Iy,__awaiter:Oy,__generator:Sy,__createBinding:Ay,__exportStar:Cy,__values:ic,__read:ld,__spread:Py,__spreadArrays:Dy,__await:rs,__asyncGenerator:Ty,__asyncDelegator:Ry,__asyncValues:Ny,__makeTemplateObject:By,__importStar:Ly,__importDefault:My,__classPrivateFieldGet:Uy,__classPrivateFieldSet:jy}),yo=Gh(Fy),sc={},ns={},ud;function ky(){if(ud)return ns;ud=1,Object.defineProperty(ns,"__esModule",{value:!0}),ns.delay=void 0;function t(e){return new Promise(r=>{setTimeout(()=>{r(!0)},e)})}return ns.delay=t,ns}var an={},oc={},cn={},hd;function qy(){return hd||(hd=1,Object.defineProperty(cn,"__esModule",{value:!0}),cn.ONE_THOUSAND=cn.ONE_HUNDRED=void 0,cn.ONE_HUNDRED=100,cn.ONE_THOUSAND=1e3),cn}var ac={},dd;function zy(){return dd||(dd=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_YEAR=t.FOUR_WEEKS=t.THREE_WEEKS=t.TWO_WEEKS=t.ONE_WEEK=t.THIRTY_DAYS=t.SEVEN_DAYS=t.FIVE_DAYS=t.THREE_DAYS=t.ONE_DAY=t.TWENTY_FOUR_HOURS=t.TWELVE_HOURS=t.SIX_HOURS=t.THREE_HOURS=t.ONE_HOUR=t.SIXTY_MINUTES=t.THIRTY_MINUTES=t.TEN_MINUTES=t.FIVE_MINUTES=t.ONE_MINUTE=t.SIXTY_SECONDS=t.THIRTY_SECONDS=t.TEN_SECONDS=t.FIVE_SECONDS=t.ONE_SECOND=void 0,t.ONE_SECOND=1,t.FIVE_SECONDS=5,t.TEN_SECONDS=10,t.THIRTY_SECONDS=30,t.SIXTY_SECONDS=60,t.ONE_MINUTE=t.SIXTY_SECONDS,t.FIVE_MINUTES=t.ONE_MINUTE*5,t.TEN_MINUTES=t.ONE_MINUTE*10,t.THIRTY_MINUTES=t.ONE_MINUTE*30,t.SIXTY_MINUTES=t.ONE_MINUTE*60,t.ONE_HOUR=t.SIXTY_MINUTES,t.THREE_HOURS=t.ONE_HOUR*3,t.SIX_HOURS=t.ONE_HOUR*6,t.TWELVE_HOURS=t.ONE_HOUR*12,t.TWENTY_FOUR_HOURS=t.ONE_HOUR*24,t.ONE_DAY=t.TWENTY_FOUR_HOURS,t.THREE_DAYS=t.ONE_DAY*3,t.FIVE_DAYS=t.ONE_DAY*5,t.SEVEN_DAYS=t.ONE_DAY*7,t.THIRTY_DAYS=t.ONE_DAY*30,t.ONE_WEEK=t.SEVEN_DAYS,t.TWO_WEEKS=t.ONE_WEEK*2,t.THREE_WEEKS=t.ONE_WEEK*3,t.FOUR_WEEKS=t.ONE_WEEK*4,t.ONE_YEAR=t.ONE_DAY*365}(ac)),ac}var fd;function pd(){return fd||(fd=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=yo;e.__exportStar(qy(),t),e.__exportStar(zy(),t)}(oc)),oc}var gd;function Hy(){if(gd)return an;gd=1,Object.defineProperty(an,"__esModule",{value:!0}),an.fromMiliseconds=an.toMiliseconds=void 0;const t=pd();function e(n){return n*t.ONE_THOUSAND}an.toMiliseconds=e;function r(n){return Math.floor(n/t.ONE_THOUSAND)}return an.fromMiliseconds=r,an}var md;function Vy(){return md||(md=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=yo;e.__exportStar(ky(),t),e.__exportStar(Hy(),t)}(sc)),sc}var Vn={},wd;function Wy(){if(wd)return Vn;wd=1,Object.defineProperty(Vn,"__esModule",{value:!0}),Vn.Watch=void 0;class t{constructor(){this.timestamps=new Map}start(r){if(this.timestamps.has(r))throw new Error(`Watch already started for label: ${r}`);this.timestamps.set(r,{started:Date.now()})}stop(r){const n=this.get(r);if(typeof n.elapsed<"u")throw new Error(`Watch already stopped for label: ${r}`);const i=Date.now()-n.started;this.timestamps.set(r,{started:n.started,elapsed:i})}get(r){const n=this.timestamps.get(r);if(typeof n>"u")throw new Error(`No timestamp found for label: ${r}`);return n}elapsed(r){const n=this.get(r);return n.elapsed||Date.now()-n.started}}return Vn.Watch=t,Vn.default=t,Vn}var cc={},is={},yd;function Ky(){if(yd)return is;yd=1,Object.defineProperty(is,"__esModule",{value:!0}),is.IWatch=void 0;class t{}return is.IWatch=t,is}var bd;function Gy(){return bd||(bd=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),yo.__exportStar(Ky(),t)}(cc)),cc}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=yo;e.__exportStar(Vy(),t),e.__exportStar(Wy(),t),e.__exportStar(Gy(),t),e.__exportStar(pd(),t)})(j);var me={};Object.defineProperty(me,"__esModule",{value:!0}),me.getLocalStorage=me.getLocalStorageOrThrow=me.getCrypto=me.getCryptoOrThrow=vd=me.getLocation=me.getLocationOrThrow=lc=me.getNavigator=me.getNavigatorOrThrow=ss=me.getDocument=me.getDocumentOrThrow=me.getFromWindowOrThrow=me.getFromWindow=void 0;function ln(t){let e;return typeof window<"u"&&typeof window[t]<"u"&&(e=window[t]),e}me.getFromWindow=ln;function Wn(t){const e=ln(t);if(!e)throw new Error(`${t} is not defined in Window`);return e}me.getFromWindowOrThrow=Wn;function Zy(){return Wn("document")}me.getDocumentOrThrow=Zy;function Yy(){return ln("document")}var ss=me.getDocument=Yy;function Jy(){return Wn("navigator")}me.getNavigatorOrThrow=Jy;function Qy(){return ln("navigator")}var lc=me.getNavigator=Qy;function Xy(){return Wn("location")}me.getLocationOrThrow=Xy;function eb(){return ln("location")}var vd=me.getLocation=eb;function tb(){return Wn("crypto")}me.getCryptoOrThrow=tb;function rb(){return ln("crypto")}me.getCrypto=rb;function nb(){return Wn("localStorage")}me.getLocalStorageOrThrow=nb;function ib(){return ln("localStorage")}me.getLocalStorage=ib;var uc={};Object.defineProperty(uc,"__esModule",{value:!0});var Ed=uc.getWindowMetadata=void 0;const _d=me;function sb(){let t,e;try{t=_d.getDocumentOrThrow(),e=_d.getLocationOrThrow()}catch{return null}function r(){const h=t.getElementsByTagName("link"),d=[];for(let p=0;p<h.length;p++){const f=h[p],g=f.getAttribute("rel");if(g&&g.toLowerCase().indexOf("icon")>-1){const m=f.getAttribute("href");if(m)if(m.toLowerCase().indexOf("https:")===-1&&m.toLowerCase().indexOf("http:")===-1&&m.indexOf("//")!==0){let w=e.protocol+"//"+e.host;if(m.indexOf("/")===0)w+=m;else{const y=e.pathname.split("/");y.pop();const E=y.join("/");w+=E+"/"+m}d.push(w)}else if(m.indexOf("//")===0){const w=e.protocol+m;d.push(w)}else d.push(m)}}return d}function n(...h){const d=t.getElementsByTagName("meta");for(let p=0;p<d.length;p++){const f=d[p],g=["itemprop","property","name"].map(m=>f.getAttribute(m)).filter(m=>m?h.includes(m):!1);if(g.length&&g){const m=f.getAttribute("content");if(m)return m}}return""}function i(){let h=n("name","og:site_name","og:title","twitter:title");return h||(h=t.title),h}function s(){return n("description","og:description","twitter:description","keywords")}const o=i(),a=s(),c=e.origin,l=r();return{description:a,url:c,icons:l,name:o}}Ed=uc.getWindowMetadata=sb;function os(t,{strict:e=!0}={}){return!t||typeof t!="string"?!1:e?/^0x[0-9a-fA-F]*$/.test(t):t.startsWith("0x")}function $d(t){return os(t,{strict:!1})?Math.ceil((t.length-2)/2):t.length}const xd="2.23.2";let hc={getDocsUrl:({docsBaseUrl:t,docsPath:e="",docsSlug:r})=>e?`${t??"https://viem.sh"}${e}${r?`#${r}`:""}`:void 0,version:`viem@${xd}`};class un extends Error{constructor(e,r={}){const n=r.cause instanceof un?r.cause.details:r.cause?.message?r.cause.message:r.details,i=r.cause instanceof un&&r.cause.docsPath||r.docsPath,s=hc.getDocsUrl?.({...r,docsPath:i}),o=[e||"An error occurred.","",...r.metaMessages?[...r.metaMessages,""]:[],...s?[`Docs: ${s}`]:[],...n?[`Details: ${n}`]:[],...hc.version?[`Version: ${hc.version}`]:[]].join(`
`);super(o,r.cause?{cause:r.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.details=n,this.docsPath=i,this.metaMessages=r.metaMessages,this.name=r.name??this.name,this.shortMessage=e,this.version=xd}walk(e){return Id(this,e)}}function Id(t,e){return e?.(t)?t:t&&typeof t=="object"&&"cause"in t&&t.cause!==void 0?Id(t.cause,e):e?null:t}class Od extends un{constructor({size:e,targetSize:r,type:n}){super(`${n.charAt(0).toUpperCase()}${n.slice(1).toLowerCase()} size (${e}) exceeds padding size (${r}).`,{name:"SizeExceedsPaddingSizeError"})}}function Kn(t,{dir:e,size:r=32}={}){return typeof t=="string"?ob(t,{dir:e,size:r}):ab(t,{dir:e,size:r})}function ob(t,{dir:e,size:r=32}={}){if(r===null)return t;const n=t.replace("0x","");if(n.length>r*2)throw new Od({size:Math.ceil(n.length/2),targetSize:r,type:"hex"});return`0x${n[e==="right"?"padEnd":"padStart"](r*2,"0")}`}function ab(t,{dir:e,size:r=32}={}){if(r===null)return t;if(t.length>r)throw new Od({size:t.length,targetSize:r,type:"bytes"});const n=new Uint8Array(r);for(let i=0;i<r;i++){const s=e==="right";n[s?i:r-i-1]=t[s?i:t.length-i-1]}return n}class cb extends un{constructor({max:e,min:r,signed:n,size:i,value:s}){super(`Number "${s}" is not in safe ${i?`${i*8}-bit ${n?"signed":"unsigned"} `:""}integer range ${e?`(${r} to ${e})`:`(above ${r})`}`,{name:"IntegerOutOfRangeError"})}}class lb extends un{constructor({givenSize:e,maxSize:r}){super(`Size cannot exceed ${r} bytes. Given size: ${e} bytes.`,{name:"SizeOverflowError"})}}function Gn(t,{size:e}){if($d(t)>e)throw new lb({givenSize:$d(t),maxSize:e})}function dc(t,e={}){const{signed:r}=e;e.size&&Gn(t,{size:e.size});const n=BigInt(t);if(!r)return n;const i=(t.length-2)/2,s=(1n<<BigInt(i)*8n-1n)-1n;return n<=s?n:n-BigInt(`0x${"f".padStart(i*2,"f")}`)-1n}function ub(t,e={}){return Number(dc(t,e))}const hb=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function fc(t,e={}){return typeof t=="number"||typeof t=="bigint"?Ad(t,e):typeof t=="string"?pb(t,e):typeof t=="boolean"?db(t,e):Sd(t,e)}function db(t,e={}){const r=`0x${Number(t)}`;return typeof e.size=="number"?(Gn(r,{size:e.size}),Kn(r,{size:e.size})):r}function Sd(t,e={}){let r="";for(let i=0;i<t.length;i++)r+=hb[t[i]];const n=`0x${r}`;return typeof e.size=="number"?(Gn(n,{size:e.size}),Kn(n,{dir:"right",size:e.size})):n}function Ad(t,e={}){const{signed:r,size:n}=e,i=BigInt(t);let s;n?r?s=(1n<<BigInt(n)*8n-1n)-1n:s=2n**(BigInt(n)*8n)-1n:typeof t=="number"&&(s=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof s=="bigint"&&r?-s-1n:0;if(s&&i>s||i<o){const c=typeof t=="bigint"?"n":"";throw new cb({max:s?`${s}${c}`:void 0,min:`${o}${c}`,signed:r,size:n,value:`${t}${c}`})}const a=`0x${(r&&i<0?(1n<<BigInt(n*8))+BigInt(i):i).toString(16)}`;return n?Kn(a,{size:n}):a}const fb=new TextEncoder;function pb(t,e={}){const r=fb.encode(t);return Sd(r,e)}const gb=new TextEncoder;function mb(t,e={}){return typeof t=="number"||typeof t=="bigint"?yb(t,e):typeof t=="boolean"?wb(t,e):os(t)?Pd(t,e):Dd(t,e)}function wb(t,e={}){const r=new Uint8Array(1);return r[0]=Number(t),typeof e.size=="number"?(Gn(r,{size:e.size}),Kn(r,{size:e.size})):r}const hr={zero:48,nine:57,A:65,F:70,a:97,f:102};function Cd(t){if(t>=hr.zero&&t<=hr.nine)return t-hr.zero;if(t>=hr.A&&t<=hr.F)return t-(hr.A-10);if(t>=hr.a&&t<=hr.f)return t-(hr.a-10)}function Pd(t,e={}){let r=t;e.size&&(Gn(r,{size:e.size}),r=Kn(r,{dir:"right",size:e.size}));let n=r.slice(2);n.length%2&&(n=`0${n}`);const i=n.length/2,s=new Uint8Array(i);for(let o=0,a=0;o<i;o++){const c=Cd(n.charCodeAt(a++)),l=Cd(n.charCodeAt(a++));if(c===void 0||l===void 0)throw new un(`Invalid byte sequence ("${n[a-2]}${n[a-1]}" in "${n}").`);s[o]=c*16+l}return s}function yb(t,e){const r=Ad(t,e);return Pd(r)}function Dd(t,e={}){const r=gb.encode(t);return typeof e.size=="number"?(Gn(r,{size:e.size}),Kn(r,{dir:"right",size:e.size})):r}function bo(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function bb(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function as(t,...e){if(!bb(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function vb(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");bo(t.outputLen),bo(t.blockLen)}function Zn(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function Td(t,e){as(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}const vo=BigInt(2**32-1),Rd=BigInt(32);function Eb(t,e=!1){return e?{h:Number(t&vo),l:Number(t>>Rd&vo)}:{h:Number(t>>Rd&vo)|0,l:Number(t&vo)|0}}function _b(t,e=!1){let r=new Uint32Array(t.length),n=new Uint32Array(t.length);for(let i=0;i<t.length;i++){const{h:s,l:o}=Eb(t[i],e);[r[i],n[i]]=[s,o]}return[r,n]}const $b=(t,e,r)=>t<<r|e>>>32-r,xb=(t,e,r)=>e<<r|t>>>32-r,Ib=(t,e,r)=>e<<r-32|t>>>64-r,Ob=(t,e,r)=>t<<r-32|e>>>64-r,Yn=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function Sb(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function pc(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Kt(t,e){return t<<32-e|t>>>e}const Nd=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function Ab(t){return t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}function Bd(t){for(let e=0;e<t.length;e++)t[e]=Ab(t[e])}function Cb(t){if(typeof t!="string")throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array(new TextEncoder().encode(t))}function Eo(t){return typeof t=="string"&&(t=Cb(t)),as(t),t}function Pb(...t){let e=0;for(let n=0;n<t.length;n++){const i=t[n];as(i),e+=i.length}const r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){const s=t[n];r.set(s,i),i+=s.length}return r}class gc{clone(){return this._cloneInto()}}function Ld(t){const e=n=>t().update(Eo(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function Md(t=32){if(Yn&&typeof Yn.getRandomValues=="function")return Yn.getRandomValues(new Uint8Array(t));if(Yn&&typeof Yn.randomBytes=="function")return Yn.randomBytes(t);throw new Error("crypto.getRandomValues must be defined")}const Ud=[],jd=[],Fd=[],Db=BigInt(0),cs=BigInt(1),Tb=BigInt(2),Rb=BigInt(7),Nb=BigInt(256),Bb=BigInt(113);for(let t=0,e=cs,r=1,n=0;t<24;t++){[r,n]=[n,(2*r+3*n)%5],Ud.push(2*(5*n+r)),jd.push((t+1)*(t+2)/2%64);let i=Db;for(let s=0;s<7;s++)e=(e<<cs^(e>>Rb)*Bb)%Nb,e&Tb&&(i^=cs<<(cs<<BigInt(s))-cs);Fd.push(i)}const[Lb,Mb]=_b(Fd,!0),kd=(t,e,r)=>r>32?Ib(t,e,r):$b(t,e,r),qd=(t,e,r)=>r>32?Ob(t,e,r):xb(t,e,r);function Ub(t,e=24){const r=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let o=0;o<10;o++)r[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,l=r[c],u=r[c+1],h=kd(l,u,1)^r[a],d=qd(l,u,1)^r[a+1];for(let p=0;p<50;p+=10)t[o+p]^=h,t[o+p+1]^=d}let i=t[2],s=t[3];for(let o=0;o<24;o++){const a=jd[o],c=kd(i,s,a),l=qd(i,s,a),u=Ud[o];i=t[u],s=t[u+1],t[u]=c,t[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)r[a]=t[o+a];for(let a=0;a<10;a++)t[o+a]^=~r[(a+2)%10]&r[(a+4)%10]}t[0]^=Lb[n],t[1]^=Mb[n]}r.fill(0)}class mc extends gc{constructor(e,r,n,i=!1,s=24){if(super(),this.blockLen=e,this.suffix=r,this.outputLen=n,this.enableXOF=i,this.rounds=s,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,bo(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=Sb(this.state)}keccak(){Nd||Bd(this.state32),Ub(this.state32,this.rounds),Nd||Bd(this.state32),this.posOut=0,this.pos=0}update(e){Zn(this);const{blockLen:r,state:n}=this;e=Eo(e);const i=e.length;for(let s=0;s<i;){const o=Math.min(r-this.pos,i-s);for(let a=0;a<o;a++)n[this.pos++]^=e[s++];this.pos===r&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:r,pos:n,blockLen:i}=this;e[n]^=r,(r&128)!==0&&n===i-1&&this.keccak(),e[i-1]^=128,this.keccak()}writeInto(e){Zn(this,!1),as(e),this.finish();const r=this.state,{blockLen:n}=this;for(let i=0,s=e.length;i<s;){this.posOut>=n&&this.keccak();const o=Math.min(n-this.posOut,s-i);e.set(r.subarray(this.posOut,this.posOut+o),i),this.posOut+=o,i+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return bo(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(Td(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:r,suffix:n,outputLen:i,rounds:s,enableXOF:o}=this;return e||(e=new mc(r,n,i,o,s)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=s,e.suffix=n,e.outputLen=i,e.enableXOF=o,e.destroyed=this.destroyed,e}}const zd=((t,e,r)=>Ld(()=>new mc(e,t,r)))(1,136,256/8);function Hd(t,e){const r=e||"hex",n=zd(os(t,{strict:!1})?mb(t):t);return r==="bytes"?n:fc(n)}class Vd extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){const r=super.get(e);return super.has(e)&&r!==void 0&&(this.delete(e),super.set(e,r)),r}set(e,r){if(super.set(e,r),this.maxSize&&this.size>this.maxSize){const n=this.keys().next().value;n&&this.delete(n)}return this}}const wc=new Vd(8192);function jb(t,e){if(wc.has(`${t}.${e}`))return wc.get(`${t}.${e}`);const r=e?`${e}${t.toLowerCase()}`:t.substring(2).toLowerCase(),n=Hd(Dd(r),"bytes"),i=(e?r.substring(`${e}0x`.length):r).split("");for(let o=0;o<40;o+=2)n[o>>1]>>4>=8&&i[o]&&(i[o]=i[o].toUpperCase()),(n[o>>1]&15)>=8&&i[o+1]&&(i[o+1]=i[o+1].toUpperCase());const s=`0x${i.join("")}`;return wc.set(`${t}.${e}`,s),s}function Fb(t){const e=Hd(`0x${t.substring(4)}`).substring(26);return jb(`0x${e}`)}async function kb({hash:t,signature:e}){const r=os(t)?t:fc(t),{secp256k1:n}=await Promise.resolve().then(function(){return E2});return`0x${(()=>{if(typeof e=="object"&&"r"in e&&"s"in e){const{r:l,s:u,v:h,yParity:d}=e,p=Number(d??h),f=Wd(p);return new n.Signature(dc(l),dc(u)).addRecoveryBit(f)}const o=os(e)?e:fc(e),a=ub(`0x${o.slice(130)}`),c=Wd(a);return n.Signature.fromCompact(o.substring(2,130)).addRecoveryBit(c)})().recoverPublicKey(r.substring(2)).toHex(!1)}`}function Wd(t){if(t===0||t===1)return t;if(t===27)return 0;if(t===28)return 1;throw new Error("Invalid yParityOrV value")}async function qb({hash:t,signature:e}){return Fb(await kb({hash:t,signature:e}))}function zb(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);const i=BigInt(32),s=BigInt(4294967295),o=Number(r>>i&s),a=Number(r&s),c=n?4:0,l=n?0:4;t.setUint32(e+c,o,n),t.setUint32(e+l,a,n)}function Hb(t,e,r){return t&e^~t&r}function Vb(t,e,r){return t&e^t&r^e&r}class Wb extends gc{constructor(e,r,n,i){super(),this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=pc(this.buffer)}update(e){Zn(this);const{view:r,buffer:n,blockLen:i}=this;e=Eo(e);const s=e.length;for(let o=0;o<s;){const a=Math.min(i-this.pos,s-o);if(a===i){const c=pc(e);for(;i<=s-o;o+=i)this.process(c,o);continue}n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===i&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Zn(this),Td(e,this),this.finished=!0;const{buffer:r,view:n,blockLen:i,isLE:s}=this;let{pos:o}=this;r[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>i-o&&(this.process(n,0),o=0);for(let h=o;h<i;h++)r[h]=0;zb(n,i-8,BigInt(this.length*8),s),this.process(n,0);const a=pc(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<l;h++)a.setUint32(4*h,u[h],s)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:n,length:i,finished:s,destroyed:o,pos:a}=this;return e.length=i,e.pos=a,e.finished=s,e.destroyed=o,i%r&&e.buffer.set(n),e}}const Kb=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Dr=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Tr=new Uint32Array(64);class Gb extends Wb{constructor(){super(64,32,8,!1),this.A=Dr[0]|0,this.B=Dr[1]|0,this.C=Dr[2]|0,this.D=Dr[3]|0,this.E=Dr[4]|0,this.F=Dr[5]|0,this.G=Dr[6]|0,this.H=Dr[7]|0}get(){const{A:e,B:r,C:n,D:i,E:s,F:o,G:a,H:c}=this;return[e,r,n,i,s,o,a,c]}set(e,r,n,i,s,o,a,c){this.A=e|0,this.B=r|0,this.C=n|0,this.D=i|0,this.E=s|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,r){for(let h=0;h<16;h++,r+=4)Tr[h]=e.getUint32(r,!1);for(let h=16;h<64;h++){const d=Tr[h-15],p=Tr[h-2],f=Kt(d,7)^Kt(d,18)^d>>>3,g=Kt(p,17)^Kt(p,19)^p>>>10;Tr[h]=g+Tr[h-7]+f+Tr[h-16]|0}let{A:n,B:i,C:s,D:o,E:a,F:c,G:l,H:u}=this;for(let h=0;h<64;h++){const d=Kt(a,6)^Kt(a,11)^Kt(a,25),p=u+d+Hb(a,c,l)+Kb[h]+Tr[h]|0,g=(Kt(n,2)^Kt(n,13)^Kt(n,22))+Vb(n,i,s)|0;u=l,l=c,c=a,a=o+p|0,o=s,s=i,i=n,n=p+g|0}n=n+this.A|0,i=i+this.B|0,s=s+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(n,i,s,o,a,c,l,u)}roundClean(){Tr.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const _o=Ld(()=>new Gb);new Vd(128);const Zb=new Uint8Array([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),Kd=new Uint8Array(new Array(16).fill(0).map((t,e)=>e)),Yb=Kd.map(t=>(9*t+5)%16);let Jb=[Kd],Qb=[Yb];for(let t=0;t<4;t++)for(let e of[Jb,Qb])e.push(e[t].map(r=>Zb[r]));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const $o=BigInt(0),xo=BigInt(1),Xb=BigInt(2);function hn(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Gt(t){if(!hn(t))throw new Error("Uint8Array expected")}function Jn(t,e){if(typeof e!="boolean")throw new Error(t+" boolean expected, got "+e)}const ev=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Qn(t){Gt(t);let e="";for(let r=0;r<t.length;r++)e+=ev[t[r]];return e}function Xn(t){const e=t.toString(16);return e.length&1?"0"+e:e}function yc(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?$o:BigInt("0x"+t)}const dr={_0:48,_9:57,A:65,F:70,a:97,f:102};function Gd(t){if(t>=dr._0&&t<=dr._9)return t-dr._0;if(t>=dr.A&&t<=dr.F)return t-(dr.A-10);if(t>=dr.a&&t<=dr.f)return t-(dr.a-10)}function ei(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length,r=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(r);for(let i=0,s=0;i<r;i++,s+=2){const o=Gd(t.charCodeAt(s)),a=Gd(t.charCodeAt(s+1));if(o===void 0||a===void 0){const c=t[s]+t[s+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+s)}n[i]=o*16+a}return n}function Zt(t){return yc(Qn(t))}function bc(t){return Gt(t),yc(Qn(Uint8Array.from(t).reverse()))}function Rr(t,e){return ei(t.toString(16).padStart(e*2,"0"))}function vc(t,e){return Rr(t,e).reverse()}function tv(t){return ei(Xn(t))}function Xe(t,e,r){let n;if(typeof e=="string")try{n=ei(e)}catch(s){throw new Error(t+" must be hex string or Uint8Array, cause: "+s)}else if(hn(e))n=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const i=n.length;if(typeof r=="number"&&i!==r)throw new Error(t+" of length "+r+" expected, got "+i);return n}function yt(...t){let e=0;for(let n=0;n<t.length;n++){const i=t[n];Gt(i),e+=i.length}const r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){const s=t[n];r.set(s,i),i+=s.length}return r}function rv(t,e){if(t.length!==e.length)return!1;let r=0;for(let n=0;n<t.length;n++)r|=t[n]^e[n];return r===0}function Io(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}const Ec=t=>typeof t=="bigint"&&$o<=t;function ti(t,e,r){return Ec(t)&&Ec(e)&&Ec(r)&&e<=t&&t<r}function Nr(t,e,r,n){if(!ti(e,r,n))throw new Error("expected valid "+t+": "+r+" <= n < "+n+", got "+e)}function Zd(t){let e;for(e=0;t>$o;t>>=xo,e+=1);return e}function nv(t,e){return t>>BigInt(e)&xo}function iv(t,e,r){return t|(r?xo:$o)<<BigInt(e)}const _c=t=>(Xb<<BigInt(t-1))-xo,$c=t=>new Uint8Array(t),Yd=t=>Uint8Array.from(t);function Jd(t,e,r){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let n=$c(t),i=$c(t),s=0;const o=()=>{n.fill(1),i.fill(0),s=0},a=(...h)=>r(i,n,...h),c=(h=$c())=>{i=a(Yd([0]),h),n=a(),h.length!==0&&(i=a(Yd([1]),h),n=a())},l=()=>{if(s++>=1e3)throw new Error("drbg: tried 1000 values");let h=0;const d=[];for(;h<e;){n=a();const p=n.slice();d.push(p),h+=n.length}return yt(...d)};return(h,d)=>{o(),c(h);let p;for(;!(p=d(l()));)c();return o(),p}}const sv={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||hn(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function ri(t,e,r={}){const n=(i,s,o)=>{const a=sv[s];if(typeof a!="function")throw new Error("invalid validator function");const c=t[i];if(!(o&&c===void 0)&&!a(c,t))throw new Error("param "+String(i)+" is invalid. Expected "+s+", got "+c)};for(const[i,s]of Object.entries(e))n(i,s,!1);for(const[i,s]of Object.entries(r))n(i,s,!0);return t}const ov=()=>{throw new Error("not implemented")};function xc(t){const e=new WeakMap;return(r,...n)=>{const i=e.get(r);if(i!==void 0)return i;const s=t(r,...n);return e.set(r,s),s}}var av=Object.freeze({__proto__:null,isBytes:hn,abytes:Gt,abool:Jn,bytesToHex:Qn,numberToHexUnpadded:Xn,hexToNumber:yc,hexToBytes:ei,bytesToNumberBE:Zt,bytesToNumberLE:bc,numberToBytesBE:Rr,numberToBytesLE:vc,numberToVarBytesBE:tv,ensureBytes:Xe,concatBytes:yt,equalBytes:rv,utf8ToBytes:Io,inRange:ti,aInRange:Nr,bitLen:Zd,bitGet:nv,bitSet:iv,bitMask:_c,createHmacDrbg:Jd,validateObject:ri,notImplemented:ov,memoized:xc});const cv="0.1.1";function lv(){return cv}class rt extends Error{constructor(e,r={}){const n=(()=>{if(r.cause instanceof rt){if(r.cause.details)return r.cause.details;if(r.cause.shortMessage)return r.cause.shortMessage}return r.cause?.message?r.cause.message:r.details})(),i=r.cause instanceof rt&&r.cause.docsPath||r.docsPath,o=`https://oxlib.sh${i??""}`,a=[e||"An error occurred.",...r.metaMessages?["",...r.metaMessages]:[],...n||i?["",n?`Details: ${n}`:void 0,i?`See: ${o}`:void 0]:[]].filter(c=>typeof c=="string").join(`
`);super(a,r.cause?{cause:r.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:`ox@${lv()}`}),this.cause=r.cause,this.details=n,this.docs=o,this.docsPath=i,this.shortMessage=e}walk(e){return Qd(this,e)}}function Qd(t,e){return e?.(t)?t:t&&typeof t=="object"&&"cause"in t&&t.cause?Qd(t.cause,e):e?null:t}function uv(t,e){if(tf(t)>e)throw new yv({givenSize:tf(t),maxSize:e})}const fr={zero:48,nine:57,A:65,F:70,a:97,f:102};function Xd(t){if(t>=fr.zero&&t<=fr.nine)return t-fr.zero;if(t>=fr.A&&t<=fr.F)return t-(fr.A-10);if(t>=fr.a&&t<=fr.f)return t-(fr.a-10)}function hv(t,e={}){const{dir:r,size:n=32}=e;if(n===0)return t;if(t.length>n)throw new bv({size:t.length,targetSize:n,type:"Bytes"});const i=new Uint8Array(n);for(let s=0;s<n;s++){const o=r==="right";i[o?s:n-s-1]=t[o?s:t.length-s-1]}return i}function Ic(t,e){if(Sc(t)>e)throw new Ov({givenSize:Sc(t),maxSize:e})}function ef(t,e={}){const{dir:r,size:n=32}=e;if(n===0)return t;const i=t.replace("0x","");if(i.length>n*2)throw new Sv({size:Math.ceil(i.length/2),targetSize:n,type:"Hex"});return`0x${i[r==="right"?"padEnd":"padStart"](n*2,"0")}`}const dv=new TextEncoder;function fv(t){return t instanceof Uint8Array?t:typeof t=="string"?gv(t):pv(t)}function pv(t){return t instanceof Uint8Array?t:new Uint8Array(t)}function gv(t,e={}){const{size:r}=e;let n=t;r&&(Ic(t,r),n=Oc(t,r));let i=n.slice(2);i.length%2&&(i=`0${i}`);const s=i.length/2,o=new Uint8Array(s);for(let a=0,c=0;a<s;a++){const l=Xd(i.charCodeAt(c++)),u=Xd(i.charCodeAt(c++));if(l===void 0||u===void 0)throw new rt(`Invalid byte sequence ("${i[c-2]}${i[c-1]}" in "${i}").`);o[a]=l*16+u}return o}function mv(t,e={}){const{size:r}=e,n=dv.encode(t);return typeof r=="number"?(uv(n,r),wv(n,r)):n}function wv(t,e){return hv(t,{dir:"right",size:e})}function tf(t){return t.length}class yv extends rt{constructor({givenSize:e,maxSize:r}){super(`Size cannot exceed \`${r}\` bytes. Given size: \`${e}\` bytes.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.SizeOverflowError"})}}class bv extends rt{constructor({size:e,targetSize:r,type:n}){super(`${n.charAt(0).toUpperCase()}${n.slice(1).toLowerCase()} size (\`${e}\`) exceeds padding size (\`${r}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.SizeExceedsPaddingSizeError"})}}const vv=new TextEncoder,Ev=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function rf(...t){return`0x${t.reduce((e,r)=>e+r.replace("0x",""),"")}`}function _v(t,e={}){const r=`0x${Number(t)}`;return typeof e.size=="number"?(Ic(r,e.size),Oo(r,e.size)):r}function nf(t,e={}){let r="";for(let i=0;i<t.length;i++)r+=Ev[t[i]];const n=`0x${r}`;return typeof e.size=="number"?(Ic(n,e.size),Oc(n,e.size)):n}function $v(t,e={}){const{signed:r,size:n}=e,i=BigInt(t);let s;n?r?s=(1n<<BigInt(n)*8n-1n)-1n:s=2n**(BigInt(n)*8n)-1n:typeof t=="number"&&(s=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof s=="bigint"&&r?-s-1n:0;if(s&&i>s||i<o){const l=typeof t=="bigint"?"n":"";throw new Iv({max:s?`${s}${l}`:void 0,min:`${o}${l}`,signed:r,size:n,value:`${t}${l}`})}const c=`0x${(r&&i<0?(1n<<BigInt(n*8))+BigInt(i):i).toString(16)}`;return n?Oo(c,n):c}function xv(t,e={}){return nf(vv.encode(t),e)}function Oo(t,e){return ef(t,{dir:"left",size:e})}function Oc(t,e){return ef(t,{dir:"right",size:e})}function Sc(t){return Math.ceil((t.length-2)/2)}class Iv extends rt{constructor({max:e,min:r,signed:n,size:i,value:s}){super(`Number \`${s}\` is not in safe${i?` ${i*8}-bit`:""}${n?" signed":" unsigned"} integer range ${e?`(\`${r}\` to \`${e}\`)`:`(above \`${r}\`)`}`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.IntegerOutOfRangeError"})}}class Ov extends rt{constructor({givenSize:e,maxSize:r}){super(`Size cannot exceed \`${r}\` bytes. Given size: \`${e}\` bytes.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeOverflowError"})}}class Sv extends rt{constructor({size:e,targetSize:r,type:n}){super(`${n.charAt(0).toUpperCase()}${n.slice(1).toLowerCase()} size (\`${e}\`) exceeds padding size (\`${r}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeExceedsPaddingSizeError"})}}function Av(t,e={}){const{as:r=typeof t=="string"?"Hex":"Bytes"}=e,n=zd(fv(t));return r==="Bytes"?n:nf(n)}class Cv extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){const r=super.get(e);return super.has(e)&&r!==void 0&&(this.delete(e),super.set(e,r)),r}set(e,r){if(super.set(e,r),this.maxSize&&this.size>this.maxSize){const n=this.keys().next().value;n&&this.delete(n)}return this}}const Ac={checksum:new Cv(8192)}.checksum,Pv=/^0x[a-fA-F0-9]{40}$/;function sf(t,e={}){const{strict:r=!0}=e;if(!Pv.test(t))throw new of({address:t,cause:new Tv});if(r){if(t.toLowerCase()===t)return;if(Dv(t)!==t)throw new of({address:t,cause:new Rv})}}function Dv(t){if(Ac.has(t))return Ac.get(t);sf(t,{strict:!1});const e=t.substring(2).toLowerCase(),r=Av(mv(e),{as:"Bytes"}),n=e.split("");for(let s=0;s<40;s+=2)r[s>>1]>>4>=8&&n[s]&&(n[s]=n[s].toUpperCase()),(r[s>>1]&15)>=8&&n[s+1]&&(n[s+1]=n[s+1].toUpperCase());const i=`0x${n.join("")}`;return Ac.set(t,i),i}class of extends rt{constructor({address:e,cause:r}){super(`Address "${e}" is invalid.`,{cause:r}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidAddressError"})}}class Tv extends rt{constructor(){super("Address is not a 20 byte (40 hexadecimal character) value."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidInputError"})}}class Rv extends rt{constructor(){super("Address does not match its checksum counterpart."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidChecksumError"})}}const Nv=/^(.*)\[([0-9]*)\]$/,Bv=/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/,Lv=/^(u?int)(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/;function Cc(t,e){if(t.length!==e.length)throw new Uv({expectedLength:t.length,givenLength:e.length});const r=[];for(let n=0;n<t.length;n++){const i=t[n],s=e[n];r.push(Cc.encode(i,s))}return rf(...r)}(function(t){function e(r,n,i=!1){if(r==="address"){const c=n;return sf(c),Oo(c.toLowerCase(),i?32:0)}if(r==="string")return xv(n);if(r==="bytes")return n;if(r==="bool")return Oo(_v(n),i?32:1);const s=r.match(Lv);if(s){const[c,l,u="256"]=s,h=Number.parseInt(u)/8;return $v(n,{size:i?32:h,signed:l==="int"})}const o=r.match(Bv);if(o){const[c,l]=o;if(Number.parseInt(l)!==(n.length-2)/2)throw new Mv({expectedSize:Number.parseInt(l),value:n});return Oc(n,i?32:0)}const a=r.match(Nv);if(a&&Array.isArray(n)){const[c,l]=a,u=[];for(let h=0;h<n.length;h++)u.push(e(l,n[h],!0));return u.length===0?"0x":rf(...u)}throw new jv(r)}t.encode=e})(Cc||(Cc={}));class Mv extends rt{constructor({expectedSize:e,value:r}){super(`Size of bytes "${r}" (bytes${Sc(r)}) does not match expected size (bytes${e}).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiParameters.BytesSizeMismatchError"})}}class Uv extends rt{constructor({expectedLength:e,givenLength:r}){super(["ABI encoding parameters/values length mismatch.",`Expected length (parameters): ${e}`,`Given length (values): ${r}`].join(`
`)),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiParameters.LengthMismatchError"})}}class jv extends rt{constructor(e){super(`Type \`${e}\` is not a valid ABI Type.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiParameters.InvalidTypeError"})}}class af extends gc{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,vb(e);const n=Eo(r);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const i=this.blockLen,s=new Uint8Array(i);s.set(n.length>i?e.create().update(n).digest():n);for(let o=0;o<s.length;o++)s[o]^=54;this.iHash.update(s),this.oHash=e.create();for(let o=0;o<s.length;o++)s[o]^=106;this.oHash.update(s),s.fill(0)}update(e){return Zn(this),this.iHash.update(e),this}digestInto(e){Zn(this),as(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:r,iHash:n,finished:i,destroyed:s,blockLen:o,outputLen:a}=this;return e=e,e.finished=i,e.destroyed=s,e.blockLen=o,e.outputLen=a,e.oHash=r._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const cf=(t,e,r)=>new af(t,e).update(r).digest();cf.create=(t,e)=>new af(t,e);const Ne=BigInt(0),$e=BigInt(1),dn=BigInt(2),Fv=BigInt(3),Pc=BigInt(4),lf=BigInt(5),uf=BigInt(8);function Be(t,e){const r=t%e;return r>=Ne?r:e+r}function kv(t,e,r){if(e<Ne)throw new Error("invalid exponent, negatives unsupported");if(r<=Ne)throw new Error("invalid modulus");if(r===$e)return Ne;let n=$e;for(;e>Ne;)e&$e&&(n=n*t%r),t=t*t%r,e>>=$e;return n}function At(t,e,r){let n=t;for(;e-- >Ne;)n*=n,n%=r;return n}function Dc(t,e){if(t===Ne)throw new Error("invert: expected non-zero number");if(e<=Ne)throw new Error("invert: expected positive modulus, got "+e);let r=Be(t,e),n=e,i=Ne,s=$e;for(;r!==Ne;){const a=n/r,c=n%r,l=i-s*a;n=r,r=c,i=s,s=l}if(n!==$e)throw new Error("invert: does not exist");return Be(i,e)}function qv(t){const e=(t-$e)/dn;let r,n,i;for(r=t-$e,n=0;r%dn===Ne;r/=dn,n++);for(i=dn;i<t&&kv(i,e,t)!==t-$e;i++)if(i>1e3)throw new Error("Cannot find square root: likely non-prime P");if(n===1){const o=(t+$e)/Pc;return function(c,l){const u=c.pow(l,o);if(!c.eql(c.sqr(u),l))throw new Error("Cannot find square root");return u}}const s=(r+$e)/dn;return function(a,c){if(a.pow(c,e)===a.neg(a.ONE))throw new Error("Cannot find square root");let l=n,u=a.pow(a.mul(a.ONE,i),r),h=a.pow(c,s),d=a.pow(c,r);for(;!a.eql(d,a.ONE);){if(a.eql(d,a.ZERO))return a.ZERO;let p=1;for(let g=a.sqr(d);p<l&&!a.eql(g,a.ONE);p++)g=a.sqr(g);const f=a.pow(u,$e<<BigInt(l-p-1));u=a.sqr(f),h=a.mul(h,f),d=a.mul(d,u),l=p}return h}}function zv(t){if(t%Pc===Fv){const e=(t+$e)/Pc;return function(n,i){const s=n.pow(i,e);if(!n.eql(n.sqr(s),i))throw new Error("Cannot find square root");return s}}if(t%uf===lf){const e=(t-lf)/uf;return function(n,i){const s=n.mul(i,dn),o=n.pow(s,e),a=n.mul(i,o),c=n.mul(n.mul(a,dn),o),l=n.mul(a,n.sub(c,n.ONE));if(!n.eql(n.sqr(l),i))throw new Error("Cannot find square root");return l}}return qv(t)}const Hv=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function hf(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=Hv.reduce((n,i)=>(n[i]="function",n),e);return ri(t,r)}function Vv(t,e,r){if(r<Ne)throw new Error("invalid exponent, negatives unsupported");if(r===Ne)return t.ONE;if(r===$e)return e;let n=t.ONE,i=e;for(;r>Ne;)r&$e&&(n=t.mul(n,i)),i=t.sqr(i),r>>=$e;return n}function Wv(t,e){const r=new Array(e.length),n=e.reduce((s,o,a)=>t.is0(o)?s:(r[a]=s,t.mul(s,o)),t.ONE),i=t.inv(n);return e.reduceRight((s,o,a)=>t.is0(o)?s:(r[a]=t.mul(s,r[a]),t.mul(s,o)),i),r}function df(t,e){const r=e!==void 0?e:t.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function ff(t,e,r=!1,n={}){if(t<=Ne)throw new Error("invalid field: expected ORDER > 0, got "+t);const{nBitLength:i,nByteLength:s}=df(t,e);if(s>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:t,isLE:r,BITS:i,BYTES:s,MASK:_c(i),ZERO:Ne,ONE:$e,create:c=>Be(c,t),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return Ne<=c&&c<t},is0:c=>c===Ne,isOdd:c=>(c&$e)===$e,neg:c=>Be(-c,t),eql:(c,l)=>c===l,sqr:c=>Be(c*c,t),add:(c,l)=>Be(c+l,t),sub:(c,l)=>Be(c-l,t),mul:(c,l)=>Be(c*l,t),pow:(c,l)=>Vv(a,c,l),div:(c,l)=>Be(c*Dc(l,t),t),sqrN:c=>c*c,addN:(c,l)=>c+l,subN:(c,l)=>c-l,mulN:(c,l)=>c*l,inv:c=>Dc(c,t),sqrt:n.sqrt||(c=>(o||(o=zv(t)),o(a,c))),invertBatch:c=>Wv(a,c),cmov:(c,l,u)=>u?l:c,toBytes:c=>r?vc(c,s):Rr(c,s),fromBytes:c=>{if(c.length!==s)throw new Error("Field.fromBytes: expected "+s+" bytes, got "+c.length);return r?bc(c):Zt(c)}});return Object.freeze(a)}function pf(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function gf(t){const e=pf(t);return e+Math.ceil(e/2)}function Kv(t,e,r=!1){const n=t.length,i=pf(e),s=gf(e);if(n<16||n<s||n>1024)throw new Error("expected "+s+"-1024 bytes of input, got "+n);const o=r?bc(t):Zt(t),a=Be(o,e-$e)+$e;return r?vc(a,i):Rr(a,i)}const mf=BigInt(0),So=BigInt(1);function Tc(t,e){const r=e.negate();return t?r:e}function wf(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function Rc(t,e){wf(t,e);const r=Math.ceil(e/t)+1,n=2**(t-1);return{windows:r,windowSize:n}}function Gv(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((r,n)=>{if(!(r instanceof e))throw new Error("invalid point at index "+n)})}function Zv(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((r,n)=>{if(!e.isValid(r))throw new Error("invalid scalar at index "+n)})}const Nc=new WeakMap,yf=new WeakMap;function Bc(t){return yf.get(t)||1}function Yv(t,e){return{constTimeNegate:Tc,hasPrecomputes(r){return Bc(r)!==1},unsafeLadder(r,n,i=t.ZERO){let s=r;for(;n>mf;)n&So&&(i=i.add(s)),s=s.double(),n>>=So;return i},precomputeWindow(r,n){const{windows:i,windowSize:s}=Rc(n,e),o=[];let a=r,c=a;for(let l=0;l<i;l++){c=a,o.push(c);for(let u=1;u<s;u++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(r,n,i){const{windows:s,windowSize:o}=Rc(r,e);let a=t.ZERO,c=t.BASE;const l=BigInt(2**r-1),u=2**r,h=BigInt(r);for(let d=0;d<s;d++){const p=d*o;let f=Number(i&l);i>>=h,f>o&&(f-=u,i+=So);const g=p,m=p+Math.abs(f)-1,w=d%2!==0,y=f<0;f===0?c=c.add(Tc(w,n[g])):a=a.add(Tc(y,n[m]))}return{p:a,f:c}},wNAFUnsafe(r,n,i,s=t.ZERO){const{windows:o,windowSize:a}=Rc(r,e),c=BigInt(2**r-1),l=2**r,u=BigInt(r);for(let h=0;h<o;h++){const d=h*a;if(i===mf)break;let p=Number(i&c);if(i>>=u,p>a&&(p-=l,i+=So),p===0)continue;let f=n[d+Math.abs(p)-1];p<0&&(f=f.negate()),s=s.add(f)}return s},getPrecomputes(r,n,i){let s=Nc.get(n);return s||(s=this.precomputeWindow(n,r),r!==1&&Nc.set(n,i(s))),s},wNAFCached(r,n,i){const s=Bc(r);return this.wNAF(s,this.getPrecomputes(s,r,i),n)},wNAFCachedUnsafe(r,n,i,s){const o=Bc(r);return o===1?this.unsafeLadder(r,n,s):this.wNAFUnsafe(o,this.getPrecomputes(o,r,i),n,s)},setWindowSize(r,n){wf(n,e),yf.set(r,n),Nc.delete(r)}}}function Jv(t,e,r,n){if(Gv(r,t),Zv(n,e),r.length!==n.length)throw new Error("arrays of points and scalars must have equal length");const i=t.ZERO,s=Zd(BigInt(r.length)),o=s>12?s-3:s>4?s-2:s?2:1,a=(1<<o)-1,c=new Array(a+1).fill(i),l=Math.floor((e.BITS-1)/o)*o;let u=i;for(let h=l;h>=0;h-=o){c.fill(i);for(let p=0;p<n.length;p++){const f=n[p],g=Number(f>>BigInt(h)&BigInt(a));c[g]=c[g].add(r[p])}let d=i;for(let p=c.length-1,f=i;p>0;p--)f=f.add(c[p]),d=d.add(f);if(u=u.add(d),h!==0)for(let p=0;p<o;p++)u=u.double()}return u}function bf(t){return hf(t.Fp),ri(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...df(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}function vf(t){t.lowS!==void 0&&Jn("lowS",t.lowS),t.prehash!==void 0&&Jn("prehash",t.prehash)}function Qv(t){const e=bf(t);ri(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:r,Fp:n,a:i}=e;if(r){if(!n.eql(i,n.ZERO))throw new Error("invalid endomorphism, can only be defined for Koblitz curves that have a=0");if(typeof r!="object"||typeof r.beta!="bigint"||typeof r.splitScalar!="function")throw new Error("invalid endomorphism, expected beta: bigint and splitScalar: function")}return Object.freeze({...e})}const{bytesToNumberBE:Xv,hexToBytes:e2}=av;class t2 extends Error{constructor(e=""){super(e)}}const pr={Err:t2,_tlv:{encode:(t,e)=>{const{Err:r}=pr;if(t<0||t>256)throw new r("tlv.encode: wrong tag");if(e.length&1)throw new r("tlv.encode: unpadded data");const n=e.length/2,i=Xn(n);if(i.length/2&128)throw new r("tlv.encode: long form length too big");const s=n>127?Xn(i.length/2|128):"";return Xn(t)+s+i+e},decode(t,e){const{Err:r}=pr;let n=0;if(t<0||t>256)throw new r("tlv.encode: wrong tag");if(e.length<2||e[n++]!==t)throw new r("tlv.decode: wrong tlv");const i=e[n++],s=!!(i&128);let o=0;if(!s)o=i;else{const c=i&127;if(!c)throw new r("tlv.decode(long): indefinite length not supported");if(c>4)throw new r("tlv.decode(long): byte length is too big");const l=e.subarray(n,n+c);if(l.length!==c)throw new r("tlv.decode: length bytes not complete");if(l[0]===0)throw new r("tlv.decode(long): zero leftmost byte");for(const u of l)o=o<<8|u;if(n+=c,o<128)throw new r("tlv.decode(long): not minimal encoding")}const a=e.subarray(n,n+o);if(a.length!==o)throw new r("tlv.decode: wrong value length");return{v:a,l:e.subarray(n+o)}}},_int:{encode(t){const{Err:e}=pr;if(t<Ut)throw new e("integer: negative integers are not allowed");let r=Xn(t);if(Number.parseInt(r[0],16)&8&&(r="00"+r),r.length&1)throw new e("unexpected DER parsing assertion: unpadded hex");return r},decode(t){const{Err:e}=pr;if(t[0]&128)throw new e("invalid signature integer: negative");if(t[0]===0&&!(t[1]&128))throw new e("invalid signature integer: unnecessary leading zero");return Xv(t)}},toSig(t){const{Err:e,_int:r,_tlv:n}=pr,i=typeof t=="string"?e2(t):t;Gt(i);const{v:s,l:o}=n.decode(48,i);if(o.length)throw new e("invalid signature: left bytes after parsing");const{v:a,l:c}=n.decode(2,s),{v:l,l:u}=n.decode(2,c);if(u.length)throw new e("invalid signature: left bytes after parsing");return{r:r.decode(a),s:r.decode(l)}},hexFromSig(t){const{_tlv:e,_int:r}=pr,n=e.encode(2,r.encode(t.r)),i=e.encode(2,r.encode(t.s)),s=n+i;return e.encode(48,s)}},Ut=BigInt(0),fe=BigInt(1),Br=BigInt(2),Ao=BigInt(3),Ef=BigInt(4);function r2(t){const e=Qv(t),{Fp:r}=e,n=ff(e.n,e.nBitLength),i=e.toBytes||((g,m,w)=>{const y=m.toAffine();return yt(Uint8Array.from([4]),r.toBytes(y.x),r.toBytes(y.y))}),s=e.fromBytes||(g=>{const m=g.subarray(1),w=r.fromBytes(m.subarray(0,r.BYTES)),y=r.fromBytes(m.subarray(r.BYTES,2*r.BYTES));return{x:w,y}});function o(g){const{a:m,b:w}=e,y=r.sqr(g),E=r.mul(y,g);return r.add(r.add(E,r.mul(g,m)),w)}if(!r.eql(r.sqr(e.Gy),o(e.Gx)))throw new Error("bad generator point: equation left != right");function a(g){return ti(g,fe,e.n)}function c(g){const{allowedPrivateKeyLengths:m,nByteLength:w,wrapPrivateKey:y,n:E}=e;if(m&&typeof g!="bigint"){if(hn(g)&&(g=Qn(g)),typeof g!="string"||!m.includes(g.length))throw new Error("invalid private key");g=g.padStart(w*2,"0")}let _;try{_=typeof g=="bigint"?g:Zt(Xe("private key",g,w))}catch{throw new Error("invalid private key, expected hex or "+w+" bytes, got "+typeof g)}return y&&(_=Be(_,E)),Nr("private key",_,fe,E),_}function l(g){if(!(g instanceof d))throw new Error("ProjectivePoint expected")}const u=xc((g,m)=>{const{px:w,py:y,pz:E}=g;if(r.eql(E,r.ONE))return{x:w,y};const _=g.is0();m==null&&(m=_?r.ONE:r.inv(E));const O=r.mul(w,m),S=r.mul(y,m),x=r.mul(E,m);if(_)return{x:r.ZERO,y:r.ZERO};if(!r.eql(x,r.ONE))throw new Error("invZ was invalid");return{x:O,y:S}}),h=xc(g=>{if(g.is0()){if(e.allowInfinityPoint&&!r.is0(g.py))return;throw new Error("bad point: ZERO")}const{x:m,y:w}=g.toAffine();if(!r.isValid(m)||!r.isValid(w))throw new Error("bad point: x or y not FE");const y=r.sqr(w),E=o(m);if(!r.eql(y,E))throw new Error("bad point: equation left != right");if(!g.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});class d{constructor(m,w,y){if(this.px=m,this.py=w,this.pz=y,m==null||!r.isValid(m))throw new Error("x required");if(w==null||!r.isValid(w))throw new Error("y required");if(y==null||!r.isValid(y))throw new Error("z required");Object.freeze(this)}static fromAffine(m){const{x:w,y}=m||{};if(!m||!r.isValid(w)||!r.isValid(y))throw new Error("invalid affine point");if(m instanceof d)throw new Error("projective point not allowed");const E=_=>r.eql(_,r.ZERO);return E(w)&&E(y)?d.ZERO:new d(w,y,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(m){const w=r.invertBatch(m.map(y=>y.pz));return m.map((y,E)=>y.toAffine(w[E])).map(d.fromAffine)}static fromHex(m){const w=d.fromAffine(s(Xe("pointHex",m)));return w.assertValidity(),w}static fromPrivateKey(m){return d.BASE.multiply(c(m))}static msm(m,w){return Jv(d,n,m,w)}_setWindowSize(m){f.setWindowSize(this,m)}assertValidity(){h(this)}hasEvenY(){const{y:m}=this.toAffine();if(r.isOdd)return!r.isOdd(m);throw new Error("Field doesn't support isOdd")}equals(m){l(m);const{px:w,py:y,pz:E}=this,{px:_,py:O,pz:S}=m,x=r.eql(r.mul(w,S),r.mul(_,E)),P=r.eql(r.mul(y,S),r.mul(O,E));return x&&P}negate(){return new d(this.px,r.neg(this.py),this.pz)}double(){const{a:m,b:w}=e,y=r.mul(w,Ao),{px:E,py:_,pz:O}=this;let S=r.ZERO,x=r.ZERO,P=r.ZERO,$=r.mul(E,E),B=r.mul(_,_),D=r.mul(O,O),R=r.mul(E,_);return R=r.add(R,R),P=r.mul(E,O),P=r.add(P,P),S=r.mul(m,P),x=r.mul(y,D),x=r.add(S,x),S=r.sub(B,x),x=r.add(B,x),x=r.mul(S,x),S=r.mul(R,S),P=r.mul(y,P),D=r.mul(m,D),R=r.sub($,D),R=r.mul(m,R),R=r.add(R,P),P=r.add($,$),$=r.add(P,$),$=r.add($,D),$=r.mul($,R),x=r.add(x,$),D=r.mul(_,O),D=r.add(D,D),$=r.mul(D,R),S=r.sub(S,$),P=r.mul(D,B),P=r.add(P,P),P=r.add(P,P),new d(S,x,P)}add(m){l(m);const{px:w,py:y,pz:E}=this,{px:_,py:O,pz:S}=m;let x=r.ZERO,P=r.ZERO,$=r.ZERO;const B=e.a,D=r.mul(e.b,Ao);let R=r.mul(w,_),M=r.mul(y,O),A=r.mul(E,S),b=r.add(w,y),v=r.add(_,O);b=r.mul(b,v),v=r.add(R,M),b=r.sub(b,v),v=r.add(w,E);let I=r.add(_,S);return v=r.mul(v,I),I=r.add(R,A),v=r.sub(v,I),I=r.add(y,E),x=r.add(O,S),I=r.mul(I,x),x=r.add(M,A),I=r.sub(I,x),$=r.mul(B,v),x=r.mul(D,A),$=r.add(x,$),x=r.sub(M,$),$=r.add(M,$),P=r.mul(x,$),M=r.add(R,R),M=r.add(M,R),A=r.mul(B,A),v=r.mul(D,v),M=r.add(M,A),A=r.sub(R,A),A=r.mul(B,A),v=r.add(v,A),R=r.mul(M,v),P=r.add(P,R),R=r.mul(I,v),x=r.mul(b,x),x=r.sub(x,R),R=r.mul(b,M),$=r.mul(I,$),$=r.add($,R),new d(x,P,$)}subtract(m){return this.add(m.negate())}is0(){return this.equals(d.ZERO)}wNAF(m){return f.wNAFCached(this,m,d.normalizeZ)}multiplyUnsafe(m){const{endo:w,n:y}=e;Nr("scalar",m,Ut,y);const E=d.ZERO;if(m===Ut)return E;if(this.is0()||m===fe)return this;if(!w||f.hasPrecomputes(this))return f.wNAFCachedUnsafe(this,m,d.normalizeZ);let{k1neg:_,k1:O,k2neg:S,k2:x}=w.splitScalar(m),P=E,$=E,B=this;for(;O>Ut||x>Ut;)O&fe&&(P=P.add(B)),x&fe&&($=$.add(B)),B=B.double(),O>>=fe,x>>=fe;return _&&(P=P.negate()),S&&($=$.negate()),$=new d(r.mul($.px,w.beta),$.py,$.pz),P.add($)}multiply(m){const{endo:w,n:y}=e;Nr("scalar",m,fe,y);let E,_;if(w){const{k1neg:O,k1:S,k2neg:x,k2:P}=w.splitScalar(m);let{p:$,f:B}=this.wNAF(S),{p:D,f:R}=this.wNAF(P);$=f.constTimeNegate(O,$),D=f.constTimeNegate(x,D),D=new d(r.mul(D.px,w.beta),D.py,D.pz),E=$.add(D),_=B.add(R)}else{const{p:O,f:S}=this.wNAF(m);E=O,_=S}return d.normalizeZ([E,_])[0]}multiplyAndAddUnsafe(m,w,y){const E=d.BASE,_=(S,x)=>x===Ut||x===fe||!S.equals(E)?S.multiplyUnsafe(x):S.multiply(x),O=_(this,w).add(_(m,y));return O.is0()?void 0:O}toAffine(m){return u(this,m)}isTorsionFree(){const{h:m,isTorsionFree:w}=e;if(m===fe)return!0;if(w)return w(d,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:m,clearCofactor:w}=e;return m===fe?this:w?w(d,this):this.multiplyUnsafe(e.h)}toRawBytes(m=!0){return Jn("isCompressed",m),this.assertValidity(),i(d,this,m)}toHex(m=!0){return Jn("isCompressed",m),Qn(this.toRawBytes(m))}}d.BASE=new d(e.Gx,e.Gy,r.ONE),d.ZERO=new d(r.ZERO,r.ONE,r.ZERO);const p=e.nBitLength,f=Yv(d,e.endo?Math.ceil(p/2):p);return{CURVE:e,ProjectivePoint:d,normPrivateKeyToScalar:c,weierstrassEquation:o,isWithinCurveOrder:a}}function n2(t){const e=bf(t);return ri(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function i2(t){const e=n2(t),{Fp:r,n}=e,i=r.BYTES+1,s=2*r.BYTES+1;function o(A){return Be(A,n)}function a(A){return Dc(A,n)}const{ProjectivePoint:c,normPrivateKeyToScalar:l,weierstrassEquation:u,isWithinCurveOrder:h}=r2({...e,toBytes(A,b,v){const I=b.toAffine(),T=r.toBytes(I.x),C=yt;return Jn("isCompressed",v),v?C(Uint8Array.from([b.hasEvenY()?2:3]),T):C(Uint8Array.from([4]),T,r.toBytes(I.y))},fromBytes(A){const b=A.length,v=A[0],I=A.subarray(1);if(b===i&&(v===2||v===3)){const T=Zt(I);if(!ti(T,fe,r.ORDER))throw new Error("Point is not on curve");const C=u(T);let N;try{N=r.sqrt(C)}catch(H){const q=H instanceof Error?": "+H.message:"";throw new Error("Point is not on curve"+q)}const U=(N&fe)===fe;return(v&1)===1!==U&&(N=r.neg(N)),{x:T,y:N}}else if(b===s&&v===4){const T=r.fromBytes(I.subarray(0,r.BYTES)),C=r.fromBytes(I.subarray(r.BYTES,2*r.BYTES));return{x:T,y:C}}else{const T=i,C=s;throw new Error("invalid Point, expected length of "+T+", or uncompressed "+C+", got "+b)}}}),d=A=>Qn(Rr(A,e.nByteLength));function p(A){const b=n>>fe;return A>b}function f(A){return p(A)?o(-A):A}const g=(A,b,v)=>Zt(A.slice(b,v));class m{constructor(b,v,I){this.r=b,this.s=v,this.recovery=I,this.assertValidity()}static fromCompact(b){const v=e.nByteLength;return b=Xe("compactSignature",b,v*2),new m(g(b,0,v),g(b,v,2*v))}static fromDER(b){const{r:v,s:I}=pr.toSig(Xe("DER",b));return new m(v,I)}assertValidity(){Nr("r",this.r,fe,n),Nr("s",this.s,fe,n)}addRecoveryBit(b){return new m(this.r,this.s,b)}recoverPublicKey(b){const{r:v,s:I,recovery:T}=this,C=S(Xe("msgHash",b));if(T==null||![0,1,2,3].includes(T))throw new Error("recovery id invalid");const N=T===2||T===3?v+e.n:v;if(N>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");const U=(T&1)===0?"02":"03",k=c.fromHex(U+d(N)),H=a(N),q=o(-C*H),W=o(I*H),G=c.BASE.multiplyAndAddUnsafe(k,q,W);if(!G)throw new Error("point at infinify");return G.assertValidity(),G}hasHighS(){return p(this.s)}normalizeS(){return this.hasHighS()?new m(this.r,o(-this.s),this.recovery):this}toDERRawBytes(){return ei(this.toDERHex())}toDERHex(){return pr.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return ei(this.toCompactHex())}toCompactHex(){return d(this.r)+d(this.s)}}const w={isValidPrivateKey(A){try{return l(A),!0}catch{return!1}},normPrivateKeyToScalar:l,randomPrivateKey:()=>{const A=gf(e.n);return Kv(e.randomBytes(A),e.n)},precompute(A=8,b=c.BASE){return b._setWindowSize(A),b.multiply(BigInt(3)),b}};function y(A,b=!0){return c.fromPrivateKey(A).toRawBytes(b)}function E(A){const b=hn(A),v=typeof A=="string",I=(b||v)&&A.length;return b?I===i||I===s:v?I===2*i||I===2*s:A instanceof c}function _(A,b,v=!0){if(E(A))throw new Error("first arg must be private key");if(!E(b))throw new Error("second arg must be public key");return c.fromHex(b).multiply(l(A)).toRawBytes(v)}const O=e.bits2int||function(A){if(A.length>8192)throw new Error("input is too large");const b=Zt(A),v=A.length*8-e.nBitLength;return v>0?b>>BigInt(v):b},S=e.bits2int_modN||function(A){return o(O(A))},x=_c(e.nBitLength);function P(A){return Nr("num < 2^"+e.nBitLength,A,Ut,x),Rr(A,e.nByteLength)}function $(A,b,v=B){if(["recovered","canonical"].some(X=>X in v))throw new Error("sign() legacy options not supported");const{hash:I,randomBytes:T}=e;let{lowS:C,prehash:N,extraEntropy:U}=v;C==null&&(C=!0),A=Xe("msgHash",A),vf(v),N&&(A=Xe("prehashed msgHash",I(A)));const k=S(A),H=l(b),q=[P(H),P(k)];if(U!=null&&U!==!1){const X=U===!0?T(r.BYTES):U;q.push(Xe("extraEntropy",X))}const W=yt(...q),G=k;function ce(X){const Q=O(X);if(!h(Q))return;const Se=a(Q),ve=c.BASE.multiply(Q).toAffine(),_e=o(ve.x);if(_e===Ut)return;const He=o(Se*o(G+_e*H));if(He===Ut)return;let Pe=(ve.x===_e?0:2)|Number(ve.y&fe),Pr=He;return C&&p(He)&&(Pr=f(He),Pe^=1),new m(_e,Pr,Pe)}return{seed:W,k2sig:ce}}const B={lowS:e.lowS,prehash:!1},D={lowS:e.lowS,prehash:!1};function R(A,b,v=B){const{seed:I,k2sig:T}=$(A,b,v),C=e;return Jd(C.hash.outputLen,C.nByteLength,C.hmac)(I,T)}c.BASE._setWindowSize(8);function M(A,b,v,I=D){const T=A;b=Xe("msgHash",b),v=Xe("publicKey",v);const{lowS:C,prehash:N,format:U}=I;if(vf(I),"strict"in I)throw new Error("options.strict was renamed to lowS");if(U!==void 0&&U!=="compact"&&U!=="der")throw new Error("format must be compact or der");const k=typeof T=="string"||hn(T),H=!k&&!U&&typeof T=="object"&&T!==null&&typeof T.r=="bigint"&&typeof T.s=="bigint";if(!k&&!H)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let q,W;try{if(H&&(q=new m(T.r,T.s)),k){try{U!=="compact"&&(q=m.fromDER(T))}catch(Pe){if(!(Pe instanceof pr.Err))throw Pe}!q&&U!=="der"&&(q=m.fromCompact(T))}W=c.fromHex(v)}catch{return!1}if(!q||C&&q.hasHighS())return!1;N&&(b=e.hash(b));const{r:G,s:ce}=q,X=S(b),Q=a(ce),Se=o(X*Q),ve=o(G*Q),_e=c.BASE.multiplyAndAddUnsafe(W,Se,ve)?.toAffine();return _e?o(_e.x)===G:!1}return{CURVE:e,getPublicKey:y,getSharedSecret:_,sign:R,verify:M,ProjectivePoint:c,Signature:m,utils:w}}function s2(t,e){const r=t.ORDER;let n=Ut;for(let f=r-fe;f%Br===Ut;f/=Br)n+=fe;const i=n,s=Br<<i-fe-fe,o=s*Br,a=(r-fe)/o,c=(a-fe)/Br,l=o-fe,u=s,h=t.pow(e,a),d=t.pow(e,(a+fe)/Br);let p=(f,g)=>{let m=h,w=t.pow(g,l),y=t.sqr(w);y=t.mul(y,g);let E=t.mul(f,y);E=t.pow(E,c),E=t.mul(E,w),w=t.mul(E,g),y=t.mul(E,f);let _=t.mul(y,w);E=t.pow(_,u);let O=t.eql(E,t.ONE);w=t.mul(y,d),E=t.mul(_,m),y=t.cmov(w,y,O),_=t.cmov(E,_,O);for(let S=i;S>fe;S--){let x=S-Br;x=Br<<x-fe;let P=t.pow(_,x);const $=t.eql(P,t.ONE);w=t.mul(y,m),m=t.mul(m,m),P=t.mul(_,m),y=t.cmov(w,y,$),_=t.cmov(P,_,$)}return{isValid:O,value:y}};if(t.ORDER%Ef===Ao){const f=(t.ORDER-Ao)/Ef,g=t.sqrt(t.neg(e));p=(m,w)=>{let y=t.sqr(w);const E=t.mul(m,w);y=t.mul(y,E);let _=t.pow(y,f);_=t.mul(_,E);const O=t.mul(_,g),S=t.mul(t.sqr(_),w),x=t.eql(S,m);let P=t.cmov(O,_,x);return{isValid:x,value:P}}}return p}function o2(t,e){if(hf(t),!t.isValid(e.A)||!t.isValid(e.B)||!t.isValid(e.Z))throw new Error("mapToCurveSimpleSWU: invalid opts");const r=s2(t,e.Z);if(!t.isOdd)throw new Error("Fp.isOdd is not implemented!");return n=>{let i,s,o,a,c,l,u,h;i=t.sqr(n),i=t.mul(i,e.Z),s=t.sqr(i),s=t.add(s,i),o=t.add(s,t.ONE),o=t.mul(o,e.B),a=t.cmov(e.Z,t.neg(s),!t.eql(s,t.ZERO)),a=t.mul(a,e.A),s=t.sqr(o),l=t.sqr(a),c=t.mul(l,e.A),s=t.add(s,c),s=t.mul(s,o),l=t.mul(l,a),c=t.mul(l,e.B),s=t.add(s,c),u=t.mul(i,o);const{isValid:d,value:p}=r(s,l);h=t.mul(i,n),h=t.mul(h,p),u=t.cmov(u,o,d),h=t.cmov(h,p,d);const f=t.isOdd(n)===t.isOdd(h);return h=t.cmov(t.neg(h),h,f),u=t.div(u,a),{x:u,y:h}}}function a2(t){return{hash:t,hmac:(e,...r)=>cf(t,e,Pb(...r)),randomBytes:Md}}function c2(t,e){const r=n=>i2({...t,...a2(n)});return{...r(e),create:r}}const l2=Zt;function Lr(t,e){if(ls(t),ls(e),t<0||t>=1<<8*e)throw new Error("invalid I2OSP input: "+t);const r=Array.from({length:e}).fill(0);for(let n=e-1;n>=0;n--)r[n]=t&255,t>>>=8;return new Uint8Array(r)}function u2(t,e){const r=new Uint8Array(t.length);for(let n=0;n<t.length;n++)r[n]=t[n]^e[n];return r}function ls(t){if(!Number.isSafeInteger(t))throw new Error("number expected")}function h2(t,e,r,n){Gt(t),Gt(e),ls(r),e.length>255&&(e=n(yt(Io("H2C-OVERSIZE-DST-"),e)));const{outputLen:i,blockLen:s}=n,o=Math.ceil(r/i);if(r>65535||o>255)throw new Error("expand_message_xmd: invalid lenInBytes");const a=yt(e,Lr(e.length,1)),c=Lr(0,s),l=Lr(r,2),u=new Array(o),h=n(yt(c,t,l,Lr(0,1),a));u[0]=n(yt(h,Lr(1,1),a));for(let p=1;p<=o;p++){const f=[u2(h,u[p-1]),Lr(p+1,1),a];u[p]=n(yt(...f))}return yt(...u).slice(0,r)}function d2(t,e,r,n,i){if(Gt(t),Gt(e),ls(r),e.length>255){const s=Math.ceil(2*n/8);e=i.create({dkLen:s}).update(Io("H2C-OVERSIZE-DST-")).update(e).digest()}if(r>65535||e.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return i.create({dkLen:r}).update(t).update(Lr(r,2)).update(e).update(Lr(e.length,1)).digest()}function _f(t,e,r){ri(r,{DST:"stringOrUint8Array",p:"bigint",m:"isSafeInteger",k:"isSafeInteger",hash:"hash"});const{p:n,k:i,m:s,hash:o,expand:a,DST:c}=r;Gt(t),ls(e);const l=typeof c=="string"?Io(c):c,u=n.toString(2).length,h=Math.ceil((u+i)/8),d=e*s*h;let p;if(a==="xmd")p=h2(t,l,d,o);else if(a==="xof")p=d2(t,l,d,i,o);else if(a==="_internal_pass")p=t;else throw new Error('expand must be "xmd" or "xof"');const f=new Array(e);for(let g=0;g<e;g++){const m=new Array(s);for(let w=0;w<s;w++){const y=h*(w+g*s),E=p.subarray(y,y+h);m[w]=Be(l2(E),n)}f[g]=m}return f}function f2(t,e){const r=e.map(n=>Array.from(n).reverse());return(n,i)=>{const[s,o,a,c]=r.map(l=>l.reduce((u,h)=>t.add(t.mul(u,n),h)));return n=t.div(s,o),i=t.mul(i,t.div(a,c)),{x:n,y:i}}}function p2(t,e,r){if(typeof e!="function")throw new Error("mapToCurve() must be defined");return{hashToCurve(n,i){const s=_f(n,2,{...r,DST:r.DST,...i}),o=t.fromAffine(e(s[0])),a=t.fromAffine(e(s[1])),c=o.add(a).clearCofactor();return c.assertValidity(),c},encodeToCurve(n,i){const s=_f(n,1,{...r,DST:r.encodeDST,...i}),o=t.fromAffine(e(s[0])).clearCofactor();return o.assertValidity(),o},mapToCurve(n){if(!Array.isArray(n))throw new Error("mapToCurve: expected array of bigints");for(const s of n)if(typeof s!="bigint")throw new Error("mapToCurve: expected array of bigints");const i=t.fromAffine(e(n)).clearCofactor();return i.assertValidity(),i}}}const us=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),Co=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),hs=BigInt(1),Po=BigInt(2),$f=(t,e)=>(t+e/Po)/e;function xf(t){const e=us,r=BigInt(3),n=BigInt(6),i=BigInt(11),s=BigInt(22),o=BigInt(23),a=BigInt(44),c=BigInt(88),l=t*t*t%e,u=l*l*t%e,h=At(u,r,e)*u%e,d=At(h,r,e)*u%e,p=At(d,Po,e)*l%e,f=At(p,i,e)*p%e,g=At(f,s,e)*f%e,m=At(g,a,e)*g%e,w=At(m,c,e)*m%e,y=At(w,a,e)*g%e,E=At(y,r,e)*u%e,_=At(E,o,e)*f%e,O=At(_,n,e)*l%e,S=At(O,Po,e);if(!Mr.eql(Mr.sqr(S),t))throw new Error("Cannot find square root");return S}const Mr=ff(us,void 0,void 0,{sqrt:xf}),ds=c2({a:BigInt(0),b:BigInt(7),Fp:Mr,n:Co,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{const e=Co,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-hs*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=r,o=BigInt("0x100000000000000000000000000000000"),a=$f(s*t,e),c=$f(-n*t,e);let l=Be(t-a*r-c*i,e),u=Be(-a*n-c*s,e);const h=l>o,d=u>o;if(h&&(l=e-l),d&&(u=e-u),l>o||u>o)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:h,k1:l,k2neg:d,k2:u}}}},_o),If=BigInt(0),Of={};function Do(t,...e){let r=Of[t];if(r===void 0){const n=_o(Uint8Array.from(t,i=>i.charCodeAt(0)));r=yt(n,n),Of[t]=r}return _o(yt(r,...e))}const Lc=t=>t.toRawBytes(!0).slice(1),Mc=t=>Rr(t,32),Uc=t=>Be(t,us),fs=t=>Be(t,Co),jc=ds.ProjectivePoint,g2=(t,e,r)=>jc.BASE.multiplyAndAddUnsafe(t,e,r);function Fc(t){let e=ds.utils.normPrivateKeyToScalar(t),r=jc.fromPrivateKey(e);return{scalar:r.hasEvenY()?e:fs(-e),bytes:Lc(r)}}function Sf(t){Nr("x",t,hs,us);const e=Uc(t*t),r=Uc(e*t+BigInt(7));let n=xf(r);n%Po!==If&&(n=Uc(-n));const i=new jc(t,n,hs);return i.assertValidity(),i}const ni=Zt;function Af(...t){return fs(ni(Do("BIP0340/challenge",...t)))}function m2(t){return Fc(t).bytes}function w2(t,e,r=Md(32)){const n=Xe("message",t),{bytes:i,scalar:s}=Fc(e),o=Xe("auxRand",r,32),a=Mc(s^ni(Do("BIP0340/aux",o))),c=Do("BIP0340/nonce",a,i,n),l=fs(ni(c));if(l===If)throw new Error("sign failed: k is zero");const{bytes:u,scalar:h}=Fc(l),d=Af(u,i,n),p=new Uint8Array(64);if(p.set(u,0),p.set(Mc(fs(h+d*s)),32),!Cf(p,n,i))throw new Error("sign: Invalid signature produced");return p}function Cf(t,e,r){const n=Xe("signature",t,64),i=Xe("message",e),s=Xe("publicKey",r,32);try{const o=Sf(ni(s)),a=ni(n.subarray(0,32));if(!ti(a,hs,us))return!1;const c=ni(n.subarray(32,64));if(!ti(c,hs,Co))return!1;const l=Af(Mc(a),Lc(o),i),u=g2(o,c,fs(-l));return!(!u||!u.hasEvenY()||u.toAffine().x!==a)}catch{return!1}}const y2={getPublicKey:m2,sign:w2,verify:Cf,utils:{randomPrivateKey:ds.utils.randomPrivateKey,lift_x:Sf,pointToBytes:Lc,numberToBytesBE:Rr,bytesToNumberBE:Zt,taggedHash:Do,mod:Be}},b2=f2(Mr,[["0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7","0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581","0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262","0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c"],["0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b","0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14","0x0000000000000000000000000000000000000000000000000000000000000001"],["0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c","0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3","0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931","0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84"],["0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b","0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573","0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f","0x0000000000000000000000000000000000000000000000000000000000000001"]].map(t=>t.map(e=>BigInt(e)))),v2=o2(Mr,{A:BigInt("0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533"),B:BigInt("1771"),Z:Mr.create(BigInt("-11"))}),Pf=p2(ds.ProjectivePoint,t=>{const{x:e,y:r}=v2(Mr.create(t[0]));return b2(e,r)},{DST:"secp256k1_XMD:SHA-256_SSWU_RO_",encodeDST:"secp256k1_XMD:SHA-256_SSWU_NU_",p:Mr.ORDER,m:1,k:128,expand:"xmd",hash:_o});var E2=Object.freeze({__proto__:null,secp256k1:ds,schnorr:y2,hashToCurve:Pf.hashToCurve,encodeToCurve:Pf.encodeToCurve});function _2(t){if(t.length>=255)throw new TypeError("Alphabet too long");const e=new Uint8Array(256);for(let l=0;l<e.length;l++)e[l]=255;for(let l=0;l<t.length;l++){const u=t.charAt(l),h=u.charCodeAt(0);if(e[h]!==255)throw new TypeError(u+" is ambiguous");e[h]=l}const r=t.length,n=t.charAt(0),i=Math.log(r)/Math.log(256),s=Math.log(256)/Math.log(r);function o(l){if(l instanceof Uint8Array||(ArrayBuffer.isView(l)?l=new Uint8Array(l.buffer,l.byteOffset,l.byteLength):Array.isArray(l)&&(l=Uint8Array.from(l))),!(l instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(l.length===0)return"";let u=0,h=0,d=0;const p=l.length;for(;d!==p&&l[d]===0;)d++,u++;const f=(p-d)*s+1>>>0,g=new Uint8Array(f);for(;d!==p;){let y=l[d],E=0;for(let _=f-1;(y!==0||E<h)&&_!==-1;_--,E++)y+=256*g[_]>>>0,g[_]=y%r>>>0,y=y/r>>>0;if(y!==0)throw new Error("Non-zero carry");h=E,d++}let m=f-h;for(;m!==f&&g[m]===0;)m++;let w=n.repeat(u);for(;m<f;++m)w+=t.charAt(g[m]);return w}function a(l){if(typeof l!="string")throw new TypeError("Expected String");if(l.length===0)return new Uint8Array;let u=0,h=0,d=0;for(;l[u]===n;)h++,u++;const p=(l.length-u)*i+1>>>0,f=new Uint8Array(p);for(;l[u];){let y=e[l.charCodeAt(u)];if(y===255)return;let E=0;for(let _=p-1;(y!==0||E<d)&&_!==-1;_--,E++)y+=r*f[_]>>>0,f[_]=y%256>>>0,y=y/256>>>0;if(y!==0)throw new Error("Non-zero carry");d=E,u++}let g=p-d;for(;g!==p&&f[g]===0;)g++;const m=new Uint8Array(h+(p-g));let w=h;for(;g!==p;)m[w++]=f[g++];return m}function c(l){const u=a(l);if(u)return u;throw new Error("Non-base"+r+" character")}return{encode:o,decodeUnsafe:a,decode:c}}var $2="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",x2=_2($2);const I2=t=>JSON.stringify(t,(e,r)=>typeof r=="bigint"?r.toString()+"n":r),O2=t=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=t.replace(e,'$1"$2n"$3');return JSON.parse(r,(n,i)=>typeof i=="string"&&i.match(/^\d+n$/)?BigInt(i.substring(0,i.length-1)):i)};function fn(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return O2(t)}catch{return t}}function gr(t){return typeof t=="string"?t:I2(t)||""}function S2(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Df(t,...e){if(!S2(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function Tf(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function A2(t,e){Df(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}const ii=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const kc=t=>new DataView(t.buffer,t.byteOffset,t.byteLength);function C2(t){if(typeof t!="string")throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array(new TextEncoder().encode(t))}function Rf(t){return typeof t=="string"&&(t=C2(t)),Df(t),t}class P2{clone(){return this._cloneInto()}}function D2(t){const e=n=>t().update(Rf(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function Nf(t=32){if(ii&&typeof ii.getRandomValues=="function")return ii.getRandomValues(new Uint8Array(t));if(ii&&typeof ii.randomBytes=="function")return ii.randomBytes(t);throw new Error("crypto.getRandomValues must be defined")}function T2(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);const i=BigInt(32),s=BigInt(4294967295),o=Number(r>>i&s),a=Number(r&s),c=n?4:0,l=n?0:4;t.setUint32(e+c,o,n),t.setUint32(e+l,a,n)}class R2 extends P2{constructor(e,r,n,i){super(),this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=kc(this.buffer)}update(e){Tf(this);const{view:r,buffer:n,blockLen:i}=this;e=Rf(e);const s=e.length;for(let o=0;o<s;){const a=Math.min(i-this.pos,s-o);if(a===i){const c=kc(e);for(;i<=s-o;o+=i)this.process(c,o);continue}n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===i&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Tf(this),A2(e,this),this.finished=!0;const{buffer:r,view:n,blockLen:i,isLE:s}=this;let{pos:o}=this;r[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>i-o&&(this.process(n,0),o=0);for(let h=o;h<i;h++)r[h]=0;T2(n,i-8,BigInt(this.length*8),s),this.process(n,0);const a=kc(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<l;h++)a.setUint32(4*h,u[h],s)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:n,length:i,finished:s,destroyed:o,pos:a}=this;return e.length=i,e.pos=a,e.finished=s,e.destroyed=o,i%r&&e.buffer.set(n),e}}const To=BigInt(2**32-1),qc=BigInt(32);function Bf(t,e=!1){return e?{h:Number(t&To),l:Number(t>>qc&To)}:{h:Number(t>>qc&To)|0,l:Number(t&To)|0}}function N2(t,e=!1){let r=new Uint32Array(t.length),n=new Uint32Array(t.length);for(let i=0;i<t.length;i++){const{h:s,l:o}=Bf(t[i],e);[r[i],n[i]]=[s,o]}return[r,n]}const B2=(t,e)=>BigInt(t>>>0)<<qc|BigInt(e>>>0),L2=(t,e,r)=>t>>>r,M2=(t,e,r)=>t<<32-r|e>>>r,U2=(t,e,r)=>t>>>r|e<<32-r,j2=(t,e,r)=>t<<32-r|e>>>r,F2=(t,e,r)=>t<<64-r|e>>>r-32,k2=(t,e,r)=>t>>>r-32|e<<64-r,q2=(t,e)=>e,z2=(t,e)=>t,H2=(t,e,r)=>t<<r|e>>>32-r,V2=(t,e,r)=>e<<r|t>>>32-r,W2=(t,e,r)=>e<<r-32|t>>>64-r,K2=(t,e,r)=>t<<r-32|e>>>64-r;function G2(t,e,r,n){const i=(e>>>0)+(n>>>0);return{h:t+r+(i/2**32|0)|0,l:i|0}}const Z2=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),Y2=(t,e,r,n)=>e+r+n+(t/2**32|0)|0,J2=(t,e,r,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0),Q2=(t,e,r,n,i)=>e+r+n+i+(t/2**32|0)|0,X2=(t,e,r,n,i)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0)+(i>>>0),eE=(t,e,r,n,i,s)=>e+r+n+i+s+(t/2**32|0)|0,Y={fromBig:Bf,split:N2,toBig:B2,shrSH:L2,shrSL:M2,rotrSH:U2,rotrSL:j2,rotrBH:F2,rotrBL:k2,rotr32H:q2,rotr32L:z2,rotlSH:H2,rotlSL:V2,rotlBH:W2,rotlBL:K2,add:G2,add3L:Z2,add3H:Y2,add4L:J2,add4H:Q2,add5H:eE,add5L:X2},[tE,rE]=Y.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),Ur=new Uint32Array(80),jr=new Uint32Array(80);class nE extends R2{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:r,Bh:n,Bl:i,Ch:s,Cl:o,Dh:a,Dl:c,Eh:l,El:u,Fh:h,Fl:d,Gh:p,Gl:f,Hh:g,Hl:m}=this;return[e,r,n,i,s,o,a,c,l,u,h,d,p,f,g,m]}set(e,r,n,i,s,o,a,c,l,u,h,d,p,f,g,m){this.Ah=e|0,this.Al=r|0,this.Bh=n|0,this.Bl=i|0,this.Ch=s|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=l|0,this.El=u|0,this.Fh=h|0,this.Fl=d|0,this.Gh=p|0,this.Gl=f|0,this.Hh=g|0,this.Hl=m|0}process(e,r){for(let E=0;E<16;E++,r+=4)Ur[E]=e.getUint32(r),jr[E]=e.getUint32(r+=4);for(let E=16;E<80;E++){const _=Ur[E-15]|0,O=jr[E-15]|0,S=Y.rotrSH(_,O,1)^Y.rotrSH(_,O,8)^Y.shrSH(_,O,7),x=Y.rotrSL(_,O,1)^Y.rotrSL(_,O,8)^Y.shrSL(_,O,7),P=Ur[E-2]|0,$=jr[E-2]|0,B=Y.rotrSH(P,$,19)^Y.rotrBH(P,$,61)^Y.shrSH(P,$,6),D=Y.rotrSL(P,$,19)^Y.rotrBL(P,$,61)^Y.shrSL(P,$,6),R=Y.add4L(x,D,jr[E-7],jr[E-16]),M=Y.add4H(R,S,B,Ur[E-7],Ur[E-16]);Ur[E]=M|0,jr[E]=R|0}let{Ah:n,Al:i,Bh:s,Bl:o,Ch:a,Cl:c,Dh:l,Dl:u,Eh:h,El:d,Fh:p,Fl:f,Gh:g,Gl:m,Hh:w,Hl:y}=this;for(let E=0;E<80;E++){const _=Y.rotrSH(h,d,14)^Y.rotrSH(h,d,18)^Y.rotrBH(h,d,41),O=Y.rotrSL(h,d,14)^Y.rotrSL(h,d,18)^Y.rotrBL(h,d,41),S=h&p^~h&g,x=d&f^~d&m,P=Y.add5L(y,O,x,rE[E],jr[E]),$=Y.add5H(P,w,_,S,tE[E],Ur[E]),B=P|0,D=Y.rotrSH(n,i,28)^Y.rotrBH(n,i,34)^Y.rotrBH(n,i,39),R=Y.rotrSL(n,i,28)^Y.rotrBL(n,i,34)^Y.rotrBL(n,i,39),M=n&s^n&a^s&a,A=i&o^i&c^o&c;w=g|0,y=m|0,g=p|0,m=f|0,p=h|0,f=d|0,{h,l:d}=Y.add(l|0,u|0,$|0,B|0),l=a|0,u=c|0,a=s|0,c=o|0,s=n|0,o=i|0;const b=Y.add3L(B,R,A);n=Y.add3H(b,$,D,M),i=b|0}({h:n,l:i}=Y.add(this.Ah|0,this.Al|0,n|0,i|0)),{h:s,l:o}=Y.add(this.Bh|0,this.Bl|0,s|0,o|0),{h:a,l:c}=Y.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:l,l:u}=Y.add(this.Dh|0,this.Dl|0,l|0,u|0),{h,l:d}=Y.add(this.Eh|0,this.El|0,h|0,d|0),{h:p,l:f}=Y.add(this.Fh|0,this.Fl|0,p|0,f|0),{h:g,l:m}=Y.add(this.Gh|0,this.Gl|0,g|0,m|0),{h:w,l:y}=Y.add(this.Hh|0,this.Hl|0,w|0,y|0),this.set(n,i,s,o,a,c,l,u,h,d,p,f,g,m,w,y)}roundClean(){Ur.fill(0),jr.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const iE=D2(()=>new nE);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const zc=BigInt(0),Lf=BigInt(1),sE=BigInt(2);function Hc(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Vc(t){if(!Hc(t))throw new Error("Uint8Array expected")}function Wc(t,e){if(typeof e!="boolean")throw new Error(t+" boolean expected, got "+e)}const oE=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Kc(t){Vc(t);let e="";for(let r=0;r<t.length;r++)e+=oE[t[r]];return e}function Mf(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?zc:BigInt("0x"+t)}const mr={_0:48,_9:57,A:65,F:70,a:97,f:102};function Uf(t){if(t>=mr._0&&t<=mr._9)return t-mr._0;if(t>=mr.A&&t<=mr.F)return t-(mr.A-10);if(t>=mr.a&&t<=mr.f)return t-(mr.a-10)}function jf(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length,r=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(r);for(let i=0,s=0;i<r;i++,s+=2){const o=Uf(t.charCodeAt(s)),a=Uf(t.charCodeAt(s+1));if(o===void 0||a===void 0){const c=t[s]+t[s+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+s)}n[i]=o*16+a}return n}function aE(t){return Mf(Kc(t))}function Ro(t){return Vc(t),Mf(Kc(Uint8Array.from(t).reverse()))}function Ff(t,e){return jf(t.toString(16).padStart(e*2,"0"))}function Gc(t,e){return Ff(t,e).reverse()}function wr(t,e,r){let n;if(typeof e=="string")try{n=jf(e)}catch(s){throw new Error(t+" must be hex string or Uint8Array, cause: "+s)}else if(Hc(e))n=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const i=n.length;if(typeof r=="number"&&i!==r)throw new Error(t+" of length "+r+" expected, got "+i);return n}function kf(...t){let e=0;for(let n=0;n<t.length;n++){const i=t[n];Vc(i),e+=i.length}const r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){const s=t[n];r.set(s,i),i+=s.length}return r}const Zc=t=>typeof t=="bigint"&&zc<=t;function cE(t,e,r){return Zc(t)&&Zc(e)&&Zc(r)&&e<=t&&t<r}function ps(t,e,r,n){if(!cE(e,r,n))throw new Error("expected valid "+t+": "+r+" <= n < "+n+", got "+e)}function lE(t){let e;for(e=0;t>zc;t>>=Lf,e+=1);return e}const uE=t=>(sE<<BigInt(t-1))-Lf,hE={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||Hc(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function Yc(t,e,r={}){const n=(i,s,o)=>{const a=hE[s];if(typeof a!="function")throw new Error("invalid validator function");const c=t[i];if(!(o&&c===void 0)&&!a(c,t))throw new Error("param "+String(i)+" is invalid. Expected "+s+", got "+c)};for(const[i,s]of Object.entries(e))n(i,s,!1);for(const[i,s]of Object.entries(r))n(i,s,!0);return t}function qf(t){const e=new WeakMap;return(r,...n)=>{const i=e.get(r);if(i!==void 0)return i;const s=t(r,...n);return e.set(r,s),s}}const Le=BigInt(0),xe=BigInt(1),pn=BigInt(2),dE=BigInt(3),Jc=BigInt(4),zf=BigInt(5),Hf=BigInt(8);function De(t,e){const r=t%e;return r>=Le?r:e+r}function fE(t,e,r){if(e<Le)throw new Error("invalid exponent, negatives unsupported");if(r<=Le)throw new Error("invalid modulus");if(r===xe)return Le;let n=xe;for(;e>Le;)e&xe&&(n=n*t%r),t=t*t%r,e>>=xe;return n}function Yt(t,e,r){let n=t;for(;e-- >Le;)n*=n,n%=r;return n}function Vf(t,e){if(t===Le)throw new Error("invert: expected non-zero number");if(e<=Le)throw new Error("invert: expected positive modulus, got "+e);let r=De(t,e),n=e,i=Le,s=xe;for(;r!==Le;){const o=n/r,a=n%r,c=i-s*o;n=r,r=a,i=s,s=c}if(n!==xe)throw new Error("invert: does not exist");return De(i,e)}function pE(t){const e=(t-xe)/pn;let r,n,i;for(r=t-xe,n=0;r%pn===Le;r/=pn,n++);for(i=pn;i<t&&fE(i,e,t)!==t-xe;i++)if(i>1e3)throw new Error("Cannot find square root: likely non-prime P");if(n===1){const o=(t+xe)/Jc;return function(a,c){const l=a.pow(c,o);if(!a.eql(a.sqr(l),c))throw new Error("Cannot find square root");return l}}const s=(r+xe)/pn;return function(o,a){if(o.pow(a,e)===o.neg(o.ONE))throw new Error("Cannot find square root");let c=n,l=o.pow(o.mul(o.ONE,i),r),u=o.pow(a,s),h=o.pow(a,r);for(;!o.eql(h,o.ONE);){if(o.eql(h,o.ZERO))return o.ZERO;let d=1;for(let f=o.sqr(h);d<c&&!o.eql(f,o.ONE);d++)f=o.sqr(f);const p=o.pow(l,xe<<BigInt(c-d-1));l=o.sqr(p),u=o.mul(u,p),h=o.mul(h,l),c=d}return u}}function gE(t){if(t%Jc===dE){const e=(t+xe)/Jc;return function(r,n){const i=r.pow(n,e);if(!r.eql(r.sqr(i),n))throw new Error("Cannot find square root");return i}}if(t%Hf===zf){const e=(t-zf)/Hf;return function(r,n){const i=r.mul(n,pn),s=r.pow(i,e),o=r.mul(n,s),a=r.mul(r.mul(o,pn),s),c=r.mul(o,r.sub(a,r.ONE));if(!r.eql(r.sqr(c),n))throw new Error("Cannot find square root");return c}}return pE(t)}const mE=(t,e)=>(De(t,e)&xe)===xe,wE=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function yE(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=wE.reduce((n,i)=>(n[i]="function",n),e);return Yc(t,r)}function bE(t,e,r){if(r<Le)throw new Error("invalid exponent, negatives unsupported");if(r===Le)return t.ONE;if(r===xe)return e;let n=t.ONE,i=e;for(;r>Le;)r&xe&&(n=t.mul(n,i)),i=t.sqr(i),r>>=xe;return n}function vE(t,e){const r=new Array(e.length),n=e.reduce((s,o,a)=>t.is0(o)?s:(r[a]=s,t.mul(s,o)),t.ONE),i=t.inv(n);return e.reduceRight((s,o,a)=>t.is0(o)?s:(r[a]=t.mul(s,r[a]),t.mul(s,o)),i),r}function Wf(t,e){const r=e!==void 0?e:t.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function Kf(t,e,r=!1,n={}){if(t<=Le)throw new Error("invalid field: expected ORDER > 0, got "+t);const{nBitLength:i,nByteLength:s}=Wf(t,e);if(s>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:t,isLE:r,BITS:i,BYTES:s,MASK:uE(i),ZERO:Le,ONE:xe,create:c=>De(c,t),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return Le<=c&&c<t},is0:c=>c===Le,isOdd:c=>(c&xe)===xe,neg:c=>De(-c,t),eql:(c,l)=>c===l,sqr:c=>De(c*c,t),add:(c,l)=>De(c+l,t),sub:(c,l)=>De(c-l,t),mul:(c,l)=>De(c*l,t),pow:(c,l)=>bE(a,c,l),div:(c,l)=>De(c*Vf(l,t),t),sqrN:c=>c*c,addN:(c,l)=>c+l,subN:(c,l)=>c-l,mulN:(c,l)=>c*l,inv:c=>Vf(c,t),sqrt:n.sqrt||(c=>(o||(o=gE(t)),o(a,c))),invertBatch:c=>vE(a,c),cmov:(c,l,u)=>u?l:c,toBytes:c=>r?Gc(c,s):Ff(c,s),fromBytes:c=>{if(c.length!==s)throw new Error("Field.fromBytes: expected "+s+" bytes, got "+c.length);return r?Ro(c):aE(c)}});return Object.freeze(a)}const Gf=BigInt(0),No=BigInt(1);function Qc(t,e){const r=e.negate();return t?r:e}function Zf(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function Xc(t,e){Zf(t,e);const r=Math.ceil(e/t)+1,n=2**(t-1);return{windows:r,windowSize:n}}function EE(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((r,n)=>{if(!(r instanceof e))throw new Error("invalid point at index "+n)})}function _E(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((r,n)=>{if(!e.isValid(r))throw new Error("invalid scalar at index "+n)})}const el=new WeakMap,Yf=new WeakMap;function tl(t){return Yf.get(t)||1}function $E(t,e){return{constTimeNegate:Qc,hasPrecomputes(r){return tl(r)!==1},unsafeLadder(r,n,i=t.ZERO){let s=r;for(;n>Gf;)n&No&&(i=i.add(s)),s=s.double(),n>>=No;return i},precomputeWindow(r,n){const{windows:i,windowSize:s}=Xc(n,e),o=[];let a=r,c=a;for(let l=0;l<i;l++){c=a,o.push(c);for(let u=1;u<s;u++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(r,n,i){const{windows:s,windowSize:o}=Xc(r,e);let a=t.ZERO,c=t.BASE;const l=BigInt(2**r-1),u=2**r,h=BigInt(r);for(let d=0;d<s;d++){const p=d*o;let f=Number(i&l);i>>=h,f>o&&(f-=u,i+=No);const g=p,m=p+Math.abs(f)-1,w=d%2!==0,y=f<0;f===0?c=c.add(Qc(w,n[g])):a=a.add(Qc(y,n[m]))}return{p:a,f:c}},wNAFUnsafe(r,n,i,s=t.ZERO){const{windows:o,windowSize:a}=Xc(r,e),c=BigInt(2**r-1),l=2**r,u=BigInt(r);for(let h=0;h<o;h++){const d=h*a;if(i===Gf)break;let p=Number(i&c);if(i>>=u,p>a&&(p-=l,i+=No),p===0)continue;let f=n[d+Math.abs(p)-1];p<0&&(f=f.negate()),s=s.add(f)}return s},getPrecomputes(r,n,i){let s=el.get(n);return s||(s=this.precomputeWindow(n,r),r!==1&&el.set(n,i(s))),s},wNAFCached(r,n,i){const s=tl(r);return this.wNAF(s,this.getPrecomputes(s,r,i),n)},wNAFCachedUnsafe(r,n,i,s){const o=tl(r);return o===1?this.unsafeLadder(r,n,s):this.wNAFUnsafe(o,this.getPrecomputes(o,r,i),n,s)},setWindowSize(r,n){Zf(n,e),Yf.set(r,n),el.delete(r)}}}function xE(t,e,r,n){if(EE(r,t),_E(n,e),r.length!==n.length)throw new Error("arrays of points and scalars must have equal length");const i=t.ZERO,s=lE(BigInt(r.length)),o=s>12?s-3:s>4?s-2:s?2:1,a=(1<<o)-1,c=new Array(a+1).fill(i),l=Math.floor((e.BITS-1)/o)*o;let u=i;for(let h=l;h>=0;h-=o){c.fill(i);for(let p=0;p<n.length;p++){const f=n[p],g=Number(f>>BigInt(h)&BigInt(a));c[g]=c[g].add(r[p])}let d=i;for(let p=c.length-1,f=i;p>0;p--)f=f.add(c[p]),d=d.add(f);if(u=u.add(d),h!==0)for(let p=0;p<o;p++)u=u.double()}return u}function IE(t){return yE(t.Fp),Yc(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Wf(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}const jt=BigInt(0),lt=BigInt(1),Bo=BigInt(2),OE=BigInt(8),SE={zip215:!0};function AE(t){const e=IE(t);return Yc(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function CE(t){const e=AE(t),{Fp:r,n,prehash:i,hash:s,randomBytes:o,nByteLength:a,h:c}=e,l=Bo<<BigInt(a*8)-lt,u=r.create,h=Kf(e.n,e.nBitLength),d=e.uvRatio||((b,v)=>{try{return{isValid:!0,value:r.sqrt(b*r.inv(v))}}catch{return{isValid:!1,value:jt}}}),p=e.adjustScalarBytes||(b=>b),f=e.domain||((b,v,I)=>{if(Wc("phflag",I),v.length||I)throw new Error("Contexts/pre-hash are not supported");return b});function g(b,v){ps("coordinate "+b,v,jt,l)}function m(b){if(!(b instanceof E))throw new Error("ExtendedPoint expected")}const w=qf((b,v)=>{const{ex:I,ey:T,ez:C}=b,N=b.is0();v==null&&(v=N?OE:r.inv(C));const U=u(I*v),k=u(T*v),H=u(C*v);if(N)return{x:jt,y:lt};if(H!==lt)throw new Error("invZ was invalid");return{x:U,y:k}}),y=qf(b=>{const{a:v,d:I}=e;if(b.is0())throw new Error("bad point: ZERO");const{ex:T,ey:C,ez:N,et:U}=b,k=u(T*T),H=u(C*C),q=u(N*N),W=u(q*q),G=u(k*v),ce=u(q*u(G+H)),X=u(W+u(I*u(k*H)));if(ce!==X)throw new Error("bad point: equation left != right (1)");const Q=u(T*C),Se=u(N*U);if(Q!==Se)throw new Error("bad point: equation left != right (2)");return!0});class E{constructor(v,I,T,C){this.ex=v,this.ey=I,this.ez=T,this.et=C,g("x",v),g("y",I),g("z",T),g("t",C),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(v){if(v instanceof E)throw new Error("extended point not allowed");const{x:I,y:T}=v||{};return g("x",I),g("y",T),new E(I,T,lt,u(I*T))}static normalizeZ(v){const I=r.invertBatch(v.map(T=>T.ez));return v.map((T,C)=>T.toAffine(I[C])).map(E.fromAffine)}static msm(v,I){return xE(E,h,v,I)}_setWindowSize(v){S.setWindowSize(this,v)}assertValidity(){y(this)}equals(v){m(v);const{ex:I,ey:T,ez:C}=this,{ex:N,ey:U,ez:k}=v,H=u(I*k),q=u(N*C),W=u(T*k),G=u(U*C);return H===q&&W===G}is0(){return this.equals(E.ZERO)}negate(){return new E(u(-this.ex),this.ey,this.ez,u(-this.et))}double(){const{a:v}=e,{ex:I,ey:T,ez:C}=this,N=u(I*I),U=u(T*T),k=u(Bo*u(C*C)),H=u(v*N),q=I+T,W=u(u(q*q)-N-U),G=H+U,ce=G-k,X=H-U,Q=u(W*ce),Se=u(G*X),ve=u(W*X),_e=u(ce*G);return new E(Q,Se,_e,ve)}add(v){m(v);const{a:I,d:T}=e,{ex:C,ey:N,ez:U,et:k}=this,{ex:H,ey:q,ez:W,et:G}=v;if(I===BigInt(-1)){const Gw=u((N-C)*(q+H)),Zw=u((N+C)*(q-H)),Kh=u(Zw-Gw);if(Kh===jt)return this.double();const Yw=u(U*Bo*G),Jw=u(k*Bo*W),Qw=Jw+Yw,Xw=Zw+Gw,ey=Jw-Yw,gN=u(Qw*Kh),mN=u(Xw*ey),wN=u(Qw*ey),yN=u(Kh*Xw);return new E(gN,mN,yN,wN)}const ce=u(C*H),X=u(N*q),Q=u(k*T*G),Se=u(U*W),ve=u((C+N)*(H+q)-ce-X),_e=Se-Q,He=Se+Q,Pe=u(X-I*ce),Pr=u(ve*_e),dN=u(He*Pe),fN=u(ve*Pe),pN=u(_e*He);return new E(Pr,dN,pN,fN)}subtract(v){return this.add(v.negate())}wNAF(v){return S.wNAFCached(this,v,E.normalizeZ)}multiply(v){const I=v;ps("scalar",I,lt,n);const{p:T,f:C}=this.wNAF(I);return E.normalizeZ([T,C])[0]}multiplyUnsafe(v,I=E.ZERO){const T=v;return ps("scalar",T,jt,n),T===jt?O:this.is0()||T===lt?this:S.wNAFCachedUnsafe(this,T,E.normalizeZ,I)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return S.unsafeLadder(this,n).is0()}toAffine(v){return w(this,v)}clearCofactor(){const{h:v}=e;return v===lt?this:this.multiplyUnsafe(v)}static fromHex(v,I=!1){const{d:T,a:C}=e,N=r.BYTES;v=wr("pointHex",v,N),Wc("zip215",I);const U=v.slice(),k=v[N-1];U[N-1]=k&-129;const H=Ro(U),q=I?l:r.ORDER;ps("pointHex.y",H,jt,q);const W=u(H*H),G=u(W-lt),ce=u(T*W-C);let{isValid:X,value:Q}=d(G,ce);if(!X)throw new Error("Point.fromHex: invalid y coordinate");const Se=(Q&lt)===lt,ve=(k&128)!==0;if(!I&&Q===jt&&ve)throw new Error("Point.fromHex: x=0 and x_0=1");return ve!==Se&&(Q=u(-Q)),E.fromAffine({x:Q,y:H})}static fromPrivateKey(v){return $(v).point}toRawBytes(){const{x:v,y:I}=this.toAffine(),T=Gc(I,r.BYTES);return T[T.length-1]|=v&lt?128:0,T}toHex(){return Kc(this.toRawBytes())}}E.BASE=new E(e.Gx,e.Gy,lt,u(e.Gx*e.Gy)),E.ZERO=new E(jt,lt,lt,jt);const{BASE:_,ZERO:O}=E,S=$E(E,a*8);function x(b){return De(b,n)}function P(b){return x(Ro(b))}function $(b){const v=r.BYTES;b=wr("private key",b,v);const I=wr("hashed private key",s(b),2*v),T=p(I.slice(0,v)),C=I.slice(v,2*v),N=P(T),U=_.multiply(N),k=U.toRawBytes();return{head:T,prefix:C,scalar:N,point:U,pointBytes:k}}function B(b){return $(b).pointBytes}function D(b=new Uint8Array,...v){const I=kf(...v);return P(s(f(I,wr("context",b),!!i)))}function R(b,v,I={}){b=wr("message",b),i&&(b=i(b));const{prefix:T,scalar:C,pointBytes:N}=$(v),U=D(I.context,T,b),k=_.multiply(U).toRawBytes(),H=D(I.context,k,N,b),q=x(U+H*C);ps("signature.s",q,jt,n);const W=kf(k,Gc(q,r.BYTES));return wr("result",W,r.BYTES*2)}const M=SE;function A(b,v,I,T=M){const{context:C,zip215:N}=T,U=r.BYTES;b=wr("signature",b,2*U),v=wr("message",v),I=wr("publicKey",I,U),N!==void 0&&Wc("zip215",N),i&&(v=i(v));const k=Ro(b.slice(U,2*U));let H,q,W;try{H=E.fromHex(I,N),q=E.fromHex(b.slice(0,U),N),W=_.multiplyUnsafe(k)}catch{return!1}if(!N&&H.isSmallOrder())return!1;const G=D(C,q.toRawBytes(),H.toRawBytes(),v);return q.add(H.multiplyUnsafe(G)).subtract(W).clearCofactor().equals(E.ZERO)}return _._setWindowSize(8),{CURVE:e,getPublicKey:B,sign:R,verify:A,ExtendedPoint:E,utils:{getExtendedPublicKey:$,randomPrivateKey:()=>o(r.BYTES),precompute(b=8,v=E.BASE){return v._setWindowSize(b),v.multiply(BigInt(3)),v}}}}BigInt(0),BigInt(1);const rl=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),Jf=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const PE=BigInt(1),Qf=BigInt(2);BigInt(3);const DE=BigInt(5),TE=BigInt(8);function RE(t){const e=BigInt(10),r=BigInt(20),n=BigInt(40),i=BigInt(80),s=rl,o=t*t%s*t%s,a=Yt(o,Qf,s)*o%s,c=Yt(a,PE,s)*t%s,l=Yt(c,DE,s)*c%s,u=Yt(l,e,s)*l%s,h=Yt(u,r,s)*u%s,d=Yt(h,n,s)*h%s,p=Yt(d,i,s)*d%s,f=Yt(p,i,s)*d%s,g=Yt(f,e,s)*l%s;return{pow_p_5_8:Yt(g,Qf,s)*t%s,b2:o}}function NE(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function BE(t,e){const r=rl,n=De(e*e*e,r),i=De(n*n*e,r),s=RE(t*i).pow_p_5_8;let o=De(t*n*s,r);const a=De(e*o*o,r),c=o,l=De(o*Jf,r),u=a===t,h=a===De(-t,r),d=a===De(-t*Jf,r);return u&&(o=c),(h||d)&&(o=l),mE(o,r)&&(o=De(-o,r)),{isValid:u||h,value:o}}const LE=Kf(rl,void 0,!0),ME={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:LE,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:TE,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:iE,randomBytes:Nf,adjustScalarBytes:NE,uvRatio:BE},Xf=CE(ME),UE="EdDSA",jE="JWT",Lo=".",Mo="base64url",ep="utf8",tp="utf8",FE=":",kE="did",qE="key",rp="base58btc",zE="z",HE="K36",VE=32;function nl(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function np(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?nl(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function ip(t,e){e||(e=t.reduce((i,s)=>i+s.length,0));const r=np(e);let n=0;for(const i of t)r.set(i,n),n+=i.length;return nl(r)}function WE(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var s=t.charAt(i),o=s.charCodeAt(0);if(r[o]!==255)throw new TypeError(s+" is ambiguous");r[o]=i}var a=t.length,c=t.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(f){if(f instanceof Uint8Array||(ArrayBuffer.isView(f)?f=new Uint8Array(f.buffer,f.byteOffset,f.byteLength):Array.isArray(f)&&(f=Uint8Array.from(f))),!(f instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(f.length===0)return"";for(var g=0,m=0,w=0,y=f.length;w!==y&&f[w]===0;)w++,g++;for(var E=(y-w)*u+1>>>0,_=new Uint8Array(E);w!==y;){for(var O=f[w],S=0,x=E-1;(O!==0||S<m)&&x!==-1;x--,S++)O+=256*_[x]>>>0,_[x]=O%a>>>0,O=O/a>>>0;if(O!==0)throw new Error("Non-zero carry");m=S,w++}for(var P=E-m;P!==E&&_[P]===0;)P++;for(var $=c.repeat(g);P<E;++P)$+=t.charAt(_[P]);return $}function d(f){if(typeof f!="string")throw new TypeError("Expected String");if(f.length===0)return new Uint8Array;var g=0;if(f[g]!==" "){for(var m=0,w=0;f[g]===c;)m++,g++;for(var y=(f.length-g)*l+1>>>0,E=new Uint8Array(y);f[g];){var _=r[f.charCodeAt(g)];if(_===255)return;for(var O=0,S=y-1;(_!==0||O<w)&&S!==-1;S--,O++)_+=a*E[S]>>>0,E[S]=_%256>>>0,_=_/256>>>0;if(_!==0)throw new Error("Non-zero carry");w=O,g++}if(f[g]!==" "){for(var x=y-w;x!==y&&E[x]===0;)x++;for(var P=new Uint8Array(m+(y-x)),$=m;x!==y;)P[$++]=E[x++];return P}}}function p(f){var g=d(f);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:d,decode:p}}var KE=WE,GE=KE;const sp=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},ZE=t=>new TextEncoder().encode(t),YE=t=>new TextDecoder().decode(t);class JE{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class QE{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return op(this,e)}}class XE{constructor(e){this.decoders=e}or(e){return op(this,e)}decode(e){const r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const op=(t,e)=>new XE({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class e3{constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new JE(e,r,n),this.decoder=new QE(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Uo=({name:t,prefix:e,encode:r,decode:n})=>new e3(t,e,r,n),gs=({prefix:t,name:e,alphabet:r})=>{const{encode:n,decode:i}=GE(r,e);return Uo({prefix:t,name:e,encode:n,decode:s=>sp(i(s))})},t3=(t,e,r,n)=>{const i={};for(let u=0;u<e.length;++u)i[e[u]]=u;let s=t.length;for(;t[s-1]==="=";)--s;const o=new Uint8Array(s*r/8|0);let a=0,c=0,l=0;for(let u=0;u<s;++u){const h=i[t[u]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|h,a+=r,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},r3=(t,e,r)=>{const n=e[e.length-1]==="=",i=(1<<r)-1;let s="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>r;)o-=r,s+=e[i&a>>o];if(o&&(s+=e[i&a<<r-o]),n)for(;s.length*r&7;)s+="=";return s},We=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>Uo({prefix:e,name:t,encode(i){return r3(i,n,r)},decode(i){return t3(i,n,r,t)}}),n3=Uo({prefix:"\0",name:"identity",encode:t=>YE(t),decode:t=>ZE(t)});var i3=Object.freeze({__proto__:null,identity:n3});const s3=We({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var o3=Object.freeze({__proto__:null,base2:s3});const a3=We({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var c3=Object.freeze({__proto__:null,base8:a3});const l3=gs({prefix:"9",name:"base10",alphabet:"0123456789"});var u3=Object.freeze({__proto__:null,base10:l3});const h3=We({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),d3=We({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var f3=Object.freeze({__proto__:null,base16:h3,base16upper:d3});const p3=We({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),g3=We({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),m3=We({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),w3=We({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),y3=We({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),b3=We({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),v3=We({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),E3=We({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),_3=We({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var $3=Object.freeze({__proto__:null,base32:p3,base32upper:g3,base32pad:m3,base32padupper:w3,base32hex:y3,base32hexupper:b3,base32hexpad:v3,base32hexpadupper:E3,base32z:_3});const x3=gs({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),I3=gs({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var O3=Object.freeze({__proto__:null,base36:x3,base36upper:I3});const S3=gs({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),A3=gs({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var C3=Object.freeze({__proto__:null,base58btc:S3,base58flickr:A3});const P3=We({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),D3=We({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),T3=We({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),R3=We({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var N3=Object.freeze({__proto__:null,base64:P3,base64pad:D3,base64url:T3,base64urlpad:R3});const ap=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),B3=ap.reduce((t,e,r)=>(t[r]=e,t),[]),L3=ap.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function M3(t){return t.reduce((e,r)=>(e+=B3[r],e),"")}function U3(t){const e=[];for(const r of t){const n=L3[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}const j3=Uo({prefix:"\u{1F680}",name:"base256emoji",encode:M3,decode:U3});var F3=Object.freeze({__proto__:null,base256emoji:j3}),k3=lp,cp=128,q3=127,z3=~q3,H3=Math.pow(2,31);function lp(t,e,r){e=e||[],r=r||0;for(var n=r;t>=H3;)e[r++]=t&255|cp,t/=128;for(;t&z3;)e[r++]=t&255|cp,t>>>=7;return e[r]=t|0,lp.bytes=r-n+1,e}var V3=il,W3=128,up=127;function il(t,n){var r=0,n=n||0,i=0,s=n,o,a=t.length;do{if(s>=a)throw il.bytes=0,new RangeError("Could not decode varint");o=t[s++],r+=i<28?(o&up)<<i:(o&up)*Math.pow(2,i),i+=7}while(o>=W3);return il.bytes=s-n,r}var K3=Math.pow(2,7),G3=Math.pow(2,14),Z3=Math.pow(2,21),Y3=Math.pow(2,28),J3=Math.pow(2,35),Q3=Math.pow(2,42),X3=Math.pow(2,49),e_=Math.pow(2,56),t_=Math.pow(2,63),r_=function(t){return t<K3?1:t<G3?2:t<Z3?3:t<Y3?4:t<J3?5:t<Q3?6:t<X3?7:t<e_?8:t<t_?9:10},n_={encode:k3,decode:V3,encodingLength:r_},hp=n_;const dp=(t,e,r=0)=>(hp.encode(t,e,r),e),fp=t=>hp.encodingLength(t),sl=(t,e)=>{const r=e.byteLength,n=fp(t),i=n+fp(r),s=new Uint8Array(i+r);return dp(t,s,0),dp(r,s,n),s.set(e,i),new i_(t,r,e,s)};class i_{constructor(e,r,n,i){this.code=e,this.size=r,this.digest=n,this.bytes=i}}const pp=({name:t,code:e,encode:r})=>new s_(t,e,r);class s_{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?sl(this.code,r):r.then(n=>sl(this.code,n))}else throw Error("Unknown type, must be binary type")}}const gp=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),o_=pp({name:"sha2-256",code:18,encode:gp("SHA-256")}),a_=pp({name:"sha2-512",code:19,encode:gp("SHA-512")});var c_=Object.freeze({__proto__:null,sha256:o_,sha512:a_});const mp=0,l_="identity",wp=sp;var u_=Object.freeze({__proto__:null,identity:{code:mp,name:l_,encode:wp,digest:t=>sl(mp,wp(t))}});new TextEncoder,new TextDecoder;const yp={...i3,...o3,...c3,...u3,...f3,...$3,...O3,...C3,...N3,...F3};({...c_,...u_});function bp(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}const vp=bp("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),ol=bp("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=np(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),Ep={utf8:vp,"utf-8":vp,hex:yp.base16,latin1:ol,ascii:ol,binary:ol,...yp};function jo(t,e="utf8"){const r=Ep[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}function si(t,e="utf8"){const r=Ep[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?nl(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}function _p(t){return fn(jo(si(t,Mo),ep))}function Fo(t){return jo(si(gr(t),ep),Mo)}function $p(t){const e=si(HE,rp),r=zE+jo(ip([e,t]),rp);return[kE,qE,r].join(FE)}function h_(t){return jo(t,Mo)}function d_(t){return si(t,Mo)}function f_(t){return si([Fo(t.header),Fo(t.payload)].join(Lo),tp)}function p_(t){return[Fo(t.header),Fo(t.payload),h_(t.signature)].join(Lo)}function al(t){const e=t.split(Lo),r=_p(e[0]),n=_p(e[1]),i=d_(e[2]),s=si(e.slice(0,2).join(Lo),tp);return{header:r,payload:n,signature:i,data:s}}function xp(t=Nf(VE)){const e=Xf.getPublicKey(t);return{secretKey:ip([t,e]),publicKey:e}}async function g_(t,e,r,n,i=j.fromMiliseconds(Date.now())){const s={alg:UE,typ:jE},o=$p(n.publicKey),a=i+r,c={iss:o,sub:t,aud:e,iat:i,exp:a},l=f_({header:s,payload:c}),u=Xf.sign(l,n.secretKey.slice(0,32));return p_({header:s,payload:c,signature:u})}function Ip(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t)}function ms(t,e){e||(e=t.reduce((i,s)=>i+s.length,0));const r=Ip(e);let n=0;for(const i of t)r.set(i,n),n+=i.length;return r}function m_(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var s=t.charAt(i),o=s.charCodeAt(0);if(r[o]!==255)throw new TypeError(s+" is ambiguous");r[o]=i}var a=t.length,c=t.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(f){if(f instanceof Uint8Array||(ArrayBuffer.isView(f)?f=new Uint8Array(f.buffer,f.byteOffset,f.byteLength):Array.isArray(f)&&(f=Uint8Array.from(f))),!(f instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(f.length===0)return"";for(var g=0,m=0,w=0,y=f.length;w!==y&&f[w]===0;)w++,g++;for(var E=(y-w)*u+1>>>0,_=new Uint8Array(E);w!==y;){for(var O=f[w],S=0,x=E-1;(O!==0||S<m)&&x!==-1;x--,S++)O+=256*_[x]>>>0,_[x]=O%a>>>0,O=O/a>>>0;if(O!==0)throw new Error("Non-zero carry");m=S,w++}for(var P=E-m;P!==E&&_[P]===0;)P++;for(var $=c.repeat(g);P<E;++P)$+=t.charAt(_[P]);return $}function d(f){if(typeof f!="string")throw new TypeError("Expected String");if(f.length===0)return new Uint8Array;var g=0;if(f[g]!==" "){for(var m=0,w=0;f[g]===c;)m++,g++;for(var y=(f.length-g)*l+1>>>0,E=new Uint8Array(y);f[g];){var _=r[f.charCodeAt(g)];if(_===255)return;for(var O=0,S=y-1;(_!==0||O<w)&&S!==-1;S--,O++)_+=a*E[S]>>>0,E[S]=_%256>>>0,_=_/256>>>0;if(_!==0)throw new Error("Non-zero carry");w=O,g++}if(f[g]!==" "){for(var x=y-w;x!==y&&E[x]===0;)x++;for(var P=new Uint8Array(m+(y-x)),$=m;x!==y;)P[$++]=E[x++];return P}}}function p(f){var g=d(f);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:d,decode:p}}var w_=m_,y_=w_;const Op=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},b_=t=>new TextEncoder().encode(t),v_=t=>new TextDecoder().decode(t);class E_{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class __{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Sp(this,e)}}class $_{constructor(e){this.decoders=e}or(e){return Sp(this,e)}decode(e){const r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Sp=(t,e)=>new $_({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class x_{constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new E_(e,r,n),this.decoder=new __(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const ko=({name:t,prefix:e,encode:r,decode:n})=>new x_(t,e,r,n),ws=({prefix:t,name:e,alphabet:r})=>{const{encode:n,decode:i}=y_(r,e);return ko({prefix:t,name:e,encode:n,decode:s=>Op(i(s))})},I_=(t,e,r,n)=>{const i={};for(let u=0;u<e.length;++u)i[e[u]]=u;let s=t.length;for(;t[s-1]==="=";)--s;const o=new Uint8Array(s*r/8|0);let a=0,c=0,l=0;for(let u=0;u<s;++u){const h=i[t[u]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|h,a+=r,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},O_=(t,e,r)=>{const n=e[e.length-1]==="=",i=(1<<r)-1;let s="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>r;)o-=r,s+=e[i&a>>o];if(o&&(s+=e[i&a<<r-o]),n)for(;s.length*r&7;)s+="=";return s},Ke=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>ko({prefix:e,name:t,encode(i){return O_(i,n,r)},decode(i){return I_(i,n,r,t)}}),S_=ko({prefix:"\0",name:"identity",encode:t=>v_(t),decode:t=>b_(t)});var A_=Object.freeze({__proto__:null,identity:S_});const C_=Ke({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var P_=Object.freeze({__proto__:null,base2:C_});const D_=Ke({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var T_=Object.freeze({__proto__:null,base8:D_});const R_=ws({prefix:"9",name:"base10",alphabet:"0123456789"});var N_=Object.freeze({__proto__:null,base10:R_});const B_=Ke({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),L_=Ke({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var M_=Object.freeze({__proto__:null,base16:B_,base16upper:L_});const U_=Ke({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),j_=Ke({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),F_=Ke({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),k_=Ke({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),q_=Ke({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),z_=Ke({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),H_=Ke({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),V_=Ke({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),W_=Ke({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var K_=Object.freeze({__proto__:null,base32:U_,base32upper:j_,base32pad:F_,base32padupper:k_,base32hex:q_,base32hexupper:z_,base32hexpad:H_,base32hexpadupper:V_,base32z:W_});const G_=ws({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Z_=ws({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Y_=Object.freeze({__proto__:null,base36:G_,base36upper:Z_});const J_=ws({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Q_=ws({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var X_=Object.freeze({__proto__:null,base58btc:J_,base58flickr:Q_});const e5=Ke({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),t5=Ke({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),r5=Ke({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),n5=Ke({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var i5=Object.freeze({__proto__:null,base64:e5,base64pad:t5,base64url:r5,base64urlpad:n5});const Ap=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),s5=Ap.reduce((t,e,r)=>(t[r]=e,t),[]),o5=Ap.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function a5(t){return t.reduce((e,r)=>(e+=s5[r],e),"")}function c5(t){const e=[];for(const r of t){const n=o5[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}const l5=ko({prefix:"\u{1F680}",name:"base256emoji",encode:a5,decode:c5});var u5=Object.freeze({__proto__:null,base256emoji:l5}),h5=Pp,Cp=128,d5=127,f5=~d5,p5=Math.pow(2,31);function Pp(t,e,r){e=e||[],r=r||0;for(var n=r;t>=p5;)e[r++]=t&255|Cp,t/=128;for(;t&f5;)e[r++]=t&255|Cp,t>>>=7;return e[r]=t|0,Pp.bytes=r-n+1,e}var g5=cl,m5=128,Dp=127;function cl(t,n){var r=0,n=n||0,i=0,s=n,o,a=t.length;do{if(s>=a)throw cl.bytes=0,new RangeError("Could not decode varint");o=t[s++],r+=i<28?(o&Dp)<<i:(o&Dp)*Math.pow(2,i),i+=7}while(o>=m5);return cl.bytes=s-n,r}var w5=Math.pow(2,7),y5=Math.pow(2,14),b5=Math.pow(2,21),v5=Math.pow(2,28),E5=Math.pow(2,35),_5=Math.pow(2,42),$5=Math.pow(2,49),x5=Math.pow(2,56),I5=Math.pow(2,63),O5=function(t){return t<w5?1:t<y5?2:t<b5?3:t<v5?4:t<E5?5:t<_5?6:t<$5?7:t<x5?8:t<I5?9:10},S5={encode:h5,decode:g5,encodingLength:O5},Tp=S5;const Rp=(t,e,r=0)=>(Tp.encode(t,e,r),e),Np=t=>Tp.encodingLength(t),ll=(t,e)=>{const r=e.byteLength,n=Np(t),i=n+Np(r),s=new Uint8Array(i+r);return Rp(t,s,0),Rp(r,s,n),s.set(e,i),new A5(t,r,e,s)};class A5{constructor(e,r,n,i){this.code=e,this.size=r,this.digest=n,this.bytes=i}}const Bp=({name:t,code:e,encode:r})=>new C5(t,e,r);class C5{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?ll(this.code,r):r.then(n=>ll(this.code,n))}else throw Error("Unknown type, must be binary type")}}const Lp=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),P5=Bp({name:"sha2-256",code:18,encode:Lp("SHA-256")}),D5=Bp({name:"sha2-512",code:19,encode:Lp("SHA-512")});var T5=Object.freeze({__proto__:null,sha256:P5,sha512:D5});const Mp=0,R5="identity",Up=Op;var N5=Object.freeze({__proto__:null,identity:{code:Mp,name:R5,encode:Up,digest:t=>ll(Mp,Up(t))}});new TextEncoder,new TextDecoder;const jp={...A_,...P_,...T_,...N_,...M_,...K_,...Y_,...X_,...i5,...u5};({...T5,...N5});function Fp(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}const kp=Fp("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),ul=Fp("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=Ip(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),qp={utf8:kp,"utf-8":kp,hex:jp.base16,latin1:ul,ascii:ul,binary:ul,...jp};function Ct(t,e="utf8"){const r=qp[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t,"utf8"):r.decoder.decode(`${r.prefix}${t}`)}function ut(t,e="utf8"){const r=qp[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}const B5={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe",batchFetchMessages:"waku_batchFetchMessages"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe",batchFetchMessages:"irn_batchFetchMessages"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe",batchFetchMessages:"iridium_batchFetchMessages"}};var L5=Object.defineProperty,M5=Object.defineProperties,U5=Object.getOwnPropertyDescriptors,zp=Object.getOwnPropertySymbols,j5=Object.prototype.hasOwnProperty,F5=Object.prototype.propertyIsEnumerable,Hp=(t,e,r)=>e in t?L5(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,yr=(t,e)=>{for(var r in e||(e={}))j5.call(e,r)&&Hp(t,r,e[r]);if(zp)for(var r of zp(e))F5.call(e,r)&&Hp(t,r,e[r]);return t},hl=(t,e)=>M5(t,U5(e));const k5=":";function oi(t){const[e,r]=t.split(k5);return{namespace:e,reference:r}}function Vp(t,e=[]){const r=[];return Object.keys(t).forEach(n=>{if(e.length&&!e.includes(n))return;const i=t[n];r.push(...i.accounts)}),r}function Wp(t,e){return t.includes(":")?[t]:e.chains||[]}var q5=Object.defineProperty,z5=Object.defineProperties,H5=Object.getOwnPropertyDescriptors,Kp=Object.getOwnPropertySymbols,V5=Object.prototype.hasOwnProperty,W5=Object.prototype.propertyIsEnumerable,Gp=(t,e,r)=>e in t?q5(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Zp=(t,e)=>{for(var r in e||(e={}))V5.call(e,r)&&Gp(t,r,e[r]);if(Kp)for(var r of Kp(e))W5.call(e,r)&&Gp(t,r,e[r]);return t},K5=(t,e)=>z5(t,H5(e));const G5="ReactNative",bt={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},Z5="js";function qo(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Fr(){return!ss()&&!!lc()&&navigator.product===G5}function Y5(){return Fr()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="android"}function J5(){return Fr()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="ios"}function ys(){return!qo()&&!!lc()&&!!ss()}function bs(){return Fr()?bt.reactNative:qo()?bt.node:ys()?bt.browser:bt.unknown}function Yp(){var t;try{return Fr()&&typeof global<"u"&&typeof(global==null?void 0:global.Application)<"u"?(t=global.Application)==null?void 0:t.applicationId:void 0}catch{return}}function Q5(t,e){const r=new URLSearchParams(t);for(const n of Object.keys(e).sort())if(e.hasOwnProperty(n)){const i=e[n];i!==void 0&&r.set(n,i)}return r.toString()}function X5(t){var e,r;const n=Jp();try{return t!=null&&t.url&&n.url&&t.url!==n.url&&(console.warn(`The configured WalletConnect 'metadata.url':${t.url} differs from the actual page url:${n.url}. This is probably unintended and can lead to issues.`),t.url=n.url),(e=t?.icons)!=null&&e.length&&t.icons.length>0&&(t.icons=t.icons.filter(i=>i!=="")),K5(Zp(Zp({},n),t),{url:t?.url||n.url,name:t?.name||n.name,description:t?.description||n.description,icons:(r=t?.icons)!=null&&r.length&&t.icons.length>0?t.icons:n.icons})}catch(i){return console.warn("Error populating app metadata",i),t||n}}function Jp(){return Ed()||{name:"",description:"",url:"",icons:[""]}}function e4(){if(bs()===bt.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:r,Version:n}=global.Platform;return[r,n].join("-")}const t=my();if(t===null)return"unknown";const e=t.os?t.os.replace(" ","").toLowerCase():"unknown";return t.type==="browser"?[e,t.name,t.version].join("-"):[e,t.version].join("-")}function t4(){var t;const e=bs();return e===bt.browser?[e,((t=vd())==null?void 0:t.host)||"unknown"].join(":"):e}function Qp(t,e,r){const n=e4(),i=t4();return[[t,e].join("-"),[Z5,r].join("-"),n,i].join("/")}function r4({protocol:t,version:e,relayUrl:r,sdkVersion:n,auth:i,projectId:s,useOnCloseEvent:o,bundleId:a,packageName:c}){const l=r.split("?"),u=Qp(t,e,n),h={auth:i,ua:u,projectId:s,useOnCloseEvent:o||void 0,packageName:c||void 0,bundleId:a||void 0},d=Q5(l[1]||"",h);return l[0]+"?"+d}function gn(t,e){return t.filter(r=>e.includes(r)).length===t.length}function dl(t){return Object.fromEntries(t.entries())}function fl(t){return new Map(Object.entries(t))}function mn(t=j.FIVE_MINUTES,e){const r=j.toMiliseconds(t||j.FIVE_MINUTES);let n,i,s,o;return{resolve:a=>{s&&n&&(clearTimeout(s),n(a),o=Promise.resolve(a))},reject:a=>{s&&i&&(clearTimeout(s),i(a))},done:()=>new Promise((a,c)=>{if(o)return a(o);s=setTimeout(()=>{const l=new Error(e);o=Promise.reject(l),c(l)},r),n=a,i=c})}}function kr(t,e,r){return new Promise(async(n,i)=>{const s=setTimeout(()=>i(new Error(r)),e);try{const o=await t;n(o)}catch(o){i(o)}clearTimeout(s)})}function Xp(t,e){if(typeof e=="string"&&e.startsWith(`${t}:`))return e;if(t.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(t.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${t}`)}function n4(t){return Xp("topic",t)}function i4(t){return Xp("id",t)}function eg(t){const[e,r]=t.split(":"),n={id:void 0,topic:void 0};if(e==="topic"&&typeof r=="string")n.topic=r;else if(e==="id"&&Number.isInteger(Number(r)))n.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${r}`);return n}function Te(t,e){return j.fromMiliseconds((e||Date.now())+j.toMiliseconds(t))}function qr(t){return Date.now()>=j.toMiliseconds(t)}function le(t,e){return`${t}${e?`:${e}`:""}`}function zo(t=[],e=[]){return[...new Set([...t,...e])]}async function s4({id:t,topic:e,wcDeepLink:r}){var n;try{if(!r)return;const i=typeof r=="string"?JSON.parse(r):r,s=i?.href;if(typeof s!="string")return;const o=o4(s,t,e),a=bs();if(a===bt.browser){if(!((n=ss())!=null&&n.hasFocus())){console.warn("Document does not have focus, skipping deeplink.");return}a4(o)}else a===bt.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(o)}catch(i){console.error(i)}}function o4(t,e,r){const n=`requestId=${e}&sessionTopic=${r}`;t.endsWith("/")&&(t=t.slice(0,-1));let i=`${t}`;if(t.startsWith("https://t.me")){const s=t.includes("?")?"&startapp=":"?startapp=";i=`${i}${s}${h4(n,!0)}`}else i=`${i}/wc?${n}`;return i}function a4(t){let e="_self";u4()?e="_top":(l4()||t.startsWith("https://")||t.startsWith("http://"))&&(e="_blank"),window.open(t,e,"noreferrer noopener")}async function c4(t,e){let r="";try{if(ys()&&(r=localStorage.getItem(e),r))return r;r=await t.getItem(e)}catch(n){console.error(n)}return r}function tg(t,e){if(!t.includes(e))return null;const r=t.split(/([&,?,=])/),n=r.indexOf(e);return r[n+2]}function rg(){return typeof crypto<"u"&&crypto!=null&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)})}function pl(){return typeof process<"u"&&process.env.IS_VITEST==="true"}function l4(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)}function u4(){try{return window.self!==window.top}catch{return!1}}function h4(t,e=!1){const r=Buffer.from(t).toString("base64");return e?r.replace(/[=]/g,""):r}function ng(t){return Buffer.from(t,"base64").toString("utf-8")}function d4(t){return new Promise(e=>setTimeout(e,t))}function vs(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function f4(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Es(t,...e){if(!f4(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function gl(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");vs(t.outputLen),vs(t.blockLen)}function ai(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function ig(t,e){Es(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}const Ho=BigInt(2**32-1),sg=BigInt(32);function p4(t,e=!1){return e?{h:Number(t&Ho),l:Number(t>>sg&Ho)}:{h:Number(t>>sg&Ho)|0,l:Number(t&Ho)|0}}function g4(t,e=!1){let r=new Uint32Array(t.length),n=new Uint32Array(t.length);for(let i=0;i<t.length;i++){const{h:s,l:o}=p4(t[i],e);[r[i],n[i]]=[s,o]}return[r,n]}const m4=(t,e,r)=>t<<r|e>>>32-r,w4=(t,e,r)=>e<<r|t>>>32-r,y4=(t,e,r)=>e<<r-32|t>>>64-r,b4=(t,e,r)=>t<<r-32|e>>>64-r,ci=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function v4(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function ml(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Jt(t,e){return t<<32-e|t>>>e}const og=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function E4(t){return t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}function ag(t){for(let e=0;e<t.length;e++)t[e]=E4(t[e])}function _4(t){if(typeof t!="string")throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array(new TextEncoder().encode(t))}function li(t){return typeof t=="string"&&(t=_4(t)),Es(t),t}function $4(...t){let e=0;for(let n=0;n<t.length;n++){const i=t[n];Es(i),e+=i.length}const r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){const s=t[n];r.set(s,i),i+=s.length}return r}class wl{clone(){return this._cloneInto()}}function cg(t){const e=n=>t().update(li(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function ui(t=32){if(ci&&typeof ci.getRandomValues=="function")return ci.getRandomValues(new Uint8Array(t));if(ci&&typeof ci.randomBytes=="function")return ci.randomBytes(t);throw new Error("crypto.getRandomValues must be defined")}const lg=[],ug=[],hg=[],x4=BigInt(0),_s=BigInt(1),I4=BigInt(2),O4=BigInt(7),S4=BigInt(256),A4=BigInt(113);for(let t=0,e=_s,r=1,n=0;t<24;t++){[r,n]=[n,(2*r+3*n)%5],lg.push(2*(5*n+r)),ug.push((t+1)*(t+2)/2%64);let i=x4;for(let s=0;s<7;s++)e=(e<<_s^(e>>O4)*A4)%S4,e&I4&&(i^=_s<<(_s<<BigInt(s))-_s);hg.push(i)}const[C4,P4]=g4(hg,!0),dg=(t,e,r)=>r>32?y4(t,e,r):m4(t,e,r),fg=(t,e,r)=>r>32?b4(t,e,r):w4(t,e,r);function D4(t,e=24){const r=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let o=0;o<10;o++)r[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,l=r[c],u=r[c+1],h=dg(l,u,1)^r[a],d=fg(l,u,1)^r[a+1];for(let p=0;p<50;p+=10)t[o+p]^=h,t[o+p+1]^=d}let i=t[2],s=t[3];for(let o=0;o<24;o++){const a=ug[o],c=dg(i,s,a),l=fg(i,s,a),u=lg[o];i=t[u],s=t[u+1],t[u]=c,t[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)r[a]=t[o+a];for(let a=0;a<10;a++)t[o+a]^=~r[(a+2)%10]&r[(a+4)%10]}t[0]^=C4[n],t[1]^=P4[n]}r.fill(0)}class yl extends wl{constructor(e,r,n,i=!1,s=24){if(super(),this.blockLen=e,this.suffix=r,this.outputLen=n,this.enableXOF=i,this.rounds=s,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,vs(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=v4(this.state)}keccak(){og||ag(this.state32),D4(this.state32,this.rounds),og||ag(this.state32),this.posOut=0,this.pos=0}update(e){ai(this);const{blockLen:r,state:n}=this;e=li(e);const i=e.length;for(let s=0;s<i;){const o=Math.min(r-this.pos,i-s);for(let a=0;a<o;a++)n[this.pos++]^=e[s++];this.pos===r&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:r,pos:n,blockLen:i}=this;e[n]^=r,(r&128)!==0&&n===i-1&&this.keccak(),e[i-1]^=128,this.keccak()}writeInto(e){ai(this,!1),Es(e),this.finish();const r=this.state,{blockLen:n}=this;for(let i=0,s=e.length;i<s;){this.posOut>=n&&this.keccak();const o=Math.min(n-this.posOut,s-i);e.set(r.subarray(this.posOut,this.posOut+o),i),this.posOut+=o,i+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return vs(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(ig(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:r,suffix:n,outputLen:i,rounds:s,enableXOF:o}=this;return e||(e=new yl(r,n,i,o,s)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=s,e.suffix=n,e.outputLen=i,e.enableXOF=o,e.destroyed=this.destroyed,e}}const T4=(t,e,r)=>cg(()=>new yl(e,t,r)),R4=T4(1,136,256/8),N4="https://rpc.walletconnect.org/v1";function pg(t){const e=`Ethereum Signed Message:
${t.length}`,r=new TextEncoder().encode(e+t);return"0x"+Buffer.from(R4(r)).toString("hex")}async function B4(t,e,r,n,i,s){switch(r.t){case"eip191":return await L4(t,e,r.s);case"eip1271":return await M4(t,e,r.s,n,i,s);default:throw new Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${r.t}`)}}async function L4(t,e,r){return(await qb({hash:pg(e),signature:r})).toLowerCase()===t.toLowerCase()}async function M4(t,e,r,n,i,s){const o=oi(n);if(!o.namespace||!o.reference)throw new Error(`isValidEip1271Signature failed: chainId must be in CAIP-2 format, received: ${n}`);try{const a="0x1626ba7e",c="0000000000000000000000000000000000000000000000000000000000000040",l="0000000000000000000000000000000000000000000000000000000000000041",u=r.substring(2),h=pg(e).substring(2),d=a+h+c+l+u,p=await fetch(`${s||N4}/?chainId=${n}&projectId=${i}`,{method:"POST",body:JSON.stringify({id:U4(),jsonrpc:"2.0",method:"eth_call",params:[{to:t,data:d},"latest"]})}),{result:f}=await p.json();return f?f.slice(0,a.length).toLowerCase()===a.toLowerCase():!1}catch(a){return console.error("isValidEip1271Signature: ",a),!1}}function U4(){return Date.now()+Math.floor(Math.random()*1e3)}function j4(t){const e=atob(t),r=new Uint8Array(e.length);for(let o=0;o<e.length;o++)r[o]=e.charCodeAt(o);const n=r[0];if(n===0)throw new Error("No signatures found");const i=1+n*64;if(r.length<i)throw new Error("Transaction data too short for claimed signature count");if(r.length<100)throw new Error("Transaction too short");const s=Buffer.from(t,"base64").slice(1,65);return x2.encode(s)}var F4=Object.defineProperty,k4=Object.defineProperties,q4=Object.getOwnPropertyDescriptors,gg=Object.getOwnPropertySymbols,z4=Object.prototype.hasOwnProperty,H4=Object.prototype.propertyIsEnumerable,mg=(t,e,r)=>e in t?F4(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,V4=(t,e)=>{for(var r in e||(e={}))z4.call(e,r)&&mg(t,r,e[r]);if(gg)for(var r of gg(e))H4.call(e,r)&&mg(t,r,e[r]);return t},W4=(t,e)=>k4(t,q4(e));const K4="did:pkh:",bl=t=>t?.split(":"),G4=t=>{const e=t&&bl(t);if(e)return t.includes(K4)?e[3]:e[1]},vl=t=>{const e=t&&bl(t);if(e)return e[2]+":"+e[3]},Vo=t=>{const e=t&&bl(t);if(e)return e.pop()};async function wg(t){const{cacao:e,projectId:r}=t,{s:n,p:i}=e,s=yg(i,i.iss),o=Vo(i.iss);return await B4(o,s,n,vl(i.iss),r)}const yg=(t,e)=>{const r=`${t.domain} wants you to sign in with your Ethereum account:`,n=Vo(e);if(!t.aud&&!t.uri)throw new Error("Either `aud` or `uri` is required to construct the message");let i=t.statement||void 0;const s=`URI: ${t.aud||t.uri}`,o=`Version: ${t.version}`,a=`Chain ID: ${G4(e)}`,c=`Nonce: ${t.nonce}`,l=`Issued At: ${t.iat}`,u=t.exp?`Expiration Time: ${t.exp}`:void 0,h=t.nbf?`Not Before: ${t.nbf}`:void 0,d=t.requestId?`Request ID: ${t.requestId}`:void 0,p=t.resources?`Resources:${t.resources.map(g=>`
- ${g}`).join("")}`:void 0,f=Wo(t.resources);if(f){const g=$s(f);i=n8(i,g)}return[r,n,"",i,"",s,o,a,c,l,u,h,d,p].filter(g=>g!=null).join(`
`)};function Z4(t){return Buffer.from(JSON.stringify(t)).toString("base64")}function Y4(t){return JSON.parse(Buffer.from(t,"base64").toString("utf-8"))}function wn(t){if(!t)throw new Error("No recap provided, value is undefined");if(!t.att)throw new Error("No `att` property found");const e=Object.keys(t.att);if(!(e!=null&&e.length))throw new Error("No resources found in `att` property");e.forEach(r=>{const n=t.att[r];if(Array.isArray(n))throw new Error(`Resource must be an object: ${r}`);if(typeof n!="object")throw new Error(`Resource must be an object: ${r}`);if(!Object.keys(n).length)throw new Error(`Resource object is empty: ${r}`);Object.keys(n).forEach(i=>{const s=n[i];if(!Array.isArray(s))throw new Error(`Ability limits ${i} must be an array of objects, found: ${s}`);if(!s.length)throw new Error(`Value of ${i} is empty array, must be an array with objects`);s.forEach(o=>{if(typeof o!="object")throw new Error(`Ability limits (${i}) must be an array of objects, found: ${o}`)})})})}function J4(t,e,r,n={}){return r?.sort((i,s)=>i.localeCompare(s)),{att:{[t]:Q4(e,r,n)}}}function Q4(t,e,r={}){e=e?.sort((i,s)=>i.localeCompare(s));const n=e.map(i=>({[`${t}/${i}`]:[r]}));return Object.assign({},...n)}function bg(t){return wn(t),`urn:recap:${Z4(t).replace(/=/g,"")}`}function $s(t){const e=Y4(t.replace("urn:recap:",""));return wn(e),e}function X4(t,e,r){const n=J4(t,e,r);return bg(n)}function e8(t){return t&&t.includes("urn:recap:")}function t8(t,e){const r=$s(t),n=$s(e),i=r8(r,n);return bg(i)}function r8(t,e){wn(t),wn(e);const r=Object.keys(t.att).concat(Object.keys(e.att)).sort((i,s)=>i.localeCompare(s)),n={att:{}};return r.forEach(i=>{var s,o;Object.keys(((s=t.att)==null?void 0:s[i])||{}).concat(Object.keys(((o=e.att)==null?void 0:o[i])||{})).sort((a,c)=>a.localeCompare(c)).forEach(a=>{var c,l;n.att[i]=W4(V4({},n.att[i]),{[a]:((c=t.att[i])==null?void 0:c[a])||((l=e.att[i])==null?void 0:l[a])})})}),n}function n8(t="",e){wn(e);const r="I further authorize the stated URI to perform the following actions on my behalf: ";if(t.includes(r))return t;const n=[];let i=0;Object.keys(e.att).forEach(a=>{const c=Object.keys(e.att[a]).map(h=>({ability:h.split("/")[0],action:h.split("/")[1]}));c.sort((h,d)=>h.action.localeCompare(d.action));const l={};c.forEach(h=>{l[h.ability]||(l[h.ability]=[]),l[h.ability].push(h.action)});const u=Object.keys(l).map(h=>(i++,`(${i}) '${h}': '${l[h].join("', '")}' for '${a}'.`));n.push(u.join(", ").replace(".,","."))});const s=n.join(" "),o=`${r}${s}`;return`${t?t+" ":""}${o}`}function vg(t){var e;const r=$s(t);wn(r);const n=(e=r.att)==null?void 0:e.eip155;return n?Object.keys(n).map(i=>i.split("/")[1]):[]}function Eg(t){const e=$s(t);wn(e);const r=[];return Object.values(e.att).forEach(n=>{Object.values(n).forEach(i=>{var s;(s=i?.[0])!=null&&s.chains&&r.push(i[0].chains)})}),[...new Set(r.flat())]}function Wo(t){if(!t)return;const e=t?.[t.length-1];return e8(e)?e:void 0}function El(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function _g(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function vt(t,...e){if(!_g(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function $g(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function i8(t,e){vt(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}function xg(t){if(typeof t!="boolean")throw new Error(`boolean expected, not ${t}`)}const zr=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),s8=t=>new DataView(t.buffer,t.byteOffset,t.byteLength);if(!(new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68))throw new Error("Non little-endian hardware is not supported");function o8(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function _l(t){if(typeof t=="string")t=o8(t);else if(_g(t))t=$l(t);else throw new Error("Uint8Array expected, got "+typeof t);return t}function a8(t,e){if(e==null||typeof e!="object")throw new Error("options must be defined");return Object.assign(t,e)}function c8(t,e){if(t.length!==e.length)return!1;let r=0;for(let n=0;n<t.length;n++)r|=t[n]^e[n];return r===0}const l8=(t,e)=>{function r(n,...i){if(vt(n),t.nonceLength!==void 0){const l=i[0];if(!l)throw new Error("nonce / iv required");t.varSizeNonce?vt(l):vt(l,t.nonceLength)}const s=t.tagLength;s&&i[1]!==void 0&&vt(i[1]);const o=e(n,...i),a=(l,u)=>{if(u!==void 0){if(l!==2)throw new Error("cipher output not supported");vt(u)}};let c=!1;return{encrypt(l,u){if(c)throw new Error("cannot encrypt() twice with same key + nonce");return c=!0,vt(l),a(o.encrypt.length,u),o.encrypt(l,u)},decrypt(l,u){if(vt(l),s&&l.length<s)throw new Error("invalid ciphertext length: smaller than tagLength="+s);return a(o.decrypt.length,u),o.decrypt(l,u)}}}return Object.assign(r,t),r};function Ig(t,e,r=!0){if(e===void 0)return new Uint8Array(t);if(e.length!==t)throw new Error("invalid output length, expected "+t+", got: "+e.length);if(r&&!u8(e))throw new Error("invalid output, must be aligned");return e}function Og(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);const i=BigInt(32),s=BigInt(4294967295),o=Number(r>>i&s),a=Number(r&s),c=n?4:0,l=n?0:4;t.setUint32(e+c,o,n),t.setUint32(e+l,a,n)}function u8(t){return t.byteOffset%4===0}function $l(t){return Uint8Array.from(t)}function hi(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}const Sg=t=>Uint8Array.from(t.split("").map(e=>e.charCodeAt(0))),h8=Sg("expand 16-byte k"),d8=Sg("expand 32-byte k"),f8=zr(h8),p8=zr(d8);function ie(t,e){return t<<e|t>>>32-e}function xl(t){return t.byteOffset%4===0}const Ko=64,g8=16,Ag=2**32-1,Cg=new Uint32Array;function m8(t,e,r,n,i,s,o,a){const c=i.length,l=new Uint8Array(Ko),u=zr(l),h=xl(i)&&xl(s),d=h?zr(i):Cg,p=h?zr(s):Cg;for(let f=0;f<c;o++){if(t(e,r,n,u,o,a),o>=Ag)throw new Error("arx: counter overflow");const g=Math.min(Ko,c-f);if(h&&g===Ko){const m=f/4;if(f%4!==0)throw new Error("arx: invalid block position");for(let w=0,y;w<g8;w++)y=m+w,p[y]=d[y]^u[w];f+=Ko;continue}for(let m=0,w;m<g;m++)w=f+m,s[w]=i[w]^l[m];f+=g}}function w8(t,e){const{allowShortKeys:r,extendNonceFn:n,counterLength:i,counterRight:s,rounds:o}=a8({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},e);if(typeof t!="function")throw new Error("core must be a function");return El(i),El(o),xg(s),xg(r),(a,c,l,u,h=0)=>{vt(a),vt(c),vt(l);const d=l.length;if(u===void 0&&(u=new Uint8Array(d)),vt(u),El(h),h<0||h>=Ag)throw new Error("arx: counter overflow");if(u.length<d)throw new Error(`arx: output (${u.length}) is shorter than data (${d})`);const p=[];let f=a.length,g,m;if(f===32)p.push(g=$l(a)),m=p8;else if(f===16&&r)g=new Uint8Array(32),g.set(a),g.set(a,16),m=f8,p.push(g);else throw new Error(`arx: invalid 32-byte key, got length=${f}`);xl(c)||p.push(c=$l(c));const w=zr(g);if(n){if(c.length!==24)throw new Error("arx: extended nonce must be 24 bytes");n(m,w,zr(c.subarray(0,16)),w),c=c.subarray(16)}const y=16-i;if(y!==c.length)throw new Error(`arx: nonce must be ${y} or 16 bytes`);if(y!==12){const _=new Uint8Array(12);_.set(c,s?0:12-c.length),c=_,p.push(c)}const E=zr(c);return m8(t,m,w,E,l,u,h,o),hi(...p),u}}const Ge=(t,e)=>t[e++]&255|(t[e++]&255)<<8;class y8{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,e=_l(e),vt(e,32);const r=Ge(e,0),n=Ge(e,2),i=Ge(e,4),s=Ge(e,6),o=Ge(e,8),a=Ge(e,10),c=Ge(e,12),l=Ge(e,14);this.r[0]=r&8191,this.r[1]=(r>>>13|n<<3)&8191,this.r[2]=(n>>>10|i<<6)&7939,this.r[3]=(i>>>7|s<<9)&8191,this.r[4]=(s>>>4|o<<12)&255,this.r[5]=o>>>1&8190,this.r[6]=(o>>>14|a<<2)&8191,this.r[7]=(a>>>11|c<<5)&8065,this.r[8]=(c>>>8|l<<8)&8191,this.r[9]=l>>>5&127;for(let u=0;u<8;u++)this.pad[u]=Ge(e,16+2*u)}process(e,r,n=!1){const i=n?0:2048,{h:s,r:o}=this,a=o[0],c=o[1],l=o[2],u=o[3],h=o[4],d=o[5],p=o[6],f=o[7],g=o[8],m=o[9],w=Ge(e,r+0),y=Ge(e,r+2),E=Ge(e,r+4),_=Ge(e,r+6),O=Ge(e,r+8),S=Ge(e,r+10),x=Ge(e,r+12),P=Ge(e,r+14);let $=s[0]+(w&8191),B=s[1]+((w>>>13|y<<3)&8191),D=s[2]+((y>>>10|E<<6)&8191),R=s[3]+((E>>>7|_<<9)&8191),M=s[4]+((_>>>4|O<<12)&8191),A=s[5]+(O>>>1&8191),b=s[6]+((O>>>14|S<<2)&8191),v=s[7]+((S>>>11|x<<5)&8191),I=s[8]+((x>>>8|P<<8)&8191),T=s[9]+(P>>>5|i),C=0,N=C+$*a+B*(5*m)+D*(5*g)+R*(5*f)+M*(5*p);C=N>>>13,N&=8191,N+=A*(5*d)+b*(5*h)+v*(5*u)+I*(5*l)+T*(5*c),C+=N>>>13,N&=8191;let U=C+$*c+B*a+D*(5*m)+R*(5*g)+M*(5*f);C=U>>>13,U&=8191,U+=A*(5*p)+b*(5*d)+v*(5*h)+I*(5*u)+T*(5*l),C+=U>>>13,U&=8191;let k=C+$*l+B*c+D*a+R*(5*m)+M*(5*g);C=k>>>13,k&=8191,k+=A*(5*f)+b*(5*p)+v*(5*d)+I*(5*h)+T*(5*u),C+=k>>>13,k&=8191;let H=C+$*u+B*l+D*c+R*a+M*(5*m);C=H>>>13,H&=8191,H+=A*(5*g)+b*(5*f)+v*(5*p)+I*(5*d)+T*(5*h),C+=H>>>13,H&=8191;let q=C+$*h+B*u+D*l+R*c+M*a;C=q>>>13,q&=8191,q+=A*(5*m)+b*(5*g)+v*(5*f)+I*(5*p)+T*(5*d),C+=q>>>13,q&=8191;let W=C+$*d+B*h+D*u+R*l+M*c;C=W>>>13,W&=8191,W+=A*a+b*(5*m)+v*(5*g)+I*(5*f)+T*(5*p),C+=W>>>13,W&=8191;let G=C+$*p+B*d+D*h+R*u+M*l;C=G>>>13,G&=8191,G+=A*c+b*a+v*(5*m)+I*(5*g)+T*(5*f),C+=G>>>13,G&=8191;let ce=C+$*f+B*p+D*d+R*h+M*u;C=ce>>>13,ce&=8191,ce+=A*l+b*c+v*a+I*(5*m)+T*(5*g),C+=ce>>>13,ce&=8191;let X=C+$*g+B*f+D*p+R*d+M*h;C=X>>>13,X&=8191,X+=A*u+b*l+v*c+I*a+T*(5*m),C+=X>>>13,X&=8191;let Q=C+$*m+B*g+D*f+R*p+M*d;C=Q>>>13,Q&=8191,Q+=A*h+b*u+v*l+I*c+T*a,C+=Q>>>13,Q&=8191,C=(C<<2)+C|0,C=C+N|0,N=C&8191,C=C>>>13,U+=C,s[0]=N,s[1]=U,s[2]=k,s[3]=H,s[4]=q,s[5]=W,s[6]=G,s[7]=ce,s[8]=X,s[9]=Q}finalize(){const{h:e,pad:r}=this,n=new Uint16Array(10);let i=e[1]>>>13;e[1]&=8191;for(let a=2;a<10;a++)e[a]+=i,i=e[a]>>>13,e[a]&=8191;e[0]+=i*5,i=e[0]>>>13,e[0]&=8191,e[1]+=i,i=e[1]>>>13,e[1]&=8191,e[2]+=i,n[0]=e[0]+5,i=n[0]>>>13,n[0]&=8191;for(let a=1;a<10;a++)n[a]=e[a]+i,i=n[a]>>>13,n[a]&=8191;n[9]-=8192;let s=(i^1)-1;for(let a=0;a<10;a++)n[a]&=s;s=~s;for(let a=0;a<10;a++)e[a]=e[a]&s|n[a];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let o=e[0]+r[0];e[0]=o&65535;for(let a=1;a<8;a++)o=(e[a]+r[a]|0)+(o>>>16)|0,e[a]=o&65535;hi(n)}update(e){$g(this);const{buffer:r,blockLen:n}=this;e=_l(e);const i=e.length;for(let s=0;s<i;){const o=Math.min(n-this.pos,i-s);if(o===n){for(;n<=i-s;s+=n)this.process(e,s);continue}r.set(e.subarray(s,s+o),this.pos),this.pos+=o,s+=o,this.pos===n&&(this.process(r,0,!1),this.pos=0)}return this}destroy(){hi(this.h,this.r,this.buffer,this.pad)}digestInto(e){$g(this),i8(e,this),this.finished=!0;const{buffer:r,h:n}=this;let{pos:i}=this;if(i){for(r[i++]=1;i<16;i++)r[i]=0;this.process(r,0,!0)}this.finalize();let s=0;for(let o=0;o<8;o++)e[s++]=n[o]>>>0,e[s++]=n[o]>>>8;return e}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const n=e.slice(0,r);return this.destroy(),n}}function b8(t){const e=(n,i)=>t(i).update(_l(n)).digest(),r=t(new Uint8Array(32));return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=n=>t(n),e}const v8=b8(t=>new y8(t));function E8(t,e,r,n,i,s=20){let o=t[0],a=t[1],c=t[2],l=t[3],u=e[0],h=e[1],d=e[2],p=e[3],f=e[4],g=e[5],m=e[6],w=e[7],y=i,E=r[0],_=r[1],O=r[2],S=o,x=a,P=c,$=l,B=u,D=h,R=d,M=p,A=f,b=g,v=m,I=w,T=y,C=E,N=_,U=O;for(let H=0;H<s;H+=2)S=S+B|0,T=ie(T^S,16),A=A+T|0,B=ie(B^A,12),S=S+B|0,T=ie(T^S,8),A=A+T|0,B=ie(B^A,7),x=x+D|0,C=ie(C^x,16),b=b+C|0,D=ie(D^b,12),x=x+D|0,C=ie(C^x,8),b=b+C|0,D=ie(D^b,7),P=P+R|0,N=ie(N^P,16),v=v+N|0,R=ie(R^v,12),P=P+R|0,N=ie(N^P,8),v=v+N|0,R=ie(R^v,7),$=$+M|0,U=ie(U^$,16),I=I+U|0,M=ie(M^I,12),$=$+M|0,U=ie(U^$,8),I=I+U|0,M=ie(M^I,7),S=S+D|0,U=ie(U^S,16),v=v+U|0,D=ie(D^v,12),S=S+D|0,U=ie(U^S,8),v=v+U|0,D=ie(D^v,7),x=x+R|0,T=ie(T^x,16),I=I+T|0,R=ie(R^I,12),x=x+R|0,T=ie(T^x,8),I=I+T|0,R=ie(R^I,7),P=P+M|0,C=ie(C^P,16),A=A+C|0,M=ie(M^A,12),P=P+M|0,C=ie(C^P,8),A=A+C|0,M=ie(M^A,7),$=$+B|0,N=ie(N^$,16),b=b+N|0,B=ie(B^b,12),$=$+B|0,N=ie(N^$,8),b=b+N|0,B=ie(B^b,7);let k=0;n[k++]=o+S|0,n[k++]=a+x|0,n[k++]=c+P|0,n[k++]=l+$|0,n[k++]=u+B|0,n[k++]=h+D|0,n[k++]=d+R|0,n[k++]=p+M|0,n[k++]=f+A|0,n[k++]=g+b|0,n[k++]=m+v|0,n[k++]=w+I|0,n[k++]=y+T|0,n[k++]=E+C|0,n[k++]=_+N|0,n[k++]=O+U|0}const _8=w8(E8,{counterRight:!1,counterLength:4,allowShortKeys:!1}),$8=new Uint8Array(16),Pg=(t,e)=>{t.update(e);const r=e.length%16;r&&t.update($8.subarray(r))},x8=new Uint8Array(32);function Dg(t,e,r,n,i){const s=t(e,r,x8),o=v8.create(s);i&&Pg(o,i),Pg(o,n);const a=new Uint8Array(16),c=s8(a);Og(c,0,BigInt(i?i.length:0),!0),Og(c,8,BigInt(n.length),!0),o.update(a);const l=o.digest();return hi(s,a),l}const I8=t=>(e,r,n)=>({encrypt(i,s){const o=i.length;s=Ig(o+16,s,!1),s.set(i);const a=s.subarray(0,-16);t(e,r,a,a,1);const c=Dg(t,e,r,a,n);return s.set(c,o),hi(c),s},decrypt(i,s){s=Ig(i.length-16,s,!1);const o=i.subarray(0,-16),a=i.subarray(-16),c=Dg(t,e,r,o,n);if(!c8(a,c))throw new Error("invalid tag");return s.set(i.subarray(0,-16)),t(e,r,s,s,1),hi(c),s}}),Tg=l8({blockSize:64,nonceLength:12,tagLength:16},I8(_8));class Rg extends wl{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,gl(e);const n=li(r);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const i=this.blockLen,s=new Uint8Array(i);s.set(n.length>i?e.create().update(n).digest():n);for(let o=0;o<s.length;o++)s[o]^=54;this.iHash.update(s),this.oHash=e.create();for(let o=0;o<s.length;o++)s[o]^=106;this.oHash.update(s),s.fill(0)}update(e){return ai(this),this.iHash.update(e),this}digestInto(e){ai(this),Es(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:r,iHash:n,finished:i,destroyed:s,blockLen:o,outputLen:a}=this;return e=e,e.finished=i,e.destroyed=s,e.blockLen=o,e.outputLen=a,e.oHash=r._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const Go=(t,e,r)=>new Rg(t,e).update(r).digest();Go.create=(t,e)=>new Rg(t,e);function O8(t,e,r){return gl(t),r===void 0&&(r=new Uint8Array(t.outputLen)),Go(t,li(r),li(e))}const Il=new Uint8Array([0]),Ng=new Uint8Array;function S8(t,e,r,n=32){if(gl(t),vs(n),n>255*t.outputLen)throw new Error("Length should be <= 255*HashLen");const i=Math.ceil(n/t.outputLen);r===void 0&&(r=Ng);const s=new Uint8Array(i*t.outputLen),o=Go.create(t,e),a=o._cloneInto(),c=new Uint8Array(o.outputLen);for(let l=0;l<i;l++)Il[0]=l+1,a.update(l===0?Ng:c).update(r).update(Il).digestInto(c),s.set(c,t.outputLen*l),o._cloneInto(a);return o.destroy(),a.destroy(),c.fill(0),Il.fill(0),s.slice(0,n)}const A8=(t,e,r,n,i)=>S8(t,O8(t,e,r),n,i);function C8(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);const i=BigInt(32),s=BigInt(4294967295),o=Number(r>>i&s),a=Number(r&s),c=n?4:0,l=n?0:4;t.setUint32(e+c,o,n),t.setUint32(e+l,a,n)}function P8(t,e,r){return t&e^~t&r}function D8(t,e,r){return t&e^t&r^e&r}class T8 extends wl{constructor(e,r,n,i){super(),this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=ml(this.buffer)}update(e){ai(this);const{view:r,buffer:n,blockLen:i}=this;e=li(e);const s=e.length;for(let o=0;o<s;){const a=Math.min(i-this.pos,s-o);if(a===i){const c=ml(e);for(;i<=s-o;o+=i)this.process(c,o);continue}n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===i&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){ai(this),ig(e,this),this.finished=!0;const{buffer:r,view:n,blockLen:i,isLE:s}=this;let{pos:o}=this;r[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>i-o&&(this.process(n,0),o=0);for(let h=o;h<i;h++)r[h]=0;C8(n,i-8,BigInt(this.length*8),s),this.process(n,0);const a=ml(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<l;h++)a.setUint32(4*h,u[h],s)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:n,length:i,finished:s,destroyed:o,pos:a}=this;return e.length=i,e.pos=a,e.finished=s,e.destroyed=o,i%r&&e.buffer.set(n),e}}const R8=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Hr=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Vr=new Uint32Array(64);class N8 extends T8{constructor(){super(64,32,8,!1),this.A=Hr[0]|0,this.B=Hr[1]|0,this.C=Hr[2]|0,this.D=Hr[3]|0,this.E=Hr[4]|0,this.F=Hr[5]|0,this.G=Hr[6]|0,this.H=Hr[7]|0}get(){const{A:e,B:r,C:n,D:i,E:s,F:o,G:a,H:c}=this;return[e,r,n,i,s,o,a,c]}set(e,r,n,i,s,o,a,c){this.A=e|0,this.B=r|0,this.C=n|0,this.D=i|0,this.E=s|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,r){for(let h=0;h<16;h++,r+=4)Vr[h]=e.getUint32(r,!1);for(let h=16;h<64;h++){const d=Vr[h-15],p=Vr[h-2],f=Jt(d,7)^Jt(d,18)^d>>>3,g=Jt(p,17)^Jt(p,19)^p>>>10;Vr[h]=g+Vr[h-7]+f+Vr[h-16]|0}let{A:n,B:i,C:s,D:o,E:a,F:c,G:l,H:u}=this;for(let h=0;h<64;h++){const d=Jt(a,6)^Jt(a,11)^Jt(a,25),p=u+d+P8(a,c,l)+R8[h]+Vr[h]|0,f=(Jt(n,2)^Jt(n,13)^Jt(n,22))+D8(n,i,s)|0;u=l,l=c,c=a,a=o+p|0,o=s,s=i,i=n,n=p+f|0}n=n+this.A|0,i=i+this.B|0,s=s+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(n,i,s,o,a,c,l,u)}roundClean(){Vr.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const xs=cg(()=>new N8);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Zo=BigInt(0),Yo=BigInt(1),B8=BigInt(2);function yn(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Is(t){if(!yn(t))throw new Error("Uint8Array expected")}function di(t,e){if(typeof e!="boolean")throw new Error(t+" boolean expected, got "+e)}const L8=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function fi(t){Is(t);let e="";for(let r=0;r<t.length;r++)e+=L8[t[r]];return e}function pi(t){const e=t.toString(16);return e.length&1?"0"+e:e}function Ol(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?Zo:BigInt("0x"+t)}const br={_0:48,_9:57,A:65,F:70,a:97,f:102};function Bg(t){if(t>=br._0&&t<=br._9)return t-br._0;if(t>=br.A&&t<=br.F)return t-(br.A-10);if(t>=br.a&&t<=br.f)return t-(br.a-10)}function gi(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length,r=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(r);for(let i=0,s=0;i<r;i++,s+=2){const o=Bg(t.charCodeAt(s)),a=Bg(t.charCodeAt(s+1));if(o===void 0||a===void 0){const c=t[s]+t[s+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+s)}n[i]=o*16+a}return n}function bn(t){return Ol(fi(t))}function Os(t){return Is(t),Ol(fi(Uint8Array.from(t).reverse()))}function mi(t,e){return gi(t.toString(16).padStart(e*2,"0"))}function Jo(t,e){return mi(t,e).reverse()}function M8(t){return gi(pi(t))}function Et(t,e,r){let n;if(typeof e=="string")try{n=gi(e)}catch(s){throw new Error(t+" must be hex string or Uint8Array, cause: "+s)}else if(yn(e))n=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const i=n.length;if(typeof r=="number"&&i!==r)throw new Error(t+" of length "+r+" expected, got "+i);return n}function Ss(...t){let e=0;for(let n=0;n<t.length;n++){const i=t[n];Is(i),e+=i.length}const r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){const s=t[n];r.set(s,i),i+=s.length}return r}function U8(t,e){if(t.length!==e.length)return!1;let r=0;for(let n=0;n<t.length;n++)r|=t[n]^e[n];return r===0}function j8(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}const Sl=t=>typeof t=="bigint"&&Zo<=t;function Qo(t,e,r){return Sl(t)&&Sl(e)&&Sl(r)&&e<=t&&t<r}function vr(t,e,r,n){if(!Qo(e,r,n))throw new Error("expected valid "+t+": "+r+" <= n < "+n+", got "+e)}function Lg(t){let e;for(e=0;t>Zo;t>>=Yo,e+=1);return e}function F8(t,e){return t>>BigInt(e)&Yo}function k8(t,e,r){return t|(r?Yo:Zo)<<BigInt(e)}const Al=t=>(B8<<BigInt(t-1))-Yo,Cl=t=>new Uint8Array(t),Mg=t=>Uint8Array.from(t);function Ug(t,e,r){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let n=Cl(t),i=Cl(t),s=0;const o=()=>{n.fill(1),i.fill(0),s=0},a=(...u)=>r(i,n,...u),c=(u=Cl())=>{i=a(Mg([0]),u),n=a(),u.length!==0&&(i=a(Mg([1]),u),n=a())},l=()=>{if(s++>=1e3)throw new Error("drbg: tried 1000 values");let u=0;const h=[];for(;u<e;){n=a();const d=n.slice();h.push(d),u+=n.length}return Ss(...h)};return(u,h)=>{o(),c(u);let d;for(;!(d=h(l()));)c();return o(),d}}const q8={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||yn(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function wi(t,e,r={}){const n=(i,s,o)=>{const a=q8[s];if(typeof a!="function")throw new Error("invalid validator function");const c=t[i];if(!(o&&c===void 0)&&!a(c,t))throw new Error("param "+String(i)+" is invalid. Expected "+s+", got "+c)};for(const[i,s]of Object.entries(e))n(i,s,!1);for(const[i,s]of Object.entries(r))n(i,s,!0);return t}const z8=()=>{throw new Error("not implemented")};function Pl(t){const e=new WeakMap;return(r,...n)=>{const i=e.get(r);if(i!==void 0)return i;const s=t(r,...n);return e.set(r,s),s}}var H8=Object.freeze({__proto__:null,isBytes:yn,abytes:Is,abool:di,bytesToHex:fi,numberToHexUnpadded:pi,hexToNumber:Ol,hexToBytes:gi,bytesToNumberBE:bn,bytesToNumberLE:Os,numberToBytesBE:mi,numberToBytesLE:Jo,numberToVarBytesBE:M8,ensureBytes:Et,concatBytes:Ss,equalBytes:U8,utf8ToBytes:j8,inRange:Qo,aInRange:vr,bitLen:Lg,bitGet:F8,bitSet:k8,bitMask:Al,createHmacDrbg:Ug,validateObject:wi,notImplemented:z8,memoized:Pl});const Me=BigInt(0),Ie=BigInt(1),vn=BigInt(2),V8=BigInt(3),Dl=BigInt(4),jg=BigInt(5),Fg=BigInt(8);function ht(t,e){const r=t%e;return r>=Me?r:e+r}function kg(t,e,r){if(e<Me)throw new Error("invalid exponent, negatives unsupported");if(r<=Me)throw new Error("invalid modulus");if(r===Ie)return Me;let n=Ie;for(;e>Me;)e&Ie&&(n=n*t%r),t=t*t%r,e>>=Ie;return n}function Ft(t,e,r){let n=t;for(;e-- >Me;)n*=n,n%=r;return n}function Tl(t,e){if(t===Me)throw new Error("invert: expected non-zero number");if(e<=Me)throw new Error("invert: expected positive modulus, got "+e);let r=ht(t,e),n=e,i=Me,s=Ie;for(;r!==Me;){const o=n/r,a=n%r,c=i-s*o;n=r,r=a,i=s,s=c}if(n!==Ie)throw new Error("invert: does not exist");return ht(i,e)}function W8(t){const e=(t-Ie)/vn;let r,n,i;for(r=t-Ie,n=0;r%vn===Me;r/=vn,n++);for(i=vn;i<t&&kg(i,e,t)!==t-Ie;i++)if(i>1e3)throw new Error("Cannot find square root: likely non-prime P");if(n===1){const o=(t+Ie)/Dl;return function(a,c){const l=a.pow(c,o);if(!a.eql(a.sqr(l),c))throw new Error("Cannot find square root");return l}}const s=(r+Ie)/vn;return function(o,a){if(o.pow(a,e)===o.neg(o.ONE))throw new Error("Cannot find square root");let c=n,l=o.pow(o.mul(o.ONE,i),r),u=o.pow(a,s),h=o.pow(a,r);for(;!o.eql(h,o.ONE);){if(o.eql(h,o.ZERO))return o.ZERO;let d=1;for(let f=o.sqr(h);d<c&&!o.eql(f,o.ONE);d++)f=o.sqr(f);const p=o.pow(l,Ie<<BigInt(c-d-1));l=o.sqr(p),u=o.mul(u,p),h=o.mul(h,l),c=d}return u}}function K8(t){if(t%Dl===V8){const e=(t+Ie)/Dl;return function(r,n){const i=r.pow(n,e);if(!r.eql(r.sqr(i),n))throw new Error("Cannot find square root");return i}}if(t%Fg===jg){const e=(t-jg)/Fg;return function(r,n){const i=r.mul(n,vn),s=r.pow(i,e),o=r.mul(n,s),a=r.mul(r.mul(o,vn),s),c=r.mul(o,r.sub(a,r.ONE));if(!r.eql(r.sqr(c),n))throw new Error("Cannot find square root");return c}}return W8(t)}const G8=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Z8(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=G8.reduce((n,i)=>(n[i]="function",n),e);return wi(t,r)}function Y8(t,e,r){if(r<Me)throw new Error("invalid exponent, negatives unsupported");if(r===Me)return t.ONE;if(r===Ie)return e;let n=t.ONE,i=e;for(;r>Me;)r&Ie&&(n=t.mul(n,i)),i=t.sqr(i),r>>=Ie;return n}function J8(t,e){const r=new Array(e.length),n=e.reduce((s,o,a)=>t.is0(o)?s:(r[a]=s,t.mul(s,o)),t.ONE),i=t.inv(n);return e.reduceRight((s,o,a)=>t.is0(o)?s:(r[a]=t.mul(s,r[a]),t.mul(s,o)),i),r}function qg(t,e){const r=e!==void 0?e:t.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function zg(t,e,r=!1,n={}){if(t<=Me)throw new Error("invalid field: expected ORDER > 0, got "+t);const{nBitLength:i,nByteLength:s}=qg(t,e);if(s>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:t,isLE:r,BITS:i,BYTES:s,MASK:Al(i),ZERO:Me,ONE:Ie,create:c=>ht(c,t),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return Me<=c&&c<t},is0:c=>c===Me,isOdd:c=>(c&Ie)===Ie,neg:c=>ht(-c,t),eql:(c,l)=>c===l,sqr:c=>ht(c*c,t),add:(c,l)=>ht(c+l,t),sub:(c,l)=>ht(c-l,t),mul:(c,l)=>ht(c*l,t),pow:(c,l)=>Y8(a,c,l),div:(c,l)=>ht(c*Tl(l,t),t),sqrN:c=>c*c,addN:(c,l)=>c+l,subN:(c,l)=>c-l,mulN:(c,l)=>c*l,inv:c=>Tl(c,t),sqrt:n.sqrt||(c=>(o||(o=K8(t)),o(a,c))),invertBatch:c=>J8(a,c),cmov:(c,l,u)=>u?l:c,toBytes:c=>r?Jo(c,s):mi(c,s),fromBytes:c=>{if(c.length!==s)throw new Error("Field.fromBytes: expected "+s+" bytes, got "+c.length);return r?Os(c):bn(c)}});return Object.freeze(a)}function Hg(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function Vg(t){const e=Hg(t);return e+Math.ceil(e/2)}function Q8(t,e,r=!1){const n=t.length,i=Hg(e),s=Vg(e);if(n<16||n<s||n>1024)throw new Error("expected "+s+"-1024 bytes of input, got "+n);const o=r?Os(t):bn(t),a=ht(o,e-Ie)+Ie;return r?Jo(a,i):mi(a,i)}const Wg=BigInt(0),Xo=BigInt(1);function Rl(t,e){const r=e.negate();return t?r:e}function Kg(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function Nl(t,e){Kg(t,e);const r=Math.ceil(e/t)+1,n=2**(t-1);return{windows:r,windowSize:n}}function X8(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((r,n)=>{if(!(r instanceof e))throw new Error("invalid point at index "+n)})}function e$(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((r,n)=>{if(!e.isValid(r))throw new Error("invalid scalar at index "+n)})}const Bl=new WeakMap,Gg=new WeakMap;function Ll(t){return Gg.get(t)||1}function t$(t,e){return{constTimeNegate:Rl,hasPrecomputes(r){return Ll(r)!==1},unsafeLadder(r,n,i=t.ZERO){let s=r;for(;n>Wg;)n&Xo&&(i=i.add(s)),s=s.double(),n>>=Xo;return i},precomputeWindow(r,n){const{windows:i,windowSize:s}=Nl(n,e),o=[];let a=r,c=a;for(let l=0;l<i;l++){c=a,o.push(c);for(let u=1;u<s;u++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(r,n,i){const{windows:s,windowSize:o}=Nl(r,e);let a=t.ZERO,c=t.BASE;const l=BigInt(2**r-1),u=2**r,h=BigInt(r);for(let d=0;d<s;d++){const p=d*o;let f=Number(i&l);i>>=h,f>o&&(f-=u,i+=Xo);const g=p,m=p+Math.abs(f)-1,w=d%2!==0,y=f<0;f===0?c=c.add(Rl(w,n[g])):a=a.add(Rl(y,n[m]))}return{p:a,f:c}},wNAFUnsafe(r,n,i,s=t.ZERO){const{windows:o,windowSize:a}=Nl(r,e),c=BigInt(2**r-1),l=2**r,u=BigInt(r);for(let h=0;h<o;h++){const d=h*a;if(i===Wg)break;let p=Number(i&c);if(i>>=u,p>a&&(p-=l,i+=Xo),p===0)continue;let f=n[d+Math.abs(p)-1];p<0&&(f=f.negate()),s=s.add(f)}return s},getPrecomputes(r,n,i){let s=Bl.get(n);return s||(s=this.precomputeWindow(n,r),r!==1&&Bl.set(n,i(s))),s},wNAFCached(r,n,i){const s=Ll(r);return this.wNAF(s,this.getPrecomputes(s,r,i),n)},wNAFCachedUnsafe(r,n,i,s){const o=Ll(r);return o===1?this.unsafeLadder(r,n,s):this.wNAFUnsafe(o,this.getPrecomputes(o,r,i),n,s)},setWindowSize(r,n){Kg(n,e),Gg.set(r,n),Bl.delete(r)}}}function r$(t,e,r,n){if(X8(r,t),e$(n,e),r.length!==n.length)throw new Error("arrays of points and scalars must have equal length");const i=t.ZERO,s=Lg(BigInt(r.length)),o=s>12?s-3:s>4?s-2:s?2:1,a=(1<<o)-1,c=new Array(a+1).fill(i),l=Math.floor((e.BITS-1)/o)*o;let u=i;for(let h=l;h>=0;h-=o){c.fill(i);for(let p=0;p<n.length;p++){const f=n[p],g=Number(f>>BigInt(h)&BigInt(a));c[g]=c[g].add(r[p])}let d=i;for(let p=c.length-1,f=i;p>0;p--)f=f.add(c[p]),d=d.add(f);if(u=u.add(d),h!==0)for(let p=0;p<o;p++)u=u.double()}return u}function Zg(t){return Z8(t.Fp),wi(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze(hl(yr(yr({},qg(t.n,t.nBitLength)),t),{p:t.Fp.ORDER}))}BigInt(0),BigInt(1),BigInt(2),BigInt(8);const yi=BigInt(0),Ml=BigInt(1);function n$(t){return wi(t,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze(yr({},t))}function i$(t){const e=n$(t),{P:r}=e,n=y=>ht(y,r),i=e.montgomeryBits,s=Math.ceil(i/8),o=e.nByteLength,a=e.adjustScalarBytes||(y=>y),c=e.powPminus2||(y=>kg(y,r-BigInt(2),r));function l(y,E,_){const O=n(y*(E-_));return E=n(E-O),_=n(_+O),[E,_]}const u=(e.a-BigInt(2))/BigInt(4);function h(y,E){vr("u",y,yi,r),vr("scalar",E,yi,r);const _=E,O=y;let S=Ml,x=yi,P=y,$=Ml,B=yi,D;for(let M=BigInt(i-1);M>=yi;M--){const A=_>>M&Ml;B^=A,D=l(B,S,P),S=D[0],P=D[1],D=l(B,x,$),x=D[0],$=D[1],B=A;const b=S+x,v=n(b*b),I=S-x,T=n(I*I),C=v-T,N=P+$,U=P-$,k=n(U*b),H=n(N*I),q=k+H,W=k-H;P=n(q*q),$=n(O*n(W*W)),S=n(v*T),x=n(C*(v+n(u*C)))}D=l(B,S,P),S=D[0],P=D[1],D=l(B,x,$),x=D[0],$=D[1];const R=c(x);return n(S*R)}function d(y){return Jo(n(y),s)}function p(y){const E=Et("u coordinate",y,s);return o===32&&(E[31]&=127),Os(E)}function f(y){const E=Et("scalar",y),_=E.length;if(_!==s&&_!==o){let O=""+s+" or "+o;throw new Error("invalid scalar, expected "+O+" bytes, got "+_)}return Os(a(E))}function g(y,E){const _=p(E),O=f(y),S=h(_,O);if(S===yi)throw new Error("invalid private or public key received");return d(S)}const m=d(e.Gu);function w(y){return g(y,m)}return{scalarMult:g,scalarMultBase:w,getSharedSecret:(y,E)=>g(y,E),getPublicKey:y=>w(y),utils:{randomPrivateKey:()=>e.randomBytes(e.nByteLength)},GuBytes:m}}const Ul=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949");BigInt(0);const s$=BigInt(1),Yg=BigInt(2),o$=BigInt(3),a$=BigInt(5);BigInt(8);function c$(t){const e=BigInt(10),r=BigInt(20),n=BigInt(40),i=BigInt(80),s=Ul,o=t*t%s*t%s,a=Ft(o,Yg,s)*o%s,c=Ft(a,s$,s)*t%s,l=Ft(c,a$,s)*c%s,u=Ft(l,e,s)*l%s,h=Ft(u,r,s)*u%s,d=Ft(h,n,s)*h%s,p=Ft(d,i,s)*d%s,f=Ft(p,i,s)*d%s,g=Ft(f,e,s)*l%s;return{pow_p_5_8:Ft(g,Yg,s)*t%s,b2:o}}function l$(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}const jl=i$({P:Ul,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:t=>{const e=Ul,{pow_p_5_8:r,b2:n}=c$(t);return ht(Ft(r,o$,e)*n,e)},adjustScalarBytes:l$,randomBytes:ui});function Jg(t){t.lowS!==void 0&&di("lowS",t.lowS),t.prehash!==void 0&&di("prehash",t.prehash)}function u$(t){const e=Zg(t);wi(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:r,Fp:n,a:i}=e;if(r){if(!n.eql(i,n.ZERO))throw new Error("invalid endomorphism, can only be defined for Koblitz curves that have a=0");if(typeof r!="object"||typeof r.beta!="bigint"||typeof r.splitScalar!="function")throw new Error("invalid endomorphism, expected beta: bigint and splitScalar: function")}return Object.freeze(yr({},e))}const{bytesToNumberBE:h$,hexToBytes:d$}=H8;class f$ extends Error{constructor(e=""){super(e)}}const Er={Err:f$,_tlv:{encode:(t,e)=>{const{Err:r}=Er;if(t<0||t>256)throw new r("tlv.encode: wrong tag");if(e.length&1)throw new r("tlv.encode: unpadded data");const n=e.length/2,i=pi(n);if(i.length/2&128)throw new r("tlv.encode: long form length too big");const s=n>127?pi(i.length/2|128):"";return pi(t)+s+i+e},decode(t,e){const{Err:r}=Er;let n=0;if(t<0||t>256)throw new r("tlv.encode: wrong tag");if(e.length<2||e[n++]!==t)throw new r("tlv.decode: wrong tlv");const i=e[n++],s=!!(i&128);let o=0;if(!s)o=i;else{const c=i&127;if(!c)throw new r("tlv.decode(long): indefinite length not supported");if(c>4)throw new r("tlv.decode(long): byte length is too big");const l=e.subarray(n,n+c);if(l.length!==c)throw new r("tlv.decode: length bytes not complete");if(l[0]===0)throw new r("tlv.decode(long): zero leftmost byte");for(const u of l)o=o<<8|u;if(n+=c,o<128)throw new r("tlv.decode(long): not minimal encoding")}const a=e.subarray(n,n+o);if(a.length!==o)throw new r("tlv.decode: wrong value length");return{v:a,l:e.subarray(n+o)}}},_int:{encode(t){const{Err:e}=Er;if(t<_r)throw new e("integer: negative integers are not allowed");let r=pi(t);if(Number.parseInt(r[0],16)&8&&(r="00"+r),r.length&1)throw new e("unexpected DER parsing assertion: unpadded hex");return r},decode(t){const{Err:e}=Er;if(t[0]&128)throw new e("invalid signature integer: negative");if(t[0]===0&&!(t[1]&128))throw new e("invalid signature integer: unnecessary leading zero");return h$(t)}},toSig(t){const{Err:e,_int:r,_tlv:n}=Er,i=typeof t=="string"?d$(t):t;Is(i);const{v:s,l:o}=n.decode(48,i);if(o.length)throw new e("invalid signature: left bytes after parsing");const{v:a,l:c}=n.decode(2,s),{v:l,l:u}=n.decode(2,c);if(u.length)throw new e("invalid signature: left bytes after parsing");return{r:r.decode(a),s:r.decode(l)}},hexFromSig(t){const{_tlv:e,_int:r}=Er,n=e.encode(2,r.encode(t.r)),i=e.encode(2,r.encode(t.s)),s=n+i;return e.encode(48,s)}},_r=BigInt(0),Ue=BigInt(1);BigInt(2);const Qg=BigInt(3);BigInt(4);function p$(t){const e=u$(t),{Fp:r}=e,n=zg(e.n,e.nBitLength),i=e.toBytes||((g,m,w)=>{const y=m.toAffine();return Ss(Uint8Array.from([4]),r.toBytes(y.x),r.toBytes(y.y))}),s=e.fromBytes||(g=>{const m=g.subarray(1),w=r.fromBytes(m.subarray(0,r.BYTES)),y=r.fromBytes(m.subarray(r.BYTES,2*r.BYTES));return{x:w,y}});function o(g){const{a:m,b:w}=e,y=r.sqr(g),E=r.mul(y,g);return r.add(r.add(E,r.mul(g,m)),w)}if(!r.eql(r.sqr(e.Gy),o(e.Gx)))throw new Error("bad generator point: equation left != right");function a(g){return Qo(g,Ue,e.n)}function c(g){const{allowedPrivateKeyLengths:m,nByteLength:w,wrapPrivateKey:y,n:E}=e;if(m&&typeof g!="bigint"){if(yn(g)&&(g=fi(g)),typeof g!="string"||!m.includes(g.length))throw new Error("invalid private key");g=g.padStart(w*2,"0")}let _;try{_=typeof g=="bigint"?g:bn(Et("private key",g,w))}catch{throw new Error("invalid private key, expected hex or "+w+" bytes, got "+typeof g)}return y&&(_=ht(_,E)),vr("private key",_,Ue,E),_}function l(g){if(!(g instanceof d))throw new Error("ProjectivePoint expected")}const u=Pl((g,m)=>{const{px:w,py:y,pz:E}=g;if(r.eql(E,r.ONE))return{x:w,y};const _=g.is0();m==null&&(m=_?r.ONE:r.inv(E));const O=r.mul(w,m),S=r.mul(y,m),x=r.mul(E,m);if(_)return{x:r.ZERO,y:r.ZERO};if(!r.eql(x,r.ONE))throw new Error("invZ was invalid");return{x:O,y:S}}),h=Pl(g=>{if(g.is0()){if(e.allowInfinityPoint&&!r.is0(g.py))return;throw new Error("bad point: ZERO")}const{x:m,y:w}=g.toAffine();if(!r.isValid(m)||!r.isValid(w))throw new Error("bad point: x or y not FE");const y=r.sqr(w),E=o(m);if(!r.eql(y,E))throw new Error("bad point: equation left != right");if(!g.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});class d{constructor(m,w,y){if(this.px=m,this.py=w,this.pz=y,m==null||!r.isValid(m))throw new Error("x required");if(w==null||!r.isValid(w))throw new Error("y required");if(y==null||!r.isValid(y))throw new Error("z required");Object.freeze(this)}static fromAffine(m){const{x:w,y}=m||{};if(!m||!r.isValid(w)||!r.isValid(y))throw new Error("invalid affine point");if(m instanceof d)throw new Error("projective point not allowed");const E=_=>r.eql(_,r.ZERO);return E(w)&&E(y)?d.ZERO:new d(w,y,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(m){const w=r.invertBatch(m.map(y=>y.pz));return m.map((y,E)=>y.toAffine(w[E])).map(d.fromAffine)}static fromHex(m){const w=d.fromAffine(s(Et("pointHex",m)));return w.assertValidity(),w}static fromPrivateKey(m){return d.BASE.multiply(c(m))}static msm(m,w){return r$(d,n,m,w)}_setWindowSize(m){f.setWindowSize(this,m)}assertValidity(){h(this)}hasEvenY(){const{y:m}=this.toAffine();if(r.isOdd)return!r.isOdd(m);throw new Error("Field doesn't support isOdd")}equals(m){l(m);const{px:w,py:y,pz:E}=this,{px:_,py:O,pz:S}=m,x=r.eql(r.mul(w,S),r.mul(_,E)),P=r.eql(r.mul(y,S),r.mul(O,E));return x&&P}negate(){return new d(this.px,r.neg(this.py),this.pz)}double(){const{a:m,b:w}=e,y=r.mul(w,Qg),{px:E,py:_,pz:O}=this;let S=r.ZERO,x=r.ZERO,P=r.ZERO,$=r.mul(E,E),B=r.mul(_,_),D=r.mul(O,O),R=r.mul(E,_);return R=r.add(R,R),P=r.mul(E,O),P=r.add(P,P),S=r.mul(m,P),x=r.mul(y,D),x=r.add(S,x),S=r.sub(B,x),x=r.add(B,x),x=r.mul(S,x),S=r.mul(R,S),P=r.mul(y,P),D=r.mul(m,D),R=r.sub($,D),R=r.mul(m,R),R=r.add(R,P),P=r.add($,$),$=r.add(P,$),$=r.add($,D),$=r.mul($,R),x=r.add(x,$),D=r.mul(_,O),D=r.add(D,D),$=r.mul(D,R),S=r.sub(S,$),P=r.mul(D,B),P=r.add(P,P),P=r.add(P,P),new d(S,x,P)}add(m){l(m);const{px:w,py:y,pz:E}=this,{px:_,py:O,pz:S}=m;let x=r.ZERO,P=r.ZERO,$=r.ZERO;const B=e.a,D=r.mul(e.b,Qg);let R=r.mul(w,_),M=r.mul(y,O),A=r.mul(E,S),b=r.add(w,y),v=r.add(_,O);b=r.mul(b,v),v=r.add(R,M),b=r.sub(b,v),v=r.add(w,E);let I=r.add(_,S);return v=r.mul(v,I),I=r.add(R,A),v=r.sub(v,I),I=r.add(y,E),x=r.add(O,S),I=r.mul(I,x),x=r.add(M,A),I=r.sub(I,x),$=r.mul(B,v),x=r.mul(D,A),$=r.add(x,$),x=r.sub(M,$),$=r.add(M,$),P=r.mul(x,$),M=r.add(R,R),M=r.add(M,R),A=r.mul(B,A),v=r.mul(D,v),M=r.add(M,A),A=r.sub(R,A),A=r.mul(B,A),v=r.add(v,A),R=r.mul(M,v),P=r.add(P,R),R=r.mul(I,v),x=r.mul(b,x),x=r.sub(x,R),R=r.mul(b,M),$=r.mul(I,$),$=r.add($,R),new d(x,P,$)}subtract(m){return this.add(m.negate())}is0(){return this.equals(d.ZERO)}wNAF(m){return f.wNAFCached(this,m,d.normalizeZ)}multiplyUnsafe(m){const{endo:w,n:y}=e;vr("scalar",m,_r,y);const E=d.ZERO;if(m===_r)return E;if(this.is0()||m===Ue)return this;if(!w||f.hasPrecomputes(this))return f.wNAFCachedUnsafe(this,m,d.normalizeZ);let{k1neg:_,k1:O,k2neg:S,k2:x}=w.splitScalar(m),P=E,$=E,B=this;for(;O>_r||x>_r;)O&Ue&&(P=P.add(B)),x&Ue&&($=$.add(B)),B=B.double(),O>>=Ue,x>>=Ue;return _&&(P=P.negate()),S&&($=$.negate()),$=new d(r.mul($.px,w.beta),$.py,$.pz),P.add($)}multiply(m){const{endo:w,n:y}=e;vr("scalar",m,Ue,y);let E,_;if(w){const{k1neg:O,k1:S,k2neg:x,k2:P}=w.splitScalar(m);let{p:$,f:B}=this.wNAF(S),{p:D,f:R}=this.wNAF(P);$=f.constTimeNegate(O,$),D=f.constTimeNegate(x,D),D=new d(r.mul(D.px,w.beta),D.py,D.pz),E=$.add(D),_=B.add(R)}else{const{p:O,f:S}=this.wNAF(m);E=O,_=S}return d.normalizeZ([E,_])[0]}multiplyAndAddUnsafe(m,w,y){const E=d.BASE,_=(S,x)=>x===_r||x===Ue||!S.equals(E)?S.multiplyUnsafe(x):S.multiply(x),O=_(this,w).add(_(m,y));return O.is0()?void 0:O}toAffine(m){return u(this,m)}isTorsionFree(){const{h:m,isTorsionFree:w}=e;if(m===Ue)return!0;if(w)return w(d,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:m,clearCofactor:w}=e;return m===Ue?this:w?w(d,this):this.multiplyUnsafe(e.h)}toRawBytes(m=!0){return di("isCompressed",m),this.assertValidity(),i(d,this,m)}toHex(m=!0){return di("isCompressed",m),fi(this.toRawBytes(m))}}d.BASE=new d(e.Gx,e.Gy,r.ONE),d.ZERO=new d(r.ZERO,r.ONE,r.ZERO);const p=e.nBitLength,f=t$(d,e.endo?Math.ceil(p/2):p);return{CURVE:e,ProjectivePoint:d,normPrivateKeyToScalar:c,weierstrassEquation:o,isWithinCurveOrder:a}}function g$(t){const e=Zg(t);return wi(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze(yr({lowS:!0},e))}function m$(t){const e=g$(t),{Fp:r,n}=e,i=r.BYTES+1,s=2*r.BYTES+1;function o(A){return ht(A,n)}function a(A){return Tl(A,n)}const{ProjectivePoint:c,normPrivateKeyToScalar:l,weierstrassEquation:u,isWithinCurveOrder:h}=p$(hl(yr({},e),{toBytes(A,b,v){const I=b.toAffine(),T=r.toBytes(I.x),C=Ss;return di("isCompressed",v),v?C(Uint8Array.from([b.hasEvenY()?2:3]),T):C(Uint8Array.from([4]),T,r.toBytes(I.y))},fromBytes(A){const b=A.length,v=A[0],I=A.subarray(1);if(b===i&&(v===2||v===3)){const T=bn(I);if(!Qo(T,Ue,r.ORDER))throw new Error("Point is not on curve");const C=u(T);let N;try{N=r.sqrt(C)}catch(k){const H=k instanceof Error?": "+k.message:"";throw new Error("Point is not on curve"+H)}const U=(N&Ue)===Ue;return(v&1)===1!==U&&(N=r.neg(N)),{x:T,y:N}}else if(b===s&&v===4){const T=r.fromBytes(I.subarray(0,r.BYTES)),C=r.fromBytes(I.subarray(r.BYTES,2*r.BYTES));return{x:T,y:C}}else{const T=i,C=s;throw new Error("invalid Point, expected length of "+T+", or uncompressed "+C+", got "+b)}}})),d=A=>fi(mi(A,e.nByteLength));function p(A){const b=n>>Ue;return A>b}function f(A){return p(A)?o(-A):A}const g=(A,b,v)=>bn(A.slice(b,v));class m{constructor(b,v,I){this.r=b,this.s=v,this.recovery=I,this.assertValidity()}static fromCompact(b){const v=e.nByteLength;return b=Et("compactSignature",b,v*2),new m(g(b,0,v),g(b,v,2*v))}static fromDER(b){const{r:v,s:I}=Er.toSig(Et("DER",b));return new m(v,I)}assertValidity(){vr("r",this.r,Ue,n),vr("s",this.s,Ue,n)}addRecoveryBit(b){return new m(this.r,this.s,b)}recoverPublicKey(b){const{r:v,s:I,recovery:T}=this,C=S(Et("msgHash",b));if(T==null||![0,1,2,3].includes(T))throw new Error("recovery id invalid");const N=T===2||T===3?v+e.n:v;if(N>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");const U=(T&1)===0?"02":"03",k=c.fromHex(U+d(N)),H=a(N),q=o(-C*H),W=o(I*H),G=c.BASE.multiplyAndAddUnsafe(k,q,W);if(!G)throw new Error("point at infinify");return G.assertValidity(),G}hasHighS(){return p(this.s)}normalizeS(){return this.hasHighS()?new m(this.r,o(-this.s),this.recovery):this}toDERRawBytes(){return gi(this.toDERHex())}toDERHex(){return Er.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return gi(this.toCompactHex())}toCompactHex(){return d(this.r)+d(this.s)}}const w={isValidPrivateKey(A){try{return l(A),!0}catch{return!1}},normPrivateKeyToScalar:l,randomPrivateKey:()=>{const A=Vg(e.n);return Q8(e.randomBytes(A),e.n)},precompute(A=8,b=c.BASE){return b._setWindowSize(A),b.multiply(BigInt(3)),b}};function y(A,b=!0){return c.fromPrivateKey(A).toRawBytes(b)}function E(A){const b=yn(A),v=typeof A=="string",I=(b||v)&&A.length;return b?I===i||I===s:v?I===2*i||I===2*s:A instanceof c}function _(A,b,v=!0){if(E(A))throw new Error("first arg must be private key");if(!E(b))throw new Error("second arg must be public key");return c.fromHex(b).multiply(l(A)).toRawBytes(v)}const O=e.bits2int||function(A){if(A.length>8192)throw new Error("input is too large");const b=bn(A),v=A.length*8-e.nBitLength;return v>0?b>>BigInt(v):b},S=e.bits2int_modN||function(A){return o(O(A))},x=Al(e.nBitLength);function P(A){return vr("num < 2^"+e.nBitLength,A,_r,x),mi(A,e.nByteLength)}function $(A,b,v=B){if(["recovered","canonical"].some(X=>X in v))throw new Error("sign() legacy options not supported");const{hash:I,randomBytes:T}=e;let{lowS:C,prehash:N,extraEntropy:U}=v;C==null&&(C=!0),A=Et("msgHash",A),Jg(v),N&&(A=Et("prehashed msgHash",I(A)));const k=S(A),H=l(b),q=[P(H),P(k)];if(U!=null&&U!==!1){const X=U===!0?T(r.BYTES):U;q.push(Et("extraEntropy",X))}const W=Ss(...q),G=k;function ce(X){const Q=O(X);if(!h(Q))return;const Se=a(Q),ve=c.BASE.multiply(Q).toAffine(),_e=o(ve.x);if(_e===_r)return;const He=o(Se*o(G+_e*H));if(He===_r)return;let Pe=(ve.x===_e?0:2)|Number(ve.y&Ue),Pr=He;return C&&p(He)&&(Pr=f(He),Pe^=1),new m(_e,Pr,Pe)}return{seed:W,k2sig:ce}}const B={lowS:e.lowS,prehash:!1},D={lowS:e.lowS,prehash:!1};function R(A,b,v=B){const{seed:I,k2sig:T}=$(A,b,v),C=e;return Ug(C.hash.outputLen,C.nByteLength,C.hmac)(I,T)}c.BASE._setWindowSize(8);function M(A,b,v,I=D){var T;const C=A;b=Et("msgHash",b),v=Et("publicKey",v);const{lowS:N,prehash:U,format:k}=I;if(Jg(I),"strict"in I)throw new Error("options.strict was renamed to lowS");if(k!==void 0&&k!=="compact"&&k!=="der")throw new Error("format must be compact or der");const H=typeof C=="string"||yn(C),q=!H&&!k&&typeof C=="object"&&C!==null&&typeof C.r=="bigint"&&typeof C.s=="bigint";if(!H&&!q)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let W,G;try{if(q&&(W=new m(C.r,C.s)),H){try{k!=="compact"&&(W=m.fromDER(C))}catch(Pe){if(!(Pe instanceof Er.Err))throw Pe}!W&&k!=="der"&&(W=m.fromCompact(C))}G=c.fromHex(v)}catch{return!1}if(!W||N&&W.hasHighS())return!1;U&&(b=e.hash(b));const{r:ce,s:X}=W,Q=S(b),Se=a(X),ve=o(Q*Se),_e=o(ce*Se),He=(T=c.BASE.multiplyAndAddUnsafe(G,ve,_e))==null?void 0:T.toAffine();return He?o(He.x)===ce:!1}return{CURVE:e,getPublicKey:y,getSharedSecret:_,sign:R,verify:M,ProjectivePoint:c,Signature:m,utils:w}}function w$(t){return{hash:t,hmac:(e,...r)=>Go(t,e,$4(...r)),randomBytes:ui}}function y$(t,e){const r=n=>m$(yr(yr({},t),w$(n)));return hl(yr({},r(e)),{create:r})}const Xg=zg(BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff")),b$=Xg.create(BigInt("-3")),v$=BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),E$=y$({a:b$,b:v$,Fp:Xg,n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),h:BigInt(1),lowS:!1},xs),e0="base10",nt="base16",kt="base64pad",Wr="base64url",As="utf8",t0=0,$r=1,Cs=2,_$=0,r0=1,Ps=12,Fl=32;function $$(){const t=jl.utils.randomPrivateKey(),e=jl.getPublicKey(t);return{privateKey:ut(t,nt),publicKey:ut(e,nt)}}function kl(){const t=ui(Fl);return ut(t,nt)}function x$(t,e){const r=jl.getSharedSecret(Ct(t,nt),Ct(e,nt)),n=A8(xs,r,void 0,void 0,Fl);return ut(n,nt)}function ea(t){const e=xs(Ct(t,nt));return ut(e,nt)}function Qt(t){const e=xs(Ct(t,As));return ut(e,nt)}function n0(t){return Ct(`${t}`,e0)}function En(t){return Number(ut(t,e0))}function i0(t){return t.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function s0(t){const e=t.replace(/-/g,"+").replace(/_/g,"/"),r=(4-e.length%4)%4;return e+"=".repeat(r)}function I$(t){const e=n0(typeof t.type<"u"?t.type:t0);if(En(e)===$r&&typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof t.senderPublicKey<"u"?Ct(t.senderPublicKey,nt):void 0,n=typeof t.iv<"u"?Ct(t.iv,nt):ui(Ps),i=Ct(t.symKey,nt),s=Tg(i,n).encrypt(Ct(t.message,As)),o=o0({type:e,sealed:s,iv:n,senderPublicKey:r});return t.encoding===Wr?i0(o):o}function O$(t){const e=Ct(t.symKey,nt),{sealed:r,iv:n}=Ds({encoded:t.encoded,encoding:t.encoding}),i=Tg(e,n).decrypt(r);if(i===null)throw new Error("Failed to decrypt");return ut(i,As)}function S$(t,e){const r=n0(Cs),n=ui(Ps),i=Ct(t,As),s=o0({type:r,sealed:i,iv:n});return e===Wr?i0(s):s}function A$(t,e){const{sealed:r}=Ds({encoded:t,encoding:e});return ut(r,As)}function o0(t){if(En(t.type)===Cs)return ut(ms([t.type,t.sealed]),kt);if(En(t.type)===$r){if(typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return ut(ms([t.type,t.senderPublicKey,t.iv,t.sealed]),kt)}return ut(ms([t.type,t.iv,t.sealed]),kt)}function Ds(t){const e=(t.encoding||kt)===Wr?s0(t.encoded):t.encoded,r=Ct(e,kt),n=r.slice(_$,r0),i=r0;if(En(n)===$r){const c=i+Fl,l=c+Ps,u=r.slice(i,c),h=r.slice(c,l),d=r.slice(l);return{type:n,sealed:d,iv:h,senderPublicKey:u}}if(En(n)===Cs){const c=r.slice(i),l=ui(Ps);return{type:n,sealed:c,iv:l}}const s=i+Ps,o=r.slice(i,s),a=r.slice(s);return{type:n,sealed:a,iv:o}}function C$(t,e){const r=Ds({encoded:t,encoding:e?.encoding});return a0({type:En(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?ut(r.senderPublicKey,nt):void 0,receiverPublicKey:e?.receiverPublicKey})}function a0(t){const e=t?.type||t0;if(e===$r){if(typeof t?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof t?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:t?.senderPublicKey,receiverPublicKey:t?.receiverPublicKey}}function c0(t){return t.type===$r&&typeof t.senderPublicKey=="string"&&typeof t.receiverPublicKey=="string"}function l0(t){return t.type===Cs}function P$(t){const e=Buffer.from(t.x,"base64"),r=Buffer.from(t.y,"base64");return ms([new Uint8Array([4]),e,r])}function D$(t,e){const[r,n,i]=t.split("."),s=Buffer.from(s0(i),"base64");if(s.length!==64)throw new Error("Invalid signature length");const o=s.slice(0,32),a=s.slice(32,64),c=`${r}.${n}`,l=xs(c),u=P$(e);if(!E$.verify(ms([o,a]),l,u))throw new Error("Invalid signature");return al(t).payload}const T$="irn";function ta(t){return t?.relay||{protocol:T$}}function Ts(t){const e=B5[t];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${t}`);return e}function R$(t,e="-"){const r={},n="relay"+e;return Object.keys(t).forEach(i=>{if(i.startsWith(n)){const s=i.replace(n,""),o=t[i];r[s]=o}}),r}function u0(t){if(!t.includes("wc:")){const l=ng(t);l!=null&&l.includes("wc:")&&(t=l)}t=t.includes("wc://")?t.replace("wc://",""):t,t=t.includes("wc:")?t.replace("wc:",""):t;const e=t.indexOf(":"),r=t.indexOf("?")!==-1?t.indexOf("?"):void 0,n=t.substring(0,e),i=t.substring(e+1,r).split("@"),s=typeof r<"u"?t.substring(r):"",o=new URLSearchParams(s),a={};o.forEach((l,u)=>{a[u]=l});const c=typeof a.methods=="string"?a.methods.split(","):void 0;return{protocol:n,topic:N$(i[0]),version:parseInt(i[1],10),symKey:a.symKey,relay:R$(a),methods:c,expiryTimestamp:a.expiryTimestamp?parseInt(a.expiryTimestamp,10):void 0}}function N$(t){return t.startsWith("//")?t.substring(2):t}function B$(t,e="-"){const r="relay",n={};return Object.keys(t).forEach(i=>{const s=i,o=r+e+s;t[s]&&(n[o]=t[s])}),n}function h0(t){const e=new URLSearchParams,r=B$(t.relay);Object.keys(r).sort().forEach(i=>{e.set(i,r[i])}),e.set("symKey",t.symKey),t.expiryTimestamp&&e.set("expiryTimestamp",t.expiryTimestamp.toString()),t.methods&&e.set("methods",t.methods.join(","));const n=e.toString();return`${t.protocol}:${t.topic}@${t.version}?${n}`}function ra(t,e,r){return`${t}?wc_ev=${r}&topic=${e}`}function bi(t){const e=[];return t.forEach(r=>{const[n,i]=r.split(":");e.push(`${n}:${i}`)}),e}function L$(t){const e=[];return Object.values(t).forEach(r=>{e.push(...bi(r.accounts))}),e}function M$(t,e){const r=[];return Object.values(t).forEach(n=>{bi(n.accounts).includes(e)&&r.push(...n.methods)}),r}function U$(t,e){const r=[];return Object.values(t).forEach(n=>{bi(n.accounts).includes(e)&&r.push(...n.events)}),r}function ql(t){return t.includes(":")}function Rs(t){return ql(t)?t.split(":")[0]:t}function j$(t){const e={};return t?.forEach(r=>{var n;const[i,s]=r.split(":");e[i]||(e[i]={accounts:[],chains:[],events:[],methods:[]}),e[i].accounts.push(r),(n=e[i].chains)==null||n.push(`${i}:${s}`)}),e}function d0(t,e){e=e.map(n=>n.replace("did:pkh:",""));const r=j$(e);for(const[n,i]of Object.entries(r))i.methods?i.methods=zo(i.methods,t):i.methods=t,i.events=["chainChanged","accountsChanged"];return r}const F$={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},k$={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function F(t,e){const{message:r,code:n}=k$[t];return{message:e?`${r} ${e}`:r,code:n}}function he(t,e){const{message:r,code:n}=F$[t];return{message:e?`${r} ${e}`:r,code:n}}function qt(t,e){return Array.isArray(t)?typeof e<"u"&&t.length?t.every(e):!0:!1}function Ns(t){return Object.getPrototypeOf(t)===Object.prototype&&Object.keys(t).length}function Ze(t){return typeof t>"u"}function Ae(t,e){return e&&Ze(t)?!0:typeof t=="string"&&!!t.trim().length}function zl(t,e){return e&&Ze(t)?!0:typeof t=="number"&&!isNaN(t)}function q$(t,e){const{requiredNamespaces:r}=e,n=Object.keys(t.namespaces),i=Object.keys(r);let s=!0;return gn(i,n)?(n.forEach(o=>{const{accounts:a,methods:c,events:l}=t.namespaces[o],u=bi(a),h=r[o];(!gn(Wp(o,h),u)||!gn(h.methods,c)||!gn(h.events,l))&&(s=!1)}),s):!1}function na(t){return Ae(t,!1)&&t.includes(":")?t.split(":").length===2:!1}function z$(t){if(Ae(t,!1)&&t.includes(":")){const e=t.split(":");if(e.length===3){const r=e[0]+":"+e[1];return!!e[2]&&na(r)}}return!1}function H$(t){function e(r){try{return typeof new URL(r)<"u"}catch{return!1}}try{if(Ae(t,!1)){if(e(t))return!0;const r=ng(t);return e(r)}}catch{}return!1}function V$(t){var e;return(e=t?.proposer)==null?void 0:e.publicKey}function W$(t){return t?.topic}function K$(t,e){let r=null;return Ae(t?.publicKey,!1)||(r=F("MISSING_OR_INVALID",`${e} controller public key should be a string`)),r}function f0(t){let e=!0;return qt(t)?t.length&&(e=t.every(r=>Ae(r,!1))):e=!1,e}function G$(t,e,r){let n=null;return qt(e)&&e.length?e.forEach(i=>{n||na(i)||(n=he("UNSUPPORTED_CHAINS",`${r}, chain ${i} should be a string and conform to "namespace:chainId" format`))}):na(t)||(n=he("UNSUPPORTED_CHAINS",`${r}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),n}function Z$(t,e,r){let n=null;return Object.entries(t).forEach(([i,s])=>{if(n)return;const o=G$(i,Wp(i,s),`${e} ${r}`);o&&(n=o)}),n}function Y$(t,e){let r=null;return qt(t)?t.forEach(n=>{r||z$(n)||(r=he("UNSUPPORTED_ACCOUNTS",`${e}, account ${n} should be a string and conform to "namespace:chainId:address" format`))}):r=he("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function J$(t,e){let r=null;return Object.values(t).forEach(n=>{if(r)return;const i=Y$(n?.accounts,`${e} namespace`);i&&(r=i)}),r}function Q$(t,e){let r=null;return f0(t?.methods)?f0(t?.events)||(r=he("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):r=he("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),r}function p0(t,e){let r=null;return Object.values(t).forEach(n=>{if(r)return;const i=Q$(n,`${e}, namespace`);i&&(r=i)}),r}function X$(t,e,r){let n=null;if(t&&Ns(t)){const i=p0(t,e);i&&(n=i);const s=Z$(t,e,r);s&&(n=s)}else n=F("MISSING_OR_INVALID",`${e}, ${r} should be an object with data`);return n}function Hl(t,e){let r=null;if(t&&Ns(t)){const n=p0(t,e);n&&(r=n);const i=J$(t,e);i&&(r=i)}else r=F("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return r}function g0(t){return Ae(t.protocol,!0)}function ex(t,e){let r=!1;return e&&!t?r=!0:t&&qt(t)&&t.length&&t.forEach(n=>{r=g0(n)}),r}function tx(t){return typeof t=="number"}function dt(t){return typeof t<"u"&&typeof t!==null}function rx(t){return!(!t||typeof t!="object"||!t.code||!zl(t.code,!1)||!t.message||!Ae(t.message,!1))}function nx(t){return!(Ze(t)||!Ae(t.method,!1))}function ix(t){return!(Ze(t)||Ze(t.result)&&Ze(t.error)||!zl(t.id,!1)||!Ae(t.jsonrpc,!1))}function sx(t){return!(Ze(t)||!Ae(t.name,!1))}function m0(t,e){return!(!na(e)||!L$(t).includes(e))}function ox(t,e,r){return Ae(r,!1)?M$(t,e).includes(r):!1}function ax(t,e,r){return Ae(r,!1)?U$(t,e).includes(r):!1}function w0(t,e,r){let n=null;const i=cx(t),s=lx(e),o=Object.keys(i),a=Object.keys(s),c=y0(Object.keys(t)),l=y0(Object.keys(e)),u=c.filter(h=>!l.includes(h));return u.length&&(n=F("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.
      Required: ${u.toString()}
      Received: ${Object.keys(e).toString()}`)),gn(o,a)||(n=F("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.
      Required: ${o.toString()}
      Approved: ${a.toString()}`)),Object.keys(e).forEach(h=>{if(!h.includes(":")||n)return;const d=bi(e[h].accounts);d.includes(h)||(n=F("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${h}
        Required: ${h}
        Approved: ${d.toString()}`))}),o.forEach(h=>{n||(gn(i[h].methods,s[h].methods)?gn(i[h].events,s[h].events)||(n=F("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${h}`)):n=F("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${h}`))}),n}function cx(t){const e={};return Object.keys(t).forEach(r=>{var n;r.includes(":")?e[r]=t[r]:(n=t[r].chains)==null||n.forEach(i=>{e[i]={methods:t[r].methods,events:t[r].events}})}),e}function y0(t){return[...new Set(t.map(e=>e.includes(":")?e.split(":")[0]:e))]}function lx(t){const e={};return Object.keys(t).forEach(r=>{if(r.includes(":"))e[r]=t[r];else{const n=bi(t[r].accounts);n?.forEach(i=>{e[i]={accounts:t[r].accounts.filter(s=>s.includes(`${i}:`)),methods:t[r].methods,events:t[r].events}})}}),e}function ux(t,e){return zl(t,!1)&&t<=e.max&&t>=e.min}function b0(){const t=bs();return new Promise(e=>{switch(t){case bt.browser:e(hx());break;case bt.reactNative:e(dx());break;case bt.node:e(fx());break;default:e(!0)}})}function hx(){return ys()&&navigator?.onLine}async function dx(){if(Fr()&&typeof global<"u"&&global!=null&&global.NetInfo){const t=await(global==null?void 0:global.NetInfo.fetch());return t?.isConnected}return!0}function fx(){return!0}function px(t){switch(bs()){case bt.browser:gx(t);break;case bt.reactNative:mx(t);break}}function gx(t){!Fr()&&ys()&&(window.addEventListener("online",()=>t(!0)),window.addEventListener("offline",()=>t(!1)))}function mx(t){Fr()&&typeof global<"u"&&global!=null&&global.NetInfo&&global?.NetInfo.addEventListener(e=>t(e?.isConnected))}const Vl={};class Bs{static get(e){return Vl[e]}static set(e,r){Vl[e]=r}static delete(e){delete Vl[e]}}class _n{}class wx extends _n{constructor(e){super()}}const v0=j.FIVE_SECONDS,vi={pulse:"heartbeat_pulse"};class Wl extends wx{constructor(e){super(e),this.events=new Ve.exports.EventEmitter,this.interval=v0,this.interval=e?.interval||v0}static async init(e){const r=new Wl(e);return await r.init(),r}async init(){await this.initialize()}stop(){clearInterval(this.intervalRef)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async initialize(){this.intervalRef=setInterval(()=>this.pulse(),j.toMiliseconds(this.interval))}pulse(){this.events.emit(vi.pulse)}}const yx=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,bx=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,vx=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function Ex(t,e){if(t==="__proto__"||t==="constructor"&&e&&typeof e=="object"&&"prototype"in e){_x(t);return}return e}function _x(t){console.warn(`[destr] Dropping "${t}" key to prevent prototype pollution.`)}function ia(t,e={}){if(typeof t!="string")return t;const r=t.trim();if(t[0]==='"'&&t.endsWith('"')&&!t.includes("\\"))return r.slice(1,-1);if(r.length<=9){const n=r.toLowerCase();if(n==="true")return!0;if(n==="false")return!1;if(n==="undefined")return;if(n==="null")return null;if(n==="nan")return Number.NaN;if(n==="infinity")return Number.POSITIVE_INFINITY;if(n==="-infinity")return Number.NEGATIVE_INFINITY}if(!vx.test(t)){if(e.strict)throw new SyntaxError("[destr] Invalid JSON");return t}try{if(yx.test(t)||bx.test(t)){if(e.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(t,Ex)}return JSON.parse(t)}catch(n){if(e.strict)throw n;return t}}function $x(t){return!t||typeof t.then!="function"?Promise.resolve(t):t}function je(t,...e){try{return $x(t(...e))}catch(r){return Promise.reject(r)}}function xx(t){const e=typeof t;return t===null||e!=="object"&&e!=="function"}function Ix(t){const e=Object.getPrototypeOf(t);return!e||e.isPrototypeOf(Object)}function sa(t){if(xx(t))return String(t);if(Ix(t)||Array.isArray(t))return JSON.stringify(t);if(typeof t.toJSON=="function")return sa(t.toJSON());throw new Error("[unstorage] Cannot stringify value!")}const Kl="base64:";function Ox(t){return typeof t=="string"?t:Kl+Cx(t)}function Sx(t){return typeof t!="string"||!t.startsWith(Kl)?t:Ax(t.slice(Kl.length))}function Ax(t){return globalThis.Buffer?Buffer.from(t,"base64"):Uint8Array.from(globalThis.atob(t),e=>e.codePointAt(0))}function Cx(t){return globalThis.Buffer?Buffer.from(t).toString("base64"):globalThis.btoa(String.fromCodePoint(...t))}function ft(t){return t&&t.split("?")[0]?.replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,"")||""}function Px(...t){return ft(t.join(":"))}function oa(t){return t=ft(t),t?t+":":""}function AN(t){return t}const Dx="memory",Tx=()=>{const t=new Map;return{name:Dx,getInstance:()=>t,hasItem(e){return t.has(e)},getItem(e){return t.get(e)??null},getItemRaw(e){return t.get(e)??null},setItem(e,r){t.set(e,r)},setItemRaw(e,r){t.set(e,r)},removeItem(e){t.delete(e)},getKeys(){return[...t.keys()]},clear(){t.clear()},dispose(){t.clear()}}};function Rx(t={}){const e={mounts:{"":t.driver||Tx()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},r=l=>{for(const u of e.mountpoints)if(l.startsWith(u))return{base:u,relativeKey:l.slice(u.length),driver:e.mounts[u]};return{base:"",relativeKey:l,driver:e.mounts[""]}},n=(l,u)=>e.mountpoints.filter(h=>h.startsWith(l)||u&&l.startsWith(h)).map(h=>({relativeBase:l.length>h.length?l.slice(h.length):void 0,mountpoint:h,driver:e.mounts[h]})),i=(l,u)=>{if(e.watching){u=ft(u);for(const h of e.watchListeners)h(l,u)}},s=async()=>{if(!e.watching){e.watching=!0;for(const l in e.mounts)e.unwatch[l]=await E0(e.mounts[l],i,l)}},o=async()=>{if(e.watching){for(const l in e.unwatch)await e.unwatch[l]();e.unwatch={},e.watching=!1}},a=(l,u,h)=>{const d=new Map,p=f=>{let g=d.get(f.base);return g||(g={driver:f.driver,base:f.base,items:[]},d.set(f.base,g)),g};for(const f of l){const g=typeof f=="string",m=ft(g?f:f.key),w=g?void 0:f.value,y=g||!f.options?u:{...u,...f.options},E=r(m);p(E).items.push({key:m,value:w,relativeKey:E.relativeKey,options:y})}return Promise.all([...d.values()].map(f=>h(f))).then(f=>f.flat())},c={hasItem(l,u={}){l=ft(l);const{relativeKey:h,driver:d}=r(l);return je(d.hasItem,h,u)},getItem(l,u={}){l=ft(l);const{relativeKey:h,driver:d}=r(l);return je(d.getItem,h,u).then(p=>ia(p))},getItems(l,u={}){return a(l,u,h=>h.driver.getItems?je(h.driver.getItems,h.items.map(d=>({key:d.relativeKey,options:d.options})),u).then(d=>d.map(p=>({key:Px(h.base,p.key),value:ia(p.value)}))):Promise.all(h.items.map(d=>je(h.driver.getItem,d.relativeKey,d.options).then(p=>({key:d.key,value:ia(p)})))))},getItemRaw(l,u={}){l=ft(l);const{relativeKey:h,driver:d}=r(l);return d.getItemRaw?je(d.getItemRaw,h,u):je(d.getItem,h,u).then(p=>Sx(p))},async setItem(l,u,h={}){if(u===void 0)return c.removeItem(l);l=ft(l);const{relativeKey:d,driver:p}=r(l);p.setItem&&(await je(p.setItem,d,sa(u),h),p.watch||i("update",l))},async setItems(l,u){await a(l,u,async h=>{if(h.driver.setItems)return je(h.driver.setItems,h.items.map(d=>({key:d.relativeKey,value:sa(d.value),options:d.options})),u);h.driver.setItem&&await Promise.all(h.items.map(d=>je(h.driver.setItem,d.relativeKey,sa(d.value),d.options)))})},async setItemRaw(l,u,h={}){if(u===void 0)return c.removeItem(l,h);l=ft(l);const{relativeKey:d,driver:p}=r(l);if(p.setItemRaw)await je(p.setItemRaw,d,u,h);else if(p.setItem)await je(p.setItem,d,Ox(u),h);else return;p.watch||i("update",l)},async removeItem(l,u={}){typeof u=="boolean"&&(u={removeMeta:u}),l=ft(l);const{relativeKey:h,driver:d}=r(l);d.removeItem&&(await je(d.removeItem,h,u),(u.removeMeta||u.removeMata)&&await je(d.removeItem,h+"$",u),d.watch||i("remove",l))},async getMeta(l,u={}){typeof u=="boolean"&&(u={nativeOnly:u}),l=ft(l);const{relativeKey:h,driver:d}=r(l),p=Object.create(null);if(d.getMeta&&Object.assign(p,await je(d.getMeta,h,u)),!u.nativeOnly){const f=await je(d.getItem,h+"$",u).then(g=>ia(g));f&&typeof f=="object"&&(typeof f.atime=="string"&&(f.atime=new Date(f.atime)),typeof f.mtime=="string"&&(f.mtime=new Date(f.mtime)),Object.assign(p,f))}return p},setMeta(l,u,h={}){return this.setItem(l+"$",u,h)},removeMeta(l,u={}){return this.removeItem(l+"$",u)},async getKeys(l,u={}){l=oa(l);const h=n(l,!0);let d=[];const p=[];for(const f of h){const g=await je(f.driver.getKeys,f.relativeBase,u);for(const m of g){const w=f.mountpoint+ft(m);d.some(y=>w.startsWith(y))||p.push(w)}d=[f.mountpoint,...d.filter(m=>!m.startsWith(f.mountpoint))]}return l?p.filter(f=>f.startsWith(l)&&f[f.length-1]!=="$"):p.filter(f=>f[f.length-1]!=="$")},async clear(l,u={}){l=oa(l),await Promise.all(n(l,!1).map(async h=>{if(h.driver.clear)return je(h.driver.clear,h.relativeBase,u);if(h.driver.removeItem){const d=await h.driver.getKeys(h.relativeBase||"",u);return Promise.all(d.map(p=>h.driver.removeItem(p,u)))}}))},async dispose(){await Promise.all(Object.values(e.mounts).map(l=>_0(l)))},async watch(l){return await s(),e.watchListeners.push(l),async()=>{e.watchListeners=e.watchListeners.filter(u=>u!==l),e.watchListeners.length===0&&await o()}},async unwatch(){e.watchListeners=[],await o()},mount(l,u){if(l=oa(l),l&&e.mounts[l])throw new Error(`already mounted at ${l}`);return l&&(e.mountpoints.push(l),e.mountpoints.sort((h,d)=>d.length-h.length)),e.mounts[l]=u,e.watching&&Promise.resolve(E0(u,i,l)).then(h=>{e.unwatch[l]=h}).catch(console.error),c},async unmount(l,u=!0){l=oa(l),!(!l||!e.mounts[l])&&(e.watching&&l in e.unwatch&&(e.unwatch[l]?.(),delete e.unwatch[l]),u&&await _0(e.mounts[l]),e.mountpoints=e.mountpoints.filter(h=>h!==l),delete e.mounts[l])},getMount(l=""){l=ft(l)+":";const u=r(l);return{driver:u.driver,base:u.base}},getMounts(l="",u={}){return l=ft(l),n(l,u.parents).map(d=>({driver:d.driver,base:d.mountpoint}))},keys:(l,u={})=>c.getKeys(l,u),get:(l,u={})=>c.getItem(l,u),set:(l,u,h={})=>c.setItem(l,u,h),has:(l,u={})=>c.hasItem(l,u),del:(l,u={})=>c.removeItem(l,u),remove:(l,u={})=>c.removeItem(l,u)};return c}function E0(t,e,r){return t.watch?t.watch((n,i)=>e(n,r+i)):()=>{}}async function _0(t){typeof t.dispose=="function"&&await je(t.dispose)}function $n(t){return new Promise((e,r)=>{t.oncomplete=t.onsuccess=()=>e(t.result),t.onabort=t.onerror=()=>r(t.error)})}function $0(t,e){const r=indexedDB.open(t);r.onupgradeneeded=()=>r.result.createObjectStore(e);const n=$n(r);return(i,s)=>n.then(o=>s(o.transaction(e,i).objectStore(e)))}let Gl;function Ls(){return Gl||(Gl=$0("keyval-store","keyval")),Gl}function x0(t,e=Ls()){return e("readonly",r=>$n(r.get(t)))}function Nx(t,e,r=Ls()){return r("readwrite",n=>(n.put(e,t),$n(n.transaction)))}function Bx(t,e=Ls()){return e("readwrite",r=>(r.delete(t),$n(r.transaction)))}function Lx(t=Ls()){return t("readwrite",e=>(e.clear(),$n(e.transaction)))}function Mx(t,e){return t.openCursor().onsuccess=function(){this.result&&(e(this.result),this.result.continue())},$n(t.transaction)}function Ux(t=Ls()){return t("readonly",e=>{if(e.getAllKeys)return $n(e.getAllKeys());const r=[];return Mx(e,n=>r.push(n.key)).then(()=>r)})}const jx="idb-keyval";var Fx=(t={})=>{const e=t.base&&t.base.length>0?`${t.base}:`:"",r=i=>e+i;let n;return t.dbName&&t.storeName&&(n=$0(t.dbName,t.storeName)),{name:jx,options:t,async hasItem(i){return!(typeof await x0(r(i),n)>"u")},async getItem(i){return await x0(r(i),n)??null},setItem(i,s){return Nx(r(i),s,n)},removeItem(i){return Bx(r(i),n)},getKeys(){return Ux(n)},clear(){return Lx(n)}}};const kx="WALLET_CONNECT_V2_INDEXED_DB",qx="keyvaluestorage";class zx{constructor(){this.indexedDb=Rx({driver:Fx({dbName:kx,storeName:qx})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(e=>[e.key,e.value])}async getItem(e){const r=await this.indexedDb.getItem(e);if(r!==null)return r}async setItem(e,r){await this.indexedDb.setItem(e,gr(r))}async removeItem(e){await this.indexedDb.removeItem(e)}}var Zl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},aa={exports:{}};(function(){let t;function e(){}t=e,t.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},t.prototype.setItem=function(r,n){this[r]=String(n)},t.prototype.removeItem=function(r){delete this[r]},t.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(n){r[n]=void 0,delete r[n]})},t.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},t.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Zl<"u"&&Zl.localStorage?aa.exports=Zl.localStorage:typeof window<"u"&&window.localStorage?aa.exports=window.localStorage:aa.exports=new e})();function Hx(t){var e;return[t[0],fn((e=t[1])!=null?e:"")]}class Vx{constructor(){this.localStorage=aa.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(Hx)}async getItem(e){const r=this.localStorage.getItem(e);if(r!==null)return fn(r)}async setItem(e,r){this.localStorage.setItem(e,gr(r))}async removeItem(e){this.localStorage.removeItem(e)}}const Wx="wc_storage_version",I0=1,Kx=async(t,e,r)=>{const n=Wx,i=await e.getItem(n);if(i&&i>=I0){r(e);return}const s=await t.getKeys();if(!s.length){r(e);return}const o=[];for(;s.length;){const a=s.shift();if(!a)continue;const c=a.toLowerCase();if(c.includes("wc@")||c.includes("walletconnect")||c.includes("wc_")||c.includes("wallet_connect")){const l=await t.getItem(a);await e.setItem(a,l),o.push(a)}}await e.setItem(n,I0),r(e),Gx(t,o)},Gx=async(t,e)=>{e.length&&e.forEach(async r=>{await t.removeItem(r)})};class Zx{constructor(){this.initialized=!1,this.setInitialized=r=>{this.storage=r,this.initialized=!0};const e=new Vx;this.storage=e;try{const r=new zx;Kx(e,r,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(e){return await this.initialize(),this.storage.getItem(e)}async setItem(e,r){return await this.initialize(),this.storage.setItem(e,r)}async removeItem(e){return await this.initialize(),this.storage.removeItem(e)}async initialize(){this.initialized||await new Promise(e=>{const r=setInterval(()=>{this.initialized&&(clearInterval(r),e())},20)})}}function Yx(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}var Jx=Qx;function Qx(t,e,r){var n=r&&r.stringify||Yx,i=1;if(typeof t=="object"&&t!==null){var s=e.length+i;if(s===1)return t;var o=new Array(s);o[0]=n(t);for(var a=1;a<s;a++)o[a]=n(e[a]);return o.join(" ")}if(typeof t!="string")return t;var c=e.length;if(c===0)return t;for(var l="",u=1-i,h=-1,d=t&&t.length||0,p=0;p<d;){if(t.charCodeAt(p)===37&&p+1<d){switch(h=h>-1?h:0,t.charCodeAt(p+1)){case 100:case 102:if(u>=c||e[u]==null)break;h<p&&(l+=t.slice(h,p)),l+=Number(e[u]),h=p+2,p++;break;case 105:if(u>=c||e[u]==null)break;h<p&&(l+=t.slice(h,p)),l+=Math.floor(Number(e[u])),h=p+2,p++;break;case 79:case 111:case 106:if(u>=c||e[u]===void 0)break;h<p&&(l+=t.slice(h,p));var f=typeof e[u];if(f==="string"){l+="'"+e[u]+"'",h=p+2,p++;break}if(f==="function"){l+=e[u].name||"<anonymous>",h=p+2,p++;break}l+=n(e[u]),h=p+2,p++;break;case 115:if(u>=c)break;h<p&&(l+=t.slice(h,p)),l+=String(e[u]),h=p+2,p++;break;case 37:h<p&&(l+=t.slice(h,p)),l+="%",h=p+2,p++,u--;break}++u}++p}return h===-1?t:(h<d&&(l+=t.slice(h)),l)}const O0=Jx;var Xt=er;const Ms=c6().console||{},Xx={mapHttpRequest:la,mapHttpResponse:la,wrapRequestSerializer:Jl,wrapResponseSerializer:Jl,wrapErrorSerializer:Jl,req:la,res:la,err:i6};function e6(t,e){return Array.isArray(t)?t.filter(function(n){return n!=="!stdSerializers.err"}):t===!0?Object.keys(e):!1}function er(t){t=t||{},t.browser=t.browser||{};const e=t.browser.transmit;if(e&&typeof e.send!="function")throw Error("pino: transmit option must have a send function");const r=t.browser.write||Ms;t.browser.write&&(t.browser.asObject=!0);const n=t.serializers||{},i=e6(t.browser.serialize,n);let s=t.browser.serialize;Array.isArray(t.browser.serialize)&&t.browser.serialize.indexOf("!stdSerializers.err")>-1&&(s=!1);const o=["error","fatal","warn","info","debug","trace"];typeof r=="function"&&(r.error=r.fatal=r.warn=r.info=r.debug=r.trace=r),t.enabled===!1&&(t.level="silent");const a=t.level||"info",c=Object.create(r);c.log||(c.log=Us),Object.defineProperty(c,"levelVal",{get:u}),Object.defineProperty(c,"level",{get:h,set:d});const l={transmit:e,serialize:i,asObject:t.browser.asObject,levels:o,timestamp:s6(t)};c.levels=er.levels,c.level=a,c.setMaxListeners=c.getMaxListeners=c.emit=c.addListener=c.on=c.prependListener=c.once=c.prependOnceListener=c.removeListener=c.removeAllListeners=c.listeners=c.listenerCount=c.eventNames=c.write=c.flush=Us,c.serializers=n,c._serialize=i,c._stdErrSerialize=s,c.child=p,e&&(c._logEvent=Yl());function u(){return this.level==="silent"?1/0:this.levels.values[this.level]}function h(){return this._level}function d(f){if(f!=="silent"&&!this.levels.values[f])throw Error("unknown level "+f);this._level=f,Ei(l,c,"error","log"),Ei(l,c,"fatal","error"),Ei(l,c,"warn","error"),Ei(l,c,"info","log"),Ei(l,c,"debug","log"),Ei(l,c,"trace","log")}function p(f,g){if(!f)throw new Error("missing bindings for child Pino");g=g||{},i&&f.serializers&&(g.serializers=f.serializers);const m=g.serializers;if(i&&m){var w=Object.assign({},n,m),y=t.browser.serialize===!0?Object.keys(w):i;delete f.serializers,ca([f],y,w,this._stdErrSerialize)}function E(_){this._childLevel=(_._childLevel|0)+1,this.error=_i(_,f,"error"),this.fatal=_i(_,f,"fatal"),this.warn=_i(_,f,"warn"),this.info=_i(_,f,"info"),this.debug=_i(_,f,"debug"),this.trace=_i(_,f,"trace"),w&&(this.serializers=w,this._serialize=y),e&&(this._logEvent=Yl([].concat(_._logEvent.bindings,f)))}return E.prototype=this,new E(this)}return c}er.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},er.stdSerializers=Xx,er.stdTimeFunctions=Object.assign({},{nullTime:S0,epochTime:A0,unixTime:o6,isoTime:a6});function Ei(t,e,r,n){const i=Object.getPrototypeOf(e);e[r]=e.levelVal>e.levels.values[r]?Us:i[r]?i[r]:Ms[r]||Ms[n]||Us,t6(t,e,r)}function t6(t,e,r){!t.transmit&&e[r]===Us||(e[r]=function(n){return function(){const s=t.timestamp(),o=new Array(arguments.length),a=Object.getPrototypeOf&&Object.getPrototypeOf(this)===Ms?Ms:this;for(var c=0;c<o.length;c++)o[c]=arguments[c];if(t.serialize&&!t.asObject&&ca(o,this._serialize,this.serializers,this._stdErrSerialize),t.asObject?n.call(a,r6(this,r,o,s)):n.apply(a,o),t.transmit){const l=t.transmit.level||e.level,u=er.levels.values[l],h=er.levels.values[r];if(h<u)return;n6(this,{ts:s,methodLevel:r,methodValue:h,transmitLevel:l,transmitValue:er.levels.values[t.transmit.level||e.level],send:t.transmit.send,val:e.levelVal},o)}}}(e[r]))}function r6(t,e,r,n){t._serialize&&ca(r,t._serialize,t.serializers,t._stdErrSerialize);const i=r.slice();let s=i[0];const o={};n&&(o.time=n),o.level=er.levels.values[e];let a=(t._childLevel|0)+1;if(a<1&&(a=1),s!==null&&typeof s=="object"){for(;a--&&typeof i[0]=="object";)Object.assign(o,i.shift());s=i.length?O0(i.shift(),i):void 0}else typeof s=="string"&&(s=O0(i.shift(),i));return s!==void 0&&(o.msg=s),o}function ca(t,e,r,n){for(const i in t)if(n&&t[i]instanceof Error)t[i]=er.stdSerializers.err(t[i]);else if(typeof t[i]=="object"&&!Array.isArray(t[i]))for(const s in t[i])e&&e.indexOf(s)>-1&&s in r&&(t[i][s]=r[s](t[i][s]))}function _i(t,e,r){return function(){const n=new Array(1+arguments.length);n[0]=e;for(var i=1;i<n.length;i++)n[i]=arguments[i-1];return t[r].apply(this,n)}}function n6(t,e,r){const n=e.send,i=e.ts,s=e.methodLevel,o=e.methodValue,a=e.val,c=t._logEvent.bindings;ca(r,t._serialize||Object.keys(t.serializers),t.serializers,t._stdErrSerialize===void 0?!0:t._stdErrSerialize),t._logEvent.ts=i,t._logEvent.messages=r.filter(function(l){return c.indexOf(l)===-1}),t._logEvent.level.label=s,t._logEvent.level.value=o,n(s,t._logEvent,a),t._logEvent=Yl(c)}function Yl(t){return{ts:0,messages:[],bindings:t||[],level:{label:"",value:0}}}function i6(t){const e={type:t.constructor.name,msg:t.message,stack:t.stack};for(const r in t)e[r]===void 0&&(e[r]=t[r]);return e}function s6(t){return typeof t.timestamp=="function"?t.timestamp:t.timestamp===!1?S0:A0}function la(){return{}}function Jl(t){return t}function Us(){}function S0(){return!1}function A0(){return Date.now()}function o6(){return Math.round(Date.now()/1e3)}function a6(){return new Date(Date.now()).toISOString()}function c6(){function t(e){return typeof e<"u"&&e}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return t(self)||t(window)||t(this)||{}}}const l6={level:"info"},js="custom_context",Ql=1e3*1024;class u6{constructor(e){this.nodeValue=e,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}}class C0{constructor(e){this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=e,this.sizeInBytes=0}append(e){const r=new u6(e);if(r.size>this.maxSizeInBytes)throw new Error(`[LinkedList] Value too big to insert into list: ${e} with size ${r.size}`);for(;this.size+r.size>this.maxSizeInBytes;)this.shift();this.head?(this.tail&&(this.tail.next=r),this.tail=r):(this.head=r,this.tail=r),this.lengthInNodes++,this.sizeInBytes+=r.size}shift(){if(!this.head)return;const e=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=e.size}toArray(){const e=[];let r=this.head;for(;r!==null;)e.push(r.value),r=r.next;return e}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let e=this.head;return{next:()=>{if(!e)return{done:!0,value:null};const r=e.value;return e=e.next,{done:!1,value:r}}}}}class P0{constructor(e,r=Ql){this.level=e??"error",this.levelValue=Xt.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=r,this.logs=new C0(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(e,r){r===Xt.levels.values.error?console.error(e):r===Xt.levels.values.warn?console.warn(e):r===Xt.levels.values.debug?console.debug(e):r===Xt.levels.values.trace?console.trace(e):console.log(e)}appendToLogs(e){this.logs.append(gr({timestamp:new Date().toISOString(),log:e}));const r=typeof e=="string"?JSON.parse(e).level:e.level;r>=this.levelValue&&this.forwardToConsole(e,r)}getLogs(){return this.logs}clearLogs(){this.logs=new C0(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(e){const r=this.getLogArray();return r.push(gr({extraMetadata:e})),new Blob(r,{type:"application/json"})}}class h6{constructor(e,r=Ql){this.baseChunkLogger=new P0(e,r)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}downloadLogsBlobInBrowser(e){const r=URL.createObjectURL(this.logsToBlob(e)),n=document.createElement("a");n.href=r,n.download=`walletconnect-logs-${new Date().toISOString()}.txt`,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(r)}}class d6{constructor(e,r=Ql){this.baseChunkLogger=new P0(e,r)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}}var f6=Object.defineProperty,p6=Object.defineProperties,g6=Object.getOwnPropertyDescriptors,D0=Object.getOwnPropertySymbols,m6=Object.prototype.hasOwnProperty,w6=Object.prototype.propertyIsEnumerable,T0=(t,e,r)=>e in t?f6(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ua=(t,e)=>{for(var r in e||(e={}))m6.call(e,r)&&T0(t,r,e[r]);if(D0)for(var r of D0(e))w6.call(e,r)&&T0(t,r,e[r]);return t},ha=(t,e)=>p6(t,g6(e));function da(t){return ha(ua({},t),{level:t?.level||l6.level})}function y6(t,e=js){return t[e]||""}function b6(t,e,r=js){return t[r]=e,t}function pt(t,e=js){let r="";return typeof t.bindings>"u"?r=y6(t,e):r=t.bindings().context||"",r}function v6(t,e,r=js){const n=pt(t,r);return n.trim()?`${n}/${e}`:e}function it(t,e,r=js){const n=v6(t,e,r),i=t.child({context:n});return b6(i,n,r)}function E6(t){var e,r;const n=new h6((e=t.opts)==null?void 0:e.level,t.maxSizeInBytes);return{logger:Xt(ha(ua({},t.opts),{level:"trace",browser:ha(ua({},(r=t.opts)==null?void 0:r.browser),{write:i=>n.write(i)})})),chunkLoggerController:n}}function _6(t){var e;const r=new d6((e=t.opts)==null?void 0:e.level,t.maxSizeInBytes);return{logger:Xt(ha(ua({},t.opts),{level:"trace"})),chunkLoggerController:r}}function $6(t){return typeof t.loggerOverride<"u"&&typeof t.loggerOverride!="string"?{logger:t.loggerOverride,chunkLoggerController:null}:typeof window<"u"?E6(t):_6(t)}var x6=Object.defineProperty,I6=(t,e,r)=>e in t?x6(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,R0=(t,e,r)=>I6(t,typeof e!="symbol"?e+"":e,r);class O6 extends _n{constructor(e){super(),this.opts=e,R0(this,"protocol","wc"),R0(this,"version",2)}}var S6=Object.defineProperty,A6=(t,e,r)=>e in t?S6(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,C6=(t,e,r)=>A6(t,typeof e!="symbol"?e+"":e,r);class P6 extends _n{constructor(e,r){super(),this.core=e,this.logger=r,C6(this,"records",new Map)}}class D6{constructor(e,r){this.logger=e,this.core=r}}class T6 extends _n{constructor(e,r){super(),this.relayer=e,this.logger=r}}class R6 extends _n{constructor(e){super()}}class N6{constructor(e,r,n,i){this.core=e,this.logger=r,this.name=n}}class B6 extends _n{constructor(e,r){super(),this.relayer=e,this.logger=r}}class L6 extends _n{constructor(e,r){super(),this.core=e,this.logger=r}}class M6{constructor(e,r,n){this.core=e,this.logger=r,this.store=n}}class U6{constructor(e,r){this.projectId=e,this.logger=r}}class j6{constructor(e,r,n){this.core=e,this.logger=r,this.telemetryEnabled=n}}var F6=Object.defineProperty,k6=(t,e,r)=>e in t?F6(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,N0=(t,e,r)=>k6(t,typeof e!="symbol"?e+"":e,r);class q6{constructor(e){this.opts=e,N0(this,"protocol","wc"),N0(this,"version",2)}}class z6{constructor(e){this.client=e}}const H6="PARSE_ERROR",V6="INVALID_REQUEST",W6="METHOD_NOT_FOUND",K6="INVALID_PARAMS",B0="INTERNAL_ERROR",Xl="SERVER_ERROR",G6=[-32700,-32600,-32601,-32602,-32603],Fs={[H6]:{code:-32700,message:"Parse error"},[V6]:{code:-32600,message:"Invalid Request"},[W6]:{code:-32601,message:"Method not found"},[K6]:{code:-32602,message:"Invalid params"},[B0]:{code:-32603,message:"Internal error"},[Xl]:{code:-32e3,message:"Server error"}},L0=Xl;function Z6(t){return G6.includes(t)}function M0(t){return Object.keys(Fs).includes(t)?Fs[t]:Fs[L0]}function Y6(t){const e=Object.values(Fs).find(r=>r.code===t);return e||Fs[L0]}function U0(t,e,r){return t.message.includes("getaddrinfo ENOTFOUND")||t.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${e}`):t}var j0={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var eu=function(t,e){return eu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},eu(t,e)};function J6(t,e){eu(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var tu=function(){return tu=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},tu.apply(this,arguments)};function Q6(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function X6(t,e,r,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,r,s):o(e,r))||s);return i>3&&s&&Object.defineProperty(e,r,s),s}function eI(t,e){return function(r,n){e(r,n,t)}}function tI(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function rI(t,e,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(h){o(h)}}function c(u){try{l(n.throw(u))}catch(h){o(h)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})}function nI(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(u){return c([l,u])}}function c(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=l[0]&2?i.return:l[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,l[1])).done)return s;switch(i=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,i=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){r.label=l[1];break}if(l[0]===6&&r.label<s[1]){r.label=s[1],s=l;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(l);break}s[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(u){l=[6,u],i=0}finally{n=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function iI(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}function sI(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function ru(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function F0(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],o;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(a){o={error:a}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return s}function oI(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(F0(arguments[e]));return t}function aI(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)n[i]=s[o];return n}function ks(t){return this instanceof ks?(this.v=t,this):new ks(t)}function cI(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(d){n[d]&&(i[d]=function(p){return new Promise(function(f,g){s.push([d,p,f,g])>1||a(d,p)})})}function a(d,p){try{c(n[d](p))}catch(f){h(s[0][3],f)}}function c(d){d.value instanceof ks?Promise.resolve(d.value.v).then(l,u):h(s[0][2],d)}function l(d){a("next",d)}function u(d){a("throw",d)}function h(d,p){d(p),s.shift(),s.length&&a(s[0][0],s[0][1])}}function lI(t){var e,r;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,s){e[i]=t[i]?function(o){return(r=!r)?{value:ks(t[i](o)),done:i==="return"}:s?s(o):o}:s}}function uI(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof ru=="function"?ru(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=t[s]&&function(o){return new Promise(function(a,c){o=t[s](o),i(a,c,o.done,o.value)})}}function i(s,o,a,c){Promise.resolve(c).then(function(l){s({value:l,done:a})},o)}}function hI(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function dI(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function fI(t){return t&&t.__esModule?t:{default:t}}function pI(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function gI(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var mI=Object.freeze({__proto__:null,__extends:J6,get __assign(){return tu},__rest:Q6,__decorate:X6,__param:eI,__metadata:tI,__awaiter:rI,__generator:nI,__createBinding:iI,__exportStar:sI,__values:ru,__read:F0,__spread:oI,__spreadArrays:aI,__await:ks,__asyncGenerator:cI,__asyncDelegator:lI,__asyncValues:uI,__makeTemplateObject:hI,__importStar:dI,__importDefault:fI,__classPrivateFieldGet:pI,__classPrivateFieldSet:gI}),wI=Gh(mI),xr={},k0;function yI(){if(k0)return xr;k0=1,Object.defineProperty(xr,"__esModule",{value:!0}),xr.isBrowserCryptoAvailable=xr.getSubtleCrypto=xr.getBrowerCrypto=void 0;function t(){return ct?.crypto||ct?.msCrypto||{}}xr.getBrowerCrypto=t;function e(){const n=t();return n.subtle||n.webkitSubtle}xr.getSubtleCrypto=e;function r(){return!!t()&&!!e()}return xr.isBrowserCryptoAvailable=r,xr}var Ir={},q0;function bI(){if(q0)return Ir;q0=1,Object.defineProperty(Ir,"__esModule",{value:!0}),Ir.isBrowser=Ir.isNode=Ir.isReactNative=void 0;function t(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}Ir.isReactNative=t;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}Ir.isNode=e;function r(){return!t()&&!e()}return Ir.isBrowser=r,Ir}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=wI;e.__exportStar(yI(),t),e.__exportStar(bI(),t)})(j0);function tr(t=3){const e=Date.now()*Math.pow(10,t),r=Math.floor(Math.random()*Math.pow(10,t));return e+r}function xn(t=6){return BigInt(tr(t))}function Kr(t,e,r){return{id:r||tr(),jsonrpc:"2.0",method:t,params:e}}function fa(t,e){return{id:t,jsonrpc:"2.0",result:e}}function pa(t,e,r){return{id:t,jsonrpc:"2.0",error:vI(e,r)}}function vI(t,e){return typeof t>"u"?M0(B0):(typeof t=="string"&&(t=Object.assign(Object.assign({},M0(Xl)),{message:t})),typeof e<"u"&&(t.data=e),Z6(t.code)&&(t=Y6(t.code)),t)}class EI{}class _I extends EI{constructor(){super()}}class $I extends _I{constructor(e){super()}}const xI="^https?:",II="^wss?:";function OI(t){const e=t.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function z0(t,e){const r=OI(t);return typeof r>"u"?!1:new RegExp(e).test(r)}function H0(t){return z0(t,xI)}function V0(t){return z0(t,II)}function SI(t){return new RegExp("wss?://localhost(:d{2,5})?").test(t)}function W0(t){return typeof t=="object"&&"id"in t&&"jsonrpc"in t&&t.jsonrpc==="2.0"}function nu(t){return W0(t)&&"method"in t}function ga(t){return W0(t)&&(rr(t)||Pt(t))}function rr(t){return"result"in t}function Pt(t){return"error"in t}class Dt extends $I{constructor(e){super(e),this.events=new Ve.exports.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async request(e,r){return this.requestStrict(Kr(e.method,e.params||[],e.id||xn().toString()),r)}async requestStrict(e,r){return new Promise(async(n,i)=>{if(!this.connection.connected)try{await this.open()}catch(s){i(s)}this.events.on(`${e.id}`,s=>{Pt(s)?i(s.error):n(s.result)});try{await this.connection.send(e,r)}catch(s){i(s)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),ga(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const AI=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),CI=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",K0=t=>t.split("?")[0],G0=10,PI=AI();class DI{constructor(e){if(this.url=e,this.events=new Ve.exports.EventEmitter,this.registering=!1,!V0(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=n=>{this.onClose(n),e()},this.socket.close()})}async send(e){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(gr(e))}catch(r){this.onError(e.id,r)}}register(e=this.url){if(!V0(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((n,i)=>{this.events.once("register_error",s=>{this.resetMaxListeners(),i(s)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return i(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=e,this.registering=!0,new Promise((r,n)=>{const i=j0.isReactNative()?void 0:{rejectUnauthorized:!SI(e)},s=new PI(e,[],i);CI()?s.onerror=o=>{const a=o;n(this.emitError(a.error))}:s.on("error",o=>{n(this.emitError(o))}),s.onopen=()=>{this.onOpen(s),r(s)}})}onOpen(e){e.onmessage=r=>this.onPayload(r),e.onclose=r=>this.onClose(r),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?fn(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const n=this.parseError(r),i=n.message||n.toString(),s=pa(e,i);this.events.emit("payload",s)}parseError(e,r=this.url){return U0(e,K0(r),"WS")}resetMaxListeners(){this.events.getMaxListeners()>G0&&this.events.setMaxListeners(G0)}emitError(e){const r=this.parseError(new Error(e?.message||`WebSocket connection failed for host: ${K0(this.url)}`));return this.events.emit("register_error",r),r}}var TI=Object.defineProperty,Z0=Object.getOwnPropertySymbols,RI=Object.prototype.hasOwnProperty,NI=Object.prototype.propertyIsEnumerable,Y0=(t,e,r)=>e in t?TI(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,st=(t,e)=>{for(var r in e||(e={}))RI.call(e,r)&&Y0(t,r,e[r]);if(Z0)for(var r of Z0(e))NI.call(e,r)&&Y0(t,r,e[r]);return t};const J0="wc",Q0=2,ma="core",nr=`${J0}@2:${ma}:`,BI={name:ma,logger:"error"},LI={database:":memory:"},MI="crypto",X0="client_ed25519_seed",UI=j.ONE_DAY,jI="keychain",FI="0.3",kI="messages",qI="0.3",em=j.SIX_HOURS,zI="publisher",tm="irn",HI="error",rm="wss://relay.walletconnect.org",VI="relayer",Fe={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},WI="_subscription",Tt={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},KI=.1,iu="2.19.2",ye={link_mode:"link_mode",relay:"relay"},wa={inbound:"inbound",outbound:"outbound"},GI="0.3",ZI="WALLETCONNECT_CLIENT_ID",nm="WALLETCONNECT_LINK_MODE_APPS",_t={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},YI="subscription",JI="0.3",QI="pairing",XI="0.3",qs={wc_pairingDelete:{req:{ttl:j.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:j.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:j.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:j.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:j.ONE_DAY,prompt:!1,tag:0},res:{ttl:j.ONE_DAY,prompt:!1,tag:0}}},In={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},zt={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},eO="history",tO="0.3",rO="expirer",Rt={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},nO="0.3",iO="verify-api",sO="https://verify.walletconnect.com",im="https://verify.walletconnect.org",zs=im,oO=`${zs}/v3`,aO=[sO,im],cO="echo",lO="https://echo.walletconnect.com",ir={pairing_started:"pairing_started",pairing_uri_validation_success:"pairing_uri_validation_success",pairing_uri_not_expired:"pairing_uri_not_expired",store_new_pairing:"store_new_pairing",subscribing_pairing_topic:"subscribing_pairing_topic",subscribe_pairing_topic_success:"subscribe_pairing_topic_success",existing_pairing:"existing_pairing",pairing_not_expired:"pairing_not_expired",emit_inactive_pairing:"emit_inactive_pairing",emit_session_proposal:"emit_session_proposal",subscribing_to_pairing_topic:"subscribing_to_pairing_topic"},Or={no_wss_connection:"no_wss_connection",no_internet_connection:"no_internet_connection",malformed_pairing_uri:"malformed_pairing_uri",active_pairing_already_exists:"active_pairing_already_exists",subscribe_pairing_topic_failure:"subscribe_pairing_topic_failure",pairing_expired:"pairing_expired",proposal_expired:"proposal_expired",proposal_listener_not_found:"proposal_listener_not_found"},Ht={session_approve_started:"session_approve_started",proposal_not_expired:"proposal_not_expired",session_namespaces_validation_success:"session_namespaces_validation_success",create_session_topic:"create_session_topic",subscribing_session_topic:"subscribing_session_topic",subscribe_session_topic_success:"subscribe_session_topic_success",publishing_session_approve:"publishing_session_approve",session_approve_publish_success:"session_approve_publish_success",store_session:"store_session",publishing_session_settle:"publishing_session_settle",session_settle_publish_success:"session_settle_publish_success"},On={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",proposal_expired:"proposal_expired",subscribe_session_topic_failure:"subscribe_session_topic_failure",session_approve_publish_failure:"session_approve_publish_failure",session_settle_publish_failure:"session_settle_publish_failure",session_approve_namespace_validation_failure:"session_approve_namespace_validation_failure",proposal_not_found:"proposal_not_found"},Sn={authenticated_session_approve_started:"authenticated_session_approve_started",authenticated_session_not_expired:"authenticated_session_not_expired",chains_caip2_compliant:"chains_caip2_compliant",chains_evm_compliant:"chains_evm_compliant",create_authenticated_session_topic:"create_authenticated_session_topic",cacaos_verified:"cacaos_verified",store_authenticated_session:"store_authenticated_session",subscribing_authenticated_session_topic:"subscribing_authenticated_session_topic",subscribe_authenticated_session_topic_success:"subscribe_authenticated_session_topic_success",publishing_authenticated_session_approve:"publishing_authenticated_session_approve",authenticated_session_approve_publish_success:"authenticated_session_approve_publish_success"},Hs={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",missing_session_authenticate_request:"missing_session_authenticate_request",session_authenticate_request_expired:"session_authenticate_request_expired",chains_caip2_compliant_failure:"chains_caip2_compliant_failure",chains_evm_compliant_failure:"chains_evm_compliant_failure",invalid_cacao:"invalid_cacao",subscribe_authenticated_session_topic_failure:"subscribe_authenticated_session_topic_failure",authenticated_session_approve_publish_failure:"authenticated_session_approve_publish_failure",authenticated_session_pending_request_not_found:"authenticated_session_pending_request_not_found"},uO=.1,hO="event-client",dO=86400,fO="https://pulse.walletconnect.org/batch";function pO(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var s=t.charAt(i),o=s.charCodeAt(0);if(r[o]!==255)throw new TypeError(s+" is ambiguous");r[o]=i}var a=t.length,c=t.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(f){if(f instanceof Uint8Array||(ArrayBuffer.isView(f)?f=new Uint8Array(f.buffer,f.byteOffset,f.byteLength):Array.isArray(f)&&(f=Uint8Array.from(f))),!(f instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(f.length===0)return"";for(var g=0,m=0,w=0,y=f.length;w!==y&&f[w]===0;)w++,g++;for(var E=(y-w)*u+1>>>0,_=new Uint8Array(E);w!==y;){for(var O=f[w],S=0,x=E-1;(O!==0||S<m)&&x!==-1;x--,S++)O+=256*_[x]>>>0,_[x]=O%a>>>0,O=O/a>>>0;if(O!==0)throw new Error("Non-zero carry");m=S,w++}for(var P=E-m;P!==E&&_[P]===0;)P++;for(var $=c.repeat(g);P<E;++P)$+=t.charAt(_[P]);return $}function d(f){if(typeof f!="string")throw new TypeError("Expected String");if(f.length===0)return new Uint8Array;var g=0;if(f[g]!==" "){for(var m=0,w=0;f[g]===c;)m++,g++;for(var y=(f.length-g)*l+1>>>0,E=new Uint8Array(y);f[g];){var _=r[f.charCodeAt(g)];if(_===255)return;for(var O=0,S=y-1;(_!==0||O<w)&&S!==-1;S--,O++)_+=a*E[S]>>>0,E[S]=_%256>>>0,_=_/256>>>0;if(_!==0)throw new Error("Non-zero carry");w=O,g++}if(f[g]!==" "){for(var x=y-w;x!==y&&E[x]===0;)x++;for(var P=new Uint8Array(m+(y-x)),$=m;x!==y;)P[$++]=E[x++];return P}}}function p(f){var g=d(f);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:d,decode:p}}var gO=pO,mO=gO;const sm=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},wO=t=>new TextEncoder().encode(t),yO=t=>new TextDecoder().decode(t);class bO{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class vO{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return om(this,e)}}class EO{constructor(e){this.decoders=e}or(e){return om(this,e)}decode(e){const r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const om=(t,e)=>new EO(st(st({},t.decoders||{[t.prefix]:t}),e.decoders||{[e.prefix]:e}));class _O{constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new bO(e,r,n),this.decoder=new vO(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const ya=({name:t,prefix:e,encode:r,decode:n})=>new _O(t,e,r,n),Vs=({prefix:t,name:e,alphabet:r})=>{const{encode:n,decode:i}=mO(r,e);return ya({prefix:t,name:e,encode:n,decode:s=>sm(i(s))})},$O=(t,e,r,n)=>{const i={};for(let u=0;u<e.length;++u)i[e[u]]=u;let s=t.length;for(;t[s-1]==="=";)--s;const o=new Uint8Array(s*r/8|0);let a=0,c=0,l=0;for(let u=0;u<s;++u){const h=i[t[u]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|h,a+=r,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},xO=(t,e,r)=>{const n=e[e.length-1]==="=",i=(1<<r)-1;let s="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>r;)o-=r,s+=e[i&a>>o];if(o&&(s+=e[i&a<<r-o]),n)for(;s.length*r&7;)s+="=";return s},Ye=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>ya({prefix:e,name:t,encode(i){return xO(i,n,r)},decode(i){return $O(i,n,r,t)}}),IO=ya({prefix:"\0",name:"identity",encode:t=>yO(t),decode:t=>wO(t)});var OO=Object.freeze({__proto__:null,identity:IO});const SO=Ye({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var AO=Object.freeze({__proto__:null,base2:SO});const CO=Ye({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var PO=Object.freeze({__proto__:null,base8:CO});const DO=Vs({prefix:"9",name:"base10",alphabet:"0123456789"});var TO=Object.freeze({__proto__:null,base10:DO});const RO=Ye({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),NO=Ye({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var BO=Object.freeze({__proto__:null,base16:RO,base16upper:NO});const LO=Ye({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),MO=Ye({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),UO=Ye({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),jO=Ye({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),FO=Ye({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),kO=Ye({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),qO=Ye({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),zO=Ye({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),HO=Ye({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var VO=Object.freeze({__proto__:null,base32:LO,base32upper:MO,base32pad:UO,base32padupper:jO,base32hex:FO,base32hexupper:kO,base32hexpad:qO,base32hexpadupper:zO,base32z:HO});const WO=Vs({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),KO=Vs({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var GO=Object.freeze({__proto__:null,base36:WO,base36upper:KO});const ZO=Vs({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),YO=Vs({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var JO=Object.freeze({__proto__:null,base58btc:ZO,base58flickr:YO});const QO=Ye({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),XO=Ye({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),eS=Ye({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),tS=Ye({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var rS=Object.freeze({__proto__:null,base64:QO,base64pad:XO,base64url:eS,base64urlpad:tS});const am=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),nS=am.reduce((t,e,r)=>(t[r]=e,t),[]),iS=am.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function sS(t){return t.reduce((e,r)=>(e+=nS[r],e),"")}function oS(t){const e=[];for(const r of t){const n=iS[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}const aS=ya({prefix:"\u{1F680}",name:"base256emoji",encode:sS,decode:oS});var cS=Object.freeze({__proto__:null,base256emoji:aS}),lS=lm,cm=128,uS=127,hS=~uS,dS=Math.pow(2,31);function lm(t,e,r){e=e||[],r=r||0;for(var n=r;t>=dS;)e[r++]=t&255|cm,t/=128;for(;t&hS;)e[r++]=t&255|cm,t>>>=7;return e[r]=t|0,lm.bytes=r-n+1,e}var fS=su,pS=128,um=127;function su(t,n){var r=0,n=n||0,i=0,s=n,o,a=t.length;do{if(s>=a)throw su.bytes=0,new RangeError("Could not decode varint");o=t[s++],r+=i<28?(o&um)<<i:(o&um)*Math.pow(2,i),i+=7}while(o>=pS);return su.bytes=s-n,r}var gS=Math.pow(2,7),mS=Math.pow(2,14),wS=Math.pow(2,21),yS=Math.pow(2,28),bS=Math.pow(2,35),vS=Math.pow(2,42),ES=Math.pow(2,49),_S=Math.pow(2,56),$S=Math.pow(2,63),xS=function(t){return t<gS?1:t<mS?2:t<wS?3:t<yS?4:t<bS?5:t<vS?6:t<ES?7:t<_S?8:t<$S?9:10},IS={encode:lS,decode:fS,encodingLength:xS},hm=IS;const dm=(t,e,r=0)=>(hm.encode(t,e,r),e),fm=t=>hm.encodingLength(t),ou=(t,e)=>{const r=e.byteLength,n=fm(t),i=n+fm(r),s=new Uint8Array(i+r);return dm(t,s,0),dm(r,s,n),s.set(e,i),new OS(t,r,e,s)};class OS{constructor(e,r,n,i){this.code=e,this.size=r,this.digest=n,this.bytes=i}}const pm=({name:t,code:e,encode:r})=>new SS(t,e,r);class SS{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?ou(this.code,r):r.then(n=>ou(this.code,n))}else throw Error("Unknown type, must be binary type")}}const gm=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),AS=pm({name:"sha2-256",code:18,encode:gm("SHA-256")}),CS=pm({name:"sha2-512",code:19,encode:gm("SHA-512")});var PS=Object.freeze({__proto__:null,sha256:AS,sha512:CS});const mm=0,DS="identity",wm=sm;var TS=Object.freeze({__proto__:null,identity:{code:mm,name:DS,encode:wm,digest:t=>ou(mm,wm(t))}});new TextEncoder,new TextDecoder;const ym=st(st(st(st(st(st(st(st(st(st({},OO),AO),PO),TO),BO),VO),GO),JO),rS),cS);st(st({},PS),TS);function RS(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t)}function bm(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}const vm=bm("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),au=bm("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=RS(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),NS=st({utf8:vm,"utf-8":vm,hex:ym.base16,latin1:au,ascii:au,binary:au},ym);function BS(t,e="utf8"){const r=NS[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t,"utf8"):r.decoder.decode(`${r.prefix}${t}`)}var LS=Object.defineProperty,MS=(t,e,r)=>e in t?LS(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,sr=(t,e,r)=>MS(t,typeof e!="symbol"?e+"":e,r);class US{constructor(e,r){this.core=e,this.logger=r,sr(this,"keychain",new Map),sr(this,"name",jI),sr(this,"version",FI),sr(this,"initialized",!1),sr(this,"storagePrefix",nr),sr(this,"init",async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}}),sr(this,"has",n=>(this.isInitialized(),this.keychain.has(n))),sr(this,"set",async(n,i)=>{this.isInitialized(),this.keychain.set(n,i),await this.persist()}),sr(this,"get",n=>{this.isInitialized();const i=this.keychain.get(n);if(typeof i>"u"){const{message:s}=F("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(s)}return i}),sr(this,"del",async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()}),this.core=e,this.logger=it(r,this.name)}get context(){return pt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,dl(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?fl(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=F("NOT_INITIALIZED",this.name);throw new Error(e)}}}var jS=Object.defineProperty,FS=(t,e,r)=>e in t?jS(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Je=(t,e,r)=>FS(t,typeof e!="symbol"?e+"":e,r);class kS{constructor(e,r,n){this.core=e,this.logger=r,Je(this,"name",MI),Je(this,"keychain"),Je(this,"randomSessionIdentifier",kl()),Je(this,"initialized",!1),Je(this,"init",async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)}),Je(this,"hasKeys",i=>(this.isInitialized(),this.keychain.has(i))),Je(this,"getClientId",async()=>{this.isInitialized();const i=await this.getClientSeed(),s=xp(i);return $p(s.publicKey)}),Je(this,"generateKeyPair",()=>{this.isInitialized();const i=$$();return this.setPrivateKey(i.publicKey,i.privateKey)}),Je(this,"signJWT",async i=>{this.isInitialized();const s=await this.getClientSeed(),o=xp(s),a=this.randomSessionIdentifier;return await g_(a,i,UI,o)}),Je(this,"generateSharedKey",(i,s,o)=>{this.isInitialized();const a=this.getPrivateKey(i),c=x$(a,s);return this.setSymKey(c,o)}),Je(this,"setSymKey",async(i,s)=>{this.isInitialized();const o=s||ea(i);return await this.keychain.set(o,i),o}),Je(this,"deleteKeyPair",async i=>{this.isInitialized(),await this.keychain.del(i)}),Je(this,"deleteSymKey",async i=>{this.isInitialized(),await this.keychain.del(i)}),Je(this,"encode",async(i,s,o)=>{this.isInitialized();const a=a0(o),c=gr(s);if(l0(a))return S$(c,o?.encoding);if(c0(a)){const d=a.senderPublicKey,p=a.receiverPublicKey;i=await this.generateSharedKey(d,p)}const l=this.getSymKey(i),{type:u,senderPublicKey:h}=a;return I$({type:u,symKey:l,message:c,senderPublicKey:h,encoding:o?.encoding})}),Je(this,"decode",async(i,s,o)=>{this.isInitialized();const a=C$(s,o);if(l0(a)){const c=A$(s,o?.encoding);return fn(c)}if(c0(a)){const c=a.receiverPublicKey,l=a.senderPublicKey;i=await this.generateSharedKey(c,l)}try{const c=this.getSymKey(i),l=O$({symKey:c,encoded:s,encoding:o?.encoding});return fn(l)}catch(c){this.logger.error(`Failed to decode message from topic: '${i}', clientId: '${await this.getClientId()}'`),this.logger.error(c)}}),Je(this,"getPayloadType",(i,s=kt)=>{const o=Ds({encoded:i,encoding:s});return En(o.type)}),Je(this,"getPayloadSenderPublicKey",(i,s=kt)=>{const o=Ds({encoded:i,encoding:s});return o.senderPublicKey?ut(o.senderPublicKey,nt):void 0}),this.core=e,this.logger=it(r,this.name),this.keychain=n||new US(this.core,this.logger)}get context(){return pt(this.logger)}async setPrivateKey(e,r){return await this.keychain.set(e,r),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(X0)}catch{e=kl(),await this.keychain.set(X0,e)}return BS(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=F("NOT_INITIALIZED",this.name);throw new Error(e)}}}var qS=Object.defineProperty,zS=Object.defineProperties,HS=Object.getOwnPropertyDescriptors,Em=Object.getOwnPropertySymbols,VS=Object.prototype.hasOwnProperty,WS=Object.prototype.propertyIsEnumerable,cu=(t,e,r)=>e in t?qS(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,KS=(t,e)=>{for(var r in e||(e={}))VS.call(e,r)&&cu(t,r,e[r]);if(Em)for(var r of Em(e))WS.call(e,r)&&cu(t,r,e[r]);return t},GS=(t,e)=>zS(t,HS(e)),$t=(t,e,r)=>cu(t,typeof e!="symbol"?e+"":e,r);class ZS extends D6{constructor(e,r){super(e,r),this.logger=e,this.core=r,$t(this,"messages",new Map),$t(this,"messagesWithoutClientAck",new Map),$t(this,"name",kI),$t(this,"version",qI),$t(this,"initialized",!1),$t(this,"storagePrefix",nr),$t(this,"init",async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n);const i=await this.getRelayerMessagesWithoutClientAck();typeof i<"u"&&(this.messagesWithoutClientAck=i),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}}),$t(this,"set",async(n,i,s)=>{this.isInitialized();const o=Qt(i);let a=this.messages.get(n);if(typeof a>"u"&&(a={}),typeof a[o]<"u")return o;if(a[o]=i,this.messages.set(n,a),s===wa.inbound){const c=this.messagesWithoutClientAck.get(n)||{};this.messagesWithoutClientAck.set(n,GS(KS({},c),{[o]:i}))}return await this.persist(),o}),$t(this,"get",n=>{this.isInitialized();let i=this.messages.get(n);return typeof i>"u"&&(i={}),i}),$t(this,"getWithoutAck",n=>{this.isInitialized();const i={};for(const s of n){const o=this.messagesWithoutClientAck.get(s)||{};i[s]=Object.values(o)}return i}),$t(this,"has",(n,i)=>{this.isInitialized();const s=this.get(n),o=Qt(i);return typeof s[o]<"u"}),$t(this,"ack",async(n,i)=>{this.isInitialized();const s=this.messagesWithoutClientAck.get(n);if(typeof s>"u")return;const o=Qt(i);delete s[o],Object.keys(s).length===0?this.messagesWithoutClientAck.delete(n):this.messagesWithoutClientAck.set(n,s),await this.persist()}),$t(this,"del",async n=>{this.isInitialized(),this.messages.delete(n),this.messagesWithoutClientAck.delete(n),await this.persist()}),this.logger=it(e,this.name),this.core=r}get context(){return pt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get storageKeyWithoutClientAck(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name+"_withoutClientAck"}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,dl(e))}async setRelayerMessagesWithoutClientAck(e){await this.core.storage.setItem(this.storageKeyWithoutClientAck,dl(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?fl(e):void 0}async getRelayerMessagesWithoutClientAck(){const e=await this.core.storage.getItem(this.storageKeyWithoutClientAck);return typeof e<"u"?fl(e):void 0}async persist(){await this.setRelayerMessages(this.messages),await this.setRelayerMessagesWithoutClientAck(this.messagesWithoutClientAck)}isInitialized(){if(!this.initialized){const{message:e}=F("NOT_INITIALIZED",this.name);throw new Error(e)}}}var YS=Object.defineProperty,JS=Object.defineProperties,QS=Object.getOwnPropertyDescriptors,_m=Object.getOwnPropertySymbols,XS=Object.prototype.hasOwnProperty,eA=Object.prototype.propertyIsEnumerable,lu=(t,e,r)=>e in t?YS(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ba=(t,e)=>{for(var r in e||(e={}))XS.call(e,r)&&lu(t,r,e[r]);if(_m)for(var r of _m(e))eA.call(e,r)&&lu(t,r,e[r]);return t},uu=(t,e)=>JS(t,QS(e)),Vt=(t,e,r)=>lu(t,typeof e!="symbol"?e+"":e,r);class tA extends T6{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,Vt(this,"events",new Ve.exports.EventEmitter),Vt(this,"name",zI),Vt(this,"queue",new Map),Vt(this,"publishTimeout",j.toMiliseconds(j.ONE_MINUTE)),Vt(this,"initialPublishTimeout",j.toMiliseconds(j.ONE_SECOND*15)),Vt(this,"needsTransportRestart",!1),Vt(this,"publish",async(n,i,s)=>{var o;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:i,opts:s}});const a=s?.ttl||em,c=ta(s),l=s?.prompt||!1,u=s?.tag||0,h=s?.id||xn().toString(),d={topic:n,message:i,opts:{ttl:a,relay:c,prompt:l,tag:u,id:h,attestation:s?.attestation,tvf:s?.tvf}},p=`Failed to publish payload, please try again. id:${h} tag:${u}`;try{const f=new Promise(async g=>{const m=({id:y})=>{d.opts.id===y&&(this.removeRequestFromQueue(y),this.relayer.events.removeListener(Fe.publish,m),g(d))};this.relayer.events.on(Fe.publish,m);const w=kr(new Promise((y,E)=>{this.rpcPublish({topic:n,message:i,ttl:a,prompt:l,tag:u,id:h,attestation:s?.attestation,tvf:s?.tvf}).then(y).catch(_=>{this.logger.warn(_,_?.message),E(_)})}),this.initialPublishTimeout,`Failed initial publish, retrying.... id:${h} tag:${u}`);try{await w,this.events.removeListener(Fe.publish,m)}catch(y){this.queue.set(h,uu(ba({},d),{attempt:1})),this.logger.warn(y,y?.message)}});this.logger.trace({type:"method",method:"publish",params:{id:h,topic:n,message:i,opts:s}}),await kr(f,this.publishTimeout,p)}catch(f){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(f),(o=s?.internal)!=null&&o.throwOnFailedPublish)throw f}finally{this.queue.delete(h)}}),Vt(this,"on",(n,i)=>{this.events.on(n,i)}),Vt(this,"once",(n,i)=>{this.events.once(n,i)}),Vt(this,"off",(n,i)=>{this.events.off(n,i)}),Vt(this,"removeListener",(n,i)=>{this.events.removeListener(n,i)}),this.relayer=e,this.logger=it(r,this.name),this.registerEventListeners()}get context(){return pt(this.logger)}async rpcPublish(e){var r,n,i,s;const{topic:o,message:a,ttl:c=em,prompt:l,tag:u,id:h,attestation:d,tvf:p}=e,f={method:Ts(ta().protocol).publish,params:ba({topic:o,message:a,ttl:c,prompt:l,tag:u,attestation:d},p),id:h};Ze((r=f.params)==null?void 0:r.prompt)&&((n=f.params)==null||delete n.prompt),Ze((i=f.params)==null?void 0:i.tag)&&((s=f.params)==null||delete s.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:f});const g=await this.relayer.request(f);return this.relayer.events.emit(Fe.publish,e),this.logger.debug("Successfully Published Payload"),g}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async(e,r)=>{const n=e.attempt+1;this.queue.set(r,uu(ba({},e),{attempt:n}));const{topic:i,message:s,opts:o,attestation:a}=e;this.logger.warn({},`Publisher: queue->publishing: ${e.opts.id}, tag: ${e.opts.tag}, attempt: ${n}`),await this.rpcPublish(uu(ba({},e),{topic:i,message:s,ttl:o.ttl,prompt:o.prompt,tag:o.tag,id:o.id,attestation:a,tvf:o.tvf})),this.logger.warn({},`Publisher: queue->published: ${e.opts.id}`)})}registerEventListeners(){this.relayer.core.heartbeat.on(vi.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Fe.connection_stalled);return}this.checkQueue()}),this.relayer.on(Fe.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}}var rA=Object.defineProperty,nA=(t,e,r)=>e in t?rA(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,$i=(t,e,r)=>nA(t,typeof e!="symbol"?e+"":e,r);class iA{constructor(){$i(this,"map",new Map),$i(this,"set",(e,r)=>{const n=this.get(e);this.exists(e,r)||this.map.set(e,[...n,r])}),$i(this,"get",e=>this.map.get(e)||[]),$i(this,"exists",(e,r)=>this.get(e).includes(r)),$i(this,"delete",(e,r)=>{if(typeof r>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const n=this.get(e);if(!this.exists(e,r))return;const i=n.filter(s=>s!==r);if(!i.length){this.map.delete(e);return}this.map.set(e,i)}),$i(this,"clear",()=>{this.map.clear()})}get topics(){return Array.from(this.map.keys())}}var sA=Object.defineProperty,oA=Object.defineProperties,aA=Object.getOwnPropertyDescriptors,$m=Object.getOwnPropertySymbols,cA=Object.prototype.hasOwnProperty,lA=Object.prototype.propertyIsEnumerable,hu=(t,e,r)=>e in t?sA(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ws=(t,e)=>{for(var r in e||(e={}))cA.call(e,r)&&hu(t,r,e[r]);if($m)for(var r of $m(e))lA.call(e,r)&&hu(t,r,e[r]);return t},du=(t,e)=>oA(t,aA(e)),pe=(t,e,r)=>hu(t,typeof e!="symbol"?e+"":e,r);class uA extends B6{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,pe(this,"subscriptions",new Map),pe(this,"topicMap",new iA),pe(this,"events",new Ve.exports.EventEmitter),pe(this,"name",YI),pe(this,"version",JI),pe(this,"pending",new Map),pe(this,"cached",[]),pe(this,"initialized",!1),pe(this,"storagePrefix",nr),pe(this,"subscribeTimeout",j.toMiliseconds(j.ONE_MINUTE)),pe(this,"initialSubscribeTimeout",j.toMiliseconds(j.ONE_SECOND*15)),pe(this,"clientId"),pe(this,"batchSubscribeTopicsLimit",500),pe(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),await this.restore()),this.initialized=!0}),pe(this,"subscribe",async(n,i)=>{this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:i}});try{const s=ta(i),o={topic:n,relay:s,transportType:i?.transportType};this.pending.set(n,o);const a=await this.rpcSubscribe(n,s,i);return typeof a=="string"&&(this.onSubscribe(a,o),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:i}})),a}catch(s){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(s),s}}),pe(this,"unsubscribe",async(n,i)=>{this.isInitialized(),typeof i?.id<"u"?await this.unsubscribeById(n,i.id,i):await this.unsubscribeByTopic(n,i)}),pe(this,"isSubscribed",n=>new Promise(i=>{i(this.topicMap.topics.includes(n))})),pe(this,"isKnownTopic",n=>new Promise(i=>{i(this.topicMap.topics.includes(n)||this.pending.has(n)||this.cached.some(s=>s.topic===n))})),pe(this,"on",(n,i)=>{this.events.on(n,i)}),pe(this,"once",(n,i)=>{this.events.once(n,i)}),pe(this,"off",(n,i)=>{this.events.off(n,i)}),pe(this,"removeListener",(n,i)=>{this.events.removeListener(n,i)}),pe(this,"start",async()=>{await this.onConnect()}),pe(this,"stop",async()=>{await this.onDisconnect()}),pe(this,"restart",async()=>{await this.restore(),await this.onRestart()}),pe(this,"checkPending",async()=>{if(this.pending.size===0&&(!this.initialized||!this.relayer.connected))return;const n=[];this.pending.forEach(i=>{n.push(i)}),await this.batchSubscribe(n)}),pe(this,"registerEventListeners",()=>{this.relayer.core.heartbeat.on(vi.pulse,async()=>{await this.checkPending()}),this.events.on(_t.created,async n=>{const i=_t.created;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:n}),await this.persist()}),this.events.on(_t.deleted,async n=>{const i=_t.deleted;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:n}),await this.persist()})}),this.relayer=e,this.logger=it(r,this.name),this.clientId=""}get context(){return pt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}get hasAnyTopics(){return this.topicMap.topics.length>0||this.pending.size>0||this.cached.length>0||this.subscriptions.size>0}hasSubscription(e,r){let n=!1;try{n=this.getSubscription(e).topic===r}catch{}return n}reset(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,r){const n=this.topicMap.get(e);await Promise.all(n.map(async i=>await this.unsubscribeById(e,i,r)))}async unsubscribeById(e,r,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:n}});try{const i=ta(n);await this.restartToComplete({topic:e,id:r,relay:i}),await this.rpcUnsubscribe(e,r,i);const s=he("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,r,s),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:n}})}catch(i){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(i),i}}async rpcSubscribe(e,r,n){var i;(!n||n?.transportType===ye.relay)&&await this.restartToComplete({topic:e,id:e,relay:r});const s={method:Ts(r.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});const o=(i=n?.internal)==null?void 0:i.throwOnFailedPublish;try{const a=await this.getSubscriptionId(e);if(n?.transportType===ye.link_mode)return setTimeout(()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(s).catch(u=>this.logger.warn(u))},j.toMiliseconds(j.ONE_SECOND)),a;const c=new Promise(async u=>{const h=d=>{d.topic===e&&(this.events.removeListener(_t.created,h),u(d.id))};this.events.on(_t.created,h);try{const d=await kr(new Promise((p,f)=>{this.relayer.request(s).catch(g=>{this.logger.warn(g,g?.message),f(g)}).then(p)}),this.initialSubscribeTimeout,`Subscribing to ${e} failed, please try again`);this.events.removeListener(_t.created,h),u(d)}catch{}}),l=await kr(c,this.subscribeTimeout,`Subscribing to ${e} failed, please try again`);if(!l&&o)throw new Error(`Subscribing to ${e} failed, please try again`);return l?a:null}catch(a){if(this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Fe.connection_stalled),o)throw a}return null}async rpcBatchSubscribe(e){if(!e.length)return;const r=e[0].relay,n={method:Ts(r.protocol).batchSubscribe,params:{topics:e.map(i=>i.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{await await kr(new Promise(i=>{this.relayer.request(n).catch(s=>this.logger.warn(s)).then(i)}),this.subscribeTimeout,"rpcBatchSubscribe failed, please try again")}catch{this.relayer.events.emit(Fe.connection_stalled)}}async rpcBatchFetchMessages(e){if(!e.length)return;const r=e[0].relay,n={method:Ts(r.protocol).batchFetchMessages,params:{topics:e.map(s=>s.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});let i;try{i=await await kr(new Promise((s,o)=>{this.relayer.request(n).catch(a=>{this.logger.warn(a),o(a)}).then(s)}),this.subscribeTimeout,"rpcBatchFetchMessages failed, please try again")}catch{this.relayer.events.emit(Fe.connection_stalled)}return i}rpcUnsubscribe(e,r,n){const i={method:Ts(n.protocol).unsubscribe,params:{topic:e,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i}),this.relayer.request(i)}onSubscribe(e,r){this.setSubscription(e,du(Ws({},r),{id:e})),this.pending.delete(r.topic)}onBatchSubscribe(e){e.length&&e.forEach(r=>{this.setSubscription(r.id,Ws({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(e,r,n){this.events.removeAllListeners(r),this.hasSubscription(r,e)&&this.deleteSubscription(r,n),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,r){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:r}),this.addSubscription(e,r)}addSubscription(e,r){this.subscriptions.set(e,Ws({},r)),this.topicMap.set(r.topic,e),this.events.emit(_t.created,r)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const r=this.subscriptions.get(e);if(!r){const{message:n}=F("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(n)}return r}deleteSubscription(e,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:r});const n=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(n.topic,e),this.events.emit(_t.deleted,du(Ws({},n),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(_t.sync)}async onRestart(){if(this.cached.length){const e=[...this.cached],r=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let n=0;n<r;n++){const i=e.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(i)}}this.events.emit(_t.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:r}=F("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){e.length&&(await this.rpcBatchSubscribe(e),this.onBatchSubscribe(await Promise.all(e.map(async r=>du(Ws({},r),{id:await this.getSubscriptionId(r.topic)})))))}async batchFetchMessages(e){if(!e.length)return;this.logger.trace(`Fetching batch messages for ${e.length} subscriptions`);const r=await this.rpcBatchFetchMessages(e);r&&r.messages&&(await d4(j.toMiliseconds(j.ONE_SECOND)),await this.relayer.handleBatchMessageEvents(r.messages))}async onConnect(){await this.restart(),this.reset()}onDisconnect(){this.onDisable()}isInitialized(){if(!this.initialized){const{message:e}=F("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(e){!this.relayer.connected&&!this.relayer.connecting&&(this.cached.push(e),await this.relayer.transportOpen())}async getClientId(){return this.clientId||(this.clientId=await this.relayer.core.crypto.getClientId()),this.clientId}async getSubscriptionId(e){return Qt(e+await this.getClientId())}}var hA=Object.defineProperty,xm=Object.getOwnPropertySymbols,dA=Object.prototype.hasOwnProperty,fA=Object.prototype.propertyIsEnumerable,fu=(t,e,r)=>e in t?hA(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Im=(t,e)=>{for(var r in e||(e={}))dA.call(e,r)&&fu(t,r,e[r]);if(xm)for(var r of xm(e))fA.call(e,r)&&fu(t,r,e[r]);return t},se=(t,e,r)=>fu(t,typeof e!="symbol"?e+"":e,r);class pA extends R6{constructor(e){super(e),se(this,"protocol","wc"),se(this,"version",2),se(this,"core"),se(this,"logger"),se(this,"events",new Ve.exports.EventEmitter),se(this,"provider"),se(this,"messages"),se(this,"subscriber"),se(this,"publisher"),se(this,"name",VI),se(this,"transportExplicitlyClosed",!1),se(this,"initialized",!1),se(this,"connectionAttemptInProgress",!1),se(this,"relayUrl"),se(this,"projectId"),se(this,"packageName"),se(this,"bundleId"),se(this,"hasExperiencedNetworkDisruption",!1),se(this,"pingTimeout"),se(this,"heartBeatTimeout",j.toMiliseconds(j.THIRTY_SECONDS+j.FIVE_SECONDS)),se(this,"reconnectTimeout"),se(this,"connectPromise"),se(this,"reconnectInProgress",!1),se(this,"requestsInFlight",[]),se(this,"connectTimeout",j.toMiliseconds(j.ONE_SECOND*15)),se(this,"request",async r=>{var n,i;this.logger.debug("Publishing Request Payload");const s=r.id||xn().toString();await this.toEstablishConnection();try{this.logger.trace({id:s,method:r.method,topic:(n=r.params)==null?void 0:n.topic},"relayer.request - publishing...");const o=`${s}:${((i=r.params)==null?void 0:i.tag)||""}`;this.requestsInFlight.push(o);const a=await this.provider.request(r);return this.requestsInFlight=this.requestsInFlight.filter(c=>c!==o),a}catch(o){throw this.logger.debug(`Failed to Publish Request: ${s}`),o}}),se(this,"resetPingTimeout",()=>{qo()&&(clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var r,n,i,s;try{this.logger.debug({},"pingTimeout: Connection stalled, terminating..."),(s=(i=(n=(r=this.provider)==null?void 0:r.connection)==null?void 0:n.socket)==null?void 0:i.terminate)==null||s.call(i)}catch(o){this.logger.warn(o,o?.message)}},this.heartBeatTimeout))}),se(this,"onPayloadHandler",r=>{this.onProviderPayload(r),this.resetPingTimeout()}),se(this,"onConnectHandler",()=>{this.logger.warn({},"Relayer connected \u{1F6DC}"),this.startPingTimeout(),this.events.emit(Fe.connect)}),se(this,"onDisconnectHandler",()=>{this.logger.warn({},"Relayer disconnected \u{1F6D1}"),this.requestsInFlight=[],this.onProviderDisconnect()}),se(this,"onProviderErrorHandler",r=>{this.logger.fatal(`Fatal socket error: ${r.message}`),this.events.emit(Fe.error,r),this.logger.fatal("Fatal socket error received, closing transport"),this.transportClose()}),se(this,"registerProviderListeners",()=>{this.provider.on(Tt.payload,this.onPayloadHandler),this.provider.on(Tt.connect,this.onConnectHandler),this.provider.on(Tt.disconnect,this.onDisconnectHandler),this.provider.on(Tt.error,this.onProviderErrorHandler)}),this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?it(e.logger,this.name):Xt(da({level:e.logger||HI})),this.messages=new ZS(this.logger,e.core),this.subscriber=new uA(this,this.logger),this.publisher=new tA(this,this.logger),this.relayUrl=e?.relayUrl||rm,this.projectId=e.projectId,Y5()?this.packageName=Yp():J5()&&(this.bundleId=Yp()),this.provider={}}async init(){if(this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.subscriber.hasAnyTopics)try{await this.transportOpen()}catch(e){this.logger.warn(e,e?.message)}}get context(){return pt(this.logger)}get connected(){var e,r,n;return((n=(r=(e=this.provider)==null?void 0:e.connection)==null?void 0:r.socket)==null?void 0:n.readyState)===1||!1}get connecting(){var e,r,n;return((n=(r=(e=this.provider)==null?void 0:e.connection)==null?void 0:r.socket)==null?void 0:n.readyState)===0||this.connectPromise!==void 0||!1}async publish(e,r,n){this.isInitialized(),await this.publisher.publish(e,r,n),await this.recordMessageEvent({topic:e,message:r,publishedAt:Date.now(),transportType:ye.relay},wa.outbound)}async subscribe(e,r){var n,i,s;this.isInitialized(),(!(r!=null&&r.transportType)||r?.transportType==="relay")&&await this.toEstablishConnection();const o=typeof((n=r?.internal)==null?void 0:n.throwOnFailedPublish)>"u"?!0:(i=r?.internal)==null?void 0:i.throwOnFailedPublish;let a=((s=this.subscriber.topicMap.get(e))==null?void 0:s[0])||"",c;const l=u=>{u.topic===e&&(this.subscriber.off(_t.created,l),c())};return await Promise.all([new Promise(u=>{c=u,this.subscriber.on(_t.created,l)}),new Promise(async(u,h)=>{a=await this.subscriber.subscribe(e,Im({internal:{throwOnFailedPublish:o}},r)).catch(d=>{o&&h(d)})||a,u()})]),a}async unsubscribe(e,r){this.isInitialized(),await this.subscriber.unsubscribe(e,r)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async transportDisconnect(){this.provider.disconnect&&(this.hasExperiencedNetworkDisruption||this.connected)?await kr(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(e){if(!this.subscriber.hasAnyTopics){this.logger.warn("Starting WS connection skipped because the client has no topics to work with.");return}if(this.connectPromise?(this.logger.debug({},"Waiting for existing connection attempt to resolve..."),await this.connectPromise,this.logger.debug({},"Existing connection attempt resolved")):(this.connectPromise=new Promise(async(r,n)=>{await this.connect(e).then(r).catch(n).finally(()=>{this.connectPromise=void 0})}),await this.connectPromise),!this.connected)throw new Error(`Couldn't establish socket connection to the relay server: ${this.relayUrl}`)}async restartTransport(e){this.logger.debug({},"Restarting transport..."),!this.connectionAttemptInProgress&&(this.relayUrl=e||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await b0())throw new Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(e){if(e?.length===0){this.logger.trace("Batch message events is empty. Ignoring...");return}const r=e.sort((n,i)=>n.publishedAt-i.publishedAt);this.logger.debug(`Batch of ${r.length} message events sorted`);for(const n of r)try{await this.onMessageEvent(n)}catch(i){this.logger.warn(i,"Error while processing batch message event: "+i?.message)}this.logger.trace(`Batch of ${r.length} message events processed`)}async onLinkMessageEvent(e,r){const{topic:n}=e;if(!r.sessionExists){const i=Te(j.FIVE_MINUTES),s={topic:n,expiry:i,relay:{protocol:"irn"},active:!1};await this.core.pairing.pairings.set(n,s)}this.events.emit(Fe.message,e),await this.recordMessageEvent(e,wa.inbound)}async connect(e){await this.confirmOnlineStateOrThrow(),e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportDisconnect()),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;let r=1;for(;r<6;){try{if(this.transportExplicitlyClosed)break;this.logger.debug({},`Connecting to ${this.relayUrl}, attempt: ${r}...`),await this.createProvider(),await new Promise(async(n,i)=>{const s=()=>{i(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(Tt.disconnect,s),await kr(new Promise((o,a)=>{this.provider.connect().then(o).catch(a)}),this.connectTimeout,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(o=>{i(o)}).finally(()=>{this.provider.off(Tt.disconnect,s),clearTimeout(this.reconnectTimeout)}),await new Promise(async(o,a)=>{const c=()=>{a(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(Tt.disconnect,c),await this.subscriber.start().then(o).catch(a).finally(()=>{this.provider.off(Tt.disconnect,c)})}),this.hasExperiencedNetworkDisruption=!1,n()})}catch(n){await this.subscriber.stop();const i=n;this.logger.warn({},i.message),this.hasExperiencedNetworkDisruption=!0}finally{this.connectionAttemptInProgress=!1}if(this.connected){this.logger.debug({},`Connected to ${this.relayUrl} successfully on attempt: ${r}`);break}await new Promise(n=>setTimeout(n,j.toMiliseconds(r*1))),r++}}startPingTimeout(){var e,r,n,i,s;if(qo())try{(r=(e=this.provider)==null?void 0:e.connection)!=null&&r.socket&&((s=(i=(n=this.provider)==null?void 0:n.connection)==null?void 0:i.socket)==null||s.on("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(o){this.logger.warn(o,o?.message)}}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Dt(new DI(r4({sdkVersion:iu,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId,packageName:this.packageName}))),this.registerProviderListeners()}async recordMessageEvent(e,r){const{topic:n,message:i}=e;await this.messages.set(n,i,r)}async shouldIgnoreMessageEvent(e){const{topic:r,message:n}=e;if(!n||n.length===0)return this.logger.warn(`Ignoring invalid/empty message: ${n}`),!0;if(!await this.subscriber.isKnownTopic(r))return this.logger.warn(`Ignoring message for unknown topic ${r}`),!0;const i=this.messages.has(r,n);return i&&this.logger.warn(`Ignoring duplicate message: ${n}`),i}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),nu(e)){if(!e.method.endsWith(WI))return;const r=e.params,{topic:n,message:i,publishedAt:s,attestation:o}=r.data,a={topic:n,message:i,publishedAt:s,transportType:ye.relay,attestation:o};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(Im({type:"event",event:r.id},a)),this.events.emit(r.id,a),await this.acknowledgePayload(e),await this.onMessageEvent(a)}else ga(e)&&this.events.emit(Fe.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(await this.recordMessageEvent(e,wa.inbound),this.events.emit(Fe.message,e))}async acknowledgePayload(e){const r=fa(e.id,!0);await this.provider.connection.send(r)}unregisterProviderListeners(){this.provider.off(Tt.payload,this.onPayloadHandler),this.provider.off(Tt.connect,this.onConnectHandler),this.provider.off(Tt.disconnect,this.onDisconnectHandler),this.provider.off(Tt.error,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let e=await b0();px(async r=>{e!==r&&(e=r,r?await this.transportOpen().catch(n=>this.logger.error(n,n?.message)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))})}async onProviderDisconnect(){clearTimeout(this.pingTimeout),this.events.emit(Fe.disconnect),this.connectionAttemptInProgress=!1,!this.reconnectInProgress&&(this.reconnectInProgress=!0,await this.subscriber.stop(),this.subscriber.hasAnyTopics&&(this.transportExplicitlyClosed||(this.reconnectTimeout=setTimeout(async()=>{await this.transportOpen().catch(e=>this.logger.error(e,e?.message)),this.reconnectTimeout=void 0,this.reconnectInProgress=!1},j.toMiliseconds(KI)))))}isInitialized(){if(!this.initialized){const{message:e}=F("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){await this.confirmOnlineStateOrThrow(),!this.connected&&await this.connect()}}function gA(){}function Om(t){if(!t||typeof t!="object")return!1;const e=Object.getPrototypeOf(t);return e===null||e===Object.prototype||Object.getPrototypeOf(e)===null?Object.prototype.toString.call(t)==="[object Object]":!1}function Sm(t){return Object.getOwnPropertySymbols(t).filter(e=>Object.prototype.propertyIsEnumerable.call(t,e))}function Am(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}const mA="[object RegExp]",wA="[object String]",yA="[object Number]",bA="[object Boolean]",Cm="[object Arguments]",vA="[object Symbol]",EA="[object Date]",_A="[object Map]",$A="[object Set]",xA="[object Array]",IA="[object Function]",OA="[object ArrayBuffer]",pu="[object Object]",SA="[object Error]",AA="[object DataView]",CA="[object Uint8Array]",PA="[object Uint8ClampedArray]",DA="[object Uint16Array]",TA="[object Uint32Array]",RA="[object BigUint64Array]",NA="[object Int8Array]",BA="[object Int16Array]",LA="[object Int32Array]",MA="[object BigInt64Array]",UA="[object Float32Array]",jA="[object Float64Array]";function FA(t,e){return t===e||Number.isNaN(t)&&Number.isNaN(e)}function kA(t,e,r){return Ks(t,e,void 0,void 0,void 0,void 0,r)}function Ks(t,e,r,n,i,s,o){const a=o(t,e,r,n,i,s);if(a!==void 0)return a;if(typeof t==typeof e)switch(typeof t){case"bigint":case"string":case"boolean":case"symbol":case"undefined":return t===e;case"number":return t===e||Object.is(t,e);case"function":return t===e;case"object":return Gs(t,e,s,o)}return Gs(t,e,s,o)}function Gs(t,e,r,n){if(Object.is(t,e))return!0;let i=Am(t),s=Am(e);if(i===Cm&&(i=pu),s===Cm&&(s=pu),i!==s)return!1;switch(i){case wA:return t.toString()===e.toString();case yA:{const c=t.valueOf(),l=e.valueOf();return FA(c,l)}case bA:case EA:case vA:return Object.is(t.valueOf(),e.valueOf());case mA:return t.source===e.source&&t.flags===e.flags;case IA:return t===e}r=r??new Map;const o=r.get(t),a=r.get(e);if(o!=null&&a!=null)return o===e;r.set(t,e),r.set(e,t);try{switch(i){case _A:{if(t.size!==e.size)return!1;for(const[c,l]of t.entries())if(!e.has(c)||!Ks(l,e.get(c),c,t,e,r,n))return!1;return!0}case $A:{if(t.size!==e.size)return!1;const c=Array.from(t.values()),l=Array.from(e.values());for(let u=0;u<c.length;u++){const h=c[u],d=l.findIndex(p=>Ks(h,p,void 0,t,e,r,n));if(d===-1)return!1;l.splice(d,1)}return!0}case xA:case CA:case PA:case DA:case TA:case RA:case NA:case BA:case LA:case MA:case UA:case jA:{if(typeof Buffer<"u"&&Buffer.isBuffer(t)!==Buffer.isBuffer(e)||t.length!==e.length)return!1;for(let c=0;c<t.length;c++)if(!Ks(t[c],e[c],c,t,e,r,n))return!1;return!0}case OA:return t.byteLength!==e.byteLength?!1:Gs(new Uint8Array(t),new Uint8Array(e),r,n);case AA:return t.byteLength!==e.byteLength||t.byteOffset!==e.byteOffset?!1:Gs(new Uint8Array(t),new Uint8Array(e),r,n);case SA:return t.name===e.name&&t.message===e.message;case pu:{if(!(Gs(t.constructor,e.constructor,r,n)||Om(t)&&Om(e)))return!1;const c=[...Object.keys(t),...Sm(t)],l=[...Object.keys(e),...Sm(e)];if(c.length!==l.length)return!1;for(let u=0;u<c.length;u++){const h=c[u],d=t[h];if(!Object.hasOwn(e,h))return!1;const p=e[h];if(!Ks(d,p,h,t,e,r,n))return!1}return!0}default:return!1}}finally{r.delete(t),r.delete(e)}}function qA(t,e){return kA(t,e,gA)}var zA=Object.defineProperty,Pm=Object.getOwnPropertySymbols,HA=Object.prototype.hasOwnProperty,VA=Object.prototype.propertyIsEnumerable,gu=(t,e,r)=>e in t?zA(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Dm=(t,e)=>{for(var r in e||(e={}))HA.call(e,r)&&gu(t,r,e[r]);if(Pm)for(var r of Pm(e))VA.call(e,r)&&gu(t,r,e[r]);return t},gt=(t,e,r)=>gu(t,typeof e!="symbol"?e+"":e,r);class An extends N6{constructor(e,r,n,i=nr,s=void 0){super(e,r,n,i),this.core=e,this.logger=r,this.name=n,gt(this,"map",new Map),gt(this,"version",GI),gt(this,"cached",[]),gt(this,"initialized",!1),gt(this,"getKey"),gt(this,"storagePrefix",nr),gt(this,"recentlyDeleted",[]),gt(this,"recentlyDeletedLimit",200),gt(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(o=>{this.getKey&&o!==null&&!Ze(o)?this.map.set(this.getKey(o),o):V$(o)?this.map.set(o.id,o):W$(o)&&this.map.set(o.topic,o)}),this.cached=[],this.initialized=!0)}),gt(this,"set",async(o,a)=>{this.isInitialized(),this.map.has(o)?await this.update(o,a):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:o,value:a}),this.map.set(o,a),await this.persist())}),gt(this,"get",o=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:o}),this.getData(o))),gt(this,"getAll",o=>(this.isInitialized(),o?this.values.filter(a=>Object.keys(o).every(c=>qA(a[c],o[c]))):this.values)),gt(this,"update",async(o,a)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:o,update:a});const c=Dm(Dm({},this.getData(o)),a);this.map.set(o,c),await this.persist()}),gt(this,"delete",async(o,a)=>{this.isInitialized(),this.map.has(o)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:o,reason:a}),this.map.delete(o),this.addToRecentlyDeleted(o),await this.persist())}),this.logger=it(r,this.name),this.storagePrefix=i,this.getKey=s}get context(){return pt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(e){this.recentlyDeleted.push(e),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const r=this.map.get(e);if(!r){if(this.recentlyDeleted.includes(e)){const{message:i}=F("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${e}`);throw this.logger.error(i),new Error(i)}const{message:n}=F("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(n),new Error(n)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:r}=F("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=F("NOT_INITIALIZED",this.name);throw new Error(e)}}}var WA=Object.defineProperty,KA=(t,e,r)=>e in t?WA(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ee=(t,e,r)=>KA(t,typeof e!="symbol"?e+"":e,r);class GA{constructor(e,r){this.core=e,this.logger=r,ee(this,"name",QI),ee(this,"version",XI),ee(this,"events",new Ve.exports),ee(this,"pairings"),ee(this,"initialized",!1),ee(this,"storagePrefix",nr),ee(this,"ignoredPayloadTypes",[$r]),ee(this,"registeredMethods",[]),ee(this,"init",async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))}),ee(this,"register",({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]}),ee(this,"create",async n=>{this.isInitialized();const i=kl(),s=await this.core.crypto.setSymKey(i),o=Te(j.FIVE_MINUTES),a={protocol:tm},c={topic:s,expiry:o,relay:a,active:!1,methods:n?.methods},l=h0({protocol:this.core.protocol,version:this.core.version,topic:s,symKey:i,relay:a,expiryTimestamp:o,methods:n?.methods});return this.events.emit(In.create,c),this.core.expirer.set(s,o),await this.pairings.set(s,c),await this.core.relayer.subscribe(s,{transportType:n?.transportType}),{topic:s,uri:l}}),ee(this,"pair",async n=>{this.isInitialized();const i=this.core.eventClient.createEvent({properties:{topic:n?.uri,trace:[ir.pairing_started]}});this.isValidPair(n,i);const{topic:s,symKey:o,relay:a,expiryTimestamp:c,methods:l}=u0(n.uri);i.props.properties.topic=s,i.addTrace(ir.pairing_uri_validation_success),i.addTrace(ir.pairing_uri_not_expired);let u;if(this.pairings.keys.includes(s)){if(u=this.pairings.get(s),i.addTrace(ir.existing_pairing),u.active)throw i.setError(Or.active_pairing_already_exists),new Error(`Pairing already exists: ${s}. Please try again with a new connection URI.`);i.addTrace(ir.pairing_not_expired)}const h=c||Te(j.FIVE_MINUTES),d={topic:s,relay:a,expiry:h,active:!1,methods:l};this.core.expirer.set(s,h),await this.pairings.set(s,d),i.addTrace(ir.store_new_pairing),n.activatePairing&&await this.activate({topic:s}),this.events.emit(In.create,d),i.addTrace(ir.emit_inactive_pairing),this.core.crypto.keychain.has(s)||await this.core.crypto.setSymKey(o,s),i.addTrace(ir.subscribing_pairing_topic);try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{i.setError(Or.no_internet_connection)}try{await this.core.relayer.subscribe(s,{relay:a})}catch(p){throw i.setError(Or.subscribe_pairing_topic_failure),p}return i.addTrace(ir.subscribe_pairing_topic_success),d}),ee(this,"activate",async({topic:n})=>{this.isInitialized();const i=Te(j.FIVE_MINUTES);this.core.expirer.set(n,i),await this.pairings.update(n,{active:!0,expiry:i})}),ee(this,"ping",async n=>{this.isInitialized(),await this.isValidPing(n),this.logger.warn("ping() is deprecated and will be removed in the next major release.");const{topic:i}=n;if(this.pairings.keys.includes(i)){const s=await this.sendRequest(i,"wc_pairingPing",{}),{done:o,resolve:a,reject:c}=mn();this.events.once(le("pairing_ping",s),({error:l})=>{l?c(l):a()}),await o()}}),ee(this,"updateExpiry",async({topic:n,expiry:i})=>{this.isInitialized(),await this.pairings.update(n,{expiry:i})}),ee(this,"updateMetadata",async({topic:n,metadata:i})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:i})}),ee(this,"getPairings",()=>(this.isInitialized(),this.pairings.values)),ee(this,"disconnect",async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:i}=n;this.pairings.keys.includes(i)&&(await this.sendRequest(i,"wc_pairingDelete",he("USER_DISCONNECTED")),await this.deletePairing(i))}),ee(this,"formatUriFromPairing",n=>{this.isInitialized();const{topic:i,relay:s,expiry:o,methods:a}=n,c=this.core.crypto.keychain.get(i);return h0({protocol:this.core.protocol,version:this.core.version,topic:i,symKey:c,relay:s,expiryTimestamp:o,methods:a})}),ee(this,"sendRequest",async(n,i,s)=>{const o=Kr(i,s),a=await this.core.crypto.encode(n,o),c=qs[i].req;return this.core.history.set(n,o),this.core.relayer.publish(n,a,c),o.id}),ee(this,"sendResult",async(n,i,s)=>{const o=fa(n,s),a=await this.core.crypto.encode(i,o),c=(await this.core.history.get(i,n)).request.method,l=qs[c].res;await this.core.relayer.publish(i,a,l),await this.core.history.resolve(o)}),ee(this,"sendError",async(n,i,s)=>{const o=pa(n,s),a=await this.core.crypto.encode(i,o),c=(await this.core.history.get(i,n)).request.method,l=qs[c]?qs[c].res:qs.unregistered_method.res;await this.core.relayer.publish(i,a,l),await this.core.history.resolve(o)}),ee(this,"deletePairing",async(n,i)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,he("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),i?Promise.resolve():this.core.expirer.del(n)])}),ee(this,"cleanup",async()=>{const n=this.pairings.getAll().filter(i=>qr(i.expiry));await Promise.all(n.map(i=>this.deletePairing(i.topic)))}),ee(this,"onRelayEventRequest",async n=>{const{topic:i,payload:s}=n;switch(s.method){case"wc_pairingPing":return await this.onPairingPingRequest(i,s);case"wc_pairingDelete":return await this.onPairingDeleteRequest(i,s);default:return await this.onUnknownRpcMethodRequest(i,s)}}),ee(this,"onRelayEventResponse",async n=>{const{topic:i,payload:s}=n,o=(await this.core.history.get(i,s.id)).request.method;switch(o){case"wc_pairingPing":return this.onPairingPingResponse(i,s);default:return this.onUnknownRpcMethodResponse(o)}}),ee(this,"onPairingPingRequest",async(n,i)=>{const{id:s}=i;try{this.isValidPing({topic:n}),await this.sendResult(s,n,!0),this.events.emit(In.ping,{id:s,topic:n})}catch(o){await this.sendError(s,n,o),this.logger.error(o)}}),ee(this,"onPairingPingResponse",(n,i)=>{const{id:s}=i;setTimeout(()=>{rr(i)?this.events.emit(le("pairing_ping",s),{}):Pt(i)&&this.events.emit(le("pairing_ping",s),{error:i.error})},500)}),ee(this,"onPairingDeleteRequest",async(n,i)=>{const{id:s}=i;try{this.isValidDisconnect({topic:n}),await this.deletePairing(n),this.events.emit(In.delete,{id:s,topic:n})}catch(o){await this.sendError(s,n,o),this.logger.error(o)}}),ee(this,"onUnknownRpcMethodRequest",async(n,i)=>{const{id:s,method:o}=i;try{if(this.registeredMethods.includes(o))return;const a=he("WC_METHOD_UNSUPPORTED",o);await this.sendError(s,n,a),this.logger.error(a)}catch(a){await this.sendError(s,n,a),this.logger.error(a)}}),ee(this,"onUnknownRpcMethodResponse",n=>{this.registeredMethods.includes(n)||this.logger.error(he("WC_METHOD_UNSUPPORTED",n))}),ee(this,"isValidPair",(n,i)=>{var s;if(!dt(n)){const{message:a}=F("MISSING_OR_INVALID",`pair() params: ${n}`);throw i.setError(Or.malformed_pairing_uri),new Error(a)}if(!H$(n.uri)){const{message:a}=F("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw i.setError(Or.malformed_pairing_uri),new Error(a)}const o=u0(n?.uri);if(!((s=o?.relay)!=null&&s.protocol)){const{message:a}=F("MISSING_OR_INVALID","pair() uri#relay-protocol");throw i.setError(Or.malformed_pairing_uri),new Error(a)}if(!(o!=null&&o.symKey)){const{message:a}=F("MISSING_OR_INVALID","pair() uri#symKey");throw i.setError(Or.malformed_pairing_uri),new Error(a)}if(o!=null&&o.expiryTimestamp&&j.toMiliseconds(o?.expiryTimestamp)<Date.now()){i.setError(Or.pairing_expired);const{message:a}=F("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(a)}}),ee(this,"isValidPing",async n=>{if(!dt(n)){const{message:s}=F("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(s)}const{topic:i}=n;await this.isValidPairingTopic(i)}),ee(this,"isValidDisconnect",async n=>{if(!dt(n)){const{message:s}=F("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(s)}const{topic:i}=n;await this.isValidPairingTopic(i)}),ee(this,"isValidPairingTopic",async n=>{if(!Ae(n,!1)){const{message:i}=F("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(i)}if(!this.pairings.keys.includes(n)){const{message:i}=F("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(i)}if(qr(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:i}=F("EXPIRED",`pairing topic: ${n}`);throw new Error(i)}}),this.core=e,this.logger=it(r,this.name),this.pairings=new An(this.core,this.logger,this.name,this.storagePrefix)}get context(){return pt(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=F("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(Fe.message,async e=>{const{topic:r,message:n,transportType:i}=e;if(this.pairings.keys.includes(r)&&i!==ye.link_mode&&!this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))try{const s=await this.core.crypto.decode(r,n);nu(s)?(this.core.history.set(r,s),await this.onRelayEventRequest({topic:r,payload:s})):ga(s)&&(await this.core.history.resolve(s),await this.onRelayEventResponse({topic:r,payload:s}),this.core.history.delete(r,s.id)),await this.core.relayer.messages.ack(r,n)}catch(s){this.logger.error(s)}})}registerExpirerEvents(){this.core.expirer.on(Rt.expired,async e=>{const{topic:r}=eg(e.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit(In.expire,{topic:r}))})}}var ZA=Object.defineProperty,YA=(t,e,r)=>e in t?ZA(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Qe=(t,e,r)=>YA(t,typeof e!="symbol"?e+"":e,r);class JA extends P6{constructor(e,r){super(e,r),this.core=e,this.logger=r,Qe(this,"records",new Map),Qe(this,"events",new Ve.exports.EventEmitter),Qe(this,"name",eO),Qe(this,"version",tO),Qe(this,"cached",[]),Qe(this,"initialized",!1),Qe(this,"storagePrefix",nr),Qe(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),Qe(this,"set",(n,i,s)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:i,chainId:s}),this.records.has(i.id))return;const o={id:i.id,topic:n,request:{method:i.method,params:i.params||null},chainId:s,expiry:Te(j.THIRTY_DAYS)};this.records.set(o.id,o),this.persist(),this.events.emit(zt.created,o)}),Qe(this,"resolve",async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const i=await this.getRecord(n.id);typeof i.response>"u"&&(i.response=Pt(n)?{error:n.error}:{result:n.result},this.records.set(i.id,i),this.persist(),this.events.emit(zt.updated,i))}),Qe(this,"get",async(n,i)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:i}),await this.getRecord(i))),Qe(this,"delete",(n,i)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:i}),this.values.forEach(s=>{if(s.topic===n){if(typeof i<"u"&&s.id!==i)return;this.records.delete(s.id),this.events.emit(zt.deleted,s)}}),this.persist()}),Qe(this,"exists",async(n,i)=>(this.isInitialized(),this.records.has(i)?(await this.getRecord(i)).topic===n:!1)),Qe(this,"on",(n,i)=>{this.events.on(n,i)}),Qe(this,"once",(n,i)=>{this.events.once(n,i)}),Qe(this,"off",(n,i)=>{this.events.off(n,i)}),Qe(this,"removeListener",(n,i)=>{this.events.removeListener(n,i)}),this.logger=it(r,this.name)}get context(){return pt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const n={topic:r.topic,request:Kr(r.request.method,r.request.params,r.id),chainId:r.chainId};return e.push(n)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const r=this.records.get(e);if(!r){const{message:n}=F("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(n)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(zt.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:r}=F("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(zt.created,e=>{const r=zt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e})}),this.events.on(zt.updated,e=>{const r=zt.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e})}),this.events.on(zt.deleted,e=>{const r=zt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e})}),this.core.heartbeat.on(vi.pulse,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let e=!1;this.records.forEach(r=>{j.toMiliseconds(r.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${r.id}`),this.records.delete(r.id),this.events.emit(zt.deleted,r,!1),e=!0)}),e&&this.persist()}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=F("NOT_INITIALIZED",this.name);throw new Error(e)}}}var QA=Object.defineProperty,XA=(t,e,r)=>e in t?QA(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,et=(t,e,r)=>XA(t,typeof e!="symbol"?e+"":e,r);class eC extends L6{constructor(e,r){super(e,r),this.core=e,this.logger=r,et(this,"expirations",new Map),et(this,"events",new Ve.exports.EventEmitter),et(this,"name",rO),et(this,"version",nO),et(this,"cached",[]),et(this,"initialized",!1),et(this,"storagePrefix",nr),et(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),et(this,"has",n=>{try{const i=this.formatTarget(n);return typeof this.getExpiration(i)<"u"}catch{return!1}}),et(this,"set",(n,i)=>{this.isInitialized();const s=this.formatTarget(n),o={target:s,expiry:i};this.expirations.set(s,o),this.checkExpiry(s,o),this.events.emit(Rt.created,{target:s,expiration:o})}),et(this,"get",n=>{this.isInitialized();const i=this.formatTarget(n);return this.getExpiration(i)}),et(this,"del",n=>{if(this.isInitialized(),this.has(n)){const i=this.formatTarget(n),s=this.getExpiration(i);this.expirations.delete(i),this.events.emit(Rt.deleted,{target:i,expiration:s})}}),et(this,"on",(n,i)=>{this.events.on(n,i)}),et(this,"once",(n,i)=>{this.events.once(n,i)}),et(this,"off",(n,i)=>{this.events.off(n,i)}),et(this,"removeListener",(n,i)=>{this.events.removeListener(n,i)}),this.logger=it(r,this.name)}get context(){return pt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return n4(e);if(typeof e=="number")return i4(e);const{message:r}=F("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(r)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Rt.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:r}=F("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const r=this.expirations.get(e);if(!r){const{message:n}=F("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.warn(n),new Error(n)}return r}checkExpiry(e,r){const{expiry:n}=r;j.toMiliseconds(n)-Date.now()<=0&&this.expire(e,r)}expire(e,r){this.expirations.delete(e),this.events.emit(Rt.expired,{target:e,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,r)=>this.checkExpiry(r,e))}registerEventListeners(){this.core.heartbeat.on(vi.pulse,()=>this.checkExpirations()),this.events.on(Rt.created,e=>{const r=Rt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(Rt.expired,e=>{const r=Rt.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(Rt.deleted,e=>{const r=Rt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=F("NOT_INITIALIZED",this.name);throw new Error(e)}}}var tC=Object.defineProperty,rC=(t,e,r)=>e in t?tC(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ce=(t,e,r)=>rC(t,typeof e!="symbol"?e+"":e,r);class nC extends M6{constructor(e,r,n){super(e,r,n),this.core=e,this.logger=r,this.store=n,Ce(this,"name",iO),Ce(this,"abortController"),Ce(this,"isDevEnv"),Ce(this,"verifyUrlV3",oO),Ce(this,"storagePrefix",nr),Ce(this,"version",Q0),Ce(this,"publicKey"),Ce(this,"fetchPromise"),Ce(this,"init",async()=>{var i;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&j.toMiliseconds((i=this.publicKey)==null?void 0:i.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))}),Ce(this,"register",async i=>{if(!ys()||this.isDevEnv)return;const s=window.location.origin,{id:o,decryptedId:a}=i,c=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${s}&id=${o}&decryptedId=${a}`;try{const l=ss(),u=this.startAbortTimer(j.ONE_SECOND*5),h=await new Promise((d,p)=>{const f=()=>{window.removeEventListener("message",m),l.body.removeChild(g),p("attestation aborted")};this.abortController.signal.addEventListener("abort",f);const g=l.createElement("iframe");g.src=c,g.style.display="none",g.addEventListener("error",f,{signal:this.abortController.signal});const m=w=>{if(w.data&&typeof w.data=="string")try{const y=JSON.parse(w.data);if(y.type==="verify_attestation"){if(al(y.attestation).payload.id!==o)return;clearInterval(u),l.body.removeChild(g),this.abortController.signal.removeEventListener("abort",f),window.removeEventListener("message",m),d(y.attestation===null?"":y.attestation)}}catch(y){this.logger.warn(y)}};l.body.appendChild(g),window.addEventListener("message",m,{signal:this.abortController.signal})});return this.logger.debug("jwt attestation",h),h}catch(l){this.logger.warn(l)}return""}),Ce(this,"resolve",async i=>{if(this.isDevEnv)return"";const{attestationId:s,hash:o,encryptedId:a}=i;if(s===""){this.logger.debug("resolve: attestationId is empty, skipping");return}if(s){if(al(s).payload.id!==a)return;const l=await this.isValidJwtAttestation(s);if(l){if(!l.isVerified){this.logger.warn("resolve: jwt attestation: origin url not verified");return}return l}}if(!o)return;const c=this.getVerifyUrl(i?.verifyUrl);return this.fetchAttestation(o,c)}),Ce(this,"fetchAttestation",async(i,s)=>{this.logger.debug(`resolving attestation: ${i} from url: ${s}`);const o=this.startAbortTimer(j.ONE_SECOND*5),a=await fetch(`${s}/attestation/${i}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(o),a.status===200?await a.json():void 0}),Ce(this,"getVerifyUrl",i=>{let s=i||zs;return aO.includes(s)||(this.logger.info(`verify url: ${s}, not included in trusted list, assigning default: ${zs}`),s=zs),s}),Ce(this,"fetchPublicKey",async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);const i=this.startAbortTimer(j.FIVE_SECONDS),s=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(i),await s.json()}catch(i){this.logger.warn(i)}}),Ce(this,"persistPublicKey",async i=>{this.logger.debug("persisting public key to local storage",i),await this.store.setItem(this.storeKey,i),this.publicKey=i}),Ce(this,"removePublicKey",async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0}),Ce(this,"isValidJwtAttestation",async i=>{const s=await this.getPublicKey();try{if(s)return this.validateAttestation(i,s)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}const o=await this.fetchAndPersistPublicKey();try{if(o)return this.validateAttestation(i,o)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}}),Ce(this,"getPublicKey",async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey()),Ce(this,"fetchAndPersistPublicKey",async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise(async s=>{const o=await this.fetchPublicKey();o&&(await this.persistPublicKey(o),s(o))});const i=await this.fetchPromise;return this.fetchPromise=void 0,i}),Ce(this,"validateAttestation",(i,s)=>{const o=D$(i,s.publicKey),a={hasExpired:j.toMiliseconds(o.exp)<Date.now(),payload:o};if(a.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),new Error("JWT attestation expired");return{origin:a.payload.origin,isScam:a.payload.isScam,isVerified:a.payload.isVerified}}),this.logger=it(r,this.name),this.abortController=new AbortController,this.isDevEnv=pl(),this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return pt(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),j.toMiliseconds(e))}}var iC=Object.defineProperty,sC=(t,e,r)=>e in t?iC(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Tm=(t,e,r)=>sC(t,typeof e!="symbol"?e+"":e,r);class oC extends U6{constructor(e,r){super(e,r),this.projectId=e,this.logger=r,Tm(this,"context",cO),Tm(this,"registerDeviceToken",async n=>{const{clientId:i,token:s,notificationType:o,enableEncrypted:a=!1}=n,c=`${lO}/${this.projectId}/clients`;await fetch(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:i,type:o,token:s,always_raw:a})})}),this.logger=it(r,this.context)}}var aC=Object.defineProperty,Rm=Object.getOwnPropertySymbols,cC=Object.prototype.hasOwnProperty,lC=Object.prototype.propertyIsEnumerable,mu=(t,e,r)=>e in t?aC(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Zs=(t,e)=>{for(var r in e||(e={}))cC.call(e,r)&&mu(t,r,e[r]);if(Rm)for(var r of Rm(e))lC.call(e,r)&&mu(t,r,e[r]);return t},ke=(t,e,r)=>mu(t,typeof e!="symbol"?e+"":e,r);class uC extends j6{constructor(e,r,n=!0){super(e,r,n),this.core=e,this.logger=r,ke(this,"context",hO),ke(this,"storagePrefix",nr),ke(this,"storageVersion",uO),ke(this,"events",new Map),ke(this,"shouldPersist",!1),ke(this,"init",async()=>{if(!pl())try{const i={eventId:rg(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:Qp(this.core.relayer.protocol,this.core.relayer.version,iu)}}};await this.sendEvent([i])}catch(i){this.logger.warn(i)}}),ke(this,"createEvent",i=>{const{event:s="ERROR",type:o="",properties:{topic:a,trace:c}}=i,l=rg(),u=this.core.projectId||"",h=Date.now(),d=Zs({eventId:l,timestamp:h,props:{event:s,type:o,properties:{topic:a,trace:c}},bundleId:u,domain:this.getAppDomain()},this.setMethods(l));return this.telemetryEnabled&&(this.events.set(l,d),this.shouldPersist=!0),d}),ke(this,"getEvent",i=>{const{eventId:s,topic:o}=i;if(s)return this.events.get(s);const a=Array.from(this.events.values()).find(c=>c.props.properties.topic===o);if(a)return Zs(Zs({},a),this.setMethods(a.eventId))}),ke(this,"deleteEvent",i=>{const{eventId:s}=i;this.events.delete(s),this.shouldPersist=!0}),ke(this,"setEventListeners",()=>{this.core.heartbeat.on(vi.pulse,async()=>{this.shouldPersist&&await this.persist(),this.events.forEach(i=>{j.fromMiliseconds(Date.now())-j.fromMiliseconds(i.timestamp)>dO&&(this.events.delete(i.eventId),this.shouldPersist=!0)})})}),ke(this,"setMethods",i=>({addTrace:s=>this.addTrace(i,s),setError:s=>this.setError(i,s)})),ke(this,"addTrace",(i,s)=>{const o=this.events.get(i);o&&(o.props.properties.trace.push(s),this.events.set(i,o),this.shouldPersist=!0)}),ke(this,"setError",(i,s)=>{const o=this.events.get(i);o&&(o.props.type=s,o.timestamp=Date.now(),this.events.set(i,o),this.shouldPersist=!0)}),ke(this,"persist",async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1}),ke(this,"restore",async()=>{try{const i=await this.core.storage.getItem(this.storageKey)||[];if(!i.length)return;i.forEach(s=>{this.events.set(s.eventId,Zs(Zs({},s),this.setMethods(s.eventId)))})}catch(i){this.logger.warn(i)}}),ke(this,"submit",async()=>{if(!this.telemetryEnabled||this.events.size===0)return;const i=[];for(const[s,o]of this.events)o.props.type&&i.push(o);if(i.length!==0)try{if((await this.sendEvent(i)).ok)for(const s of i)this.events.delete(s.eventId),this.shouldPersist=!0}catch(s){this.logger.warn(s)}}),ke(this,"sendEvent",async i=>{const s=this.getAppDomain()?"":"&sp=desktop";return await fetch(`${fO}?projectId=${this.core.projectId}&st=events_sdk&sv=js-${iu}${s}`,{method:"POST",body:JSON.stringify(i)})}),ke(this,"getAppDomain",()=>Jp().url),this.logger=it(r,this.context),this.telemetryEnabled=n,n?this.restore().then(async()=>{await this.submit(),this.setEventListeners()}):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}}var hC=Object.defineProperty,Nm=Object.getOwnPropertySymbols,dC=Object.prototype.hasOwnProperty,fC=Object.prototype.propertyIsEnumerable,wu=(t,e,r)=>e in t?hC(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Bm=(t,e)=>{for(var r in e||(e={}))dC.call(e,r)&&wu(t,r,e[r]);if(Nm)for(var r of Nm(e))fC.call(e,r)&&wu(t,r,e[r]);return t},we=(t,e,r)=>wu(t,typeof e!="symbol"?e+"":e,r);class yu extends O6{constructor(e){var r;super(e),we(this,"protocol",J0),we(this,"version",Q0),we(this,"name",ma),we(this,"relayUrl"),we(this,"projectId"),we(this,"customStoragePrefix"),we(this,"events",new Ve.exports.EventEmitter),we(this,"logger"),we(this,"heartbeat"),we(this,"relayer"),we(this,"crypto"),we(this,"storage"),we(this,"history"),we(this,"expirer"),we(this,"pairing"),we(this,"verify"),we(this,"echoClient"),we(this,"linkModeSupportedApps"),we(this,"eventClient"),we(this,"initialized",!1),we(this,"logChunkController"),we(this,"on",(a,c)=>this.events.on(a,c)),we(this,"once",(a,c)=>this.events.once(a,c)),we(this,"off",(a,c)=>this.events.off(a,c)),we(this,"removeListener",(a,c)=>this.events.removeListener(a,c)),we(this,"dispatchEnvelope",({topic:a,message:c,sessionExists:l})=>{if(!a||!c)return;const u={topic:a,message:c,publishedAt:Date.now(),transportType:ye.link_mode};this.relayer.onLinkMessageEvent(u,{sessionExists:l})});const n=this.getGlobalCore(e?.customStoragePrefix);if(n)try{return this.customStoragePrefix=n.customStoragePrefix,this.logger=n.logger,this.heartbeat=n.heartbeat,this.crypto=n.crypto,this.history=n.history,this.expirer=n.expirer,this.storage=n.storage,this.relayer=n.relayer,this.pairing=n.pairing,this.verify=n.verify,this.echoClient=n.echoClient,this.linkModeSupportedApps=n.linkModeSupportedApps,this.eventClient=n.eventClient,this.initialized=n.initialized,this.logChunkController=n.logChunkController,n}catch(a){console.warn("Failed to copy global core",a)}this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||rm,this.customStoragePrefix=e!=null&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";const i=da({level:typeof e?.logger=="string"&&e.logger?e.logger:BI.logger,name:ma}),{logger:s,chunkLoggerController:o}=$6({opts:i,maxSizeInBytes:e?.maxLogBlobSizeInBytes,loggerOverride:e?.logger});this.logChunkController=o,(r=this.logChunkController)!=null&&r.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var a,c;(a=this.logChunkController)!=null&&a.downloadLogsBlobInBrowser&&((c=this.logChunkController)==null||c.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=it(s,this.name),this.heartbeat=new Wl,this.crypto=new kS(this,this.logger,e?.keychain),this.history=new JA(this,this.logger),this.expirer=new eC(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new Zx(Bm(Bm({},LI),e?.storageOptions)),this.relayer=new pA({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new GA(this,this.logger),this.verify=new nC(this,this.logger,this.storage),this.echoClient=new oC(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new uC(this,this.logger,e?.telemetryEnabled),this.setGlobalCore(this)}static async init(e){const r=new yu(e);await r.initialize();const n=await r.crypto.getClientId();return await r.storage.setItem(ZI,n),r}get context(){return pt(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var e;return(e=this.logChunkController)==null?void 0:e.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(e){this.linkModeSupportedApps.includes(e)||(this.linkModeSupportedApps.push(e),await this.storage.setItem(nm,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.linkModeSupportedApps=await this.storage.getItem(nm)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}getGlobalCore(e=""){try{if(this.isGlobalCoreDisabled())return;const r=`_walletConnectCore_${e}`,n=`${r}_count`;return globalThis[n]=(globalThis[n]||0)+1,globalThis[n]>1&&console.warn(`WalletConnect Core is already initialized. This is probably a mistake and can lead to unexpected behavior. Init() was called ${globalThis[n]} times.`),globalThis[r]}catch(r){console.warn("Failed to get global WalletConnect core",r);return}}setGlobalCore(e){var r;try{if(this.isGlobalCoreDisabled())return;const n=`_walletConnectCore_${((r=e.opts)==null?void 0:r.customStoragePrefix)||""}`;globalThis[n]=e}catch(n){console.warn("Failed to set global WalletConnect core",n)}}isGlobalCoreDisabled(){try{return typeof process<"u"&&process.env.DISABLE_GLOBAL_CORE==="true"}catch{return!0}}}const pC=yu,Lm="wc",Mm=2,Um="client",bu=`${Lm}@${Mm}:${Um}:`,vu={name:Um,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.org"},jm="WALLETCONNECT_DEEPLINK_CHOICE",gC="proposal",Fm="Proposal expired",mC="session",xi=j.SEVEN_DAYS,wC="engine",qe={wc_sessionPropose:{req:{ttl:j.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:j.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:j.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:j.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:j.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:j.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:j.ONE_DAY,prompt:!1,tag:1104},res:{ttl:j.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:j.ONE_DAY,prompt:!1,tag:1106},res:{ttl:j.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:j.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:j.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:j.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:j.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:j.ONE_DAY,prompt:!1,tag:1112},res:{ttl:j.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:j.ONE_DAY,prompt:!1,tag:1114},res:{ttl:j.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:j.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:j.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:j.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:j.FIVE_MINUTES,prompt:!1,tag:1119}}},Eu={min:j.FIVE_MINUTES,max:j.SEVEN_DAYS},or={idle:"IDLE",active:"ACTIVE"},km={eth_sendTransaction:{key:""},eth_sendRawTransaction:{key:""},wallet_sendCalls:{key:""},solana_signTransaction:{key:"signature"},solana_signAllTransactions:{key:"transactions"},solana_signAndSendTransaction:{key:"signature"}},yC="request",bC=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],vC="wc",EC="auth",_C="authKeys",$C="pairingTopics",xC="requests",va=`${vC}@${1.5}:${EC}:`,Ea=`${va}:PUB_KEY`;var IC=Object.defineProperty,OC=Object.defineProperties,SC=Object.getOwnPropertyDescriptors,qm=Object.getOwnPropertySymbols,AC=Object.prototype.hasOwnProperty,CC=Object.prototype.propertyIsEnumerable,_u=(t,e,r)=>e in t?IC(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ge=(t,e)=>{for(var r in e||(e={}))AC.call(e,r)&&_u(t,r,e[r]);if(qm)for(var r of qm(e))CC.call(e,r)&&_u(t,r,e[r]);return t},ot=(t,e)=>OC(t,SC(e)),L=(t,e,r)=>_u(t,typeof e!="symbol"?e+"":e,r);class PC extends z6{constructor(e){super(e),L(this,"name",wC),L(this,"events",new Ve.exports),L(this,"initialized",!1),L(this,"requestQueue",{state:or.idle,queue:[]}),L(this,"sessionRequestQueue",{state:or.idle,queue:[]}),L(this,"requestQueueDelay",j.ONE_SECOND),L(this,"expectedPairingMethodMap",new Map),L(this,"recentlyDeletedMap",new Map),L(this,"recentlyDeletedLimit",200),L(this,"relayMessageCache",[]),L(this,"pendingSessions",new Map),L(this,"init",async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),await this.registerLinkModeListeners(),this.client.core.pairing.register({methods:Object.keys(qe)}),this.initialized=!0,setTimeout(async()=>{await this.processPendingMessageEvents(),this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},j.toMiliseconds(this.requestQueueDelay)))}),L(this,"connect",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();const n=ot(ge({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(n);const{pairingTopic:i,requiredNamespaces:s,optionalNamespaces:o,sessionProperties:a,scopedProperties:c,relays:l}=n;let u=i,h,d=!1;try{if(u){const S=this.client.core.pairing.pairings.get(u);this.client.logger.warn("connect() with existing pairing topic is deprecated and will be removed in the next major release."),d=S.active}}catch(S){throw this.client.logger.error(`connect() -> pairing.get(${u}) failed`),S}if(!u||!d){const{topic:S,uri:x}=await this.client.core.pairing.create();u=S,h=x}if(!u){const{message:S}=F("NO_MATCHING_KEY",`connect() pairing topic: ${u}`);throw new Error(S)}const p=await this.client.core.crypto.generateKeyPair(),f=qe.wc_sessionPropose.req.ttl||j.FIVE_MINUTES,g=Te(f),m=ot(ge(ge({requiredNamespaces:s,optionalNamespaces:o,relays:l??[{protocol:tm}],proposer:{publicKey:p,metadata:this.client.metadata},expiryTimestamp:g,pairingTopic:u},a&&{sessionProperties:a}),c&&{scopedProperties:c}),{id:tr()}),w=le("session_connect",m.id),{reject:y,resolve:E,done:_}=mn(f,Fm),O=({id:S})=>{S===m.id&&(this.client.events.off("proposal_expire",O),this.pendingSessions.delete(m.id),this.events.emit(w,{error:{message:Fm,code:0}}))};return this.client.events.on("proposal_expire",O),this.events.once(w,({error:S,session:x})=>{this.client.events.off("proposal_expire",O),S?y(S):x&&E(x)}),await this.sendRequest({topic:u,method:"wc_sessionPropose",params:m,throwOnFailedPublish:!0,clientRpcId:m.id}),await this.setProposal(m.id,m),{uri:h,approval:_}}),L(this,"pair",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{return await this.client.core.pairing.pair(r)}catch(n){throw this.client.logger.error("pair() failed"),n}}),L(this,"approve",async r=>{var n,i,s;const o=this.client.core.eventClient.createEvent({properties:{topic:(n=r?.id)==null?void 0:n.toString(),trace:[Ht.session_approve_started]}});try{this.isInitialized(),await this.confirmOnlineStateOrThrow()}catch($){throw o.setError(On.no_internet_connection),$}try{await this.isValidProposalId(r?.id)}catch($){throw this.client.logger.error(`approve() -> proposal.get(${r?.id}) failed`),o.setError(On.proposal_not_found),$}try{await this.isValidApprove(r)}catch($){throw this.client.logger.error("approve() -> isValidApprove() failed"),o.setError(On.session_approve_namespace_validation_failure),$}const{id:a,relayProtocol:c,namespaces:l,sessionProperties:u,scopedProperties:h,sessionConfig:d}=r,p=this.client.proposal.get(a);this.client.core.eventClient.deleteEvent({eventId:o.eventId});const{pairingTopic:f,proposer:g,requiredNamespaces:m,optionalNamespaces:w}=p;let y=(i=this.client.core.eventClient)==null?void 0:i.getEvent({topic:f});y||(y=(s=this.client.core.eventClient)==null?void 0:s.createEvent({type:Ht.session_approve_started,properties:{topic:f,trace:[Ht.session_approve_started,Ht.session_namespaces_validation_success]}}));const E=await this.client.core.crypto.generateKeyPair(),_=g.publicKey,O=await this.client.core.crypto.generateSharedKey(E,_),S=ge(ge(ge({relay:{protocol:c??"irn"},namespaces:l,controller:{publicKey:E,metadata:this.client.metadata},expiry:Te(xi)},u&&{sessionProperties:u}),h&&{scopedProperties:h}),d&&{sessionConfig:d}),x=ye.relay;y.addTrace(Ht.subscribing_session_topic);try{await this.client.core.relayer.subscribe(O,{transportType:x})}catch($){throw y.setError(On.subscribe_session_topic_failure),$}y.addTrace(Ht.subscribe_session_topic_success);const P=ot(ge({},S),{topic:O,requiredNamespaces:m,optionalNamespaces:w,pairingTopic:f,acknowledged:!1,self:S.controller,peer:{publicKey:g.publicKey,metadata:g.metadata},controller:E,transportType:ye.relay});await this.client.session.set(O,P),y.addTrace(Ht.store_session);try{y.addTrace(Ht.publishing_session_settle),await this.sendRequest({topic:O,method:"wc_sessionSettle",params:S,throwOnFailedPublish:!0}).catch($=>{throw y?.setError(On.session_settle_publish_failure),$}),y.addTrace(Ht.session_settle_publish_success),y.addTrace(Ht.publishing_session_approve),await this.sendResult({id:a,topic:f,result:{relay:{protocol:c??"irn"},responderPublicKey:E},throwOnFailedPublish:!0}).catch($=>{throw y?.setError(On.session_approve_publish_failure),$}),y.addTrace(Ht.session_approve_publish_success)}catch($){throw this.client.logger.error($),this.client.session.delete(O,he("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(O),$}return this.client.core.eventClient.deleteEvent({eventId:y.eventId}),await this.client.core.pairing.updateMetadata({topic:f,metadata:g.metadata}),await this.client.proposal.delete(a,he("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:f}),await this.setExpiry(O,Te(xi)),{topic:O,acknowledged:()=>Promise.resolve(this.client.session.get(O))}}),L(this,"reject",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidReject(r)}catch(o){throw this.client.logger.error("reject() -> isValidReject() failed"),o}const{id:n,reason:i}=r;let s;try{s=this.client.proposal.get(n).pairingTopic}catch(o){throw this.client.logger.error(`reject() -> proposal.get(${n}) failed`),o}s&&(await this.sendError({id:n,topic:s,error:i,rpcOpts:qe.wc_sessionPropose.reject}),await this.client.proposal.delete(n,he("USER_DISCONNECTED")))}),L(this,"update",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidUpdate(r)}catch(h){throw this.client.logger.error("update() -> isValidUpdate() failed"),h}const{topic:n,namespaces:i}=r,{done:s,resolve:o,reject:a}=mn(),c=tr(),l=xn().toString(),u=this.client.session.get(n).namespaces;return this.events.once(le("session_update",c),({error:h})=>{h?a(h):o()}),await this.client.session.update(n,{namespaces:i}),await this.sendRequest({topic:n,method:"wc_sessionUpdate",params:{namespaces:i},throwOnFailedPublish:!0,clientRpcId:c,relayRpcId:l}).catch(h=>{this.client.logger.error(h),this.client.session.update(n,{namespaces:u}),a(h)}),{acknowledged:s}}),L(this,"extend",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidExtend(r)}catch(c){throw this.client.logger.error("extend() -> isValidExtend() failed"),c}const{topic:n}=r,i=tr(),{done:s,resolve:o,reject:a}=mn();return this.events.once(le("session_extend",i),({error:c})=>{c?a(c):o()}),await this.setExpiry(n,Te(xi)),this.sendRequest({topic:n,method:"wc_sessionExtend",params:{},clientRpcId:i,throwOnFailedPublish:!0}).catch(c=>{a(c)}),{acknowledged:s}}),L(this,"request",async r=>{this.isInitialized();try{await this.isValidRequest(r)}catch(w){throw this.client.logger.error("request() -> isValidRequest() failed"),w}const{chainId:n,request:i,topic:s,expiry:o=qe.wc_sessionRequest.req.ttl}=r,a=this.client.session.get(s);a?.transportType===ye.relay&&await this.confirmOnlineStateOrThrow();const c=tr(),l=xn().toString(),{done:u,resolve:h,reject:d}=mn(o,"Request expired. Please try again.");this.events.once(le("session_request",c),({error:w,result:y})=>{w?d(w):h(y)});const p="wc_sessionRequest",f=this.getAppLinkIfEnabled(a.peer.metadata,a.transportType);if(f)return await this.sendRequest({clientRpcId:c,relayRpcId:l,topic:s,method:p,params:{request:ot(ge({},i),{expiryTimestamp:Te(o)}),chainId:n},expiry:o,throwOnFailedPublish:!0,appLink:f}).catch(w=>d(w)),this.client.events.emit("session_request_sent",{topic:s,request:i,chainId:n,id:c}),await u();const g={request:ot(ge({},i),{expiryTimestamp:Te(o)}),chainId:n},m=this.shouldSetTVF(p,g);return await Promise.all([new Promise(async w=>{await this.sendRequest(ge({clientRpcId:c,relayRpcId:l,topic:s,method:p,params:g,expiry:o,throwOnFailedPublish:!0},m&&{tvf:this.getTVFParams(c,g)})).catch(y=>d(y)),this.client.events.emit("session_request_sent",{topic:s,request:i,chainId:n,id:c}),w()}),new Promise(async w=>{var y;if(!((y=a.sessionConfig)!=null&&y.disableDeepLink)){const E=await c4(this.client.core.storage,jm);await s4({id:c,topic:s,wcDeepLink:E})}w()}),u()]).then(w=>w[2])}),L(this,"respond",async r=>{this.isInitialized(),await this.isValidRespond(r);const{topic:n,response:i}=r,{id:s}=i,o=this.client.session.get(n);o.transportType===ye.relay&&await this.confirmOnlineStateOrThrow();const a=this.getAppLinkIfEnabled(o.peer.metadata,o.transportType);rr(i)?await this.sendResult({id:s,topic:n,result:i.result,throwOnFailedPublish:!0,appLink:a}):Pt(i)&&await this.sendError({id:s,topic:n,error:i.error,appLink:a}),this.cleanupAfterResponse(r)}),L(this,"ping",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidPing(r)}catch(i){throw this.client.logger.error("ping() -> isValidPing() failed"),i}const{topic:n}=r;if(this.client.session.keys.includes(n)){const i=tr(),s=xn().toString(),{done:o,resolve:a,reject:c}=mn();this.events.once(le("session_ping",i),({error:l})=>{l?c(l):a()}),await Promise.all([this.sendRequest({topic:n,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:i,relayRpcId:s}),o()])}else this.client.core.pairing.pairings.keys.includes(n)&&(this.client.logger.warn("ping() on pairing topic is deprecated and will be removed in the next major release."),await this.client.core.pairing.ping({topic:n}))}),L(this,"emit",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidEmit(r);const{topic:n,event:i,chainId:s}=r,o=xn().toString(),a=tr();await this.sendRequest({topic:n,method:"wc_sessionEvent",params:{event:i,chainId:s},throwOnFailedPublish:!0,relayRpcId:o,clientRpcId:a})}),L(this,"disconnect",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidDisconnect(r);const{topic:n}=r;if(this.client.session.keys.includes(n))await this.sendRequest({topic:n,method:"wc_sessionDelete",params:he("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:n,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(n))await this.client.core.pairing.disconnect({topic:n});else{const{message:i}=F("MISMATCHED_TOPIC",`Session or pairing topic not found: ${n}`);throw new Error(i)}}),L(this,"find",r=>(this.isInitialized(),this.client.session.getAll().filter(n=>q$(n,r)))),L(this,"getPendingSessionRequests",()=>this.client.pendingRequest.getAll()),L(this,"authenticate",async(r,n)=>{var i;this.isInitialized(),this.isValidAuthenticate(r);const s=n&&this.client.core.linkModeSupportedApps.includes(n)&&((i=this.client.metadata.redirect)==null?void 0:i.linkMode),o=s?ye.link_mode:ye.relay;o===ye.relay&&await this.confirmOnlineStateOrThrow();const{chains:a,statement:c="",uri:l,domain:u,nonce:h,type:d,exp:p,nbf:f,methods:g=[],expiry:m}=r,w=[...r.resources||[]],{topic:y,uri:E}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:o});this.client.logger.info({message:"Generated new pairing",pairing:{topic:y,uri:E}});const _=await this.client.core.crypto.generateKeyPair(),O=ea(_);if(await Promise.all([this.client.auth.authKeys.set(Ea,{responseTopic:O,publicKey:_}),this.client.auth.pairingTopics.set(O,{topic:O,pairingTopic:y})]),await this.client.core.relayer.subscribe(O,{transportType:o}),this.client.logger.info(`sending request to new pairing topic: ${y}`),g.length>0){const{namespace:C}=oi(a[0]);let N=X4(C,"request",g);Wo(w)&&(N=t8(N,w.pop())),w.push(N)}const S=m&&m>qe.wc_sessionAuthenticate.req.ttl?m:qe.wc_sessionAuthenticate.req.ttl,x={authPayload:{type:d??"caip122",chains:a,statement:c,aud:l,domain:u,version:"1",nonce:h,iat:new Date().toISOString(),exp:p,nbf:f,resources:w},requester:{publicKey:_,metadata:this.client.metadata},expiryTimestamp:Te(S)},P={eip155:{chains:a,methods:[...new Set(["personal_sign",...g])],events:["chainChanged","accountsChanged"]}},$={requiredNamespaces:{},optionalNamespaces:P,relays:[{protocol:"irn"}],pairingTopic:y,proposer:{publicKey:_,metadata:this.client.metadata},expiryTimestamp:Te(qe.wc_sessionPropose.req.ttl),id:tr()},{done:B,resolve:D,reject:R}=mn(S,"Request expired"),M=tr(),A=le("session_connect",$.id),b=le("session_request",M),v=async({error:C,session:N})=>{this.events.off(b,I),C?R(C):N&&D({session:N})},I=async C=>{var N,U,k;if(await this.deletePendingAuthRequest(M,{message:"fulfilled",code:0}),C.error){const Q=he("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return C.error.code===Q.code?void 0:(this.events.off(A,v),R(C.error.message))}await this.deleteProposal($.id),this.events.off(A,v);const{cacaos:H,responder:q}=C.result,W=[],G=[];for(const Q of H){await wg({cacao:Q,projectId:this.client.core.projectId})||(this.client.logger.error(Q,"Signature verification failed"),R(he("SESSION_SETTLEMENT_FAILED","Signature verification failed")));const{p:Se}=Q,ve=Wo(Se.resources),_e=[vl(Se.iss)],He=Vo(Se.iss);if(ve){const Pe=vg(ve),Pr=Eg(ve);W.push(...Pe),_e.push(...Pr)}for(const Pe of _e)G.push(`${Pe}:${He}`)}const ce=await this.client.core.crypto.generateSharedKey(_,q.publicKey);let X;W.length>0&&(X={topic:ce,acknowledged:!0,self:{publicKey:_,metadata:this.client.metadata},peer:q,controller:q.publicKey,expiry:Te(xi),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:y,namespaces:d0([...new Set(W)],[...new Set(G)]),transportType:o},await this.client.core.relayer.subscribe(ce,{transportType:o}),await this.client.session.set(ce,X),y&&await this.client.core.pairing.updateMetadata({topic:y,metadata:q.metadata}),X=this.client.session.get(ce)),(N=this.client.metadata.redirect)!=null&&N.linkMode&&(U=q.metadata.redirect)!=null&&U.linkMode&&(k=q.metadata.redirect)!=null&&k.universal&&n&&(this.client.core.addLinkModeSupportedApp(q.metadata.redirect.universal),this.client.session.update(ce,{transportType:ye.link_mode})),D({auths:H,session:X})};this.events.once(A,v),this.events.once(b,I);let T;try{if(s){const C=Kr("wc_sessionAuthenticate",x,M);this.client.core.history.set(y,C);const N=await this.client.core.crypto.encode("",C,{type:Cs,encoding:Wr});T=ra(n,y,N)}else await Promise.all([this.sendRequest({topic:y,method:"wc_sessionAuthenticate",params:x,expiry:r.expiry,throwOnFailedPublish:!0,clientRpcId:M}),this.sendRequest({topic:y,method:"wc_sessionPropose",params:$,expiry:qe.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:$.id})])}catch(C){throw this.events.off(A,v),this.events.off(b,I),C}return await this.setProposal($.id,$),await this.setAuthRequest(M,{request:ot(ge({},x),{verifyContext:{}}),pairingTopic:y,transportType:o}),{uri:T??E,response:B}}),L(this,"approveSessionAuthenticate",async r=>{const{id:n,auths:i}=r,s=this.client.core.eventClient.createEvent({properties:{topic:n.toString(),trace:[Sn.authenticated_session_approve_started]}});try{this.isInitialized()}catch(m){throw s.setError(Hs.no_internet_connection),m}const o=this.getPendingAuthRequest(n);if(!o)throw s.setError(Hs.authenticated_session_pending_request_not_found),new Error(`Could not find pending auth request with id ${n}`);const a=o.transportType||ye.relay;a===ye.relay&&await this.confirmOnlineStateOrThrow();const c=o.requester.publicKey,l=await this.client.core.crypto.generateKeyPair(),u=ea(c),h={type:$r,receiverPublicKey:c,senderPublicKey:l},d=[],p=[];for(const m of i){if(!await wg({cacao:m,projectId:this.client.core.projectId})){s.setError(Hs.invalid_cacao);const O=he("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:n,topic:u,error:O,encodeOpts:h}),new Error(O.message)}s.addTrace(Sn.cacaos_verified);const{p:w}=m,y=Wo(w.resources),E=[vl(w.iss)],_=Vo(w.iss);if(y){const O=vg(y),S=Eg(y);d.push(...O),E.push(...S)}for(const O of E)p.push(`${O}:${_}`)}const f=await this.client.core.crypto.generateSharedKey(l,c);s.addTrace(Sn.create_authenticated_session_topic);let g;if(d?.length>0){g={topic:f,acknowledged:!0,self:{publicKey:l,metadata:this.client.metadata},peer:{publicKey:c,metadata:o.requester.metadata},controller:c,expiry:Te(xi),authentication:i,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:o.pairingTopic,namespaces:d0([...new Set(d)],[...new Set(p)]),transportType:a},s.addTrace(Sn.subscribing_authenticated_session_topic);try{await this.client.core.relayer.subscribe(f,{transportType:a})}catch(m){throw s.setError(Hs.subscribe_authenticated_session_topic_failure),m}s.addTrace(Sn.subscribe_authenticated_session_topic_success),await this.client.session.set(f,g),s.addTrace(Sn.store_authenticated_session),await this.client.core.pairing.updateMetadata({topic:o.pairingTopic,metadata:o.requester.metadata})}s.addTrace(Sn.publishing_authenticated_session_approve);try{await this.sendResult({topic:u,id:n,result:{cacaos:i,responder:{publicKey:l,metadata:this.client.metadata}},encodeOpts:h,throwOnFailedPublish:!0,appLink:this.getAppLinkIfEnabled(o.requester.metadata,a)})}catch(m){throw s.setError(Hs.authenticated_session_approve_publish_failure),m}return await this.client.auth.requests.delete(n,{message:"fulfilled",code:0}),await this.client.core.pairing.activate({topic:o.pairingTopic}),this.client.core.eventClient.deleteEvent({eventId:s.eventId}),{session:g}}),L(this,"rejectSessionAuthenticate",async r=>{this.isInitialized();const{id:n,reason:i}=r,s=this.getPendingAuthRequest(n);if(!s)throw new Error(`Could not find pending auth request with id ${n}`);s.transportType===ye.relay&&await this.confirmOnlineStateOrThrow();const o=s.requester.publicKey,a=await this.client.core.crypto.generateKeyPair(),c=ea(o),l={type:$r,receiverPublicKey:o,senderPublicKey:a};await this.sendError({id:n,topic:c,error:i,encodeOpts:l,rpcOpts:qe.wc_sessionAuthenticate.reject,appLink:this.getAppLinkIfEnabled(s.requester.metadata,s.transportType)}),await this.client.auth.requests.delete(n,{message:"rejected",code:0}),await this.client.proposal.delete(n,he("USER_DISCONNECTED"))}),L(this,"formatAuthMessage",r=>{this.isInitialized();const{request:n,iss:i}=r;return yg(n,i)}),L(this,"processRelayMessageCache",()=>{setTimeout(async()=>{if(this.relayMessageCache.length!==0)for(;this.relayMessageCache.length>0;)try{const r=this.relayMessageCache.shift();r&&await this.onRelayMessage(r)}catch(r){this.client.logger.error(r)}},50)}),L(this,"cleanupDuplicatePairings",async r=>{if(r.pairingTopic)try{const n=this.client.core.pairing.pairings.get(r.pairingTopic),i=this.client.core.pairing.pairings.getAll().filter(s=>{var o,a;return((o=s.peerMetadata)==null?void 0:o.url)&&((a=s.peerMetadata)==null?void 0:a.url)===r.peer.metadata.url&&s.topic&&s.topic!==n.topic});if(i.length===0)return;this.client.logger.info(`Cleaning up ${i.length} duplicate pairing(s)`),await Promise.all(i.map(s=>this.client.core.pairing.disconnect({topic:s.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(n){this.client.logger.error(n)}}),L(this,"deleteSession",async r=>{var n;const{topic:i,expirerHasDeleted:s=!1,emitEvent:o=!0,id:a=0}=r,{self:c}=this.client.session.get(i);await this.client.core.relayer.unsubscribe(i),await this.client.session.delete(i,he("USER_DISCONNECTED")),this.addToRecentlyDeleted(i,"session"),this.client.core.crypto.keychain.has(c.publicKey)&&await this.client.core.crypto.deleteKeyPair(c.publicKey),this.client.core.crypto.keychain.has(i)&&await this.client.core.crypto.deleteSymKey(i),s||this.client.core.expirer.del(i),this.client.core.storage.removeItem(jm).catch(l=>this.client.logger.warn(l)),this.getPendingSessionRequests().forEach(l=>{l.topic===i&&this.deletePendingSessionRequest(l.id,he("USER_DISCONNECTED"))}),i===((n=this.sessionRequestQueue.queue[0])==null?void 0:n.topic)&&(this.sessionRequestQueue.state=or.idle),o&&this.client.events.emit("session_delete",{id:a,topic:i})}),L(this,"deleteProposal",async(r,n)=>{if(n)try{const i=this.client.proposal.get(r),s=this.client.core.eventClient.getEvent({topic:i.pairingTopic});s?.setError(On.proposal_expired)}catch{}await Promise.all([this.client.proposal.delete(r,he("USER_DISCONNECTED")),n?Promise.resolve():this.client.core.expirer.del(r)]),this.addToRecentlyDeleted(r,"proposal")}),L(this,"deletePendingSessionRequest",async(r,n,i=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,n),i?Promise.resolve():this.client.core.expirer.del(r)]),this.addToRecentlyDeleted(r,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(s=>s.id!==r),i&&(this.sessionRequestQueue.state=or.idle,this.client.events.emit("session_request_expire",{id:r}))}),L(this,"deletePendingAuthRequest",async(r,n,i=!1)=>{await Promise.all([this.client.auth.requests.delete(r,n),i?Promise.resolve():this.client.core.expirer.del(r)])}),L(this,"setExpiry",async(r,n)=>{this.client.session.keys.includes(r)&&(this.client.core.expirer.set(r,n),await this.client.session.update(r,{expiry:n}))}),L(this,"setProposal",async(r,n)=>{this.client.core.expirer.set(r,Te(qe.wc_sessionPropose.req.ttl)),await this.client.proposal.set(r,n)}),L(this,"setAuthRequest",async(r,n)=>{const{request:i,pairingTopic:s,transportType:o=ye.relay}=n;this.client.core.expirer.set(r,i.expiryTimestamp),await this.client.auth.requests.set(r,{authPayload:i.authPayload,requester:i.requester,expiryTimestamp:i.expiryTimestamp,id:r,pairingTopic:s,verifyContext:i.verifyContext,transportType:o})}),L(this,"setPendingSessionRequest",async r=>{const{id:n,topic:i,params:s,verifyContext:o}=r,a=s.request.expiryTimestamp||Te(qe.wc_sessionRequest.req.ttl);this.client.core.expirer.set(n,a),await this.client.pendingRequest.set(n,{id:n,topic:i,params:s,verifyContext:o})}),L(this,"sendRequest",async r=>{const{topic:n,method:i,params:s,expiry:o,relayRpcId:a,clientRpcId:c,throwOnFailedPublish:l,appLink:u,tvf:h}=r,d=Kr(i,s,c);let p;const f=!!u;try{const w=f?Wr:kt;p=await this.client.core.crypto.encode(n,d,{encoding:w})}catch(w){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${n} failed`),w}let g;if(bC.includes(i)){const w=Qt(JSON.stringify(d)),y=Qt(p);g=await this.client.core.verify.register({id:y,decryptedId:w})}const m=qe[i].req;if(m.attestation=g,o&&(m.ttl=o),a&&(m.id=a),this.client.core.history.set(n,d),f){const w=ra(u,n,p);await global.Linking.openURL(w,this.client.name)}else{const w=qe[i].req;o&&(w.ttl=o),a&&(w.id=a),w.tvf=ot(ge({},h),{correlationId:d.id}),l?(w.internal=ot(ge({},w.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(n,p,w)):this.client.core.relayer.publish(n,p,w).catch(y=>this.client.logger.error(y))}return d.id}),L(this,"sendResult",async r=>{const{id:n,topic:i,result:s,throwOnFailedPublish:o,encodeOpts:a,appLink:c}=r,l=fa(n,s);let u;const h=c&&typeof(global==null?void 0:global.Linking)<"u";try{const f=h?Wr:kt;u=await this.client.core.crypto.encode(i,l,ot(ge({},a||{}),{encoding:f}))}catch(f){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${i} failed`),f}let d,p;try{d=await this.client.core.history.get(i,n);const f=d.request;try{this.shouldSetTVF(f.method,f.params)&&(p=this.getTVFParams(n,f.params,s))}catch(g){this.client.logger.warn("sendResult() -> getTVFParams() failed",g)}}catch(f){throw this.client.logger.error(`sendResult() -> history.get(${i}, ${n}) failed`),f}if(h){const f=ra(c,i,u);await global.Linking.openURL(f,this.client.name)}else{const f=d.request.method,g=qe[f].res;g.tvf=ot(ge({},p),{correlationId:n}),o?(g.internal=ot(ge({},g.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(i,u,g)):this.client.core.relayer.publish(i,u,g).catch(m=>this.client.logger.error(m))}await this.client.core.history.resolve(l)}),L(this,"sendError",async r=>{const{id:n,topic:i,error:s,encodeOpts:o,rpcOpts:a,appLink:c}=r,l=pa(n,s);let u;const h=c&&typeof(global==null?void 0:global.Linking)<"u";try{const p=h?Wr:kt;u=await this.client.core.crypto.encode(i,l,ot(ge({},o||{}),{encoding:p}))}catch(p){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${i} failed`),p}let d;try{d=await this.client.core.history.get(i,n)}catch(p){throw this.client.logger.error(`sendError() -> history.get(${i}, ${n}) failed`),p}if(h){const p=ra(c,i,u);await global.Linking.openURL(p,this.client.name)}else{const p=d.request.method,f=a||qe[p].res;this.client.core.relayer.publish(i,u,f)}await this.client.core.history.resolve(l)}),L(this,"cleanup",async()=>{const r=[],n=[];this.client.session.getAll().forEach(i=>{let s=!1;qr(i.expiry)&&(s=!0),this.client.core.crypto.keychain.has(i.topic)||(s=!0),s&&r.push(i.topic)}),this.client.proposal.getAll().forEach(i=>{qr(i.expiryTimestamp)&&n.push(i.id)}),await Promise.all([...r.map(i=>this.deleteSession({topic:i})),...n.map(i=>this.deleteProposal(i))])}),L(this,"onProviderMessageEvent",async r=>{!this.initialized||this.relayMessageCache.length>0?this.relayMessageCache.push(r):await this.onRelayMessage(r)}),L(this,"onRelayEventRequest",async r=>{this.requestQueue.queue.push(r),await this.processRequestsQueue()}),L(this,"processRequestsQueue",async()=>{if(this.requestQueue.state===or.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=or.active;const r=this.requestQueue.queue.shift();if(r)try{await this.processRequest(r)}catch(n){this.client.logger.warn(n)}}this.requestQueue.state=or.idle}),L(this,"processRequest",async r=>{const{topic:n,payload:i,attestation:s,transportType:o,encryptedId:a}=r,c=i.method;if(!this.shouldIgnorePairingRequest({topic:n,requestMethod:c}))switch(c){case"wc_sessionPropose":return await this.onSessionProposeRequest({topic:n,payload:i,attestation:s,encryptedId:a});case"wc_sessionSettle":return await this.onSessionSettleRequest(n,i);case"wc_sessionUpdate":return await this.onSessionUpdateRequest(n,i);case"wc_sessionExtend":return await this.onSessionExtendRequest(n,i);case"wc_sessionPing":return await this.onSessionPingRequest(n,i);case"wc_sessionDelete":return await this.onSessionDeleteRequest(n,i);case"wc_sessionRequest":return await this.onSessionRequest({topic:n,payload:i,attestation:s,encryptedId:a,transportType:o});case"wc_sessionEvent":return await this.onSessionEventRequest(n,i);case"wc_sessionAuthenticate":return await this.onSessionAuthenticateRequest({topic:n,payload:i,attestation:s,encryptedId:a,transportType:o});default:return this.client.logger.info(`Unsupported request method ${c}`)}}),L(this,"onRelayEventResponse",async r=>{const{topic:n,payload:i,transportType:s}=r,o=(await this.client.core.history.get(n,i.id)).request.method;switch(o){case"wc_sessionPropose":return this.onSessionProposeResponse(n,i,s);case"wc_sessionSettle":return this.onSessionSettleResponse(n,i);case"wc_sessionUpdate":return this.onSessionUpdateResponse(n,i);case"wc_sessionExtend":return this.onSessionExtendResponse(n,i);case"wc_sessionPing":return this.onSessionPingResponse(n,i);case"wc_sessionRequest":return this.onSessionRequestResponse(n,i);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(n,i);default:return this.client.logger.info(`Unsupported response method ${o}`)}}),L(this,"onRelayEventUnknownPayload",r=>{const{topic:n}=r,{message:i}=F("MISSING_OR_INVALID",`Decoded payload on topic ${n} is not identifiable as a JSON-RPC request or a response.`);throw new Error(i)}),L(this,"shouldIgnorePairingRequest",r=>{const{topic:n,requestMethod:i}=r,s=this.expectedPairingMethodMap.get(n);return!s||s.includes(i)?!1:!!(s.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0)}),L(this,"onSessionProposeRequest",async r=>{const{topic:n,payload:i,attestation:s,encryptedId:o}=r,{params:a,id:c}=i;try{const l=this.client.core.eventClient.getEvent({topic:n});this.client.events.listenerCount("session_proposal")===0&&(console.warn("No listener for session_proposal event"),l?.setError(Or.proposal_listener_not_found)),this.isValidConnect(ge({},i.params));const u=a.expiryTimestamp||Te(qe.wc_sessionPropose.req.ttl),h=ge({id:c,pairingTopic:n,expiryTimestamp:u},a);await this.setProposal(c,h);const d=await this.getVerifyContext({attestationId:s,hash:Qt(JSON.stringify(i)),encryptedId:o,metadata:h.proposer.metadata});l?.addTrace(ir.emit_session_proposal),this.client.events.emit("session_proposal",{id:c,params:h,verifyContext:d})}catch(l){await this.sendError({id:c,topic:n,error:l,rpcOpts:qe.wc_sessionPropose.autoReject}),this.client.logger.error(l)}}),L(this,"onSessionProposeResponse",async(r,n,i)=>{const{id:s}=n;if(rr(n)){const{result:o}=n;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:o});const a=this.client.proposal.get(s);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:a});const c=a.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:c});const l=o.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:l});const u=await this.client.core.crypto.generateSharedKey(c,l);this.pendingSessions.set(s,{sessionTopic:u,pairingTopic:r,proposalId:s,publicKey:c});const h=await this.client.core.relayer.subscribe(u,{transportType:i});this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:h}),await this.client.core.pairing.activate({topic:r})}else if(Pt(n)){await this.client.proposal.delete(s,he("USER_DISCONNECTED"));const o=le("session_connect",s);if(this.events.listenerCount(o)===0)throw new Error(`emitting ${o} without any listeners, 954`);this.events.emit(o,{error:n.error})}}),L(this,"onSessionSettleRequest",async(r,n)=>{const{id:i,params:s}=n;try{this.isValidSessionSettleRequest(s);const{relay:o,controller:a,expiry:c,namespaces:l,sessionProperties:u,scopedProperties:h,sessionConfig:d}=n.params,p=[...this.pendingSessions.values()].find(m=>m.sessionTopic===r);if(!p)return this.client.logger.error(`Pending session not found for topic ${r}`);const f=this.client.proposal.get(p.proposalId),g=ot(ge(ge(ge({topic:r,relay:o,expiry:c,namespaces:l,acknowledged:!0,pairingTopic:p.pairingTopic,requiredNamespaces:f.requiredNamespaces,optionalNamespaces:f.optionalNamespaces,controller:a.publicKey,self:{publicKey:p.publicKey,metadata:this.client.metadata},peer:{publicKey:a.publicKey,metadata:a.metadata}},u&&{sessionProperties:u}),h&&{scopedProperties:h}),d&&{sessionConfig:d}),{transportType:ye.relay});await this.client.session.set(g.topic,g),await this.setExpiry(g.topic,g.expiry),await this.client.core.pairing.updateMetadata({topic:p.pairingTopic,metadata:g.peer.metadata}),this.client.events.emit("session_connect",{session:g}),this.events.emit(le("session_connect",p.proposalId),{session:g}),this.pendingSessions.delete(p.proposalId),this.deleteProposal(p.proposalId,!1),this.cleanupDuplicatePairings(g),await this.sendResult({id:n.id,topic:r,result:!0,throwOnFailedPublish:!0})}catch(o){await this.sendError({id:i,topic:r,error:o}),this.client.logger.error(o)}}),L(this,"onSessionSettleResponse",async(r,n)=>{const{id:i}=n;rr(n)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(le("session_approve",i),{})):Pt(n)&&(await this.client.session.delete(r,he("USER_DISCONNECTED")),this.events.emit(le("session_approve",i),{error:n.error}))}),L(this,"onSessionUpdateRequest",async(r,n)=>{const{params:i,id:s}=n;try{const o=`${r}_session_update`,a=Bs.get(o);if(a&&this.isRequestOutOfSync(a,s)){this.client.logger.warn(`Discarding out of sync request - ${s}`),this.sendError({id:s,topic:r,error:he("INVALID_UPDATE_REQUEST")});return}this.isValidUpdate(ge({topic:r},i));try{Bs.set(o,s),await this.client.session.update(r,{namespaces:i.namespaces}),await this.sendResult({id:s,topic:r,result:!0,throwOnFailedPublish:!0})}catch(c){throw Bs.delete(o),c}this.client.events.emit("session_update",{id:s,topic:r,params:i})}catch(o){await this.sendError({id:s,topic:r,error:o}),this.client.logger.error(o)}}),L(this,"isRequestOutOfSync",(r,n)=>n.toString().slice(0,-3)<r.toString().slice(0,-3)),L(this,"onSessionUpdateResponse",(r,n)=>{const{id:i}=n,s=le("session_update",i);if(this.events.listenerCount(s)===0)throw new Error(`emitting ${s} without any listeners`);rr(n)?this.events.emit(le("session_update",i),{}):Pt(n)&&this.events.emit(le("session_update",i),{error:n.error})}),L(this,"onSessionExtendRequest",async(r,n)=>{const{id:i}=n;try{this.isValidExtend({topic:r}),await this.setExpiry(r,Te(xi)),await this.sendResult({id:i,topic:r,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_extend",{id:i,topic:r})}catch(s){await this.sendError({id:i,topic:r,error:s}),this.client.logger.error(s)}}),L(this,"onSessionExtendResponse",(r,n)=>{const{id:i}=n,s=le("session_extend",i);if(this.events.listenerCount(s)===0)throw new Error(`emitting ${s} without any listeners`);rr(n)?this.events.emit(le("session_extend",i),{}):Pt(n)&&this.events.emit(le("session_extend",i),{error:n.error})}),L(this,"onSessionPingRequest",async(r,n)=>{const{id:i}=n;try{this.isValidPing({topic:r}),await this.sendResult({id:i,topic:r,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:i,topic:r})}catch(s){await this.sendError({id:i,topic:r,error:s}),this.client.logger.error(s)}}),L(this,"onSessionPingResponse",(r,n)=>{const{id:i}=n,s=le("session_ping",i);setTimeout(()=>{if(this.events.listenerCount(s)===0)throw new Error(`emitting ${s} without any listeners 2176`);rr(n)?this.events.emit(le("session_ping",i),{}):Pt(n)&&this.events.emit(le("session_ping",i),{error:n.error})},500)}),L(this,"onSessionDeleteRequest",async(r,n)=>{const{id:i}=n;try{this.isValidDisconnect({topic:r,reason:n.params}),Promise.all([new Promise(s=>{this.client.core.relayer.once(Fe.publish,async()=>{s(await this.deleteSession({topic:r,id:i}))})}),this.sendResult({id:i,topic:r,result:!0,throwOnFailedPublish:!0}),this.cleanupPendingSentRequestsForTopic({topic:r,error:he("USER_DISCONNECTED")})]).catch(s=>this.client.logger.error(s))}catch(s){this.client.logger.error(s)}}),L(this,"onSessionRequest",async r=>{var n,i,s;const{topic:o,payload:a,attestation:c,encryptedId:l,transportType:u}=r,{id:h,params:d}=a;try{await this.isValidRequest(ge({topic:o},d));const p=this.client.session.get(o),f=await this.getVerifyContext({attestationId:c,hash:Qt(JSON.stringify(Kr("wc_sessionRequest",d,h))),encryptedId:l,metadata:p.peer.metadata,transportType:u}),g={id:h,topic:o,params:d,verifyContext:f};await this.setPendingSessionRequest(g),u===ye.link_mode&&(n=p.peer.metadata.redirect)!=null&&n.universal&&this.client.core.addLinkModeSupportedApp((i=p.peer.metadata.redirect)==null?void 0:i.universal),(s=this.client.signConfig)!=null&&s.disableRequestQueue?this.emitSessionRequest(g):(this.addSessionRequestToSessionRequestQueue(g),this.processSessionRequestQueue())}catch(p){await this.sendError({id:h,topic:o,error:p}),this.client.logger.error(p)}}),L(this,"onSessionRequestResponse",(r,n)=>{const{id:i}=n,s=le("session_request",i);if(this.events.listenerCount(s)===0)throw new Error(`emitting ${s} without any listeners`);rr(n)?this.events.emit(le("session_request",i),{result:n.result}):Pt(n)&&this.events.emit(le("session_request",i),{error:n.error})}),L(this,"onSessionEventRequest",async(r,n)=>{const{id:i,params:s}=n;try{const o=`${r}_session_event_${s.event.name}`,a=Bs.get(o);if(a&&this.isRequestOutOfSync(a,i)){this.client.logger.info(`Discarding out of sync request - ${i}`);return}this.isValidEmit(ge({topic:r},s)),this.client.events.emit("session_event",{id:i,topic:r,params:s}),Bs.set(o,i)}catch(o){await this.sendError({id:i,topic:r,error:o}),this.client.logger.error(o)}}),L(this,"onSessionAuthenticateResponse",(r,n)=>{const{id:i}=n;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:r,payload:n}),rr(n)?this.events.emit(le("session_request",i),{result:n.result}):Pt(n)&&this.events.emit(le("session_request",i),{error:n.error})}),L(this,"onSessionAuthenticateRequest",async r=>{var n;const{topic:i,payload:s,attestation:o,encryptedId:a,transportType:c}=r;try{const{requester:l,authPayload:u,expiryTimestamp:h}=s.params,d=await this.getVerifyContext({attestationId:o,hash:Qt(JSON.stringify(s)),encryptedId:a,metadata:l.metadata,transportType:c}),p={requester:l,pairingTopic:i,id:s.id,authPayload:u,verifyContext:d,expiryTimestamp:h};await this.setAuthRequest(s.id,{request:p,pairingTopic:i,transportType:c}),c===ye.link_mode&&(n=l.metadata.redirect)!=null&&n.universal&&this.client.core.addLinkModeSupportedApp(l.metadata.redirect.universal),this.client.events.emit("session_authenticate",{topic:i,params:s.params,id:s.id,verifyContext:d})}catch(l){this.client.logger.error(l);const u=s.params.requester.publicKey,h=await this.client.core.crypto.generateKeyPair(),d=this.getAppLinkIfEnabled(s.params.requester.metadata,c),p={type:$r,receiverPublicKey:u,senderPublicKey:h};await this.sendError({id:s.id,topic:i,error:l,encodeOpts:p,rpcOpts:qe.wc_sessionAuthenticate.autoReject,appLink:d})}}),L(this,"addSessionRequestToSessionRequestQueue",r=>{this.sessionRequestQueue.queue.push(r)}),L(this,"cleanupAfterResponse",r=>{this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=or.idle,this.processSessionRequestQueue()},j.toMiliseconds(this.requestQueueDelay))}),L(this,"cleanupPendingSentRequestsForTopic",({topic:r,error:n})=>{const i=this.client.core.history.pending;i.length>0&&i.filter(s=>s.topic===r&&s.request.method==="wc_sessionRequest").forEach(s=>{const o=s.request.id,a=le("session_request",o);if(this.events.listenerCount(a)===0)throw new Error(`emitting ${a} without any listeners`);this.events.emit(le("session_request",s.request.id),{error:n})})}),L(this,"processSessionRequestQueue",()=>{if(this.sessionRequestQueue.state===or.active){this.client.logger.info("session request queue is already active.");return}const r=this.sessionRequestQueue.queue[0];if(!r){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=or.active,this.emitSessionRequest(r)}catch(n){this.client.logger.error(n)}}),L(this,"emitSessionRequest",r=>{this.client.events.emit("session_request",r)}),L(this,"onPairingCreated",r=>{if(r.methods&&this.expectedPairingMethodMap.set(r.topic,r.methods),r.active)return;const n=this.client.proposal.getAll().find(i=>i.pairingTopic===r.topic);n&&this.onSessionProposeRequest({topic:r.topic,payload:Kr("wc_sessionPropose",ot(ge({},n),{requiredNamespaces:n.requiredNamespaces,optionalNamespaces:n.optionalNamespaces,relays:n.relays,proposer:n.proposer,sessionProperties:n.sessionProperties,scopedProperties:n.scopedProperties}),n.id)})}),L(this,"isValidConnect",async r=>{if(!dt(r)){const{message:l}=F("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(l)}const{pairingTopic:n,requiredNamespaces:i,optionalNamespaces:s,sessionProperties:o,scopedProperties:a,relays:c}=r;if(Ze(n)||await this.isValidPairingTopic(n),!ex(c,!0)){const{message:l}=F("MISSING_OR_INVALID",`connect() relays: ${c}`);throw new Error(l)}if(!Ze(i)&&Ns(i)!==0&&this.validateNamespaces(i,"requiredNamespaces"),!Ze(s)&&Ns(s)!==0&&this.validateNamespaces(s,"optionalNamespaces"),Ze(o)||this.validateSessionProps(o,"sessionProperties"),!Ze(a)){this.validateSessionProps(a,"scopedProperties");const l=Object.keys(i||{}).concat(Object.keys(s||{}));if(!Object.keys(a).every(u=>l.includes(u)))throw new Error(`Scoped properties must be a subset of required/optional namespaces, received: ${JSON.stringify(a)}, required/optional namespaces: ${JSON.stringify(l)}`)}}),L(this,"validateNamespaces",(r,n)=>{const i=X$(r,"connect()",n);if(i)throw new Error(i.message)}),L(this,"isValidApprove",async r=>{if(!dt(r))throw new Error(F("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:n,namespaces:i,relayProtocol:s,sessionProperties:o,scopedProperties:a}=r;this.checkRecentlyDeleted(n),await this.isValidProposalId(n);const c=this.client.proposal.get(n),l=Hl(i,"approve()");if(l)throw new Error(l.message);const u=w0(c.requiredNamespaces,i,"approve()");if(u)throw new Error(u.message);if(!Ae(s,!0)){const{message:h}=F("MISSING_OR_INVALID",`approve() relayProtocol: ${s}`);throw new Error(h)}if(Ze(o)||this.validateSessionProps(o,"sessionProperties"),!Ze(a)){this.validateSessionProps(a,"scopedProperties");const h=new Set(Object.keys(i));if(!Object.keys(a).every(d=>h.has(d)))throw new Error(`Scoped properties must be a subset of approved namespaces, received: ${JSON.stringify(a)}, approved namespaces: ${Array.from(h).join(", ")}`)}}),L(this,"isValidReject",async r=>{if(!dt(r)){const{message:s}=F("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(s)}const{id:n,reason:i}=r;if(this.checkRecentlyDeleted(n),await this.isValidProposalId(n),!rx(i)){const{message:s}=F("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(i)}`);throw new Error(s)}}),L(this,"isValidSessionSettleRequest",r=>{if(!dt(r)){const{message:l}=F("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(l)}const{relay:n,controller:i,namespaces:s,expiry:o}=r;if(!g0(n)){const{message:l}=F("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(l)}const a=K$(i,"onSessionSettleRequest()");if(a)throw new Error(a.message);const c=Hl(s,"onSessionSettleRequest()");if(c)throw new Error(c.message);if(qr(o)){const{message:l}=F("EXPIRED","onSessionSettleRequest()");throw new Error(l)}}),L(this,"isValidUpdate",async r=>{if(!dt(r)){const{message:c}=F("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(c)}const{topic:n,namespaces:i}=r;this.checkRecentlyDeleted(n),await this.isValidSessionTopic(n);const s=this.client.session.get(n),o=Hl(i,"update()");if(o)throw new Error(o.message);const a=w0(s.requiredNamespaces,i,"update()");if(a)throw new Error(a.message)}),L(this,"isValidExtend",async r=>{if(!dt(r)){const{message:i}=F("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(i)}const{topic:n}=r;this.checkRecentlyDeleted(n),await this.isValidSessionTopic(n)}),L(this,"isValidRequest",async r=>{if(!dt(r)){const{message:c}=F("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(c)}const{topic:n,request:i,chainId:s,expiry:o}=r;this.checkRecentlyDeleted(n),await this.isValidSessionTopic(n);const{namespaces:a}=this.client.session.get(n);if(!m0(a,s)){const{message:c}=F("MISSING_OR_INVALID",`request() chainId: ${s}`);throw new Error(c)}if(!nx(i)){const{message:c}=F("MISSING_OR_INVALID",`request() ${JSON.stringify(i)}`);throw new Error(c)}if(!ox(a,s,i.method)){const{message:c}=F("MISSING_OR_INVALID",`request() method: ${i.method}`);throw new Error(c)}if(o&&!ux(o,Eu)){const{message:c}=F("MISSING_OR_INVALID",`request() expiry: ${o}. Expiry must be a number (in seconds) between ${Eu.min} and ${Eu.max}`);throw new Error(c)}}),L(this,"isValidRespond",async r=>{var n;if(!dt(r)){const{message:o}=F("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(o)}const{topic:i,response:s}=r;try{await this.isValidSessionTopic(i)}catch(o){throw(n=r?.response)!=null&&n.id&&this.cleanupAfterResponse(r),o}if(!ix(s)){const{message:o}=F("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(s)}`);throw new Error(o)}}),L(this,"isValidPing",async r=>{if(!dt(r)){const{message:i}=F("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(i)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)}),L(this,"isValidEmit",async r=>{if(!dt(r)){const{message:a}=F("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(a)}const{topic:n,event:i,chainId:s}=r;await this.isValidSessionTopic(n);const{namespaces:o}=this.client.session.get(n);if(!m0(o,s)){const{message:a}=F("MISSING_OR_INVALID",`emit() chainId: ${s}`);throw new Error(a)}if(!sx(i)){const{message:a}=F("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(i)}`);throw new Error(a)}if(!ax(o,s,i.name)){const{message:a}=F("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(i)}`);throw new Error(a)}}),L(this,"isValidDisconnect",async r=>{if(!dt(r)){const{message:i}=F("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(i)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)}),L(this,"isValidAuthenticate",r=>{const{chains:n,uri:i,domain:s,nonce:o}=r;if(!Array.isArray(n)||n.length===0)throw new Error("chains is required and must be a non-empty array");if(!Ae(i,!1))throw new Error("uri is required parameter");if(!Ae(s,!1))throw new Error("domain is required parameter");if(!Ae(o,!1))throw new Error("nonce is required parameter");if([...new Set(n.map(c=>oi(c).namespace))].length>1)throw new Error("Multi-namespace requests are not supported. Please request single namespace only.");const{namespace:a}=oi(n[0]);if(a!=="eip155")throw new Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")}),L(this,"getVerifyContext",async r=>{const{attestationId:n,hash:i,encryptedId:s,metadata:o,transportType:a}=r,c={verified:{verifyUrl:o.verifyUrl||zs,validation:"UNKNOWN",origin:o.url||""}};try{if(a===ye.link_mode){const u=this.getAppLinkIfEnabled(o,a);return c.verified.validation=u&&new URL(u).origin===new URL(o.url).origin?"VALID":"INVALID",c}const l=await this.client.core.verify.resolve({attestationId:n,hash:i,encryptedId:s,verifyUrl:o.verifyUrl});l&&(c.verified.origin=l.origin,c.verified.isScam=l.isScam,c.verified.validation=l.origin===new URL(o.url).origin?"VALID":"INVALID")}catch(l){this.client.logger.warn(l)}return this.client.logger.debug(`Verify context: ${JSON.stringify(c)}`),c}),L(this,"validateSessionProps",(r,n)=>{Object.values(r).forEach((i,s)=>{if(i==null){const{message:o}=F("MISSING_OR_INVALID",`${n} must contain an existing value for each key. Received: ${i} for key ${Object.keys(r)[s]}`);throw new Error(o)}})}),L(this,"getPendingAuthRequest",r=>{const n=this.client.auth.requests.get(r);return typeof n=="object"?n:void 0}),L(this,"addToRecentlyDeleted",(r,n)=>{if(this.recentlyDeletedMap.set(r,n),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let i=0;const s=this.recentlyDeletedLimit/2;for(const o of this.recentlyDeletedMap.keys()){if(i++>=s)break;this.recentlyDeletedMap.delete(o)}}}),L(this,"checkRecentlyDeleted",r=>{const n=this.recentlyDeletedMap.get(r);if(n){const{message:i}=F("MISSING_OR_INVALID",`Record was recently deleted - ${n}: ${r}`);throw new Error(i)}}),L(this,"isLinkModeEnabled",(r,n)=>{var i,s,o,a,c,l,u,h,d;return!r||n!==ye.link_mode?!1:((s=(i=this.client.metadata)==null?void 0:i.redirect)==null?void 0:s.linkMode)===!0&&((a=(o=this.client.metadata)==null?void 0:o.redirect)==null?void 0:a.universal)!==void 0&&((l=(c=this.client.metadata)==null?void 0:c.redirect)==null?void 0:l.universal)!==""&&((u=r?.redirect)==null?void 0:u.universal)!==void 0&&((h=r?.redirect)==null?void 0:h.universal)!==""&&((d=r?.redirect)==null?void 0:d.linkMode)===!0&&this.client.core.linkModeSupportedApps.includes(r.redirect.universal)&&typeof(global==null?void 0:global.Linking)<"u"}),L(this,"getAppLinkIfEnabled",(r,n)=>{var i;return this.isLinkModeEnabled(r,n)?(i=r?.redirect)==null?void 0:i.universal:void 0}),L(this,"handleLinkModeMessage",({url:r})=>{if(!r||!r.includes("wc_ev")||!r.includes("topic"))return;const n=tg(r,"topic")||"",i=decodeURIComponent(tg(r,"wc_ev")||""),s=this.client.session.keys.includes(n);s&&this.client.session.update(n,{transportType:ye.link_mode}),this.client.core.dispatchEnvelope({topic:n,message:i,sessionExists:s})}),L(this,"registerLinkModeListeners",async()=>{var r;if(pl()||Fr()&&(r=this.client.metadata.redirect)!=null&&r.linkMode){const n=global==null?void 0:global.Linking;if(typeof n<"u"){n.addEventListener("url",this.handleLinkModeMessage,this.client.name);const i=await n.getInitialURL();i&&setTimeout(()=>{this.handleLinkModeMessage({url:i})},50)}}}),L(this,"shouldSetTVF",(r,n)=>{if(!n||r!=="wc_sessionRequest")return!1;const{request:i}=n;return Object.keys(km).includes(i.method)}),L(this,"getTVFParams",(r,n,i)=>{var s,o;try{const a=n.request.method,c=this.extractTxHashesFromResult(a,i);return ot(ge({correlationId:r,rpcMethods:[a],chainId:n.chainId},this.isValidContractData(n.request.params)&&{contractAddresses:[(o=(s=n.request.params)==null?void 0:s[0])==null?void 0:o.to]}),{txHashes:c})}catch(a){this.client.logger.warn("Error getting TVF params",a)}return{}}),L(this,"isValidContractData",r=>{var n;if(!r)return!1;try{const i=r?.data||((n=r?.[0])==null?void 0:n.data);if(!i.startsWith("0x"))return!1;const s=i.slice(2);return/^[0-9a-fA-F]*$/.test(s)?s.length%2===0:!1}catch{}return!1}),L(this,"extractTxHashesFromResult",(r,n)=>{try{const i=km[r];if(typeof n=="string")return[n];const s=n[i.key];if(qt(s))return r==="solana_signAllTransactions"?s.map(o=>j4(o)):s;if(typeof s=="string")return[s]}catch(i){this.client.logger.warn("Error extracting tx hashes from result",i)}return[]})}async processPendingMessageEvents(){try{const e=this.client.session.keys,r=this.client.core.relayer.messages.getWithoutAck(e);for(const[n,i]of Object.entries(r))for(const s of i)try{await this.onProviderMessageEvent({topic:n,message:s,publishedAt:Date.now()})}catch{this.client.logger.warn(`Error processing pending message event for topic: ${n}, message: ${s}`)}}catch(e){this.client.logger.warn("processPendingMessageEvents failed",e)}}isInitialized(){if(!this.initialized){const{message:e}=F("NOT_INITIALIZED",this.name);throw new Error(e)}}async confirmOnlineStateOrThrow(){await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(Fe.message,e=>{this.onProviderMessageEvent(e)})}async onRelayMessage(e){const{topic:r,message:n,attestation:i,transportType:s}=e,{publicKey:o}=this.client.auth.authKeys.keys.includes(Ea)?this.client.auth.authKeys.get(Ea):{responseTopic:void 0,publicKey:void 0};try{const a=await this.client.core.crypto.decode(r,n,{receiverPublicKey:o,encoding:s===ye.link_mode?Wr:kt});nu(a)?(this.client.core.history.set(r,a),await this.onRelayEventRequest({topic:r,payload:a,attestation:i,transportType:s,encryptedId:Qt(n)})):ga(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:r,payload:a,transportType:s}),this.client.core.history.delete(r,a.id)):await this.onRelayEventUnknownPayload({topic:r,payload:a,transportType:s}),await this.client.core.relayer.messages.ack(r,n)}catch(a){this.client.logger.error(a)}}registerExpirerEvents(){this.client.core.expirer.on(Rt.expired,async e=>{const{topic:r,id:n}=eg(e.target);if(n&&this.client.pendingRequest.keys.includes(n))return await this.deletePendingSessionRequest(n,F("EXPIRED"),!0);if(n&&this.client.auth.requests.keys.includes(n))return await this.deletePendingAuthRequest(n,F("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession({topic:r,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:r})):n&&(await this.deleteProposal(n,!0),this.client.events.emit("proposal_expire",{id:n}))})}registerPairingEvents(){this.client.core.pairing.events.on(In.create,e=>this.onPairingCreated(e)),this.client.core.pairing.events.on(In.delete,e=>{this.addToRecentlyDeleted(e.topic,"pairing")})}isValidPairingTopic(e){if(!Ae(e,!1)){const{message:r}=F("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:r}=F("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(r)}if(qr(this.client.core.pairing.pairings.get(e).expiry)){const{message:r}=F("EXPIRED",`pairing topic: ${e}`);throw new Error(r)}}async isValidSessionTopic(e){if(!Ae(e,!1)){const{message:r}=F("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(r)}if(this.checkRecentlyDeleted(e),!this.client.session.keys.includes(e)){const{message:r}=F("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(r)}if(qr(this.client.session.get(e).expiry)){await this.deleteSession({topic:e});const{message:r}=F("EXPIRED",`session topic: ${e}`);throw new Error(r)}if(!this.client.core.crypto.keychain.has(e)){const{message:r}=F("MISSING_OR_INVALID",`session topic does not exist in keychain: ${e}`);throw await this.deleteSession({topic:e}),new Error(r)}}async isValidSessionOrPairingTopic(e){if(this.checkRecentlyDeleted(e),this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(Ae(e,!1)){const{message:r}=F("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(r)}else{const{message:r}=F("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(r)}}async isValidProposalId(e){if(!tx(e)){const{message:r}=F("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(r)}if(!this.client.proposal.keys.includes(e)){const{message:r}=F("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(r)}if(qr(this.client.proposal.get(e).expiryTimestamp)){await this.deleteProposal(e);const{message:r}=F("EXPIRED",`proposal id: ${e}`);throw new Error(r)}}}class DC extends An{constructor(e,r){super(e,r,gC,bu),this.core=e,this.logger=r}}class TC extends An{constructor(e,r){super(e,r,mC,bu),this.core=e,this.logger=r}}class RC extends An{constructor(e,r){super(e,r,yC,bu,n=>n.id),this.core=e,this.logger=r}}class NC extends An{constructor(e,r){super(e,r,_C,va,()=>Ea),this.core=e,this.logger=r}}class BC extends An{constructor(e,r){super(e,r,$C,va),this.core=e,this.logger=r}}class LC extends An{constructor(e,r){super(e,r,xC,va,n=>n.id),this.core=e,this.logger=r}}var MC=Object.defineProperty,UC=(t,e,r)=>e in t?MC(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,$u=(t,e,r)=>UC(t,typeof e!="symbol"?e+"":e,r);class jC{constructor(e,r){this.core=e,this.logger=r,$u(this,"authKeys"),$u(this,"pairingTopics"),$u(this,"requests"),this.authKeys=new NC(this.core,this.logger),this.pairingTopics=new BC(this.core,this.logger),this.requests=new LC(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}}var FC=Object.defineProperty,kC=(t,e,r)=>e in t?FC(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,te=(t,e,r)=>kC(t,typeof e!="symbol"?e+"":e,r);class xu extends q6{constructor(e){super(e),te(this,"protocol",Lm),te(this,"version",Mm),te(this,"name",vu.name),te(this,"metadata"),te(this,"core"),te(this,"logger"),te(this,"events",new Ve.exports.EventEmitter),te(this,"engine"),te(this,"session"),te(this,"proposal"),te(this,"pendingRequest"),te(this,"auth"),te(this,"signConfig"),te(this,"on",(n,i)=>this.events.on(n,i)),te(this,"once",(n,i)=>this.events.once(n,i)),te(this,"off",(n,i)=>this.events.off(n,i)),te(this,"removeListener",(n,i)=>this.events.removeListener(n,i)),te(this,"removeAllListeners",n=>this.events.removeAllListeners(n)),te(this,"connect",async n=>{try{return await this.engine.connect(n)}catch(i){throw this.logger.error(i.message),i}}),te(this,"pair",async n=>{try{return await this.engine.pair(n)}catch(i){throw this.logger.error(i.message),i}}),te(this,"approve",async n=>{try{return await this.engine.approve(n)}catch(i){throw this.logger.error(i.message),i}}),te(this,"reject",async n=>{try{return await this.engine.reject(n)}catch(i){throw this.logger.error(i.message),i}}),te(this,"update",async n=>{try{return await this.engine.update(n)}catch(i){throw this.logger.error(i.message),i}}),te(this,"extend",async n=>{try{return await this.engine.extend(n)}catch(i){throw this.logger.error(i.message),i}}),te(this,"request",async n=>{try{return await this.engine.request(n)}catch(i){throw this.logger.error(i.message),i}}),te(this,"respond",async n=>{try{return await this.engine.respond(n)}catch(i){throw this.logger.error(i.message),i}}),te(this,"ping",async n=>{try{return await this.engine.ping(n)}catch(i){throw this.logger.error(i.message),i}}),te(this,"emit",async n=>{try{return await this.engine.emit(n)}catch(i){throw this.logger.error(i.message),i}}),te(this,"disconnect",async n=>{try{return await this.engine.disconnect(n)}catch(i){throw this.logger.error(i.message),i}}),te(this,"find",n=>{try{return this.engine.find(n)}catch(i){throw this.logger.error(i.message),i}}),te(this,"getPendingSessionRequests",()=>{try{return this.engine.getPendingSessionRequests()}catch(n){throw this.logger.error(n.message),n}}),te(this,"authenticate",async(n,i)=>{try{return await this.engine.authenticate(n,i)}catch(s){throw this.logger.error(s.message),s}}),te(this,"formatAuthMessage",n=>{try{return this.engine.formatAuthMessage(n)}catch(i){throw this.logger.error(i.message),i}}),te(this,"approveSessionAuthenticate",async n=>{try{return await this.engine.approveSessionAuthenticate(n)}catch(i){throw this.logger.error(i.message),i}}),te(this,"rejectSessionAuthenticate",async n=>{try{return await this.engine.rejectSessionAuthenticate(n)}catch(i){throw this.logger.error(i.message),i}}),this.name=e?.name||vu.name,this.metadata=X5(e?.metadata),this.signConfig=e?.signConfig;const r=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:Xt(da({level:e?.logger||vu.logger}));this.core=e?.core||new pC(e),this.logger=it(r,this.name),this.session=new TC(this.core,this.logger),this.proposal=new DC(this.core,this.logger),this.pendingRequest=new RC(this.core,this.logger),this.engine=new PC(this),this.auth=new jC(this.core,this.logger)}static async init(e){const r=new xu(e);return await r.initialize(),r}get context(){return pt(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.auth.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success"),setTimeout(()=>{this.engine.processRelayMessageCache()},j.toMiliseconds(j.ONE_SECOND))}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}}var Iu={exports:{}};(function(t,e){var r=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof ct<"u"&&ct,n=function(){function s(){this.fetch=!1,this.DOMException=r.DOMException}return s.prototype=r,new s}();(function(s){(function(o){var a=typeof s<"u"&&s||typeof self<"u"&&self||typeof ct<"u"&&ct||{},c={searchParams:"URLSearchParams"in a,iterable:"Symbol"in a&&"iterator"in Symbol,blob:"FileReader"in a&&"Blob"in a&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in a,arrayBuffer:"ArrayBuffer"in a};function l(b){return b&&DataView.prototype.isPrototypeOf(b)}if(c.arrayBuffer)var u=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],h=ArrayBuffer.isView||function(b){return b&&u.indexOf(Object.prototype.toString.call(b))>-1};function d(b){if(typeof b!="string"&&(b=String(b)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(b)||b==="")throw new TypeError('Invalid character in header field name: "'+b+'"');return b.toLowerCase()}function p(b){return typeof b!="string"&&(b=String(b)),b}function f(b){var v={next:function(){var I=b.shift();return{done:I===void 0,value:I}}};return c.iterable&&(v[Symbol.iterator]=function(){return v}),v}function g(b){this.map={},b instanceof g?b.forEach(function(v,I){this.append(I,v)},this):Array.isArray(b)?b.forEach(function(v){if(v.length!=2)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+v.length);this.append(v[0],v[1])},this):b&&Object.getOwnPropertyNames(b).forEach(function(v){this.append(v,b[v])},this)}g.prototype.append=function(b,v){b=d(b),v=p(v);var I=this.map[b];this.map[b]=I?I+", "+v:v},g.prototype.delete=function(b){delete this.map[d(b)]},g.prototype.get=function(b){return b=d(b),this.has(b)?this.map[b]:null},g.prototype.has=function(b){return this.map.hasOwnProperty(d(b))},g.prototype.set=function(b,v){this.map[d(b)]=p(v)},g.prototype.forEach=function(b,v){for(var I in this.map)this.map.hasOwnProperty(I)&&b.call(v,this.map[I],I,this)},g.prototype.keys=function(){var b=[];return this.forEach(function(v,I){b.push(I)}),f(b)},g.prototype.values=function(){var b=[];return this.forEach(function(v){b.push(v)}),f(b)},g.prototype.entries=function(){var b=[];return this.forEach(function(v,I){b.push([I,v])}),f(b)},c.iterable&&(g.prototype[Symbol.iterator]=g.prototype.entries);function m(b){if(!b._noBody){if(b.bodyUsed)return Promise.reject(new TypeError("Already read"));b.bodyUsed=!0}}function w(b){return new Promise(function(v,I){b.onload=function(){v(b.result)},b.onerror=function(){I(b.error)}})}function y(b){var v=new FileReader,I=w(v);return v.readAsArrayBuffer(b),I}function E(b){var v=new FileReader,I=w(v),T=/charset=([A-Za-z0-9_-]+)/.exec(b.type),C=T?T[1]:"utf-8";return v.readAsText(b,C),I}function _(b){for(var v=new Uint8Array(b),I=new Array(v.length),T=0;T<v.length;T++)I[T]=String.fromCharCode(v[T]);return I.join("")}function O(b){if(b.slice)return b.slice(0);var v=new Uint8Array(b.byteLength);return v.set(new Uint8Array(b)),v.buffer}function S(){return this.bodyUsed=!1,this._initBody=function(b){this.bodyUsed=this.bodyUsed,this._bodyInit=b,b?typeof b=="string"?this._bodyText=b:c.blob&&Blob.prototype.isPrototypeOf(b)?this._bodyBlob=b:c.formData&&FormData.prototype.isPrototypeOf(b)?this._bodyFormData=b:c.searchParams&&URLSearchParams.prototype.isPrototypeOf(b)?this._bodyText=b.toString():c.arrayBuffer&&c.blob&&l(b)?(this._bodyArrayBuffer=O(b.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):c.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(b)||h(b))?this._bodyArrayBuffer=O(b):this._bodyText=b=Object.prototype.toString.call(b):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||(typeof b=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):c.searchParams&&URLSearchParams.prototype.isPrototypeOf(b)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},c.blob&&(this.blob=function(){var b=m(this);if(b)return b;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var b=m(this);return b||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else{if(c.blob)return this.blob().then(y);throw new Error("could not read as ArrayBuffer")}},this.text=function(){var b=m(this);if(b)return b;if(this._bodyBlob)return E(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(_(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},c.formData&&(this.formData=function(){return this.text().then(B)}),this.json=function(){return this.text().then(JSON.parse)},this}var x=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function P(b){var v=b.toUpperCase();return x.indexOf(v)>-1?v:b}function $(b,v){if(!(this instanceof $))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');v=v||{};var I=v.body;if(b instanceof $){if(b.bodyUsed)throw new TypeError("Already read");this.url=b.url,this.credentials=b.credentials,v.headers||(this.headers=new g(b.headers)),this.method=b.method,this.mode=b.mode,this.signal=b.signal,!I&&b._bodyInit!=null&&(I=b._bodyInit,b.bodyUsed=!0)}else this.url=String(b);if(this.credentials=v.credentials||this.credentials||"same-origin",(v.headers||!this.headers)&&(this.headers=new g(v.headers)),this.method=P(v.method||this.method||"GET"),this.mode=v.mode||this.mode||null,this.signal=v.signal||this.signal||function(){if("AbortController"in a){var N=new AbortController;return N.signal}}(),this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&I)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(I),(this.method==="GET"||this.method==="HEAD")&&(v.cache==="no-store"||v.cache==="no-cache")){var T=/([?&])_=[^&]*/;if(T.test(this.url))this.url=this.url.replace(T,"$1_="+new Date().getTime());else{var C=/\?/;this.url+=(C.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}$.prototype.clone=function(){return new $(this,{body:this._bodyInit})};function B(b){var v=new FormData;return b.trim().split("&").forEach(function(I){if(I){var T=I.split("="),C=T.shift().replace(/\+/g," "),N=T.join("=").replace(/\+/g," ");v.append(decodeURIComponent(C),decodeURIComponent(N))}}),v}function D(b){var v=new g,I=b.replace(/\r?\n[\t ]+/g," ");return I.split("\r").map(function(T){return T.indexOf(`
`)===0?T.substr(1,T.length):T}).forEach(function(T){var C=T.split(":"),N=C.shift().trim();if(N){var U=C.join(":").trim();try{v.append(N,U)}catch(k){console.warn("Response "+k.message)}}}),v}S.call($.prototype);function R(b,v){if(!(this instanceof R))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(v||(v={}),this.type="default",this.status=v.status===void 0?200:v.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=v.statusText===void 0?"":""+v.statusText,this.headers=new g(v.headers),this.url=v.url||"",this._initBody(b)}S.call(R.prototype),R.prototype.clone=function(){return new R(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new g(this.headers),url:this.url})},R.error=function(){var b=new R(null,{status:200,statusText:""});return b.ok=!1,b.status=0,b.type="error",b};var M=[301,302,303,307,308];R.redirect=function(b,v){if(M.indexOf(v)===-1)throw new RangeError("Invalid status code");return new R(null,{status:v,headers:{location:b}})},o.DOMException=a.DOMException;try{new o.DOMException}catch{o.DOMException=function(v,I){this.message=v,this.name=I;var T=Error(v);this.stack=T.stack},o.DOMException.prototype=Object.create(Error.prototype),o.DOMException.prototype.constructor=o.DOMException}function A(b,v){return new Promise(function(I,T){var C=new $(b,v);if(C.signal&&C.signal.aborted)return T(new o.DOMException("Aborted","AbortError"));var N=new XMLHttpRequest;function U(){N.abort()}N.onload=function(){var q={statusText:N.statusText,headers:D(N.getAllResponseHeaders()||"")};C.url.indexOf("file://")===0&&(N.status<200||N.status>599)?q.status=200:q.status=N.status,q.url="responseURL"in N?N.responseURL:q.headers.get("X-Request-URL");var W="response"in N?N.response:N.responseText;setTimeout(function(){I(new R(W,q))},0)},N.onerror=function(){setTimeout(function(){T(new TypeError("Network request failed"))},0)},N.ontimeout=function(){setTimeout(function(){T(new TypeError("Network request timed out"))},0)},N.onabort=function(){setTimeout(function(){T(new o.DOMException("Aborted","AbortError"))},0)};function k(q){try{return q===""&&a.location.href?a.location.href:q}catch{return q}}if(N.open(C.method,k(C.url),!0),C.credentials==="include"?N.withCredentials=!0:C.credentials==="omit"&&(N.withCredentials=!1),"responseType"in N&&(c.blob?N.responseType="blob":c.arrayBuffer&&(N.responseType="arraybuffer")),v&&typeof v.headers=="object"&&!(v.headers instanceof g||a.Headers&&v.headers instanceof a.Headers)){var H=[];Object.getOwnPropertyNames(v.headers).forEach(function(q){H.push(d(q)),N.setRequestHeader(q,p(v.headers[q]))}),C.headers.forEach(function(q,W){H.indexOf(W)===-1&&N.setRequestHeader(W,q)})}else C.headers.forEach(function(q,W){N.setRequestHeader(W,q)});C.signal&&(C.signal.addEventListener("abort",U),N.onreadystatechange=function(){N.readyState===4&&C.signal.removeEventListener("abort",U)}),N.send(typeof C._bodyInit>"u"?null:C._bodyInit)})}return A.polyfill=!0,a.fetch||(a.fetch=A,a.Headers=g,a.Request=$,a.Response=R),o.Headers=g,o.Request=$,o.Response=R,o.fetch=A,Object.defineProperty(o,"__esModule",{value:!0}),o})({})})(n),n.fetch.ponyfill=!0,delete n.fetch.polyfill;var i=r.fetch?r:n;e=i.fetch,e.default=i.fetch,e.fetch=i.fetch,e.Headers=i.Headers,e.Request=i.Request,e.Response=i.Response,t.exports=e})(Iu,Iu.exports);var zm=ty(Iu.exports),qC=Object.defineProperty,zC=Object.defineProperties,HC=Object.getOwnPropertyDescriptors,Hm=Object.getOwnPropertySymbols,VC=Object.prototype.hasOwnProperty,WC=Object.prototype.propertyIsEnumerable,Vm=(t,e,r)=>e in t?qC(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Wm=(t,e)=>{for(var r in e||(e={}))VC.call(e,r)&&Vm(t,r,e[r]);if(Hm)for(var r of Hm(e))WC.call(e,r)&&Vm(t,r,e[r]);return t},Km=(t,e)=>zC(t,HC(e));const KC={Accept:"application/json","Content-Type":"application/json"},GC="POST",Gm={headers:KC,method:GC},Zm=10;class Wt{constructor(e,r=!1){if(this.url=e,this.disableProviderPing=r,this.events=new Ve.exports.EventEmitter,this.isAvailable=!1,this.registering=!1,!H0(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=r}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e){this.isAvailable||await this.register();try{const r=gr(e),n=await(await zm(this.url,Km(Wm({},Gm),{body:r}))).json();this.onPayload({data:n})}catch(r){this.onError(e.id,r)}}async register(e=this.url){if(!H0(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((n,i)=>{this.events.once("register_error",s=>{this.resetMaxListeners(),i(s)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return i(new Error("HTTP connection is missing or invalid"));n()})})}this.url=e,this.registering=!0;try{if(!this.disableProviderPing){const r=gr({id:1,jsonrpc:"2.0",method:"test",params:[]});await zm(e,Km(Wm({},Gm),{body:r}))}this.onOpen()}catch(r){const n=this.parseError(r);throw this.events.emit("register_error",n),this.onClose(),n}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?fn(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const n=this.parseError(r),i=n.message||n.toString(),s=pa(e,i);this.events.emit("payload",s)}parseError(e,r=this.url){return U0(e,r,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>Zm&&this.events.setMaxListeners(Zm)}}var ZC=Object.defineProperty,Ym=Object.getOwnPropertySymbols,YC=Object.prototype.hasOwnProperty,JC=Object.prototype.propertyIsEnumerable,Jm=(t,e,r)=>e in t?ZC(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Qm=(t,e)=>{for(var r in e||(e={}))YC.call(e,r)&&Jm(t,r,e[r]);if(Ym)for(var r of Ym(e))JC.call(e,r)&&Jm(t,r,e[r]);return t};const Xm="error",QC="wss://relay.walletconnect.org",XC="wc",eP="universal_provider",_a=`${XC}@2:${eP}:`,e1="https://rpc.walletconnect.org/v1/",Ii="generic",tP=`${e1}bundler`,Nt={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};function rP(){}function Ou(t){return t==null||typeof t!="object"&&typeof t!="function"}function Su(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function nP(t){if(Ou(t))return t;if(Array.isArray(t)||Su(t)||t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer)return t.slice(0);const e=Object.getPrototypeOf(t),r=e.constructor;if(t instanceof Date||t instanceof Map||t instanceof Set)return new r(t);if(t instanceof RegExp){const n=new r(t);return n.lastIndex=t.lastIndex,n}if(t instanceof DataView)return new r(t.buffer.slice(0));if(t instanceof Error){const n=new r(t.message);return n.stack=t.stack,n.name=t.name,n.cause=t.cause,n}if(typeof File<"u"&&t instanceof File)return new r([t],t.name,{type:t.type,lastModified:t.lastModified});if(typeof t=="object"){const n=Object.create(e);return Object.assign(n,t)}return t}function t1(t){return typeof t=="object"&&t!==null}function r1(t){return Object.getOwnPropertySymbols(t).filter(e=>Object.prototype.propertyIsEnumerable.call(t,e))}function n1(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}const iP="[object RegExp]",i1="[object String]",s1="[object Number]",o1="[object Boolean]",a1="[object Arguments]",sP="[object Symbol]",oP="[object Date]",aP="[object Map]",cP="[object Set]",lP="[object Array]",uP="[object ArrayBuffer]",hP="[object Object]",dP="[object DataView]",fP="[object Uint8Array]",pP="[object Uint8ClampedArray]",gP="[object Uint16Array]",mP="[object Uint32Array]",wP="[object Int8Array]",yP="[object Int16Array]",bP="[object Int32Array]",vP="[object Float32Array]",EP="[object Float64Array]";function _P(t,e){return Oi(t,void 0,t,new Map,e)}function Oi(t,e,r,n=new Map,i=void 0){const s=i?.(t,e,r,n);if(s!=null)return s;if(Ou(t))return t;if(n.has(t))return n.get(t);if(Array.isArray(t)){const o=new Array(t.length);n.set(t,o);for(let a=0;a<t.length;a++)o[a]=Oi(t[a],a,r,n,i);return Object.hasOwn(t,"index")&&(o.index=t.index),Object.hasOwn(t,"input")&&(o.input=t.input),o}if(t instanceof Date)return new Date(t.getTime());if(t instanceof RegExp){const o=new RegExp(t.source,t.flags);return o.lastIndex=t.lastIndex,o}if(t instanceof Map){const o=new Map;n.set(t,o);for(const[a,c]of t)o.set(a,Oi(c,a,r,n,i));return o}if(t instanceof Set){const o=new Set;n.set(t,o);for(const a of t)o.add(Oi(a,void 0,r,n,i));return o}if(typeof Buffer<"u"&&Buffer.isBuffer(t))return t.subarray();if(Su(t)){const o=new(Object.getPrototypeOf(t)).constructor(t.length);n.set(t,o);for(let a=0;a<t.length;a++)o[a]=Oi(t[a],a,r,n,i);return o}if(t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer)return t.slice(0);if(t instanceof DataView){const o=new DataView(t.buffer.slice(0),t.byteOffset,t.byteLength);return n.set(t,o),Cn(o,t,r,n,i),o}if(typeof File<"u"&&t instanceof File){const o=new File([t],t.name,{type:t.type});return n.set(t,o),Cn(o,t,r,n,i),o}if(t instanceof Blob){const o=new Blob([t],{type:t.type});return n.set(t,o),Cn(o,t,r,n,i),o}if(t instanceof Error){const o=new t.constructor;return n.set(t,o),o.message=t.message,o.name=t.name,o.stack=t.stack,o.cause=t.cause,Cn(o,t,r,n,i),o}if(typeof t=="object"&&$P(t)){const o=Object.create(Object.getPrototypeOf(t));return n.set(t,o),Cn(o,t,r,n,i),o}return t}function Cn(t,e,r=t,n,i){const s=[...Object.keys(e),...r1(e)];for(let o=0;o<s.length;o++){const a=s[o],c=Object.getOwnPropertyDescriptor(t,a);(c==null||c.writable)&&(t[a]=Oi(e[a],a,r,n,i))}}function $P(t){switch(n1(t)){case a1:case lP:case uP:case dP:case o1:case oP:case vP:case EP:case wP:case yP:case bP:case aP:case s1:case hP:case iP:case cP:case i1:case sP:case fP:case pP:case gP:case mP:return!0;default:return!1}}function xP(t,e){return _P(t,(r,n,i,s)=>{const o=e?.(r,n,i,s);if(o!=null)return o;if(typeof t=="object")switch(Object.prototype.toString.call(t)){case s1:case i1:case o1:{const a=new t.constructor(t?.valueOf());return Cn(a,t),a}case a1:{const a={};return Cn(a,t),a.length=t.length,a[Symbol.iterator]=t[Symbol.iterator],a}default:return}})}function c1(t){return xP(t)}function l1(t){return t!==null&&typeof t=="object"&&n1(t)==="[object Arguments]"}function IP(t){return Su(t)}function OP(t){var e;if(typeof t!="object"||t==null)return!1;if(Object.getPrototypeOf(t)===null)return!0;if(Object.prototype.toString.call(t)!=="[object Object]"){const n=t[Symbol.toStringTag];return n==null||!((e=Object.getOwnPropertyDescriptor(t,Symbol.toStringTag))!=null&&e.writable)?!1:t.toString()===`[object ${n}]`}let r=t;for(;Object.getPrototypeOf(r)!==null;)r=Object.getPrototypeOf(r);return Object.getPrototypeOf(t)===r}function SP(t,...e){const r=e.slice(0,-1),n=e[e.length-1];let i=t;for(let s=0;s<r.length;s++){const o=r[s];i=Au(i,o,n,new Map)}return i}function Au(t,e,r,n){var i;if(Ou(t)&&(t=Object(t)),e==null||typeof e!="object")return t;if(n.has(e))return nP(n.get(e));if(n.set(e,t),Array.isArray(e)){e=e.slice();for(let o=0;o<e.length;o++)e[o]=(i=e[o])!=null?i:void 0}const s=[...Object.keys(e),...r1(e)];for(let o=0;o<s.length;o++){const a=s[o];let c=e[a],l=t[a];if(l1(c)&&(c=Qm({},c)),l1(l)&&(l=Qm({},l)),typeof Buffer<"u"&&Buffer.isBuffer(c)&&(c=c1(c)),Array.isArray(c))if(typeof l=="object"&&l!=null){const h=[],d=Reflect.ownKeys(l);for(let p=0;p<d.length;p++){const f=d[p];h[f]=l[f]}l=h}else l=[];const u=r(l,c,a,t,e,n);u!=null?t[a]=u:Array.isArray(c)||t1(l)&&t1(c)?t[a]=Au(l,c,r,n):l==null&&OP(c)?t[a]=Au({},c,r,n):l==null&&IP(c)?t[a]=c1(c):(l===void 0||c!==void 0)&&(t[a]=c)}return t}function AP(t,...e){return SP(t,...e,rP)}var CP=Object.defineProperty,PP=Object.defineProperties,DP=Object.getOwnPropertyDescriptors,u1=Object.getOwnPropertySymbols,TP=Object.prototype.hasOwnProperty,RP=Object.prototype.propertyIsEnumerable,h1=(t,e,r)=>e in t?CP(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,$a=(t,e)=>{for(var r in e||(e={}))TP.call(e,r)&&h1(t,r,e[r]);if(u1)for(var r of u1(e))RP.call(e,r)&&h1(t,r,e[r]);return t},NP=(t,e)=>PP(t,DP(e));function xt(t,e,r){var n;const i=oi(t);return((n=e.rpcMap)==null?void 0:n[i.reference])||`${e1}?chainId=${i.namespace}:${i.reference}&projectId=${r}`}function Pn(t){return t.includes(":")?t.split(":")[1]:t}function d1(t){return t.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function BP(t,e){const r=Object.keys(e.namespaces).filter(i=>i.includes(t));if(!r.length)return[];const n=[];return r.forEach(i=>{const s=e.namespaces[i].accounts;n.push(...s)}),n}function Cu(t={},e={}){const r=f1(t),n=f1(e);return AP(r,n)}function f1(t){var e,r,n,i;const s={};if(!Ns(t))return s;for(const[o,a]of Object.entries(t)){const c=ql(o)?[o]:a.chains,l=a.methods||[],u=a.events||[],h=a.rpcMap||{},d=Rs(o);s[d]=NP($a($a({},s[d]),a),{chains:zo(c,(e=s[d])==null?void 0:e.chains),methods:zo(l,(r=s[d])==null?void 0:r.methods),events:zo(u,(n=s[d])==null?void 0:n.events),rpcMap:$a($a({},h),(i=s[d])==null?void 0:i.rpcMap)})}return s}function p1(t){return t.includes(":")?t.split(":")[2]:t}function g1(t){const e={};for(const[r,n]of Object.entries(t)){const i=n.methods||[],s=n.events||[],o=n.accounts||[],a=ql(r)?[r]:n.chains?n.chains:d1(n.accounts);e[r]={chains:a,methods:i,events:s,accounts:o}}return e}function Pu(t){return typeof t=="number"?t:t.includes("0x")?parseInt(t,16):(t=t.includes(":")?t.split(":")[1]:t,isNaN(Number(t))?t:Number(t))}const m1={},oe=t=>m1[t],Du=(t,e)=>{m1[t]=e};var LP=Object.defineProperty,MP=(t,e,r)=>e in t?LP(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Si=(t,e,r)=>MP(t,typeof e!="symbol"?e+"":e,r);class UP{constructor(e){Si(this,"name","polkadot"),Si(this,"client"),Si(this,"httpProviders"),Si(this,"events"),Si(this,"namespace"),Si(this,"chainId"),this.namespace=e.namespace,this.events=oe("events"),this.client=oe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(e,r),this.chainId=e,this.events.emit(Nt.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var n;const i=Pn(r);e[i]=this.createHttpProvider(i,(n=this.namespace.rpcMap)==null?void 0:n[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const n=this.createHttpProvider(e,r);n&&(this.httpProviders[e]=n)}createHttpProvider(e,r){const n=r||xt(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new Dt(new Wt(n,oe("disableProviderPing")))}}var jP=Object.defineProperty,FP=Object.defineProperties,kP=Object.getOwnPropertyDescriptors,w1=Object.getOwnPropertySymbols,qP=Object.prototype.hasOwnProperty,zP=Object.prototype.propertyIsEnumerable,Tu=(t,e,r)=>e in t?jP(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,y1=(t,e)=>{for(var r in e||(e={}))qP.call(e,r)&&Tu(t,r,e[r]);if(w1)for(var r of w1(e))zP.call(e,r)&&Tu(t,r,e[r]);return t},b1=(t,e)=>FP(t,kP(e)),Ai=(t,e,r)=>Tu(t,typeof e!="symbol"?e+"":e,r);class HP{constructor(e){Ai(this,"name","eip155"),Ai(this,"client"),Ai(this,"chainId"),Ai(this,"namespace"),Ai(this,"httpProviders"),Ai(this,"events"),this.namespace=e.namespace,this.events=oe("events"),this.client=oe("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain());case"wallet_getCapabilities":return await this.getCapabilities(e);case"wallet_getCallsStatus":return await this.getCallStatus(e)}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(parseInt(e),r),this.chainId=parseInt(e),this.events.emit(Nt.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,r){const n=r||xt(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new Dt(new Wt(n,oe("disableProviderPing")))}setHttpProvider(e,r){const n=this.createHttpProvider(e,r);n&&(this.httpProviders[e]=n)}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var n;const i=parseInt(Pn(r));e[i]=this.createHttpProvider(i,(n=this.namespace.rpcMap)==null?void 0:n[r])}),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}getHttpProvider(){const e=this.chainId,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}async handleSwitchChain(e){var r,n;let i=e.request.params?(r=e.request.params[0])==null?void 0:r.chainId:"0x0";i=i.startsWith("0x")?i:`0x${i}`;const s=parseInt(i,16);if(this.isChainApproved(s))this.setDefaultChain(`${s}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:i}]},chainId:(n=this.namespace.chains)==null?void 0:n[0]}),this.setDefaultChain(`${s}`);else throw new Error(`Failed to switch to chain 'eip155:${s}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}async getCapabilities(e){var r,n,i;const s=(n=(r=e.request)==null?void 0:r.params)==null?void 0:n[0];if(!s)throw new Error("Missing address parameter in `wallet_getCapabilities` request");const o=this.client.session.get(e.topic),a=((i=o?.sessionProperties)==null?void 0:i.capabilities)||{};if(a!=null&&a[s])return a?.[s];const c=await this.client.request(e);try{await this.client.session.update(e.topic,{sessionProperties:b1(y1({},o.sessionProperties||{}),{capabilities:b1(y1({},a||{}),{[s]:c})})})}catch(l){console.warn("Failed to update session with capabilities",l)}return c}async getCallStatus(e){var r,n;const i=this.client.session.get(e.topic),s=(r=i.sessionProperties)==null?void 0:r.bundler_name;if(s){const a=this.getBundlerUrl(e.chainId,s);try{return await this.getUserOperationReceipt(a,e)}catch(c){console.warn("Failed to fetch call status from bundler",c,a)}}const o=(n=i.sessionProperties)==null?void 0:n.bundler_url;if(o)try{return await this.getUserOperationReceipt(o,e)}catch(a){console.warn("Failed to fetch call status from custom bundler",a,o)}if(this.namespace.methods.includes(e.request.method))return await this.client.request(e);throw new Error("Fetching call status not approved by the wallet.")}async getUserOperationReceipt(e,r){var n;const i=new URL(e),s=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Kr("eth_getUserOperationReceipt",[(n=r.request.params)==null?void 0:n[0]]))});if(!s.ok)throw new Error(`Failed to fetch user operation receipt - ${s.status}`);return await s.json()}getBundlerUrl(e,r){return`${tP}?projectId=${this.client.core.projectId}&chainId=${e}&bundler=${r}`}}var VP=Object.defineProperty,WP=(t,e,r)=>e in t?VP(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ci=(t,e,r)=>WP(t,typeof e!="symbol"?e+"":e,r);class KP{constructor(e){Ci(this,"name","solana"),Ci(this,"client"),Ci(this,"httpProviders"),Ci(this,"events"),Ci(this,"namespace"),Ci(this,"chainId"),this.namespace=e.namespace,this.events=oe("events"),this.client=oe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(e,r),this.chainId=e,this.events.emit(Nt.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var n;const i=Pn(r);e[i]=this.createHttpProvider(i,(n=this.namespace.rpcMap)==null?void 0:n[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const n=this.createHttpProvider(e,r);n&&(this.httpProviders[e]=n)}createHttpProvider(e,r){const n=r||xt(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new Dt(new Wt(n,oe("disableProviderPing")))}}var GP=Object.defineProperty,ZP=(t,e,r)=>e in t?GP(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Pi=(t,e,r)=>ZP(t,typeof e!="symbol"?e+"":e,r);class YP{constructor(e){Pi(this,"name","cosmos"),Pi(this,"client"),Pi(this,"httpProviders"),Pi(this,"events"),Pi(this,"namespace"),Pi(this,"chainId"),this.namespace=e.namespace,this.events=oe("events"),this.client=oe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(e,r),this.chainId=e,this.events.emit(Nt.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var n;const i=Pn(r);e[i]=this.createHttpProvider(i,(n=this.namespace.rpcMap)==null?void 0:n[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const n=this.createHttpProvider(e,r);n&&(this.httpProviders[e]=n)}createHttpProvider(e,r){const n=r||xt(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new Dt(new Wt(n,oe("disableProviderPing")))}}var JP=Object.defineProperty,QP=(t,e,r)=>e in t?JP(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Di=(t,e,r)=>QP(t,typeof e!="symbol"?e+"":e,r);class XP{constructor(e){Di(this,"name","algorand"),Di(this,"client"),Di(this,"httpProviders"),Di(this,"events"),Di(this,"namespace"),Di(this,"chainId"),this.namespace=e.namespace,this.events=oe("events"),this.client=oe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){if(!this.httpProviders[e]){const n=r||xt(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,n)}this.chainId=e,this.events.emit(Nt.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var n;e[r]=this.createHttpProvider(r,(n=this.namespace.rpcMap)==null?void 0:n[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const n=this.createHttpProvider(e,r);n&&(this.httpProviders[e]=n)}createHttpProvider(e,r){const n=r||xt(e,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new Dt(new Wt(n,oe("disableProviderPing")))}}var e7=Object.defineProperty,t7=(t,e,r)=>e in t?e7(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ti=(t,e,r)=>t7(t,typeof e!="symbol"?e+"":e,r);class r7{constructor(e){Ti(this,"name","cip34"),Ti(this,"client"),Ti(this,"httpProviders"),Ti(this,"events"),Ti(this,"namespace"),Ti(this,"chainId"),this.namespace=e.namespace,this.events=oe("events"),this.client=oe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(e,r),this.chainId=e,this.events.emit(Nt.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{const n=this.getCardanoRPCUrl(r),i=Pn(r);e[i]=this.createHttpProvider(i,n)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}getCardanoRPCUrl(e){const r=this.namespace.rpcMap;if(r)return r[e]}setHttpProvider(e,r){const n=this.createHttpProvider(e,r);n&&(this.httpProviders[e]=n)}createHttpProvider(e,r){const n=r||this.getCardanoRPCUrl(e);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new Dt(new Wt(n,oe("disableProviderPing")))}}var n7=Object.defineProperty,i7=(t,e,r)=>e in t?n7(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ri=(t,e,r)=>i7(t,typeof e!="symbol"?e+"":e,r);class s7{constructor(e){Ri(this,"name","elrond"),Ri(this,"client"),Ri(this,"httpProviders"),Ri(this,"events"),Ri(this,"namespace"),Ri(this,"chainId"),this.namespace=e.namespace,this.events=oe("events"),this.client=oe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(e,r),this.chainId=e,this.events.emit(Nt.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var n;const i=Pn(r);e[i]=this.createHttpProvider(i,(n=this.namespace.rpcMap)==null?void 0:n[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const n=this.createHttpProvider(e,r);n&&(this.httpProviders[e]=n)}createHttpProvider(e,r){const n=r||xt(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new Dt(new Wt(n,oe("disableProviderPing")))}}var o7=Object.defineProperty,a7=(t,e,r)=>e in t?o7(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ni=(t,e,r)=>a7(t,typeof e!="symbol"?e+"":e,r);class c7{constructor(e){Ni(this,"name","multiversx"),Ni(this,"client"),Ni(this,"httpProviders"),Ni(this,"events"),Ni(this,"namespace"),Ni(this,"chainId"),this.namespace=e.namespace,this.events=oe("events"),this.client=oe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(e,r),this.chainId=e,this.events.emit(Nt.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var n;const i=Pn(r);e[i]=this.createHttpProvider(i,(n=this.namespace.rpcMap)==null?void 0:n[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const n=this.createHttpProvider(e,r);n&&(this.httpProviders[e]=n)}createHttpProvider(e,r){const n=r||xt(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new Dt(new Wt(n,oe("disableProviderPing")))}}var l7=Object.defineProperty,u7=(t,e,r)=>e in t?l7(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Bi=(t,e,r)=>u7(t,typeof e!="symbol"?e+"":e,r);class h7{constructor(e){Bi(this,"name","near"),Bi(this,"client"),Bi(this,"httpProviders"),Bi(this,"events"),Bi(this,"namespace"),Bi(this,"chainId"),this.namespace=e.namespace,this.events=oe("events"),this.client=oe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){if(this.chainId=e,!this.httpProviders[e]){const n=r||xt(`${this.name}:${e}`,this.namespace);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,n)}this.events.emit(Nt.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var n;e[r]=this.createHttpProvider(r,(n=this.namespace.rpcMap)==null?void 0:n[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const n=this.createHttpProvider(e,r);n&&(this.httpProviders[e]=n)}createHttpProvider(e,r){const n=r||xt(e,this.namespace);return typeof n>"u"?void 0:new Dt(new Wt(n,oe("disableProviderPing")))}}var d7=Object.defineProperty,f7=(t,e,r)=>e in t?d7(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Li=(t,e,r)=>f7(t,typeof e!="symbol"?e+"":e,r);class p7{constructor(e){Li(this,"name","tezos"),Li(this,"client"),Li(this,"httpProviders"),Li(this,"events"),Li(this,"namespace"),Li(this,"chainId"),this.namespace=e.namespace,this.events=oe("events"),this.client=oe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){if(this.chainId=e,!this.httpProviders[e]){const n=r||xt(`${this.name}:${e}`,this.namespace);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,n)}this.events.emit(Nt.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{e[r]=this.createHttpProvider(r)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const n=this.createHttpProvider(e,r);n&&(this.httpProviders[e]=n)}createHttpProvider(e,r){const n=r||xt(e,this.namespace);return typeof n>"u"?void 0:new Dt(new Wt(n))}}var g7=Object.defineProperty,m7=(t,e,r)=>e in t?g7(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Mi=(t,e,r)=>m7(t,typeof e!="symbol"?e+"":e,r);class w7{constructor(e){Mi(this,"name",Ii),Mi(this,"client"),Mi(this,"httpProviders"),Mi(this,"events"),Mi(this,"namespace"),Mi(this,"chainId"),this.namespace=e.namespace,this.events=oe("events"),this.client=oe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace.chains=[...new Set((this.namespace.chains||[]).concat(e.chains||[]))],this.namespace.accounts=[...new Set((this.namespace.accounts||[]).concat(e.accounts||[]))],this.namespace.methods=[...new Set((this.namespace.methods||[]).concat(e.methods||[]))],this.namespace.events=[...new Set((this.namespace.events||[]).concat(e.events||[]))],this.httpProviders=this.createHttpProviders()}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider(e.chainId).request(e.request)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(e,r),this.chainId=e,this.events.emit(Nt.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){var e,r;const n={};return(r=(e=this.namespace)==null?void 0:e.accounts)==null||r.forEach(i=>{const s=oi(i);n[`${s.namespace}:${s.reference}`]=this.createHttpProvider(i)}),n}getHttpProvider(e){const r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const n=this.createHttpProvider(e,r);n&&(this.httpProviders[e]=n)}createHttpProvider(e,r){const n=r||xt(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new Dt(new Wt(n,oe("disableProviderPing")))}}var y7=Object.defineProperty,b7=Object.defineProperties,v7=Object.getOwnPropertyDescriptors,v1=Object.getOwnPropertySymbols,E7=Object.prototype.hasOwnProperty,_7=Object.prototype.propertyIsEnumerable,Ru=(t,e,r)=>e in t?y7(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,xa=(t,e)=>{for(var r in e||(e={}))E7.call(e,r)&&Ru(t,r,e[r]);if(v1)for(var r of v1(e))_7.call(e,r)&&Ru(t,r,e[r]);return t},Nu=(t,e)=>b7(t,v7(e)),Bt=(t,e,r)=>Ru(t,typeof e!="symbol"?e+"":e,r);class Bu{constructor(e){Bt(this,"client"),Bt(this,"namespaces"),Bt(this,"optionalNamespaces"),Bt(this,"sessionProperties"),Bt(this,"scopedProperties"),Bt(this,"events",new Ve.exports),Bt(this,"rpcProviders",{}),Bt(this,"session"),Bt(this,"providerOpts"),Bt(this,"logger"),Bt(this,"uri"),Bt(this,"disableProviderPing",!1),this.providerOpts=e,this.logger=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:Xt(da({level:e?.logger||Xm})),this.disableProviderPing=e?.disableProviderPing||!1}static async init(e){const r=new Bu(e);return await r.initialize(),r}async request(e,r,n){const[i,s]=this.validateChain(r);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(i).request({request:xa({},e),chainId:`${i}:${s}`,topic:this.session.topic,expiry:n})}sendAsync(e,r,n,i){const s=new Date().getTime();this.request(e,n,i).then(o=>r(null,fa(s,o))).catch(o=>r(o,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:he("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),await this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}async authenticate(e,r){if(!this.client)throw new Error("Sign Client not initialized");this.setNamespaces(e),await this.cleanupPendingPairings();const{uri:n,response:i}=await this.client.authenticate(e,r);n&&(this.uri=n,this.events.emit("display_uri",n));const s=await i();if(this.session=s.session,this.session){const o=g1(this.session.namespaces);this.namespaces=Cu(this.namespaces,o),await this.persist("namespaces",this.namespaces),this.onConnect()}return s}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}removeListener(e,r){this.events.removeListener(e,r)}off(e,r){this.events.off(e,r)}get isWalletConnect(){return!0}async pair(e){const{uri:r,approval:n}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties});r&&(this.uri=r,this.events.emit("display_uri",r));const i=await n();this.session=i;const s=g1(i.namespaces);return this.namespaces=Cu(this.namespaces,s),await this.persist("namespaces",this.namespaces),await this.persist("optionalNamespaces",this.optionalNamespaces),this.onConnect(),this.session}setDefaultChain(e,r){try{if(!this.session)return;const[n,i]=this.validateChain(e),s=this.getProvider(n);s.name===Ii?s.setDefaultChain(`${n}:${i}`,r):s.setDefaultChain(i,r)}catch(n){if(!/Please call connect/.test(n.message))throw n}}async cleanupPendingPairings(e={}){this.logger.info("Cleaning up inactive pairings...");const r=this.client.pairing.getAll();if(qt(r)){for(const n of r)e.deletePairings?this.client.core.expirer.set(n.topic,0):await this.client.core.relayer.subscriber.unsubscribe(n.topic);this.logger.info(`Inactive pairings cleared: ${r.length}`)}}abortPairingAttempt(){this.logger.warn("abortPairingAttempt is deprecated. This is now a no-op.")}async checkStorage(){this.namespaces=await this.getFromStore("namespaces")||{},this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.session&&this.createProviders()}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){var e,r;if(this.client=this.providerOpts.client||await xu.init({core:this.providerOpts.core,logger:this.providerOpts.logger||Xm,relayUrl:this.providerOpts.relayUrl||QC,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name,customStoragePrefix:this.providerOpts.customStoragePrefix,telemetryEnabled:this.providerOpts.telemetryEnabled}),this.providerOpts.session)try{this.session=this.client.session.get(this.providerOpts.session.topic)}catch(n){throw this.logger.error("Failed to get session",n),new Error(`The provided session: ${(r=(e=this.providerOpts)==null?void 0:e.session)==null?void 0:r.topic} doesn't exist in the Sign client`)}else{const n=this.client.session.getAll();this.session=n[0]}this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).map(r=>Rs(r)))];Du("client",this.client),Du("events",this.events),Du("disableProviderPing",this.disableProviderPing),e.forEach(r=>{if(!this.session)return;const n=BP(r,this.session),i=d1(n),s=Cu(this.namespaces,this.optionalNamespaces),o=Nu(xa({},s[r]),{accounts:n,chains:i});switch(r){case"eip155":this.rpcProviders[r]=new HP({namespace:o});break;case"algorand":this.rpcProviders[r]=new XP({namespace:o});break;case"solana":this.rpcProviders[r]=new KP({namespace:o});break;case"cosmos":this.rpcProviders[r]=new YP({namespace:o});break;case"polkadot":this.rpcProviders[r]=new UP({namespace:o});break;case"cip34":this.rpcProviders[r]=new r7({namespace:o});break;case"elrond":this.rpcProviders[r]=new s7({namespace:o});break;case"multiversx":this.rpcProviders[r]=new c7({namespace:o});break;case"near":this.rpcProviders[r]=new h7({namespace:o});break;case"tezos":this.rpcProviders[r]=new p7({namespace:o});break;default:this.rpcProviders[Ii]?this.rpcProviders[Ii].updateNamespace(o):this.rpcProviders[Ii]=new w7({namespace:o})}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{var r;const{topic:n}=e;n===((r=this.session)==null?void 0:r.topic)&&this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{var r;const{params:n,topic:i}=e;if(i!==((r=this.session)==null?void 0:r.topic))return;const{event:s}=n;if(s.name==="accountsChanged"){const o=s.data;o&&qt(o)&&this.events.emit("accountsChanged",o.map(p1))}else if(s.name==="chainChanged"){const o=n.chainId,a=n.event.data,c=Rs(o),l=Pu(o)!==Pu(a)?`${c}:${Pu(a)}`:o;this.onChainChanged(l)}else this.events.emit(s.name,s.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:r})=>{var n,i;if(e!==((n=this.session)==null?void 0:n.topic))return;const{namespaces:s}=r,o=(i=this.client)==null?void 0:i.session.get(e);this.session=Nu(xa({},o),{namespaces:s}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:r})}),this.client.on("session_delete",async e=>{var r;e.topic===((r=this.session)==null?void 0:r.topic)&&(await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",Nu(xa({},he("USER_DISCONNECTED")),{data:e.topic})))}),this.on(Nt.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e,!0)})}getProvider(e){return this.rpcProviders[e]||this.rpcProviders[Ii]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var r;this.getProvider(e).updateNamespace((r=this.session)==null?void 0:r.namespaces[e])})}setNamespaces(e){const{namespaces:r,optionalNamespaces:n,sessionProperties:i,scopedProperties:s}=e;r&&Object.keys(r).length&&(this.namespaces=r),n&&Object.keys(n).length&&(this.optionalNamespaces=n),this.sessionProperties=i,this.scopedProperties=s}validateChain(e){const[r,n]=e?.split(":")||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[r,n];if(r&&!Object.keys(this.namespaces||{}).map(o=>Rs(o)).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);if(r&&n)return[r,n];const i=Rs(Object.keys(this.namespaces)[0]),s=this.rpcProviders[i].getDefaultChain();return[i,s]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}async onChainChanged(e,r=!1){if(!this.namespaces)return;const[n,i]=this.validateChain(e);if(!i)return;this.updateNamespaceChain(n,i),this.events.emit("chainChanged",i);const s=this.getProvider(n).getDefaultChain();r||this.getProvider(n).setDefaultChain(i),this.emitAccountsChangedOnChainChange({namespace:n,previousChainId:s,newChainId:e}),await this.persist("namespaces",this.namespaces)}emitAccountsChangedOnChainChange({namespace:e,previousChainId:r,newChainId:n}){var i,s;try{if(r===n)return;const o=(s=(i=this.session)==null?void 0:i.namespaces[e])==null?void 0:s.accounts;if(!o)return;const a=o.filter(c=>c.includes(`${n}:`)).map(p1);if(!qt(a))return;this.events.emit("accountsChanged",a)}catch(o){this.logger.warn("Failed to emit accountsChanged on chain change",o)}}updateNamespaceChain(e,r){if(!this.namespaces)return;const n=this.namespaces[e]?e:`${e}:${r}`,i={chains:[],methods:[],events:[],defaultChain:r};this.namespaces[n]?this.namespaces[n]&&(this.namespaces[n].defaultChain=r):this.namespaces[n]=i}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,await this.deleteFromStore("namespaces"),await this.deleteFromStore("optionalNamespaces"),await this.deleteFromStore("sessionProperties"),this.session=void 0,await this.cleanupPendingPairings({deletePairings:!0}),await this.cleanupStorage()}async persist(e,r){var n;const i=((n=this.session)==null?void 0:n.topic)||"";await this.client.core.storage.setItem(`${_a}/${e}${i}`,r)}async getFromStore(e){var r;const n=((r=this.session)==null?void 0:r.topic)||"";return await this.client.core.storage.getItem(`${_a}/${e}${n}`)}async deleteFromStore(e){var r;const n=((r=this.session)==null?void 0:r.topic)||"";await this.client.core.storage.removeItem(`${_a}/${e}${n}`)}async cleanupStorage(){var e;try{if(((e=this.client)==null?void 0:e.session.length)>0)return;const r=await this.client.core.storage.getKeys();for(const n of r)n.startsWith(_a)&&await this.client.core.storage.removeItem(n)}catch(r){this.logger.warn("Failed to cleanup storage",r)}}}const $7=Bu,x7="wc",I7="ethereum_provider",O7=`${x7}@2:${I7}:`,S7="https://rpc.walletconnect.org/v1/",Ia=["eth_sendTransaction","personal_sign"],E1=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_sendCalls","wallet_getCapabilities","wallet_getCallsStatus","wallet_showCallsStatus"],Oa=["chainChanged","accountsChanged"],_1=["chainChanged","accountsChanged","message","disconnect","connect"];var A7=Object.defineProperty,C7=Object.defineProperties,P7=Object.getOwnPropertyDescriptors,$1=Object.getOwnPropertySymbols,D7=Object.prototype.hasOwnProperty,T7=Object.prototype.propertyIsEnumerable,Lu=(t,e,r)=>e in t?A7(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ui=(t,e)=>{for(var r in e||(e={}))D7.call(e,r)&&Lu(t,r,e[r]);if($1)for(var r of $1(e))T7.call(e,r)&&Lu(t,r,e[r]);return t},Mu=(t,e)=>C7(t,P7(e)),It=(t,e,r)=>Lu(t,typeof e!="symbol"?e+"":e,r);function Sa(t){return Number(t[0].split(":")[1])}function Aa(t){return`0x${t.toString(16)}`}function R7(t){const{chains:e,optionalChains:r,methods:n,optionalMethods:i,events:s,optionalEvents:o,rpcMap:a}=t;if(!qt(e))throw new Error("Invalid chains");const c={chains:e,methods:n||Ia,events:s||Oa,rpcMap:Ui({},e.length?{[Sa(e)]:a[Sa(e)]}:{})},l=s?.filter(p=>!Oa.includes(p)),u=n?.filter(p=>!Ia.includes(p));if(!r&&!o&&!i&&!(l!=null&&l.length)&&!(u!=null&&u.length))return{required:e.length?c:void 0};const h=l?.length&&u?.length||!r,d={chains:[...new Set(h?c.chains.concat(r||[]):r)],methods:[...new Set(c.methods.concat(i!=null&&i.length?i:E1))],events:[...new Set(c.events.concat(o!=null&&o.length?o:_1))],rpcMap:a};return{required:e.length?c:void 0,optional:r.length?d:void 0}}class Ca{constructor(){It(this,"events",new Ve.exports.EventEmitter),It(this,"namespace","eip155"),It(this,"accounts",[]),It(this,"signer"),It(this,"chainId",1),It(this,"modal"),It(this,"rpc"),It(this,"STORAGE_KEY",O7),It(this,"on",(e,r)=>(this.events.on(e,r),this)),It(this,"once",(e,r)=>(this.events.once(e,r),this)),It(this,"removeListener",(e,r)=>(this.events.removeListener(e,r),this)),It(this,"off",(e,r)=>(this.events.off(e,r),this)),It(this,"parseAccount",e=>this.isCompatibleChainId(e)?this.parseAccountId(e).address:e),this.signer={},this.rpc={}}static async init(e){const r=new Ca;return await r.initialize(e),r}async request(e,r){return await this.signer.request(e,this.formatChainId(this.chainId),r)}sendAsync(e,r,n){this.signer.sendAsync(e,r,this.formatChainId(this.chainId),n)}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(e){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(e);const{required:r,optional:n}=R7(this.rpc);try{const i=await new Promise(async(o,a)=>{var c;this.rpc.showQrModal&&((c=this.modal)==null||c.subscribeModal(u=>{!u.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),a(new Error("Connection request reset. Please try again.")))}));const l=e!=null&&e.scopedProperties?{[this.namespace]:e.scopedProperties}:void 0;await this.signer.connect(Mu(Ui({namespaces:Ui({},r&&{[this.namespace]:r})},n&&{optionalNamespaces:{[this.namespace]:n}}),{pairingTopic:e?.pairingTopic,scopedProperties:l})).then(u=>{o(u)}).catch(u=>{a(new Error(u.message))})});if(!i)return;const s=Vp(i.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:s),this.setAccounts(s),this.events.emit("connect",{chainId:Aa(this.chainId)})}catch(i){throw this.signer.logger.error(i),i}finally{this.modal&&this.modal.closeModal()}}async authenticate(e,r){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts({chains:e?.chains});try{const n=await new Promise(async(s,o)=>{var a;this.rpc.showQrModal&&((a=this.modal)==null||a.subscribeModal(c=>{!c.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),o(new Error("Connection request reset. Please try again.")))})),await this.signer.authenticate(Mu(Ui({},e),{chains:this.rpc.chains}),r).then(c=>{s(c)}).catch(c=>{o(new Error(c.message))})}),i=n.session;if(i){const s=Vp(i.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:s),this.setAccounts(s),this.events.emit("connect",{chainId:Aa(this.chainId)})}return n}catch(n){throw this.signer.logger.error(n),n}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",e=>{const{params:r}=e,{event:n}=r;n.name==="accountsChanged"?(this.accounts=this.parseAccounts(n.data),this.events.emit("accountsChanged",this.accounts)):n.name==="chainChanged"?this.setChainId(this.formatChainId(n.data)):this.events.emit(n.name,n.data),this.events.emit("session_event",e)}),this.signer.on("accountsChanged",e=>{this.accounts=this.parseAccounts(e),this.events.emit("accountsChanged",this.accounts)}),this.signer.on("chainChanged",e=>{const r=parseInt(e);this.chainId=r,this.events.emit("chainChanged",Aa(this.chainId)),this.persist()}),this.signer.on("session_update",e=>{this.events.emit("session_update",e)}),this.signer.on("session_delete",e=>{this.reset(),this.events.emit("session_delete",e),this.events.emit("disconnect",Mu(Ui({},he("USER_DISCONNECTED")),{data:e.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",e=>{var r,n;this.rpc.showQrModal&&((r=this.modal)==null||r.closeModal(),(n=this.modal)==null||n.openModal({uri:e})),this.events.emit("display_uri",e)})}switchEthereumChain(e){this.request({method:"wallet_switchEthereumChain",params:[{chainId:e.toString(16)}]})}isCompatibleChainId(e){return typeof e=="string"?e.startsWith(`${this.namespace}:`):!1}formatChainId(e){return`${this.namespace}:${e}`}parseChainId(e){return Number(e.split(":")[1])}setChainIds(e){const r=e.filter(n=>this.isCompatibleChainId(n)).map(n=>this.parseChainId(n));r.length&&(this.chainId=r[0],this.events.emit("chainChanged",Aa(this.chainId)),this.persist())}setChainId(e){if(this.isCompatibleChainId(e)){const r=this.parseChainId(e);this.chainId=r,this.switchEthereumChain(r)}}parseAccountId(e){const[r,n,i]=e.split(":");return{chainId:`${r}:${n}`,address:i}}setAccounts(e){this.accounts=e.filter(r=>this.parseChainId(this.parseAccountId(r).chainId)===this.chainId).map(r=>this.parseAccountId(r).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(e){var r,n;const i=(r=e?.chains)!=null?r:[],s=(n=e?.optionalChains)!=null?n:[],o=i.concat(s);if(!o.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const a=i.length?e?.methods||Ia:[],c=i.length?e?.events||Oa:[],l=e?.optionalMethods||[],u=e?.optionalEvents||[],h=e?.rpcMap||this.buildRpcMap(o,e.projectId),d=e?.qrModalOptions||void 0;return{chains:i?.map(p=>this.formatChainId(p)),optionalChains:s.map(p=>this.formatChainId(p)),methods:a,events:c,optionalMethods:l,optionalEvents:u,rpcMap:h,showQrModal:!!(e!=null&&e.showQrModal),qrModalOptions:d,projectId:e.projectId,metadata:e.metadata}}buildRpcMap(e,r){const n={};return e.forEach(i=>{n[i]=this.getRpcUrl(i,r)}),n}async initialize(e){if(this.rpc=this.getRpcConfig(e),this.chainId=this.rpc.chains.length?Sa(this.rpc.chains):Sa(this.rpc.optionalChains),this.signer=await $7.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:e.disableProviderPing,relayUrl:e.relayUrl,storage:e.storage,storageOptions:e.storageOptions,customStoragePrefix:e.customStoragePrefix,telemetryEnabled:e.telemetryEnabled,logger:e.logger}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let r;try{const{WalletConnectModal:n}=await Promise.resolve().then(function(){return rD});r=n}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(r)try{this.modal=new r(Ui({projectId:this.rpc.projectId},this.rpc.qrModalOptions))}catch(n){throw this.signer.logger.error(n),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(e){if(!e)return;const{chains:r,optionalChains:n,rpcMap:i}=e;r&&qt(r)&&(this.rpc.chains=r.map(s=>this.formatChainId(s)),r.forEach(s=>{this.rpc.rpcMap[s]=i?.[s]||this.getRpcUrl(s)})),n&&qt(n)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=n?.map(s=>this.formatChainId(s)),n.forEach(s=>{this.rpc.rpcMap[s]=i?.[s]||this.getRpcUrl(s)}))}getRpcUrl(e,r){var n;return((n=this.rpc.rpcMap)==null?void 0:n[e])||`${S7}?chainId=eip155:${e}&projectId=${r||this.rpc.projectId}`}async loadPersistedSession(){if(this.session)try{const e=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),r=this.session.namespaces[`${this.namespace}:${e}`]?this.session.namespaces[`${this.namespace}:${e}`]:this.session.namespaces[this.namespace];this.setChainIds(e?[this.formatChainId(e)]:r?.accounts),this.setAccounts(r?.accounts)}catch(e){this.signer.logger.error("Failed to load persisted session, clearing state..."),this.signer.logger.error(e),await this.disconnect().catch(r=>this.signer.logger.warn(r))}}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(e){return typeof e=="string"||e instanceof String?[this.parseAccount(e)]:e.map(r=>this.parseAccount(r))}}const N7=Ca,B7=Symbol(),x1=Object.getPrototypeOf,Uu=new WeakMap,L7=t=>t&&(Uu.has(t)?Uu.get(t):x1(t)===Object.prototype||x1(t)===Array.prototype),M7=t=>L7(t)&&t[B7]||null,I1=(t,e=!0)=>{Uu.set(t,e)},ju=t=>typeof t=="object"&&t!==null,Gr=new WeakMap,Pa=new WeakSet,U7=(t=Object.is,e=(l,u)=>new Proxy(l,u),r=l=>ju(l)&&!Pa.has(l)&&(Array.isArray(l)||!(Symbol.iterator in l))&&!(l instanceof WeakMap)&&!(l instanceof WeakSet)&&!(l instanceof Error)&&!(l instanceof Number)&&!(l instanceof Date)&&!(l instanceof String)&&!(l instanceof RegExp)&&!(l instanceof ArrayBuffer),n=l=>{switch(l.status){case"fulfilled":return l.value;case"rejected":throw l.reason;default:throw l}},i=new WeakMap,s=(l,u,h=n)=>{const d=i.get(l);if(d?.[0]===u)return d[1];const p=Array.isArray(l)?[]:Object.create(Object.getPrototypeOf(l));return I1(p,!0),i.set(l,[u,p]),Reflect.ownKeys(l).forEach(f=>{if(Object.getOwnPropertyDescriptor(p,f))return;const g=Reflect.get(l,f),m={value:g,enumerable:!0,configurable:!0};if(Pa.has(g))I1(g,!1);else if(g instanceof Promise)delete m.value,m.get=()=>h(g);else if(Gr.has(g)){const[w,y]=Gr.get(g);m.value=s(w,y(),h)}Object.defineProperty(p,f,m)}),Object.preventExtensions(p)},o=new WeakMap,a=[1,1],c=l=>{if(!ju(l))throw new Error("object required");const u=o.get(l);if(u)return u;let h=a[0];const d=new Set,p=($,B=++a[0])=>{h!==B&&(h=B,d.forEach(D=>D($,B)))};let f=a[1];const g=($=++a[1])=>(f!==$&&!d.size&&(f=$,w.forEach(([B])=>{const D=B[1]($);D>h&&(h=D)})),h),m=$=>(B,D)=>{const R=[...B];R[1]=[$,...R[1]],p(R,D)},w=new Map,y=($,B)=>{if(w.has($))throw new Error("prop listener already exists");if(d.size){const D=B[3](m($));w.set($,[B,D])}else w.set($,[B])},E=$=>{var B;const D=w.get($);D&&(w.delete($),(B=D[1])==null||B.call(D))},_=$=>(d.add($),d.size===1&&w.forEach(([D,R],M)=>{if(R)throw new Error("remove already exists");const A=D[3](m(M));w.set(M,[D,A])}),()=>{d.delete($),d.size===0&&w.forEach(([D,R],M)=>{R&&(R(),w.set(M,[D]))})}),O=Array.isArray(l)?[]:Object.create(Object.getPrototypeOf(l)),x=e(O,{deleteProperty($,B){const D=Reflect.get($,B);E(B);const R=Reflect.deleteProperty($,B);return R&&p(["delete",[B],D]),R},set($,B,D,R){const M=Reflect.has($,B),A=Reflect.get($,B,R);if(M&&(t(A,D)||o.has(D)&&t(A,o.get(D))))return!0;E(B),ju(D)&&(D=M7(D)||D);let b=D;if(D instanceof Promise)D.then(v=>{D.status="fulfilled",D.value=v,p(["resolve",[B],v])}).catch(v=>{D.status="rejected",D.reason=v,p(["reject",[B],v])});else{!Gr.has(D)&&r(D)&&(b=c(D));const v=!Pa.has(b)&&Gr.get(b);v&&y(B,v)}return Reflect.set($,B,b,R),p(["set",[B],D,A]),!0}});o.set(l,x);const P=[O,g,s,_];return Gr.set(x,P),Reflect.ownKeys(l).forEach($=>{const B=Object.getOwnPropertyDescriptor(l,$);"value"in B&&(x[$]=l[$],delete B.value,delete B.writable),Object.defineProperty(O,$,B)}),x})=>[c,Gr,Pa,t,e,r,n,i,s,o,a],[j7]=U7();function Zr(t={}){return j7(t)}function Dn(t,e,r){const n=Gr.get(t);n||console.warn("Please use proxy object");let i;const s=[],o=n[3];let a=!1;const l=o(u=>{if(s.push(u),r){e(s.splice(0));return}i||(i=Promise.resolve().then(()=>{i=void 0,a&&e(s.splice(0))}))});return a=!0,()=>{a=!1,l()}}function F7(t,e){const r=Gr.get(t);r||console.warn("Please use proxy object");const[n,i,s]=r;return s(n,i(),e)}const ze=Zr({history:["ConnectWallet"],view:"ConnectWallet",data:void 0}),be={state:ze,subscribe(t){return Dn(ze,()=>t(ze))},push(t,e){t!==ze.view&&(ze.view=t,e&&(ze.data=e),ze.history.push(t))},reset(t){ze.view=t,ze.history=[t]},replace(t){ze.history.length>1&&(ze.history[ze.history.length-1]=t,ze.view=t)},goBack(){if(ze.history.length>1){ze.history.pop();const[t]=ze.history.slice(-1);ze.view=t}},setData(t){ze.data=t}},V={WALLETCONNECT_DEEPLINK_CHOICE:"WALLETCONNECT_DEEPLINK_CHOICE",WCM_VERSION:"WCM_VERSION",RECOMMENDED_WALLET_AMOUNT:9,isMobile(){return typeof window<"u"?!!(window.matchMedia("(pointer:coarse)").matches||/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini/u.test(navigator.userAgent)):!1},isAndroid(){return V.isMobile()&&navigator.userAgent.toLowerCase().includes("android")},isIos(){const t=navigator.userAgent.toLowerCase();return V.isMobile()&&(t.includes("iphone")||t.includes("ipad"))},isHttpUrl(t){return t.startsWith("http://")||t.startsWith("https://")},isArray(t){return Array.isArray(t)&&t.length>0},isTelegram(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)},formatNativeUrl(t,e,r){if(V.isHttpUrl(t))return this.formatUniversalUrl(t,e,r);let n=t;n.includes("://")||(n=t.replaceAll("/","").replaceAll(":",""),n=`${n}://`),n.endsWith("/")||(n=`${n}/`),this.setWalletConnectDeepLink(n,r);const i=encodeURIComponent(e);return`${n}wc?uri=${i}`},formatUniversalUrl(t,e,r){if(!V.isHttpUrl(t))return this.formatNativeUrl(t,e,r);let n=t;if(n.startsWith("https://t.me")){const s=Buffer.from(e).toString("base64").replace(/[=]/g,"");n.endsWith("/")&&(n=n.slice(0,-1)),this.setWalletConnectDeepLink(n,r);const o=new URL(n);return o.searchParams.set("startapp",s),o.toString()}n.endsWith("/")||(n=`${n}/`),this.setWalletConnectDeepLink(n,r);const i=encodeURIComponent(e);return`${n}wc?uri=${i}`},async wait(t){return new Promise(e=>{setTimeout(e,t)})},openHref(t,e){const r=this.isTelegram()?"_blank":e;window.open(t,r,"noreferrer noopener")},setWalletConnectDeepLink(t,e){try{localStorage.setItem(V.WALLETCONNECT_DEEPLINK_CHOICE,JSON.stringify({href:t,name:e}))}catch{console.info("Unable to set WalletConnect deep link")}},setWalletConnectAndroidDeepLink(t){try{const[e]=t.split("?");localStorage.setItem(V.WALLETCONNECT_DEEPLINK_CHOICE,JSON.stringify({href:e,name:"Android"}))}catch{console.info("Unable to set WalletConnect android deep link")}},removeWalletConnectDeepLink(){try{localStorage.removeItem(V.WALLETCONNECT_DEEPLINK_CHOICE)}catch{console.info("Unable to remove WalletConnect deep link")}},setModalVersionInStorage(){try{typeof localStorage<"u"&&localStorage.setItem(V.WCM_VERSION,"2.7.0")}catch{console.info("Unable to set Web3Modal version in storage")}},getWalletRouterData(){var t;const e=(t=be.state.data)==null?void 0:t.Wallet;if(!e)throw new Error('Missing "Wallet" view data');return e}},k7=typeof location<"u"&&(location.hostname.includes("localhost")||location.protocol.includes("https")),tt=Zr({enabled:k7,userSessionId:"",events:[],connectedWalletId:void 0}),O1={state:tt,subscribe(t){return Dn(tt.events,()=>t(F7(tt.events[tt.events.length-1])))},initialize(){tt.enabled&&typeof(crypto==null?void 0:crypto.randomUUID)<"u"&&(tt.userSessionId=crypto.randomUUID())},setConnectedWalletId(t){tt.connectedWalletId=t},click(t){if(tt.enabled){const e={type:"CLICK",name:t.name,userSessionId:tt.userSessionId,timestamp:Date.now(),data:t};tt.events.push(e)}},track(t){if(tt.enabled){const e={type:"TRACK",name:t.name,userSessionId:tt.userSessionId,timestamp:Date.now(),data:t};tt.events.push(e)}},view(t){if(tt.enabled){const e={type:"VIEW",name:t.name,userSessionId:tt.userSessionId,timestamp:Date.now(),data:t};tt.events.push(e)}}},ar=Zr({chains:void 0,walletConnectUri:void 0,isAuth:!1,isCustomDesktop:!1,isCustomMobile:!1,isDataLoaded:!1,isUiLoaded:!1}),Oe={state:ar,subscribe(t){return Dn(ar,()=>t(ar))},setChains(t){ar.chains=t},setWalletConnectUri(t){ar.walletConnectUri=t},setIsCustomDesktop(t){ar.isCustomDesktop=t},setIsCustomMobile(t){ar.isCustomMobile=t},setIsDataLoaded(t){ar.isDataLoaded=t},setIsUiLoaded(t){ar.isUiLoaded=t},setIsAuth(t){ar.isAuth=t}},Da=Zr({projectId:"",mobileWallets:void 0,desktopWallets:void 0,walletImages:void 0,chains:void 0,enableAuthMode:!1,enableExplorer:!0,explorerExcludedWalletIds:void 0,explorerRecommendedWalletIds:void 0,termsOfServiceUrl:void 0,privacyPolicyUrl:void 0}),Ot={state:Da,subscribe(t){return Dn(Da,()=>t(Da))},setConfig(t){var e,r;O1.initialize(),Oe.setChains(t.chains),Oe.setIsAuth(!!t.enableAuthMode),Oe.setIsCustomMobile(!!((e=t.mobileWallets)!=null&&e.length)),Oe.setIsCustomDesktop(!!((r=t.desktopWallets)!=null&&r.length)),V.setModalVersionInStorage(),Object.assign(Da,t)}};var q7=Object.defineProperty,S1=Object.getOwnPropertySymbols,z7=Object.prototype.hasOwnProperty,H7=Object.prototype.propertyIsEnumerable,A1=(t,e,r)=>e in t?q7(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,V7=(t,e)=>{for(var r in e||(e={}))z7.call(e,r)&&A1(t,r,e[r]);if(S1)for(var r of S1(e))H7.call(e,r)&&A1(t,r,e[r]);return t};const Fu="https://explorer-api.walletconnect.com",ku="wcm",qu="js-2.7.0";async function Ta(t,e){const r=V7({sdkType:ku,sdkVersion:qu},e),n=new URL(t,Fu);return n.searchParams.append("projectId",Ot.state.projectId),Object.entries(r).forEach(([s,o])=>{o&&n.searchParams.append(s,String(o))}),(await fetch(n)).json()}const Tn={async getDesktopListings(t){return Ta("/w3m/v1/getDesktopListings",t)},async getMobileListings(t){return Ta("/w3m/v1/getMobileListings",t)},async getInjectedListings(t){return Ta("/w3m/v1/getInjectedListings",t)},async getAllListings(t){return Ta("/w3m/v1/getAllListings",t)},getWalletImageUrl(t){return`${Fu}/w3m/v1/getWalletImage/${t}?projectId=${Ot.state.projectId}&sdkType=${ku}&sdkVersion=${qu}`},getAssetImageUrl(t){return`${Fu}/w3m/v1/getAssetImage/${t}?projectId=${Ot.state.projectId}&sdkType=${ku}&sdkVersion=${qu}`}};var W7=Object.defineProperty,C1=Object.getOwnPropertySymbols,K7=Object.prototype.hasOwnProperty,G7=Object.prototype.propertyIsEnumerable,P1=(t,e,r)=>e in t?W7(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Z7=(t,e)=>{for(var r in e||(e={}))K7.call(e,r)&&P1(t,r,e[r]);if(C1)for(var r of C1(e))G7.call(e,r)&&P1(t,r,e[r]);return t};const D1=V.isMobile(),cr=Zr({wallets:{listings:[],total:0,page:1},search:{listings:[],total:0,page:1},recomendedWallets:[]}),mt={state:cr,async getRecomendedWallets(){const{explorerRecommendedWalletIds:t,explorerExcludedWalletIds:e}=Ot.state;if(t==="NONE"||e==="ALL"&&!t)return cr.recomendedWallets;if(V.isArray(t)){const n={recommendedIds:t.join(",")},{listings:i}=await Tn.getAllListings(n),s=Object.values(i);s.sort((o,a)=>{const c=t.indexOf(o.id),l=t.indexOf(a.id);return c-l}),cr.recomendedWallets=s}else{const{chains:r,isAuth:n}=Oe.state,i=r?.join(","),s=V.isArray(e),o={page:1,sdks:n?"auth_v1":void 0,entries:V.RECOMMENDED_WALLET_AMOUNT,chains:i,version:2,excludedIds:s?e.join(","):void 0},{listings:a}=D1?await Tn.getMobileListings(o):await Tn.getDesktopListings(o);cr.recomendedWallets=Object.values(a)}return cr.recomendedWallets},async getWallets(t){const e=Z7({},t),{explorerRecommendedWalletIds:r,explorerExcludedWalletIds:n}=Ot.state,{recomendedWallets:i}=cr;if(n==="ALL")return cr.wallets;i.length?e.excludedIds=i.map(h=>h.id).join(","):V.isArray(r)&&(e.excludedIds=r.join(",")),V.isArray(n)&&(e.excludedIds=[e.excludedIds,n].filter(Boolean).join(",")),Oe.state.isAuth&&(e.sdks="auth_v1");const{page:s,search:o}=t,{listings:a,total:c}=D1?await Tn.getMobileListings(e):await Tn.getDesktopListings(e),l=Object.values(a),u=o?"search":"wallets";return cr[u]={listings:[...cr[u].listings,...l],total:c,page:s??1},{listings:l,total:c}},getWalletImageUrl(t){return Tn.getWalletImageUrl(t)},getAssetImageUrl(t){return Tn.getAssetImageUrl(t)},resetSearch(){cr.search={listings:[],total:0,page:1}}},ji=Zr({open:!1}),Rn={state:ji,subscribe(t){return Dn(ji,()=>t(ji))},async open(t){return new Promise(e=>{const{isUiLoaded:r,isDataLoaded:n}=Oe.state;if(V.removeWalletConnectDeepLink(),Oe.setWalletConnectUri(t?.uri),Oe.setChains(t?.chains),be.reset("ConnectWallet"),r&&n)ji.open=!0,e();else{const i=setInterval(()=>{const s=Oe.state;s.isUiLoaded&&s.isDataLoaded&&(clearInterval(i),ji.open=!0,e())},200)}})},close(){ji.open=!1}};var Y7=Object.defineProperty,T1=Object.getOwnPropertySymbols,J7=Object.prototype.hasOwnProperty,Q7=Object.prototype.propertyIsEnumerable,R1=(t,e,r)=>e in t?Y7(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,X7=(t,e)=>{for(var r in e||(e={}))J7.call(e,r)&&R1(t,r,e[r]);if(T1)for(var r of T1(e))Q7.call(e,r)&&R1(t,r,e[r]);return t};function eD(){return typeof matchMedia<"u"&&matchMedia("(prefers-color-scheme: dark)").matches}const Ys=Zr({themeMode:eD()?"dark":"light"}),Yr={state:Ys,subscribe(t){return Dn(Ys,()=>t(Ys))},setThemeConfig(t){const{themeMode:e,themeVariables:r}=t;e&&(Ys.themeMode=e),r&&(Ys.themeVariables=X7({},r))}},Nn=Zr({open:!1,message:"",variant:"success"}),Jr={state:Nn,subscribe(t){return Dn(Nn,()=>t(Nn))},openToast(t,e){Nn.open=!0,Nn.message=t,Nn.variant=e},closeToast(){Nn.open=!1}};class tD{constructor(e){this.openModal=Rn.open,this.closeModal=Rn.close,this.subscribeModal=Rn.subscribe,this.setTheme=Yr.setThemeConfig,Yr.setThemeConfig(e),Ot.setConfig(e),this.initUi()}async initUi(){if(typeof window<"u"){await Promise.resolve().then(function(){return hN});const e=document.createElement("wcm-modal");document.body.insertAdjacentElement("beforeend",e),Oe.setIsUiLoaded(!0)}}}var rD=Object.freeze({__proto__:null,WalletConnectModal:tD});/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Ra=window,zu=Ra.ShadowRoot&&(Ra.ShadyCSS===void 0||Ra.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,Hu=Symbol(),N1=new WeakMap;class B1{constructor(e,r,n){if(this._$cssResult$=!0,n!==Hu)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=r}get styleSheet(){let e=this.o;const r=this.t;if(zu&&e===void 0){const n=r!==void 0&&r.length===1;n&&(e=N1.get(r)),e===void 0&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),n&&N1.set(r,e))}return e}toString(){return this.cssText}}const nD=t=>new B1(typeof t=="string"?t:t+"",void 0,Hu),ae=(t,...e)=>{const r=t.length===1?t[0]:e.reduce((n,i,s)=>n+(o=>{if(o._$cssResult$===!0)return o.cssText;if(typeof o=="number")return o;throw Error("Value passed to 'css' function must be a 'css' function result: "+o+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(i)+t[s+1],t[0]);return new B1(r,t,Hu)},iD=(t,e)=>{zu?t.adoptedStyleSheets=e.map(r=>r instanceof CSSStyleSheet?r:r.styleSheet):e.forEach(r=>{const n=document.createElement("style"),i=Ra.litNonce;i!==void 0&&n.setAttribute("nonce",i),n.textContent=r.cssText,t.appendChild(n)})},L1=zu?t=>t:t=>t instanceof CSSStyleSheet?(e=>{let r="";for(const n of e.cssRules)r+=n.cssText;return nD(r)})(t):t;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */var Vu;const Na=window,M1=Na.trustedTypes,sD=M1?M1.emptyScript:"",U1=Na.reactiveElementPolyfillSupport,Wu={toAttribute(t,e){switch(e){case Boolean:t=t?sD:null;break;case Object:case Array:t=t==null?t:JSON.stringify(t)}return t},fromAttribute(t,e){let r=t;switch(e){case Boolean:r=t!==null;break;case Number:r=t===null?null:Number(t);break;case Object:case Array:try{r=JSON.parse(t)}catch{r=null}}return r}},j1=(t,e)=>e!==t&&(e==e||t==t),Ku={attribute:!0,type:String,converter:Wu,reflect:!1,hasChanged:j1},Gu="finalized";class Fi extends HTMLElement{constructor(){super(),this._$Ei=new Map,this.isUpdatePending=!1,this.hasUpdated=!1,this._$El=null,this._$Eu()}static addInitializer(e){var r;this.finalize(),((r=this.h)!==null&&r!==void 0?r:this.h=[]).push(e)}static get observedAttributes(){this.finalize();const e=[];return this.elementProperties.forEach((r,n)=>{const i=this._$Ep(n,r);i!==void 0&&(this._$Ev.set(i,n),e.push(i))}),e}static createProperty(e,r=Ku){if(r.state&&(r.attribute=!1),this.finalize(),this.elementProperties.set(e,r),!r.noAccessor&&!this.prototype.hasOwnProperty(e)){const n=typeof e=="symbol"?Symbol():"__"+e,i=this.getPropertyDescriptor(e,n,r);i!==void 0&&Object.defineProperty(this.prototype,e,i)}}static getPropertyDescriptor(e,r,n){return{get(){return this[r]},set(i){const s=this[e];this[r]=i,this.requestUpdate(e,s,n)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)||Ku}static finalize(){if(this.hasOwnProperty(Gu))return!1;this[Gu]=!0;const e=Object.getPrototypeOf(this);if(e.finalize(),e.h!==void 0&&(this.h=[...e.h]),this.elementProperties=new Map(e.elementProperties),this._$Ev=new Map,this.hasOwnProperty("properties")){const r=this.properties,n=[...Object.getOwnPropertyNames(r),...Object.getOwnPropertySymbols(r)];for(const i of n)this.createProperty(i,r[i])}return this.elementStyles=this.finalizeStyles(this.styles),!0}static finalizeStyles(e){const r=[];if(Array.isArray(e)){const n=new Set(e.flat(1/0).reverse());for(const i of n)r.unshift(L1(i))}else e!==void 0&&r.push(L1(e));return r}static _$Ep(e,r){const n=r.attribute;return n===!1?void 0:typeof n=="string"?n:typeof e=="string"?e.toLowerCase():void 0}_$Eu(){var e;this._$E_=new Promise(r=>this.enableUpdating=r),this._$AL=new Map,this._$Eg(),this.requestUpdate(),(e=this.constructor.h)===null||e===void 0||e.forEach(r=>r(this))}addController(e){var r,n;((r=this._$ES)!==null&&r!==void 0?r:this._$ES=[]).push(e),this.renderRoot!==void 0&&this.isConnected&&((n=e.hostConnected)===null||n===void 0||n.call(e))}removeController(e){var r;(r=this._$ES)===null||r===void 0||r.splice(this._$ES.indexOf(e)>>>0,1)}_$Eg(){this.constructor.elementProperties.forEach((e,r)=>{this.hasOwnProperty(r)&&(this._$Ei.set(r,this[r]),delete this[r])})}createRenderRoot(){var e;const r=(e=this.shadowRoot)!==null&&e!==void 0?e:this.attachShadow(this.constructor.shadowRootOptions);return iD(r,this.constructor.elementStyles),r}connectedCallback(){var e;this.renderRoot===void 0&&(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),(e=this._$ES)===null||e===void 0||e.forEach(r=>{var n;return(n=r.hostConnected)===null||n===void 0?void 0:n.call(r)})}enableUpdating(e){}disconnectedCallback(){var e;(e=this._$ES)===null||e===void 0||e.forEach(r=>{var n;return(n=r.hostDisconnected)===null||n===void 0?void 0:n.call(r)})}attributeChangedCallback(e,r,n){this._$AK(e,n)}_$EO(e,r,n=Ku){var i;const s=this.constructor._$Ep(e,n);if(s!==void 0&&n.reflect===!0){const o=(((i=n.converter)===null||i===void 0?void 0:i.toAttribute)!==void 0?n.converter:Wu).toAttribute(r,n.type);this._$El=e,o==null?this.removeAttribute(s):this.setAttribute(s,o),this._$El=null}}_$AK(e,r){var n;const i=this.constructor,s=i._$Ev.get(e);if(s!==void 0&&this._$El!==s){const o=i.getPropertyOptions(s),a=typeof o.converter=="function"?{fromAttribute:o.converter}:((n=o.converter)===null||n===void 0?void 0:n.fromAttribute)!==void 0?o.converter:Wu;this._$El=s,this[s]=a.fromAttribute(r,o.type),this._$El=null}}requestUpdate(e,r,n){let i=!0;e!==void 0&&(((n=n||this.constructor.getPropertyOptions(e)).hasChanged||j1)(this[e],r)?(this._$AL.has(e)||this._$AL.set(e,r),n.reflect===!0&&this._$El!==e&&(this._$EC===void 0&&(this._$EC=new Map),this._$EC.set(e,n))):i=!1),!this.isUpdatePending&&i&&(this._$E_=this._$Ej())}async _$Ej(){this.isUpdatePending=!0;try{await this._$E_}catch(r){Promise.reject(r)}const e=this.scheduleUpdate();return e!=null&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var e;if(!this.isUpdatePending)return;this.hasUpdated,this._$Ei&&(this._$Ei.forEach((i,s)=>this[s]=i),this._$Ei=void 0);let r=!1;const n=this._$AL;try{r=this.shouldUpdate(n),r?(this.willUpdate(n),(e=this._$ES)===null||e===void 0||e.forEach(i=>{var s;return(s=i.hostUpdate)===null||s===void 0?void 0:s.call(i)}),this.update(n)):this._$Ek()}catch(i){throw r=!1,this._$Ek(),i}r&&this._$AE(n)}willUpdate(e){}_$AE(e){var r;(r=this._$ES)===null||r===void 0||r.forEach(n=>{var i;return(i=n.hostUpdated)===null||i===void 0?void 0:i.call(n)}),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$Ek(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$E_}shouldUpdate(e){return!0}update(e){this._$EC!==void 0&&(this._$EC.forEach((r,n)=>this._$EO(n,this[n],r)),this._$EC=void 0),this._$Ek()}updated(e){}firstUpdated(e){}}Fi[Gu]=!0,Fi.elementProperties=new Map,Fi.elementStyles=[],Fi.shadowRootOptions={mode:"open"},U1?.({ReactiveElement:Fi}),((Vu=Na.reactiveElementVersions)!==null&&Vu!==void 0?Vu:Na.reactiveElementVersions=[]).push("1.6.3");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */var Zu;const Ba=window,ki=Ba.trustedTypes,F1=ki?ki.createPolicy("lit-html",{createHTML:t=>t}):void 0,Yu="$lit$",Qr=`lit$${(Math.random()+"").slice(9)}$`,k1="?"+Qr,oD=`<${k1}>`,Bn=document,Js=()=>Bn.createComment(""),Qs=t=>t===null||typeof t!="object"&&typeof t!="function",q1=Array.isArray,aD=t=>q1(t)||typeof t?.[Symbol.iterator]=="function",Ju=`[ 	
\f\r]`,Xs=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,z1=/-->/g,H1=/>/g,Ln=RegExp(`>|${Ju}(?:([^\\s"'>=/]+)(${Ju}*=${Ju}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),V1=/'/g,W1=/"/g,K1=/^(?:script|style|textarea|title)$/i,G1=t=>(e,...r)=>({_$litType$:t,strings:e,values:r}),z=G1(1),Ee=G1(2),Mn=Symbol.for("lit-noChange"),Re=Symbol.for("lit-nothing"),Z1=new WeakMap,Un=Bn.createTreeWalker(Bn,129,null,!1);function Y1(t,e){if(!Array.isArray(t)||!t.hasOwnProperty("raw"))throw Error("invalid template strings array");return F1!==void 0?F1.createHTML(e):e}const cD=(t,e)=>{const r=t.length-1,n=[];let i,s=e===2?"<svg>":"",o=Xs;for(let a=0;a<r;a++){const c=t[a];let l,u,h=-1,d=0;for(;d<c.length&&(o.lastIndex=d,u=o.exec(c),u!==null);)d=o.lastIndex,o===Xs?u[1]==="!--"?o=z1:u[1]!==void 0?o=H1:u[2]!==void 0?(K1.test(u[2])&&(i=RegExp("</"+u[2],"g")),o=Ln):u[3]!==void 0&&(o=Ln):o===Ln?u[0]===">"?(o=i??Xs,h=-1):u[1]===void 0?h=-2:(h=o.lastIndex-u[2].length,l=u[1],o=u[3]===void 0?Ln:u[3]==='"'?W1:V1):o===W1||o===V1?o=Ln:o===z1||o===H1?o=Xs:(o=Ln,i=void 0);const p=o===Ln&&t[a+1].startsWith("/>")?" ":"";s+=o===Xs?c+oD:h>=0?(n.push(l),c.slice(0,h)+Yu+c.slice(h)+Qr+p):c+Qr+(h===-2?(n.push(void 0),a):p)}return[Y1(t,s+(t[r]||"<?>")+(e===2?"</svg>":"")),n]};class eo{constructor({strings:e,_$litType$:r},n){let i;this.parts=[];let s=0,o=0;const a=e.length-1,c=this.parts,[l,u]=cD(e,r);if(this.el=eo.createElement(l,n),Un.currentNode=this.el.content,r===2){const h=this.el.content,d=h.firstChild;d.remove(),h.append(...d.childNodes)}for(;(i=Un.nextNode())!==null&&c.length<a;){if(i.nodeType===1){if(i.hasAttributes()){const h=[];for(const d of i.getAttributeNames())if(d.endsWith(Yu)||d.startsWith(Qr)){const p=u[o++];if(h.push(d),p!==void 0){const f=i.getAttribute(p.toLowerCase()+Yu).split(Qr),g=/([.?@])?(.*)/.exec(p);c.push({type:1,index:s,name:g[2],strings:f,ctor:g[1]==="."?uD:g[1]==="?"?dD:g[1]==="@"?fD:La})}else c.push({type:6,index:s})}for(const d of h)i.removeAttribute(d)}if(K1.test(i.tagName)){const h=i.textContent.split(Qr),d=h.length-1;if(d>0){i.textContent=ki?ki.emptyScript:"";for(let p=0;p<d;p++)i.append(h[p],Js()),Un.nextNode(),c.push({type:2,index:++s});i.append(h[d],Js())}}}else if(i.nodeType===8)if(i.data===k1)c.push({type:2,index:s});else{let h=-1;for(;(h=i.data.indexOf(Qr,h+1))!==-1;)c.push({type:7,index:s}),h+=Qr.length-1}s++}}static createElement(e,r){const n=Bn.createElement("template");return n.innerHTML=e,n}}function qi(t,e,r=t,n){var i,s,o,a;if(e===Mn)return e;let c=n!==void 0?(i=r._$Co)===null||i===void 0?void 0:i[n]:r._$Cl;const l=Qs(e)?void 0:e._$litDirective$;return c?.constructor!==l&&((s=c?._$AO)===null||s===void 0||s.call(c,!1),l===void 0?c=void 0:(c=new l(t),c._$AT(t,r,n)),n!==void 0?((o=(a=r)._$Co)!==null&&o!==void 0?o:a._$Co=[])[n]=c:r._$Cl=c),c!==void 0&&(e=qi(t,c._$AS(t,e.values),c,n)),e}class lD{constructor(e,r){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=r}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){var r;const{el:{content:n},parts:i}=this._$AD,s=((r=e?.creationScope)!==null&&r!==void 0?r:Bn).importNode(n,!0);Un.currentNode=s;let o=Un.nextNode(),a=0,c=0,l=i[0];for(;l!==void 0;){if(a===l.index){let u;l.type===2?u=new to(o,o.nextSibling,this,e):l.type===1?u=new l.ctor(o,l.name,l.strings,this,e):l.type===6&&(u=new pD(o,this,e)),this._$AV.push(u),l=i[++c]}a!==l?.index&&(o=Un.nextNode(),a++)}return Un.currentNode=Bn,s}v(e){let r=0;for(const n of this._$AV)n!==void 0&&(n.strings!==void 0?(n._$AI(e,n,r),r+=n.strings.length-2):n._$AI(e[r])),r++}}class to{constructor(e,r,n,i){var s;this.type=2,this._$AH=Re,this._$AN=void 0,this._$AA=e,this._$AB=r,this._$AM=n,this.options=i,this._$Cp=(s=i?.isConnected)===null||s===void 0||s}get _$AU(){var e,r;return(r=(e=this._$AM)===null||e===void 0?void 0:e._$AU)!==null&&r!==void 0?r:this._$Cp}get parentNode(){let e=this._$AA.parentNode;const r=this._$AM;return r!==void 0&&e?.nodeType===11&&(e=r.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,r=this){e=qi(this,e,r),Qs(e)?e===Re||e==null||e===""?(this._$AH!==Re&&this._$AR(),this._$AH=Re):e!==this._$AH&&e!==Mn&&this._(e):e._$litType$!==void 0?this.g(e):e.nodeType!==void 0?this.$(e):aD(e)?this.T(e):this._(e)}k(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}$(e){this._$AH!==e&&(this._$AR(),this._$AH=this.k(e))}_(e){this._$AH!==Re&&Qs(this._$AH)?this._$AA.nextSibling.data=e:this.$(Bn.createTextNode(e)),this._$AH=e}g(e){var r;const{values:n,_$litType$:i}=e,s=typeof i=="number"?this._$AC(e):(i.el===void 0&&(i.el=eo.createElement(Y1(i.h,i.h[0]),this.options)),i);if(((r=this._$AH)===null||r===void 0?void 0:r._$AD)===s)this._$AH.v(n);else{const o=new lD(s,this),a=o.u(this.options);o.v(n),this.$(a),this._$AH=o}}_$AC(e){let r=Z1.get(e.strings);return r===void 0&&Z1.set(e.strings,r=new eo(e)),r}T(e){q1(this._$AH)||(this._$AH=[],this._$AR());const r=this._$AH;let n,i=0;for(const s of e)i===r.length?r.push(n=new to(this.k(Js()),this.k(Js()),this,this.options)):n=r[i],n._$AI(s),i++;i<r.length&&(this._$AR(n&&n._$AB.nextSibling,i),r.length=i)}_$AR(e=this._$AA.nextSibling,r){var n;for((n=this._$AP)===null||n===void 0||n.call(this,!1,!0,r);e&&e!==this._$AB;){const i=e.nextSibling;e.remove(),e=i}}setConnected(e){var r;this._$AM===void 0&&(this._$Cp=e,(r=this._$AP)===null||r===void 0||r.call(this,e))}}class La{constructor(e,r,n,i,s){this.type=1,this._$AH=Re,this._$AN=void 0,this.element=e,this.name=r,this._$AM=i,this.options=s,n.length>2||n[0]!==""||n[1]!==""?(this._$AH=Array(n.length-1).fill(new String),this.strings=n):this._$AH=Re}get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}_$AI(e,r=this,n,i){const s=this.strings;let o=!1;if(s===void 0)e=qi(this,e,r,0),o=!Qs(e)||e!==this._$AH&&e!==Mn,o&&(this._$AH=e);else{const a=e;let c,l;for(e=s[0],c=0;c<s.length-1;c++)l=qi(this,a[n+c],r,c),l===Mn&&(l=this._$AH[c]),o||(o=!Qs(l)||l!==this._$AH[c]),l===Re?e=Re:e!==Re&&(e+=(l??"")+s[c+1]),this._$AH[c]=l}o&&!i&&this.j(e)}j(e){e===Re?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}}class uD extends La{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===Re?void 0:e}}const hD=ki?ki.emptyScript:"";class dD extends La{constructor(){super(...arguments),this.type=4}j(e){e&&e!==Re?this.element.setAttribute(this.name,hD):this.element.removeAttribute(this.name)}}class fD extends La{constructor(e,r,n,i,s){super(e,r,n,i,s),this.type=5}_$AI(e,r=this){var n;if((e=(n=qi(this,e,r,0))!==null&&n!==void 0?n:Re)===Mn)return;const i=this._$AH,s=e===Re&&i!==Re||e.capture!==i.capture||e.once!==i.once||e.passive!==i.passive,o=e!==Re&&(i===Re||s);s&&this.element.removeEventListener(this.name,this,i),o&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){var r,n;typeof this._$AH=="function"?this._$AH.call((n=(r=this.options)===null||r===void 0?void 0:r.host)!==null&&n!==void 0?n:this.element,e):this._$AH.handleEvent(e)}}class pD{constructor(e,r,n){this.element=e,this.type=6,this._$AN=void 0,this._$AM=r,this.options=n}get _$AU(){return this._$AM._$AU}_$AI(e){qi(this,e)}}const J1=Ba.litHtmlPolyfillSupport;J1?.(eo,to),((Zu=Ba.litHtmlVersions)!==null&&Zu!==void 0?Zu:Ba.litHtmlVersions=[]).push("2.8.0");const gD=(t,e,r)=>{var n,i;const s=(n=r?.renderBefore)!==null&&n!==void 0?n:e;let o=s._$litPart$;if(o===void 0){const a=(i=r?.renderBefore)!==null&&i!==void 0?i:null;s._$litPart$=o=new to(e.insertBefore(Js(),a),a,void 0,r??{})}return o._$AI(t),o};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */var Qu,Xu;class J extends Fi{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var e,r;const n=super.createRenderRoot();return(e=(r=this.renderOptions).renderBefore)!==null&&e!==void 0||(r.renderBefore=n.firstChild),n}update(e){const r=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=gD(r,this.renderRoot,this.renderOptions)}connectedCallback(){var e;super.connectedCallback(),(e=this._$Do)===null||e===void 0||e.setConnected(!0)}disconnectedCallback(){var e;super.disconnectedCallback(),(e=this._$Do)===null||e===void 0||e.setConnected(!1)}render(){return Mn}}J.finalized=!0,J._$litElement$=!0,(Qu=globalThis.litElementHydrateSupport)===null||Qu===void 0||Qu.call(globalThis,{LitElement:J});const Q1=globalThis.litElementPolyfillSupport;Q1?.({LitElement:J}),((Xu=globalThis.litElementVersions)!==null&&Xu!==void 0?Xu:globalThis.litElementVersions=[]).push("3.3.3");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const ne=t=>e=>typeof e=="function"?((r,n)=>(customElements.define(r,n),n))(t,e):((r,n)=>{const{kind:i,elements:s}=n;return{kind:i,elements:s,finisher(o){customElements.define(r,o)}}})(t,e);/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const mD=(t,e)=>e.kind==="method"&&e.descriptor&&!("value"in e.descriptor)?{...e,finisher(r){r.createProperty(e.key,t)}}:{kind:"field",key:Symbol(),placement:"own",descriptor:{},originalKey:e.key,initializer(){typeof e.initializer=="function"&&(this[e.key]=e.initializer.call(this))},finisher(r){r.createProperty(e.key,t)}},wD=(t,e,r)=>{e.constructor.createProperty(r,t)};function Z(t){return(e,r)=>r!==void 0?wD(t,e,r):mD(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function wt(t){return Z({...t,state:!0})}/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */var eh;((eh=window.HTMLSlotElement)===null||eh===void 0?void 0:eh.prototype.assignedElements)!=null;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const yD={ATTRIBUTE:1,CHILD:2,PROPERTY:3,BOOLEAN_ATTRIBUTE:4,EVENT:5,ELEMENT:6},bD=t=>(...e)=>({_$litDirective$:t,values:e});class vD{constructor(e){}get _$AU(){return this._$AM._$AU}_$AT(e,r,n){this._$Ct=e,this._$AM=r,this._$Ci=n}_$AS(e,r){return this.update(e,r)}update(e,r){return this.render(...r)}}/**
 * @license
 * Copyright 2018 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Sr=bD(class extends vD{constructor(t){var e;if(super(t),t.type!==yD.ATTRIBUTE||t.name!=="class"||((e=t.strings)===null||e===void 0?void 0:e.length)>2)throw Error("`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.")}render(t){return" "+Object.keys(t).filter(e=>t[e]).join(" ")+" "}update(t,[e]){var r,n;if(this.it===void 0){this.it=new Set,t.strings!==void 0&&(this.nt=new Set(t.strings.join(" ").split(/\s/).filter(s=>s!=="")));for(const s in e)e[s]&&!(!((r=this.nt)===null||r===void 0)&&r.has(s))&&this.it.add(s);return this.render(e)}const i=t.element.classList;this.it.forEach(s=>{s in e||(i.remove(s),this.it.delete(s))});for(const s in e){const o=!!e[s];o===this.it.has(s)||!((n=this.nt)===null||n===void 0)&&n.has(s)||(o?(i.add(s),this.it.add(s)):(i.remove(s),this.it.delete(s)))}return Mn}});function ED(t,e){t.indexOf(e)===-1&&t.push(e)}const X1=(t,e,r)=>Math.min(Math.max(r,t),e),Lt={duration:.3,delay:0,endDelay:0,repeat:0,easing:"ease"},Ma=t=>typeof t=="number",zi=t=>Array.isArray(t)&&!Ma(t[0]),_D=(t,e,r)=>{const n=e-t;return((r-t)%n+n)%n+t};function $D(t,e){return zi(t)?t[_D(0,t.length,e)]:t}const ew=(t,e,r)=>-r*t+r*e+t,tw=()=>{},Xr=t=>t,th=(t,e,r)=>e-t===0?1:(r-t)/(e-t);function rw(t,e){const r=t[t.length-1];for(let n=1;n<=e;n++){const i=th(0,e,n);t.push(ew(r,1,i))}}function xD(t){const e=[0];return rw(e,t-1),e}function ID(t,e=xD(t.length),r=Xr){const n=t.length,i=n-e.length;return i>0&&rw(e,i),s=>{let o=0;for(;o<n-2&&!(s<e[o+1]);o++);let a=X1(0,1,th(e[o],e[o+1],s));return a=$D(r,o)(a),ew(t[o],t[o+1],a)}}const nw=t=>Array.isArray(t)&&Ma(t[0]),rh=t=>typeof t=="object"&&!!t.createAnimation,jn=t=>typeof t=="function",OD=t=>typeof t=="string",ro={ms:t=>t*1e3,s:t=>t/1e3},iw=(t,e,r)=>(((1-3*r+3*e)*t+(3*r-6*e))*t+3*e)*t,SD=1e-7,AD=12;function CD(t,e,r,n,i){let s,o,a=0;do o=e+(r-e)/2,s=iw(o,n,i)-t,s>0?r=o:e=o;while(Math.abs(s)>SD&&++a<AD);return o}function no(t,e,r,n){if(t===e&&r===n)return Xr;const i=s=>CD(s,0,1,t,r);return s=>s===0||s===1?s:iw(i(s),e,n)}const PD=(t,e="end")=>r=>{r=e==="end"?Math.min(r,.999):Math.max(r,.001);const n=r*t,i=e==="end"?Math.floor(n):Math.ceil(n);return X1(0,1,i/t)},DD={ease:no(.25,.1,.25,1),"ease-in":no(.42,0,1,1),"ease-in-out":no(.42,0,.58,1),"ease-out":no(0,0,.58,1)},TD=/\((.*?)\)/;function sw(t){if(jn(t))return t;if(nw(t))return no(...t);const e=DD[t];if(e)return e;if(t.startsWith("steps")){const r=TD.exec(t);if(r){const n=r[1].split(",");return PD(parseFloat(n[0]),n[1].trim())}}return Xr}class ow{constructor(e,r=[0,1],{easing:n,duration:i=Lt.duration,delay:s=Lt.delay,endDelay:o=Lt.endDelay,repeat:a=Lt.repeat,offset:c,direction:l="normal",autoplay:u=!0}={}){if(this.startTime=null,this.rate=1,this.t=0,this.cancelTimestamp=null,this.easing=Xr,this.duration=0,this.totalDuration=0,this.repeat=0,this.playState="idle",this.finished=new Promise((d,p)=>{this.resolve=d,this.reject=p}),n=n||Lt.easing,rh(n)){const d=n.createAnimation(r);n=d.easing,r=d.keyframes||r,i=d.duration||i}this.repeat=a,this.easing=zi(n)?Xr:sw(n),this.updateDuration(i);const h=ID(r,c,zi(n)?n.map(sw):Xr);this.tick=d=>{var p;s=s;let f=0;this.pauseTime!==void 0?f=this.pauseTime:f=(d-this.startTime)*this.rate,this.t=f,f/=1e3,f=Math.max(f-s,0),this.playState==="finished"&&this.pauseTime===void 0&&(f=this.totalDuration);const g=f/this.duration;let m=Math.floor(g),w=g%1;!w&&g>=1&&(w=1),w===1&&m--;const y=m%2;(l==="reverse"||l==="alternate"&&y||l==="alternate-reverse"&&!y)&&(w=1-w);const E=f>=this.totalDuration?1:Math.min(w,1),_=h(this.easing(E));e(_),this.pauseTime===void 0&&(this.playState==="finished"||f>=this.totalDuration+o)?(this.playState="finished",(p=this.resolve)===null||p===void 0||p.call(this,_)):this.playState!=="idle"&&(this.frameRequestId=requestAnimationFrame(this.tick))},u&&this.play()}play(){const e=performance.now();this.playState="running",this.pauseTime!==void 0?this.startTime=e-this.pauseTime:this.startTime||(this.startTime=e),this.cancelTimestamp=this.startTime,this.pauseTime=void 0,this.frameRequestId=requestAnimationFrame(this.tick)}pause(){this.playState="paused",this.pauseTime=this.t}finish(){this.playState="finished",this.tick(0)}stop(){var e;this.playState="idle",this.frameRequestId!==void 0&&cancelAnimationFrame(this.frameRequestId),(e=this.reject)===null||e===void 0||e.call(this,!1)}cancel(){this.stop(),this.tick(this.cancelTimestamp)}reverse(){this.rate*=-1}commitStyles(){}updateDuration(e){this.duration=e,this.totalDuration=e*(this.repeat+1)}get currentTime(){return this.t}set currentTime(e){this.pauseTime!==void 0||this.rate===0?this.pauseTime=e:this.startTime=performance.now()-e/this.rate}get playbackRate(){return this.rate}set playbackRate(e){this.rate=e}}var nh=function(){};process.env.NODE_ENV!=="production"&&(nh=function(t,e){if(!t)throw new Error(e)});class RD{setAnimation(e){this.animation=e,e?.finished.then(()=>this.clearAnimation()).catch(()=>{})}clearAnimation(){this.animation=this.generator=void 0}}const ih=new WeakMap;function aw(t){return ih.has(t)||ih.set(t,{transforms:[],values:new Map}),ih.get(t)}function ND(t,e){return t.has(e)||t.set(e,new RD),t.get(e)}const BD=["","X","Y","Z"],LD=["translate","scale","rotate","skew"],Ua={x:"translateX",y:"translateY",z:"translateZ"},cw={syntax:"<angle>",initialValue:"0deg",toDefaultUnit:t=>t+"deg"},MD={translate:{syntax:"<length-percentage>",initialValue:"0px",toDefaultUnit:t=>t+"px"},rotate:cw,scale:{syntax:"<number>",initialValue:1,toDefaultUnit:Xr},skew:cw},io=new Map,sh=t=>`--motion-${t}`,ja=["x","y","z"];LD.forEach(t=>{BD.forEach(e=>{ja.push(t+e),io.set(sh(t+e),MD[t])})});const UD=(t,e)=>ja.indexOf(t)-ja.indexOf(e),jD=new Set(ja),lw=t=>jD.has(t),FD=(t,e)=>{Ua[e]&&(e=Ua[e]);const{transforms:r}=aw(t);ED(r,e),t.style.transform=kD(r)},kD=t=>t.sort(UD).reduce(qD,"").trim(),qD=(t,e)=>`${t} ${e}(var(${sh(e)}))`,oh=t=>t.startsWith("--"),uw=new Set;function zD(t){if(!uw.has(t)){uw.add(t);try{const{syntax:e,initialValue:r}=io.has(t)?io.get(t):{};CSS.registerProperty({name:t,inherits:!1,syntax:e,initialValue:r})}catch{}}}const ah=(t,e)=>document.createElement("div").animate(t,e),hw={cssRegisterProperty:()=>typeof CSS<"u"&&Object.hasOwnProperty.call(CSS,"registerProperty"),waapi:()=>Object.hasOwnProperty.call(Element.prototype,"animate"),partialKeyframes:()=>{try{ah({opacity:[1]})}catch{return!1}return!0},finished:()=>!!ah({opacity:[0,1]},{duration:.001}).finished,linearEasing:()=>{try{ah({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0}},ch={},Hi={};for(const t in hw)Hi[t]=()=>(ch[t]===void 0&&(ch[t]=hw[t]()),ch[t]);const HD=.015,VD=(t,e)=>{let r="";const n=Math.round(e/HD);for(let i=0;i<n;i++)r+=t(th(0,n-1,i))+", ";return r.substring(0,r.length-2)},dw=(t,e)=>jn(t)?Hi.linearEasing()?`linear(${VD(t,e)})`:Lt.easing:nw(t)?WD(t):t,WD=([t,e,r,n])=>`cubic-bezier(${t}, ${e}, ${r}, ${n})`;function KD(t,e){for(let r=0;r<t.length;r++)t[r]===null&&(t[r]=r?t[r-1]:e());return t}const GD=t=>Array.isArray(t)?t:[t];function lh(t){return Ua[t]&&(t=Ua[t]),lw(t)?sh(t):t}const Fa={get:(t,e)=>{e=lh(e);let r=oh(e)?t.style.getPropertyValue(e):getComputedStyle(t)[e];if(!r&&r!==0){const n=io.get(e);n&&(r=n.initialValue)}return r},set:(t,e,r)=>{e=lh(e),oh(e)?t.style.setProperty(e,r):t.style[e]=r}};function fw(t,e=!0){if(!(!t||t.playState==="finished"))try{t.stop?t.stop():(e&&t.commitStyles(),t.cancel())}catch{}}function ZD(t,e){var r;let n=e?.toDefaultUnit||Xr;const i=t[t.length-1];if(OD(i)){const s=((r=i.match(/(-?[\d.]+)([a-z%]*)/))===null||r===void 0?void 0:r[2])||"";s&&(n=o=>o+s)}return n}function YD(){return window.__MOTION_DEV_TOOLS_RECORD}function JD(t,e,r,n={},i){const s=YD(),o=n.record!==!1&&s;let a,{duration:c=Lt.duration,delay:l=Lt.delay,endDelay:u=Lt.endDelay,repeat:h=Lt.repeat,easing:d=Lt.easing,persist:p=!1,direction:f,offset:g,allowWebkitAcceleration:m=!1,autoplay:w=!0}=n;const y=aw(t),E=lw(e);let _=Hi.waapi();E&&FD(t,e);const O=lh(e),S=ND(y.values,O),x=io.get(O);return fw(S.animation,!(rh(d)&&S.generator)&&n.record!==!1),()=>{const P=()=>{var D,R;return(R=(D=Fa.get(t,O))!==null&&D!==void 0?D:x?.initialValue)!==null&&R!==void 0?R:0};let $=KD(GD(r),P);const B=ZD($,x);if(rh(d)){const D=d.createAnimation($,e!=="opacity",P,O,S);d=D.easing,$=D.keyframes||$,c=D.duration||c}if(oh(O)&&(Hi.cssRegisterProperty()?zD(O):_=!1),E&&!Hi.linearEasing()&&(jn(d)||zi(d)&&d.some(jn))&&(_=!1),_){x&&($=$.map(M=>Ma(M)?x.toDefaultUnit(M):M)),$.length===1&&(!Hi.partialKeyframes()||o)&&$.unshift(P());const D={delay:ro.ms(l),duration:ro.ms(c),endDelay:ro.ms(u),easing:zi(d)?void 0:dw(d,c),direction:f,iterations:h+1,fill:"both"};a=t.animate({[O]:$,offset:g,easing:zi(d)?d.map(M=>dw(M,c)):void 0},D),a.finished||(a.finished=new Promise((M,A)=>{a.onfinish=M,a.oncancel=A}));const R=$[$.length-1];a.finished.then(()=>{p||(Fa.set(t,O,R),a.cancel())}).catch(tw),m||(a.playbackRate=1.000001)}else if(i&&E)$=$.map(D=>typeof D=="string"?parseFloat(D):D),$.length===1&&$.unshift(parseFloat(P())),a=new i(D=>{Fa.set(t,O,B?B(D):D)},$,Object.assign(Object.assign({},n),{duration:c,easing:d}));else{const D=$[$.length-1];Fa.set(t,O,x&&Ma(D)?x.toDefaultUnit(D):D)}return o&&s(t,e,$,{duration:c,delay:l,easing:d,repeat:h,offset:g},"motion-one"),S.setAnimation(a),a&&!w&&a.pause(),a}}const QD=(t,e)=>t[e]?Object.assign(Object.assign({},t),t[e]):Object.assign({},t);function pw(t,e){var r;return typeof t=="string"?e?((r=e[t])!==null&&r!==void 0||(e[t]=document.querySelectorAll(t)),t=e[t]):t=document.querySelectorAll(t):t instanceof Element&&(t=[t]),Array.from(t||[])}const XD=t=>t(),gw=(t,e,r=Lt.duration)=>new Proxy({animations:t.map(XD).filter(Boolean),duration:r,options:e},t9),e9=t=>t.animations[0],t9={get:(t,e)=>{const r=e9(t);switch(e){case"duration":return t.duration;case"currentTime":return ro.s(r?.[e]||0);case"playbackRate":case"playState":return r?.[e];case"finished":return t.finished||(t.finished=Promise.all(t.animations.map(r9)).catch(tw)),t.finished;case"stop":return()=>{t.animations.forEach(n=>fw(n))};case"forEachNative":return n=>{t.animations.forEach(i=>n(i,t))};default:return typeof r?.[e]>"u"?void 0:()=>t.animations.forEach(n=>n[e]())}},set:(t,e,r)=>{switch(e){case"currentTime":r=ro.ms(r);case"playbackRate":for(let n=0;n<t.animations.length;n++)t.animations[n][e]=r;return!0}return!1}},r9=t=>t.finished;function n9(t,e,r){return jn(t)?t(e,r):t}function i9(t){return function(r,n,i={}){r=pw(r);const s=r.length;nh(!!s,"No valid element provided."),nh(!!n,"No keyframes defined.");const o=[];for(let a=0;a<s;a++){const c=r[a];for(const l in n){const u=QD(i,l);u.delay=n9(u.delay,a,s);const h=JD(c,l,n[l],u,t);o.push(h)}}return gw(o,i,i.duration)}}const s9=i9(ow);function o9(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}typeof SuppressedError=="function"&&SuppressedError;const a9={any:0,all:1};function c9(t,e,{root:r,margin:n,amount:i="any"}={}){if(typeof IntersectionObserver>"u")return()=>{};const s=pw(t),o=new WeakMap,a=l=>{l.forEach(u=>{const h=o.get(u.target);if(u.isIntersecting!==!!h)if(u.isIntersecting){const d=e(u);jn(d)?o.set(u.target,d):c.unobserve(u.target)}else h&&(h(u),o.delete(u.target))})},c=new IntersectionObserver(a,{root:r,rootMargin:n,threshold:typeof i=="number"?i:a9[i]});return s.forEach(l=>c.observe(l)),()=>c.disconnect()}function uh(t,e,r){t.dispatchEvent(new CustomEvent(e,{detail:{originalEvent:r}}))}function mw(t,e,r){t.dispatchEvent(new CustomEvent(e,{detail:{originalEntry:r}}))}const l9={isActive:t=>!!t.inView,subscribe:(t,{enable:e,disable:r},{inViewOptions:n={}})=>{const{once:i}=n,s=o9(n,["once"]);return c9(t,o=>{if(e(),mw(t,"viewenter",o),!i)return a=>{r(),mw(t,"viewleave",a)}},s)}},ww=(t,e,r)=>n=>{n.pointerType&&n.pointerType!=="mouse"||(r(),uh(t,e,n))};[...Object.keys({inView:l9,hover:{isActive:t=>!!t.hover,subscribe:(t,{enable:e,disable:r})=>{const n=ww(t,"hoverstart",e),i=ww(t,"hoverend",r);return t.addEventListener("pointerenter",n),t.addEventListener("pointerleave",i),()=>{t.removeEventListener("pointerenter",n),t.removeEventListener("pointerleave",i)}}},press:{isActive:t=>!!t.press,subscribe:(t,{enable:e,disable:r})=>{const n=s=>{r(),uh(t,"pressend",s),window.removeEventListener("pointerup",n)},i=s=>{e(),uh(t,"pressstart",s),window.addEventListener("pointerup",n)};return t.addEventListener("pointerdown",i),()=>{t.removeEventListener("pointerdown",i),window.removeEventListener("pointerup",n)}}}})];function u9(t,e={}){return gw([()=>{const r=new ow(t,[0,1],e);return r.finished.catch(()=>{}),r}],e,e.duration)}function Fn(t,e,r){return(jn(t)?u9:s9)(t,e,r)}/**
 * @license
 * Copyright 2018 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const at=t=>t??Re;var so={},h9=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then},yw={},St={};let hh;const d9=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];St.getSymbolSize=function(e){if(!e)throw new Error('"version" cannot be null or undefined');if(e<1||e>40)throw new Error('"version" should be in range from 1 to 40');return e*4+17},St.getSymbolTotalCodewords=function(e){return d9[e]},St.getBCHDigit=function(t){let e=0;for(;t!==0;)e++,t>>>=1;return e},St.setToSJISFunction=function(e){if(typeof e!="function")throw new Error('"toSJISFunc" is not a valid function.');hh=e},St.isKanjiModeEnabled=function(){return typeof hh<"u"},St.toSJIS=function(e){return hh(e)};var ka={};(function(t){t.L={bit:1},t.M={bit:0},t.Q={bit:3},t.H={bit:2};function e(r){if(typeof r!="string")throw new Error("Param is not a string");switch(r.toLowerCase()){case"l":case"low":return t.L;case"m":case"medium":return t.M;case"q":case"quartile":return t.Q;case"h":case"high":return t.H;default:throw new Error("Unknown EC Level: "+r)}}t.isValid=function(n){return n&&typeof n.bit<"u"&&n.bit>=0&&n.bit<4},t.from=function(n,i){if(t.isValid(n))return n;try{return e(n)}catch{return i}}})(ka);function bw(){this.buffer=[],this.length=0}bw.prototype={get:function(t){const e=Math.floor(t/8);return(this.buffer[e]>>>7-t%8&1)===1},put:function(t,e){for(let r=0;r<e;r++)this.putBit((t>>>e-r-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(t){const e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++}};var f9=bw;function oo(t){if(!t||t<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=t,this.data=new Uint8Array(t*t),this.reservedBit=new Uint8Array(t*t)}oo.prototype.set=function(t,e,r,n){const i=t*this.size+e;this.data[i]=r,n&&(this.reservedBit[i]=!0)},oo.prototype.get=function(t,e){return this.data[t*this.size+e]},oo.prototype.xor=function(t,e,r){this.data[t*this.size+e]^=r},oo.prototype.isReserved=function(t,e){return this.reservedBit[t*this.size+e]};var p9=oo,vw={};(function(t){const e=St.getSymbolSize;t.getRowColCoords=function(n){if(n===1)return[];const i=Math.floor(n/7)+2,s=e(n),o=s===145?26:Math.ceil((s-13)/(2*i-2))*2,a=[s-7];for(let c=1;c<i-1;c++)a[c]=a[c-1]-o;return a.push(6),a.reverse()},t.getPositions=function(n){const i=[],s=t.getRowColCoords(n),o=s.length;for(let a=0;a<o;a++)for(let c=0;c<o;c++)a===0&&c===0||a===0&&c===o-1||a===o-1&&c===0||i.push([s[a],s[c]]);return i}})(vw);var Ew={};const g9=St.getSymbolSize,_w=7;Ew.getPositions=function(e){const r=g9(e);return[[0,0],[r-_w,0],[0,r-_w]]};var $w={};(function(t){t.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const e={N1:3,N2:3,N3:40,N4:10};t.isValid=function(i){return i!=null&&i!==""&&!isNaN(i)&&i>=0&&i<=7},t.from=function(i){return t.isValid(i)?parseInt(i,10):void 0},t.getPenaltyN1=function(i){const s=i.size;let o=0,a=0,c=0,l=null,u=null;for(let h=0;h<s;h++){a=c=0,l=u=null;for(let d=0;d<s;d++){let p=i.get(h,d);p===l?a++:(a>=5&&(o+=e.N1+(a-5)),l=p,a=1),p=i.get(d,h),p===u?c++:(c>=5&&(o+=e.N1+(c-5)),u=p,c=1)}a>=5&&(o+=e.N1+(a-5)),c>=5&&(o+=e.N1+(c-5))}return o},t.getPenaltyN2=function(i){const s=i.size;let o=0;for(let a=0;a<s-1;a++)for(let c=0;c<s-1;c++){const l=i.get(a,c)+i.get(a,c+1)+i.get(a+1,c)+i.get(a+1,c+1);(l===4||l===0)&&o++}return o*e.N2},t.getPenaltyN3=function(i){const s=i.size;let o=0,a=0,c=0;for(let l=0;l<s;l++){a=c=0;for(let u=0;u<s;u++)a=a<<1&2047|i.get(l,u),u>=10&&(a===1488||a===93)&&o++,c=c<<1&2047|i.get(u,l),u>=10&&(c===1488||c===93)&&o++}return o*e.N3},t.getPenaltyN4=function(i){let s=0;const o=i.data.length;for(let c=0;c<o;c++)s+=i.data[c];return Math.abs(Math.ceil(s*100/o/5)-10)*e.N4};function r(n,i,s){switch(n){case t.Patterns.PATTERN000:return(i+s)%2===0;case t.Patterns.PATTERN001:return i%2===0;case t.Patterns.PATTERN010:return s%3===0;case t.Patterns.PATTERN011:return(i+s)%3===0;case t.Patterns.PATTERN100:return(Math.floor(i/2)+Math.floor(s/3))%2===0;case t.Patterns.PATTERN101:return i*s%2+i*s%3===0;case t.Patterns.PATTERN110:return(i*s%2+i*s%3)%2===0;case t.Patterns.PATTERN111:return(i*s%3+(i+s)%2)%2===0;default:throw new Error("bad maskPattern:"+n)}}t.applyMask=function(i,s){const o=s.size;for(let a=0;a<o;a++)for(let c=0;c<o;c++)s.isReserved(c,a)||s.xor(c,a,r(i,c,a))},t.getBestMask=function(i,s){const o=Object.keys(t.Patterns).length;let a=0,c=1/0;for(let l=0;l<o;l++){s(l),t.applyMask(l,i);const u=t.getPenaltyN1(i)+t.getPenaltyN2(i)+t.getPenaltyN3(i)+t.getPenaltyN4(i);t.applyMask(l,i),u<c&&(c=u,a=l)}return a}})($w);var qa={};const en=ka,za=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],Ha=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];qa.getBlocksCount=function(e,r){switch(r){case en.L:return za[(e-1)*4+0];case en.M:return za[(e-1)*4+1];case en.Q:return za[(e-1)*4+2];case en.H:return za[(e-1)*4+3];default:return}},qa.getTotalCodewordsCount=function(e,r){switch(r){case en.L:return Ha[(e-1)*4+0];case en.M:return Ha[(e-1)*4+1];case en.Q:return Ha[(e-1)*4+2];case en.H:return Ha[(e-1)*4+3];default:return}};var xw={},Va={};const ao=new Uint8Array(512),Wa=new Uint8Array(256);(function(){let e=1;for(let r=0;r<255;r++)ao[r]=e,Wa[e]=r,e<<=1,e&256&&(e^=285);for(let r=255;r<512;r++)ao[r]=ao[r-255]})(),Va.log=function(e){if(e<1)throw new Error("log("+e+")");return Wa[e]},Va.exp=function(e){return ao[e]},Va.mul=function(e,r){return e===0||r===0?0:ao[Wa[e]+Wa[r]]},function(t){const e=Va;t.mul=function(n,i){const s=new Uint8Array(n.length+i.length-1);for(let o=0;o<n.length;o++)for(let a=0;a<i.length;a++)s[o+a]^=e.mul(n[o],i[a]);return s},t.mod=function(n,i){let s=new Uint8Array(n);for(;s.length-i.length>=0;){const o=s[0];for(let c=0;c<i.length;c++)s[c]^=e.mul(i[c],o);let a=0;for(;a<s.length&&s[a]===0;)a++;s=s.slice(a)}return s},t.generateECPolynomial=function(n){let i=new Uint8Array([1]);for(let s=0;s<n;s++)i=t.mul(i,new Uint8Array([1,e.exp(s)]));return i}}(xw);const Iw=xw;function dh(t){this.genPoly=void 0,this.degree=t,this.degree&&this.initialize(this.degree)}dh.prototype.initialize=function(e){this.degree=e,this.genPoly=Iw.generateECPolynomial(this.degree)},dh.prototype.encode=function(e){if(!this.genPoly)throw new Error("Encoder not initialized");const r=new Uint8Array(e.length+this.degree);r.set(e);const n=Iw.mod(r,this.genPoly),i=this.degree-n.length;if(i>0){const s=new Uint8Array(this.degree);return s.set(n,i),s}return n};var m9=dh,Ow={},tn={},fh={};fh.isValid=function(e){return!isNaN(e)&&e>=1&&e<=40};var lr={};const Sw="[0-9]+",w9="[A-Z $%*+\\-./:]+";let co="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";co=co.replace(/u/g,"\\u");const y9="(?:(?![A-Z0-9 $%*+\\-./:]|"+co+`)(?:.|[\r
]))+`;lr.KANJI=new RegExp(co,"g"),lr.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),lr.BYTE=new RegExp(y9,"g"),lr.NUMERIC=new RegExp(Sw,"g"),lr.ALPHANUMERIC=new RegExp(w9,"g");const b9=new RegExp("^"+co+"$"),v9=new RegExp("^"+Sw+"$"),E9=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");lr.testKanji=function(e){return b9.test(e)},lr.testNumeric=function(e){return v9.test(e)},lr.testAlphanumeric=function(e){return E9.test(e)},function(t){const e=fh,r=lr;t.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},t.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},t.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},t.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},t.MIXED={bit:-1},t.getCharCountIndicator=function(s,o){if(!s.ccBits)throw new Error("Invalid mode: "+s);if(!e.isValid(o))throw new Error("Invalid version: "+o);return o>=1&&o<10?s.ccBits[0]:o<27?s.ccBits[1]:s.ccBits[2]},t.getBestModeForData=function(s){return r.testNumeric(s)?t.NUMERIC:r.testAlphanumeric(s)?t.ALPHANUMERIC:r.testKanji(s)?t.KANJI:t.BYTE},t.toString=function(s){if(s&&s.id)return s.id;throw new Error("Invalid mode")},t.isValid=function(s){return s&&s.bit&&s.ccBits};function n(i){if(typeof i!="string")throw new Error("Param is not a string");switch(i.toLowerCase()){case"numeric":return t.NUMERIC;case"alphanumeric":return t.ALPHANUMERIC;case"kanji":return t.KANJI;case"byte":return t.BYTE;default:throw new Error("Unknown mode: "+i)}}t.from=function(s,o){if(t.isValid(s))return s;try{return n(s)}catch{return o}}}(tn),function(t){const e=St,r=qa,n=ka,i=tn,s=fh,o=7973,a=e.getBCHDigit(o);function c(d,p,f){for(let g=1;g<=40;g++)if(p<=t.getCapacity(g,f,d))return g}function l(d,p){return i.getCharCountIndicator(d,p)+4}function u(d,p){let f=0;return d.forEach(function(g){const m=l(g.mode,p);f+=m+g.getBitsLength()}),f}function h(d,p){for(let f=1;f<=40;f++)if(u(d,f)<=t.getCapacity(f,p,i.MIXED))return f}t.from=function(p,f){return s.isValid(p)?parseInt(p,10):f},t.getCapacity=function(p,f,g){if(!s.isValid(p))throw new Error("Invalid QR Code version");typeof g>"u"&&(g=i.BYTE);const m=e.getSymbolTotalCodewords(p),w=r.getTotalCodewordsCount(p,f),y=(m-w)*8;if(g===i.MIXED)return y;const E=y-l(g,p);switch(g){case i.NUMERIC:return Math.floor(E/10*3);case i.ALPHANUMERIC:return Math.floor(E/11*2);case i.KANJI:return Math.floor(E/13);case i.BYTE:default:return Math.floor(E/8)}},t.getBestVersionForData=function(p,f){let g;const m=n.from(f,n.M);if(Array.isArray(p)){if(p.length>1)return h(p,m);if(p.length===0)return 1;g=p[0]}else g=p;return c(g.mode,g.getLength(),m)},t.getEncodedBits=function(p){if(!s.isValid(p)||p<7)throw new Error("Invalid QR Code version");let f=p<<12;for(;e.getBCHDigit(f)-a>=0;)f^=o<<e.getBCHDigit(f)-a;return p<<12|f}}(Ow);var Aw={};const ph=St,Cw=1335,_9=21522,Pw=ph.getBCHDigit(Cw);Aw.getEncodedBits=function(e,r){const n=e.bit<<3|r;let i=n<<10;for(;ph.getBCHDigit(i)-Pw>=0;)i^=Cw<<ph.getBCHDigit(i)-Pw;return(n<<10|i)^_9};var Dw={};const $9=tn;function Vi(t){this.mode=$9.NUMERIC,this.data=t.toString()}Vi.getBitsLength=function(e){return 10*Math.floor(e/3)+(e%3?e%3*3+1:0)},Vi.prototype.getLength=function(){return this.data.length},Vi.prototype.getBitsLength=function(){return Vi.getBitsLength(this.data.length)},Vi.prototype.write=function(e){let r,n,i;for(r=0;r+3<=this.data.length;r+=3)n=this.data.substr(r,3),i=parseInt(n,10),e.put(i,10);const s=this.data.length-r;s>0&&(n=this.data.substr(r),i=parseInt(n,10),e.put(i,s*3+1))};var x9=Vi;const I9=tn,gh=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function Wi(t){this.mode=I9.ALPHANUMERIC,this.data=t}Wi.getBitsLength=function(e){return 11*Math.floor(e/2)+6*(e%2)},Wi.prototype.getLength=function(){return this.data.length},Wi.prototype.getBitsLength=function(){return Wi.getBitsLength(this.data.length)},Wi.prototype.write=function(e){let r;for(r=0;r+2<=this.data.length;r+=2){let n=gh.indexOf(this.data[r])*45;n+=gh.indexOf(this.data[r+1]),e.put(n,11)}this.data.length%2&&e.put(gh.indexOf(this.data[r]),6)};var O9=Wi,S9=function(e){for(var r=[],n=e.length,i=0;i<n;i++){var s=e.charCodeAt(i);if(s>=55296&&s<=56319&&n>i+1){var o=e.charCodeAt(i+1);o>=56320&&o<=57343&&(s=(s-55296)*1024+o-56320+65536,i+=1)}if(s<128){r.push(s);continue}if(s<2048){r.push(s>>6|192),r.push(s&63|128);continue}if(s<55296||s>=57344&&s<65536){r.push(s>>12|224),r.push(s>>6&63|128),r.push(s&63|128);continue}if(s>=65536&&s<=1114111){r.push(s>>18|240),r.push(s>>12&63|128),r.push(s>>6&63|128),r.push(s&63|128);continue}r.push(239,191,189)}return new Uint8Array(r).buffer};const A9=S9,C9=tn;function Ki(t){this.mode=C9.BYTE,typeof t=="string"&&(t=A9(t)),this.data=new Uint8Array(t)}Ki.getBitsLength=function(e){return e*8},Ki.prototype.getLength=function(){return this.data.length},Ki.prototype.getBitsLength=function(){return Ki.getBitsLength(this.data.length)},Ki.prototype.write=function(t){for(let e=0,r=this.data.length;e<r;e++)t.put(this.data[e],8)};var P9=Ki;const D9=tn,T9=St;function Gi(t){this.mode=D9.KANJI,this.data=t}Gi.getBitsLength=function(e){return e*13},Gi.prototype.getLength=function(){return this.data.length},Gi.prototype.getBitsLength=function(){return Gi.getBitsLength(this.data.length)},Gi.prototype.write=function(t){let e;for(e=0;e<this.data.length;e++){let r=T9.toSJIS(this.data[e]);if(r>=33088&&r<=40956)r-=33088;else if(r>=57408&&r<=60351)r-=49472;else throw new Error("Invalid SJIS character: "+this.data[e]+`
Make sure your charset is UTF-8`);r=(r>>>8&255)*192+(r&255),t.put(r,13)}};var R9=Gi,Tw={exports:{}};(function(t){var e={single_source_shortest_paths:function(r,n,i){var s={},o={};o[n]=0;var a=e.PriorityQueue.make();a.push(n,0);for(var c,l,u,h,d,p,f,g,m;!a.empty();){c=a.pop(),l=c.value,h=c.cost,d=r[l]||{};for(u in d)d.hasOwnProperty(u)&&(p=d[u],f=h+p,g=o[u],m=typeof o[u]>"u",(m||g>f)&&(o[u]=f,a.push(u,f),s[u]=l))}if(typeof i<"u"&&typeof o[i]>"u"){var w=["Could not find a path from ",n," to ",i,"."].join("");throw new Error(w)}return s},extract_shortest_path_from_predecessor_list:function(r,n){for(var i=[],s=n;s;)i.push(s),r[s],s=r[s];return i.reverse(),i},find_path:function(r,n,i){var s=e.single_source_shortest_paths(r,n,i);return e.extract_shortest_path_from_predecessor_list(s,i)},PriorityQueue:{make:function(r){var n=e.PriorityQueue,i={},s;r=r||{};for(s in n)n.hasOwnProperty(s)&&(i[s]=n[s]);return i.queue=[],i.sorter=r.sorter||n.default_sorter,i},default_sorter:function(r,n){return r.cost-n.cost},push:function(r,n){var i={value:r,cost:n};this.queue.push(i),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};t.exports=e})(Tw),function(t){const e=tn,r=x9,n=O9,i=P9,s=R9,o=lr,a=St,c=Tw.exports;function l(w){return unescape(encodeURIComponent(w)).length}function u(w,y,E){const _=[];let O;for(;(O=w.exec(E))!==null;)_.push({data:O[0],index:O.index,mode:y,length:O[0].length});return _}function h(w){const y=u(o.NUMERIC,e.NUMERIC,w),E=u(o.ALPHANUMERIC,e.ALPHANUMERIC,w);let _,O;return a.isKanjiModeEnabled()?(_=u(o.BYTE,e.BYTE,w),O=u(o.KANJI,e.KANJI,w)):(_=u(o.BYTE_KANJI,e.BYTE,w),O=[]),y.concat(E,_,O).sort(function(x,P){return x.index-P.index}).map(function(x){return{data:x.data,mode:x.mode,length:x.length}})}function d(w,y){switch(y){case e.NUMERIC:return r.getBitsLength(w);case e.ALPHANUMERIC:return n.getBitsLength(w);case e.KANJI:return s.getBitsLength(w);case e.BYTE:return i.getBitsLength(w)}}function p(w){return w.reduce(function(y,E){const _=y.length-1>=0?y[y.length-1]:null;return _&&_.mode===E.mode?(y[y.length-1].data+=E.data,y):(y.push(E),y)},[])}function f(w){const y=[];for(let E=0;E<w.length;E++){const _=w[E];switch(_.mode){case e.NUMERIC:y.push([_,{data:_.data,mode:e.ALPHANUMERIC,length:_.length},{data:_.data,mode:e.BYTE,length:_.length}]);break;case e.ALPHANUMERIC:y.push([_,{data:_.data,mode:e.BYTE,length:_.length}]);break;case e.KANJI:y.push([_,{data:_.data,mode:e.BYTE,length:l(_.data)}]);break;case e.BYTE:y.push([{data:_.data,mode:e.BYTE,length:l(_.data)}])}}return y}function g(w,y){const E={},_={start:{}};let O=["start"];for(let S=0;S<w.length;S++){const x=w[S],P=[];for(let $=0;$<x.length;$++){const B=x[$],D=""+S+$;P.push(D),E[D]={node:B,lastCount:0},_[D]={};for(let R=0;R<O.length;R++){const M=O[R];E[M]&&E[M].node.mode===B.mode?(_[M][D]=d(E[M].lastCount+B.length,B.mode)-d(E[M].lastCount,B.mode),E[M].lastCount+=B.length):(E[M]&&(E[M].lastCount=B.length),_[M][D]=d(B.length,B.mode)+4+e.getCharCountIndicator(B.mode,y))}}O=P}for(let S=0;S<O.length;S++)_[O[S]].end=0;return{map:_,table:E}}function m(w,y){let E;const _=e.getBestModeForData(w);if(E=e.from(y,_),E!==e.BYTE&&E.bit<_.bit)throw new Error('"'+w+'" cannot be encoded with mode '+e.toString(E)+`.
 Suggested mode is: `+e.toString(_));switch(E===e.KANJI&&!a.isKanjiModeEnabled()&&(E=e.BYTE),E){case e.NUMERIC:return new r(w);case e.ALPHANUMERIC:return new n(w);case e.KANJI:return new s(w);case e.BYTE:return new i(w)}}t.fromArray=function(y){return y.reduce(function(E,_){return typeof _=="string"?E.push(m(_,null)):_.data&&E.push(m(_.data,_.mode)),E},[])},t.fromString=function(y,E){const _=h(y,a.isKanjiModeEnabled()),O=f(_),S=g(O,E),x=c.find_path(S.map,"start","end"),P=[];for(let $=1;$<x.length-1;$++)P.push(S.table[x[$]].node);return t.fromArray(p(P))},t.rawSplit=function(y){return t.fromArray(h(y,a.isKanjiModeEnabled()))}}(Dw);const Ka=St,mh=ka,N9=f9,B9=p9,L9=vw,M9=Ew,wh=$w,yh=qa,U9=m9,Ga=Ow,j9=Aw,F9=tn,bh=Dw;function k9(t,e){const r=t.size,n=M9.getPositions(e);for(let i=0;i<n.length;i++){const s=n[i][0],o=n[i][1];for(let a=-1;a<=7;a++)if(!(s+a<=-1||r<=s+a))for(let c=-1;c<=7;c++)o+c<=-1||r<=o+c||(a>=0&&a<=6&&(c===0||c===6)||c>=0&&c<=6&&(a===0||a===6)||a>=2&&a<=4&&c>=2&&c<=4?t.set(s+a,o+c,!0,!0):t.set(s+a,o+c,!1,!0))}}function q9(t){const e=t.size;for(let r=8;r<e-8;r++){const n=r%2===0;t.set(r,6,n,!0),t.set(6,r,n,!0)}}function z9(t,e){const r=L9.getPositions(e);for(let n=0;n<r.length;n++){const i=r[n][0],s=r[n][1];for(let o=-2;o<=2;o++)for(let a=-2;a<=2;a++)o===-2||o===2||a===-2||a===2||o===0&&a===0?t.set(i+o,s+a,!0,!0):t.set(i+o,s+a,!1,!0)}}function H9(t,e){const r=t.size,n=Ga.getEncodedBits(e);let i,s,o;for(let a=0;a<18;a++)i=Math.floor(a/3),s=a%3+r-8-3,o=(n>>a&1)===1,t.set(i,s,o,!0),t.set(s,i,o,!0)}function vh(t,e,r){const n=t.size,i=j9.getEncodedBits(e,r);let s,o;for(s=0;s<15;s++)o=(i>>s&1)===1,s<6?t.set(s,8,o,!0):s<8?t.set(s+1,8,o,!0):t.set(n-15+s,8,o,!0),s<8?t.set(8,n-s-1,o,!0):s<9?t.set(8,15-s-1+1,o,!0):t.set(8,15-s-1,o,!0);t.set(n-8,8,1,!0)}function V9(t,e){const r=t.size;let n=-1,i=r-1,s=7,o=0;for(let a=r-1;a>0;a-=2)for(a===6&&a--;;){for(let c=0;c<2;c++)if(!t.isReserved(i,a-c)){let l=!1;o<e.length&&(l=(e[o]>>>s&1)===1),t.set(i,a-c,l),s--,s===-1&&(o++,s=7)}if(i+=n,i<0||r<=i){i-=n,n=-n;break}}}function W9(t,e,r){const n=new N9;r.forEach(function(c){n.put(c.mode.bit,4),n.put(c.getLength(),F9.getCharCountIndicator(c.mode,t)),c.write(n)});const i=Ka.getSymbolTotalCodewords(t),s=yh.getTotalCodewordsCount(t,e),o=(i-s)*8;for(n.getLengthInBits()+4<=o&&n.put(0,4);n.getLengthInBits()%8!==0;)n.putBit(0);const a=(o-n.getLengthInBits())/8;for(let c=0;c<a;c++)n.put(c%2?17:236,8);return K9(n,t,e)}function K9(t,e,r){const n=Ka.getSymbolTotalCodewords(e),i=yh.getTotalCodewordsCount(e,r),s=n-i,o=yh.getBlocksCount(e,r),a=n%o,c=o-a,l=Math.floor(n/o),u=Math.floor(s/o),h=u+1,d=l-u,p=new U9(d);let f=0;const g=new Array(o),m=new Array(o);let w=0;const y=new Uint8Array(t.buffer);for(let x=0;x<o;x++){const P=x<c?u:h;g[x]=y.slice(f,f+P),m[x]=p.encode(g[x]),f+=P,w=Math.max(w,P)}const E=new Uint8Array(n);let _=0,O,S;for(O=0;O<w;O++)for(S=0;S<o;S++)O<g[S].length&&(E[_++]=g[S][O]);for(O=0;O<d;O++)for(S=0;S<o;S++)E[_++]=m[S][O];return E}function G9(t,e,r,n){let i;if(Array.isArray(t))i=bh.fromArray(t);else if(typeof t=="string"){let l=e;if(!l){const u=bh.rawSplit(t);l=Ga.getBestVersionForData(u,r)}i=bh.fromString(t,l||40)}else throw new Error("Invalid data");const s=Ga.getBestVersionForData(i,r);if(!s)throw new Error("The amount of data is too big to be stored in a QR Code");if(!e)e=s;else if(e<s)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+s+`.
`);const o=W9(e,r,i),a=Ka.getSymbolSize(e),c=new B9(a);return k9(c,e),q9(c),z9(c,e),vh(c,r,0),e>=7&&H9(c,e),V9(c,o),isNaN(n)&&(n=wh.getBestMask(c,vh.bind(null,c,r))),wh.applyMask(n,c),vh(c,r,n),{modules:c,version:e,errorCorrectionLevel:r,maskPattern:n,segments:i}}yw.create=function(e,r){if(typeof e>"u"||e==="")throw new Error("No input text");let n=mh.M,i,s;return typeof r<"u"&&(n=mh.from(r.errorCorrectionLevel,mh.M),i=Ga.from(r.version),s=wh.from(r.maskPattern),r.toSJISFunc&&Ka.setToSJISFunction(r.toSJISFunc)),G9(e,i,n,s)};var Rw={},Eh={};(function(t){function e(r){if(typeof r=="number"&&(r=r.toString()),typeof r!="string")throw new Error("Color should be defined as hex string");let n=r.slice().replace("#","").split("");if(n.length<3||n.length===5||n.length>8)throw new Error("Invalid hex color: "+r);(n.length===3||n.length===4)&&(n=Array.prototype.concat.apply([],n.map(function(s){return[s,s]}))),n.length===6&&n.push("F","F");const i=parseInt(n.join(""),16);return{r:i>>24&255,g:i>>16&255,b:i>>8&255,a:i&255,hex:"#"+n.slice(0,6).join("")}}t.getOptions=function(n){n||(n={}),n.color||(n.color={});const i=typeof n.margin>"u"||n.margin===null||n.margin<0?4:n.margin,s=n.width&&n.width>=21?n.width:void 0,o=n.scale||4;return{width:s,scale:s?4:o,margin:i,color:{dark:e(n.color.dark||"#000000ff"),light:e(n.color.light||"#ffffffff")},type:n.type,rendererOpts:n.rendererOpts||{}}},t.getScale=function(n,i){return i.width&&i.width>=n+i.margin*2?i.width/(n+i.margin*2):i.scale},t.getImageWidth=function(n,i){const s=t.getScale(n,i);return Math.floor((n+i.margin*2)*s)},t.qrToImageData=function(n,i,s){const o=i.modules.size,a=i.modules.data,c=t.getScale(o,s),l=Math.floor((o+s.margin*2)*c),u=s.margin*c,h=[s.color.light,s.color.dark];for(let d=0;d<l;d++)for(let p=0;p<l;p++){let f=(d*l+p)*4,g=s.color.light;if(d>=u&&p>=u&&d<l-u&&p<l-u){const m=Math.floor((d-u)/c),w=Math.floor((p-u)/c);g=h[a[m*o+w]?1:0]}n[f++]=g.r,n[f++]=g.g,n[f++]=g.b,n[f]=g.a}}})(Eh),function(t){const e=Eh;function r(i,s,o){i.clearRect(0,0,s.width,s.height),s.style||(s.style={}),s.height=o,s.width=o,s.style.height=o+"px",s.style.width=o+"px"}function n(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}t.render=function(s,o,a){let c=a,l=o;typeof c>"u"&&(!o||!o.getContext)&&(c=o,o=void 0),o||(l=n()),c=e.getOptions(c);const u=e.getImageWidth(s.modules.size,c),h=l.getContext("2d"),d=h.createImageData(u,u);return e.qrToImageData(d.data,s,c),r(h,l,u),h.putImageData(d,0,0),l},t.renderToDataURL=function(s,o,a){let c=a;typeof c>"u"&&(!o||!o.getContext)&&(c=o,o=void 0),c||(c={});const l=t.render(s,o,c),u=c.type||"image/png",h=c.rendererOpts||{};return l.toDataURL(u,h.quality)}}(Rw);var Nw={};const Z9=Eh;function Bw(t,e){const r=t.a/255,n=e+'="'+t.hex+'"';return r<1?n+" "+e+'-opacity="'+r.toFixed(2).slice(1)+'"':n}function _h(t,e,r){let n=t+e;return typeof r<"u"&&(n+=" "+r),n}function Y9(t,e,r){let n="",i=0,s=!1,o=0;for(let a=0;a<t.length;a++){const c=Math.floor(a%e),l=Math.floor(a/e);!c&&!s&&(s=!0),t[a]?(o++,a>0&&c>0&&t[a-1]||(n+=s?_h("M",c+r,.5+l+r):_h("m",i,0),i=0,s=!1),c+1<e&&t[a+1]||(n+=_h("h",o),o=0)):i++}return n}Nw.render=function(e,r,n){const i=Z9.getOptions(r),s=e.modules.size,o=e.modules.data,a=s+i.margin*2,c=i.color.light.a?"<path "+Bw(i.color.light,"fill")+' d="M0 0h'+a+"v"+a+'H0z"/>':"",l="<path "+Bw(i.color.dark,"stroke")+' d="'+Y9(o,s,i.margin)+'"/>',u='viewBox="0 0 '+a+" "+a+'"',d='<svg xmlns="http://www.w3.org/2000/svg" '+(i.width?'width="'+i.width+'" height="'+i.width+'" ':"")+u+' shape-rendering="crispEdges">'+c+l+`</svg>
`;return typeof n=="function"&&n(null,d),d};const J9=h9,$h=yw,Lw=Rw,Q9=Nw;function xh(t,e,r,n,i){const s=[].slice.call(arguments,1),o=s.length,a=typeof s[o-1]=="function";if(!a&&!J9())throw new Error("Callback required as last argument");if(a){if(o<2)throw new Error("Too few arguments provided");o===2?(i=r,r=e,e=n=void 0):o===3&&(e.getContext&&typeof i>"u"?(i=n,n=void 0):(i=n,n=r,r=e,e=void 0))}else{if(o<1)throw new Error("Too few arguments provided");return o===1?(r=e,e=n=void 0):o===2&&!e.getContext&&(n=r,r=e,e=void 0),new Promise(function(c,l){try{const u=$h.create(r,n);c(t(u,e,n))}catch(u){l(u)}})}try{const c=$h.create(r,n);i(null,t(c,e,n))}catch(c){i(c)}}so.create=$h.create,so.toCanvas=xh.bind(null,Lw.render),so.toDataURL=xh.bind(null,Lw.renderToDataURL),so.toString=xh.bind(null,function(t,e,r){return Q9.render(t,r)});var X9=Object.defineProperty,Mw=Object.getOwnPropertySymbols,eT=Object.prototype.hasOwnProperty,tT=Object.prototype.propertyIsEnumerable,Uw=(t,e,r)=>e in t?X9(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ih=(t,e)=>{for(var r in e||(e={}))eT.call(e,r)&&Uw(t,r,e[r]);if(Mw)for(var r of Mw(e))tT.call(e,r)&&Uw(t,r,e[r]);return t};function rT(){var t;const e=(t=Yr.state.themeMode)!=null?t:"dark",n={light:{foreground:{1:"rgb(20,20,20)",2:"rgb(121,134,134)",3:"rgb(158,169,169)"},background:{1:"rgb(255,255,255)",2:"rgb(241,243,243)",3:"rgb(228,231,231)"},overlay:"rgba(0,0,0,0.1)"},dark:{foreground:{1:"rgb(228,231,231)",2:"rgb(148,158,158)",3:"rgb(110,119,119)"},background:{1:"rgb(20,20,20)",2:"rgb(39,42,42)",3:"rgb(59,64,64)"},overlay:"rgba(255,255,255,0.1)"}}[e];return{"--wcm-color-fg-1":n.foreground[1],"--wcm-color-fg-2":n.foreground[2],"--wcm-color-fg-3":n.foreground[3],"--wcm-color-bg-1":n.background[1],"--wcm-color-bg-2":n.background[2],"--wcm-color-bg-3":n.background[3],"--wcm-color-overlay":n.overlay}}function jw(){return{"--wcm-accent-color":"#3396FF","--wcm-accent-fill-color":"#FFFFFF","--wcm-z-index":"89","--wcm-background-color":"#3396FF","--wcm-background-border-radius":"8px","--wcm-container-border-radius":"30px","--wcm-wallet-icon-border-radius":"15px","--wcm-wallet-icon-large-border-radius":"30px","--wcm-wallet-icon-small-border-radius":"7px","--wcm-input-border-radius":"28px","--wcm-button-border-radius":"10px","--wcm-notification-border-radius":"36px","--wcm-secondary-button-border-radius":"28px","--wcm-icon-button-border-radius":"50%","--wcm-button-hover-highlight-border-radius":"10px","--wcm-text-big-bold-size":"20px","--wcm-text-big-bold-weight":"600","--wcm-text-big-bold-line-height":"24px","--wcm-text-big-bold-letter-spacing":"-0.03em","--wcm-text-big-bold-text-transform":"none","--wcm-text-xsmall-bold-size":"10px","--wcm-text-xsmall-bold-weight":"700","--wcm-text-xsmall-bold-line-height":"12px","--wcm-text-xsmall-bold-letter-spacing":"0.02em","--wcm-text-xsmall-bold-text-transform":"uppercase","--wcm-text-xsmall-regular-size":"12px","--wcm-text-xsmall-regular-weight":"600","--wcm-text-xsmall-regular-line-height":"14px","--wcm-text-xsmall-regular-letter-spacing":"-0.03em","--wcm-text-xsmall-regular-text-transform":"none","--wcm-text-small-thin-size":"14px","--wcm-text-small-thin-weight":"500","--wcm-text-small-thin-line-height":"16px","--wcm-text-small-thin-letter-spacing":"-0.03em","--wcm-text-small-thin-text-transform":"none","--wcm-text-small-regular-size":"14px","--wcm-text-small-regular-weight":"600","--wcm-text-small-regular-line-height":"16px","--wcm-text-small-regular-letter-spacing":"-0.03em","--wcm-text-small-regular-text-transform":"none","--wcm-text-medium-regular-size":"16px","--wcm-text-medium-regular-weight":"600","--wcm-text-medium-regular-line-height":"20px","--wcm-text-medium-regular-letter-spacing":"-0.03em","--wcm-text-medium-regular-text-transform":"none","--wcm-font-family":"-apple-system, system-ui, BlinkMacSystemFont, 'Segoe UI', Roboto, Ubuntu, 'Helvetica Neue', sans-serif","--wcm-font-feature-settings":"'tnum' on, 'lnum' on, 'case' on","--wcm-success-color":"rgb(38,181,98)","--wcm-error-color":"rgb(242, 90, 103)","--wcm-overlay-background-color":"rgba(0, 0, 0, 0.3)","--wcm-overlay-backdrop-filter":"none"}}const re={getPreset(t){return jw()[t]},setTheme(){const t=document.querySelector(":root"),{themeVariables:e}=Yr.state;if(t){const r=Ih(Ih(Ih({},rT()),jw()),e);Object.entries(r).forEach(([n,i])=>t.style.setProperty(n,i))}},globalCss:ae`*,::after,::before{margin:0;padding:0;box-sizing:border-box;font-style:normal;text-rendering:optimizeSpeed;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;-webkit-tap-highlight-color:transparent;backface-visibility:hidden}button{cursor:pointer;display:flex;justify-content:center;align-items:center;position:relative;border:none;background-color:transparent;transition:all .2s ease}@media (hover:hover) and (pointer:fine){button:active{transition:all .1s ease;transform:scale(.93)}}button::after{content:'';position:absolute;top:0;bottom:0;left:0;right:0;transition:background-color,.2s ease}button:disabled{cursor:not-allowed}button svg,button wcm-text{position:relative;z-index:1}input{border:none;outline:0;appearance:none}img{display:block}::selection{color:var(--wcm-accent-fill-color);background:var(--wcm-accent-color)}`},nT=ae`button{border-radius:var(--wcm-secondary-button-border-radius);height:28px;padding:0 10px;background-color:var(--wcm-accent-color)}button path{fill:var(--wcm-accent-fill-color)}button::after{border-radius:inherit;border:1px solid var(--wcm-color-overlay)}button:disabled::after{background-color:transparent}.wcm-icon-left svg{margin-right:5px}.wcm-icon-right svg{margin-left:5px}button:active::after{background-color:var(--wcm-color-overlay)}.wcm-ghost,.wcm-ghost:active::after,.wcm-outline{background-color:transparent}.wcm-ghost:active{opacity:.5}@media(hover:hover){button:hover::after{background-color:var(--wcm-color-overlay)}.wcm-ghost:hover::after{background-color:transparent}.wcm-ghost:hover{opacity:.5}}button:disabled{background-color:var(--wcm-color-bg-3);pointer-events:none}.wcm-ghost::after{border-color:transparent}.wcm-ghost path{fill:var(--wcm-color-fg-2)}.wcm-outline path{fill:var(--wcm-accent-color)}.wcm-outline:disabled{background-color:transparent;opacity:.5}`;var iT=Object.defineProperty,sT=Object.getOwnPropertyDescriptor,Zi=(t,e,r,n)=>{for(var i=n>1?void 0:n?sT(e,r):e,s=t.length-1,o;s>=0;s--)(o=t[s])&&(i=(n?o(e,r,i):o(i))||i);return n&&i&&iT(e,r,i),i};let rn=class extends J{constructor(){super(...arguments),this.disabled=!1,this.iconLeft=void 0,this.iconRight=void 0,this.onClick=()=>null,this.variant="default"}render(){const t={"wcm-icon-left":this.iconLeft!==void 0,"wcm-icon-right":this.iconRight!==void 0,"wcm-ghost":this.variant==="ghost","wcm-outline":this.variant==="outline"};let e="inverse";return this.variant==="ghost"&&(e="secondary"),this.variant==="outline"&&(e="accent"),z`<button class="${Sr(t)}" ?disabled="${this.disabled}" @click="${this.onClick}">${this.iconLeft}<wcm-text variant="small-regular" color="${e}"><slot></slot></wcm-text>${this.iconRight}</button>`}};rn.styles=[re.globalCss,nT],Zi([Z({type:Boolean})],rn.prototype,"disabled",2),Zi([Z()],rn.prototype,"iconLeft",2),Zi([Z()],rn.prototype,"iconRight",2),Zi([Z()],rn.prototype,"onClick",2),Zi([Z()],rn.prototype,"variant",2),rn=Zi([ne("wcm-button")],rn);const oT=ae`:host{display:inline-block}button{padding:0 15px 1px;height:40px;border-radius:var(--wcm-button-border-radius);color:var(--wcm-accent-fill-color);background-color:var(--wcm-accent-color)}button::after{content:'';top:0;bottom:0;left:0;right:0;position:absolute;background-color:transparent;border-radius:inherit;transition:background-color .2s ease;border:1px solid var(--wcm-color-overlay)}button:active::after{background-color:var(--wcm-color-overlay)}button:disabled{padding-bottom:0;background-color:var(--wcm-color-bg-3);color:var(--wcm-color-fg-3)}.wcm-secondary{color:var(--wcm-accent-color);background-color:transparent}.wcm-secondary::after{display:none}@media(hover:hover){button:hover::after{background-color:var(--wcm-color-overlay)}}`;var aT=Object.defineProperty,cT=Object.getOwnPropertyDescriptor,Oh=(t,e,r,n)=>{for(var i=n>1?void 0:n?cT(e,r):e,s=t.length-1,o;s>=0;s--)(o=t[s])&&(i=(n?o(e,r,i):o(i))||i);return n&&i&&aT(e,r,i),i};let lo=class extends J{constructor(){super(...arguments),this.disabled=!1,this.variant="primary"}render(){const t={"wcm-secondary":this.variant==="secondary"};return z`<button ?disabled="${this.disabled}" class="${Sr(t)}"><slot></slot></button>`}};lo.styles=[re.globalCss,oT],Oh([Z({type:Boolean})],lo.prototype,"disabled",2),Oh([Z()],lo.prototype,"variant",2),lo=Oh([ne("wcm-button-big")],lo);const lT=ae`:host{background-color:var(--wcm-color-bg-2);border-top:1px solid var(--wcm-color-bg-3)}div{padding:10px 20px;display:inherit;flex-direction:inherit;align-items:inherit;width:inherit;justify-content:inherit}`;var uT=Object.defineProperty,hT=Object.getOwnPropertyDescriptor,dT=(t,e,r,n)=>{for(var i=n>1?void 0:n?hT(e,r):e,s=t.length-1,o;s>=0;s--)(o=t[s])&&(i=(n?o(e,r,i):o(i))||i);return n&&i&&uT(e,r,i),i};let Sh=class extends J{render(){return z`<div><slot></slot></div>`}};Sh.styles=[re.globalCss,lT],Sh=dT([ne("wcm-info-footer")],Sh);const ue={CROSS_ICON:Ee`<svg width="12" height="12" viewBox="0 0 12 12"><path d="M9.94 11A.75.75 0 1 0 11 9.94L7.414 6.353a.5.5 0 0 1 0-.708L11 2.061A.75.75 0 1 0 9.94 1L6.353 4.586a.5.5 0 0 1-.708 0L2.061 1A.75.75 0 0 0 1 2.06l3.586 3.586a.5.5 0 0 1 0 .708L1 9.939A.75.75 0 1 0 2.06 11l3.586-3.586a.5.5 0 0 1 .708 0L9.939 11Z" fill="#fff"/></svg>`,WALLET_CONNECT_LOGO:Ee`<svg width="178" height="29" viewBox="0 0 178 29" id="wcm-wc-logo"><path d="M10.683 7.926c5.284-5.17 13.85-5.17 19.134 0l.636.623a.652.652 0 0 1 0 .936l-2.176 2.129a.343.343 0 0 1-.478 0l-.875-.857c-3.686-3.607-9.662-3.607-13.348 0l-.937.918a.343.343 0 0 1-.479 0l-2.175-2.13a.652.652 0 0 1 0-.936l.698-.683Zm23.633 4.403 1.935 1.895a.652.652 0 0 1 0 .936l-8.73 8.543a.687.687 0 0 1-.956 0L20.37 17.64a.172.172 0 0 0-.239 0l-6.195 6.063a.687.687 0 0 1-.957 0l-8.73-8.543a.652.652 0 0 1 0-.936l1.936-1.895a.687.687 0 0 1 .957 0l6.196 6.064a.172.172 0 0 0 .239 0l6.195-6.064a.687.687 0 0 1 .957 0l6.196 6.064a.172.172 0 0 0 .24 0l6.195-6.064a.687.687 0 0 1 .956 0ZM48.093 20.948l2.338-9.355c.139-.515.258-1.07.416-1.942.12.872.258 1.427.357 1.942l2.022 9.355h4.181l3.528-13.874h-3.21l-1.943 8.523a24.825 24.825 0 0 0-.456 2.457c-.158-.931-.317-1.625-.495-2.438l-1.883-8.542h-4.201l-2.042 8.542a41.204 41.204 0 0 0-.475 2.438 41.208 41.208 0 0 0-.476-2.438l-1.903-8.542h-3.349l3.508 13.874h4.083ZM63.33 21.304c1.585 0 2.596-.654 3.11-1.605-.059.297-.078.595-.078.892v.357h2.655V15.22c0-2.735-1.248-4.32-4.3-4.32-2.636 0-4.36 1.466-4.52 3.487h2.914c.1-.891.734-1.426 1.705-1.426.911 0 1.407.515 1.407 1.11 0 .435-.258.693-1.03.792l-1.388.159c-2.061.257-3.825 1.01-3.825 3.19 0 1.982 1.645 3.092 3.35 3.092Zm.891-2.041c-.773 0-1.348-.436-1.348-1.19 0-.733.655-1.09 1.645-1.268l.674-.119c.575-.118.892-.218 1.09-.396v.912c0 1.228-.892 2.06-2.06 2.06ZM70.398 7.074v13.874h2.874V7.074h-2.874ZM74.934 7.074v13.874h2.874V7.074h-2.874ZM84.08 21.304c2.735 0 4.5-1.546 4.697-3.567h-2.893c-.139.892-.892 1.387-1.804 1.387-1.228 0-2.12-.99-2.14-2.358h6.897v-.555c0-3.21-1.764-5.312-4.816-5.312-2.933 0-4.994 2.062-4.994 5.173 0 3.37 2.12 5.232 5.053 5.232Zm-2.16-6.421c.119-1.11.932-1.922 2.081-1.922 1.11 0 1.883.772 1.903 1.922H81.92ZM94.92 21.146c.633 0 1.248-.1 1.525-.179v-2.18c-.218.04-.475.06-.693.06-1.05 0-1.427-.595-1.427-1.566v-3.805h2.338v-2.24h-2.338V7.788H91.47v3.448H89.37v2.24h2.1v4.201c0 2.3 1.15 3.469 3.45 3.469ZM104.62 21.304c3.924 0 6.302-2.299 6.599-5.608h-3.111c-.238 1.803-1.506 3.032-3.369 3.032-2.2 0-3.746-1.784-3.746-4.796 0-2.953 1.605-4.638 3.805-4.638 1.883 0 2.953 1.15 3.171 2.834h3.191c-.317-3.448-2.854-5.41-6.342-5.41-3.984 0-7.036 2.695-7.036 7.214 0 4.677 2.676 7.372 6.838 7.372ZM117.449 21.304c2.993 0 5.114-1.882 5.114-5.172 0-3.23-2.121-5.233-5.114-5.233-2.972 0-5.093 2.002-5.093 5.233 0 3.29 2.101 5.172 5.093 5.172Zm0-2.22c-1.327 0-2.18-1.09-2.18-2.952 0-1.903.892-2.973 2.18-2.973 1.308 0 2.2 1.07 2.2 2.973 0 1.862-.872 2.953-2.2 2.953ZM126.569 20.948v-5.689c0-1.208.753-2.1 1.823-2.1 1.011 0 1.606.773 1.606 2.06v5.729h2.873v-6.144c0-2.339-1.229-3.905-3.428-3.905-1.526 0-2.458.734-2.953 1.606a5.31 5.31 0 0 0 .079-.892v-.377h-2.874v9.712h2.874ZM137.464 20.948v-5.689c0-1.208.753-2.1 1.823-2.1 1.011 0 1.606.773 1.606 2.06v5.729h2.873v-6.144c0-2.339-1.228-3.905-3.428-3.905-1.526 0-2.458.734-2.953 1.606a5.31 5.31 0 0 0 .079-.892v-.377h-2.874v9.712h2.874ZM149.949 21.304c2.735 0 4.499-1.546 4.697-3.567h-2.893c-.139.892-.892 1.387-1.804 1.387-1.228 0-2.12-.99-2.14-2.358h6.897v-.555c0-3.21-1.764-5.312-4.816-5.312-2.933 0-4.994 2.062-4.994 5.173 0 3.37 2.12 5.232 5.053 5.232Zm-2.16-6.421c.119-1.11.932-1.922 2.081-1.922 1.11 0 1.883.772 1.903 1.922h-3.984ZM160.876 21.304c3.013 0 4.658-1.645 4.975-4.201h-2.874c-.099 1.07-.713 1.982-2.001 1.982-1.309 0-2.2-1.21-2.2-2.993 0-1.942 1.03-2.933 2.259-2.933 1.209 0 1.803.872 1.883 1.882h2.873c-.218-2.358-1.823-4.142-4.776-4.142-2.874 0-5.153 1.903-5.153 5.193 0 3.25 1.923 5.212 5.014 5.212ZM172.067 21.146c.634 0 1.248-.1 1.526-.179v-2.18c-.218.04-.476.06-.694.06-1.05 0-1.427-.595-1.427-1.566v-3.805h2.339v-2.24h-2.339V7.788h-2.854v3.448h-2.1v2.24h2.1v4.201c0 2.3 1.15 3.469 3.449 3.469Z" fill="#fff"/></svg>`,WALLET_CONNECT_ICON:Ee`<svg width="28" height="20" viewBox="0 0 28 20"><g clip-path="url(#a)"><path d="M7.386 6.482c3.653-3.576 9.575-3.576 13.228 0l.44.43a.451.451 0 0 1 0 .648L19.55 9.033a.237.237 0 0 1-.33 0l-.606-.592c-2.548-2.496-6.68-2.496-9.228 0l-.648.634a.237.237 0 0 1-.33 0L6.902 7.602a.451.451 0 0 1 0-.647l.483-.473Zm16.338 3.046 1.339 1.31a.451.451 0 0 1 0 .648l-6.035 5.909a.475.475 0 0 1-.662 0L14.083 13.2a.119.119 0 0 0-.166 0l-4.283 4.194a.475.475 0 0 1-.662 0l-6.035-5.91a.451.451 0 0 1 0-.647l1.338-1.31a.475.475 0 0 1 .662 0l4.283 4.194c.046.044.12.044.166 0l4.283-4.194a.475.475 0 0 1 .662 0l4.283 4.194c.046.044.12.044.166 0l4.283-4.194a.475.475 0 0 1 .662 0Z" fill="#000000"/></g><defs><clipPath id="a"><path fill="#ffffff" d="M0 0h28v20H0z"/></clipPath></defs></svg>`,WALLET_CONNECT_ICON_COLORED:Ee`<svg width="96" height="96" fill="none"><path fill="#fff" d="M25.322 33.597c12.525-12.263 32.83-12.263 45.355 0l1.507 1.476a1.547 1.547 0 0 1 0 2.22l-5.156 5.048a.814.814 0 0 1-1.134 0l-2.074-2.03c-8.737-8.555-22.903-8.555-31.64 0l-2.222 2.175a.814.814 0 0 1-1.134 0l-5.156-5.049a1.547 1.547 0 0 1 0-2.22l1.654-1.62Zm56.019 10.44 4.589 4.494a1.547 1.547 0 0 1 0 2.22l-20.693 20.26a1.628 1.628 0 0 1-2.267 0L48.283 56.632a.407.407 0 0 0-.567 0L33.03 71.012a1.628 1.628 0 0 1-2.268 0L10.07 50.75a1.547 1.547 0 0 1 0-2.22l4.59-4.494a1.628 1.628 0 0 1 2.267 0l14.687 14.38c.156.153.41.153.567 0l14.685-14.38a1.628 1.628 0 0 1 2.268 0l14.687 14.38c.156.153.41.153.567 0l14.686-14.38a1.628 1.628 0 0 1 2.268 0Z"/><path stroke="#000" d="M25.672 33.954c12.33-12.072 32.325-12.072 44.655 0l1.508 1.476a1.047 1.047 0 0 1 0 1.506l-5.157 5.048a.314.314 0 0 1-.434 0l-2.074-2.03c-8.932-8.746-23.409-8.746-32.34 0l-2.222 2.174a.314.314 0 0 1-.434 0l-5.157-5.048a1.047 1.047 0 0 1 0-1.506l1.655-1.62Zm55.319 10.44 4.59 4.494a1.047 1.047 0 0 1 0 1.506l-20.694 20.26a1.128 1.128 0 0 1-1.568 0l-14.686-14.38a.907.907 0 0 0-1.267 0L32.68 70.655a1.128 1.128 0 0 1-1.568 0L10.42 50.394a1.047 1.047 0 0 1 0-1.506l4.59-4.493a1.128 1.128 0 0 1 1.567 0l14.687 14.379a.907.907 0 0 0 1.266 0l-.35-.357.35.357 14.686-14.38a1.128 1.128 0 0 1 1.568 0l14.687 14.38a.907.907 0 0 0 1.267 0l14.686-14.38a1.128 1.128 0 0 1 1.568 0Z"/></svg>`,BACK_ICON:Ee`<svg width="10" height="18" viewBox="0 0 10 18"><path fill-rule="evenodd" clip-rule="evenodd" d="M8.735.179a.75.75 0 0 1 .087 1.057L2.92 8.192a1.25 1.25 0 0 0 0 1.617l5.902 6.956a.75.75 0 1 1-1.144.97L1.776 10.78a2.75 2.75 0 0 1 0-3.559L7.678.265A.75.75 0 0 1 8.735.18Z" fill="#fff"/></svg>`,COPY_ICON:Ee`<svg width="24" height="24" fill="none"><path fill="#fff" fill-rule="evenodd" d="M7.01 7.01c.03-1.545.138-2.5.535-3.28A5 5 0 0 1 9.73 1.545C10.8 1 12.2 1 15 1c2.8 0 4.2 0 5.27.545a5 5 0 0 1 2.185 2.185C23 4.8 23 6.2 23 9c0 2.8 0 4.2-.545 5.27a5 5 0 0 1-2.185 2.185c-.78.397-1.735.505-3.28.534l-.001.01c-.03 1.54-.138 2.493-.534 3.27a5 5 0 0 1-2.185 2.186C13.2 23 11.8 23 9 23c-2.8 0-4.2 0-5.27-.545a5 5 0 0 1-2.185-2.185C1 19.2 1 17.8 1 15c0-2.8 0-4.2.545-5.27A5 5 0 0 1 3.73 7.545C4.508 7.149 5.46 7.04 7 7.01h.01ZM15 15.5c-1.425 0-2.403-.001-3.162-.063-.74-.06-1.139-.172-1.427-.319a3.5 3.5 0 0 1-1.53-1.529c-.146-.288-.257-.686-.318-1.427C8.501 11.403 8.5 10.425 8.5 9c0-1.425.001-2.403.063-3.162.06-.74.172-1.139.318-1.427a3.5 3.5 0 0 1 1.53-1.53c.288-.146.686-.257 1.427-.318.759-.062 1.737-.063 3.162-.063 1.425 0 2.403.001 3.162.063.74.06 1.139.172 1.427.318a3.5 3.5 0 0 1 1.53 1.53c.146.288.257.686.318 1.427.062.759.063 1.737.063 3.162 0 1.425-.001 2.403-.063 3.162-.06.74-.172 1.139-.319 1.427a3.5 3.5 0 0 1-1.529 1.53c-.288.146-.686.257-1.427.318-.759.062-1.737.063-3.162.063ZM7 8.511c-.444.009-.825.025-1.162.052-.74.06-1.139.172-1.427.318a3.5 3.5 0 0 0-1.53 1.53c-.146.288-.257.686-.318 1.427-.062.759-.063 1.737-.063 3.162 0 1.425.001 2.403.063 3.162.06.74.172 1.139.318 1.427a3.5 3.5 0 0 0 1.53 1.53c.288.146.686.257 1.427.318.759.062 1.737.063 3.162.063 1.425 0 2.403-.001 3.162-.063.74-.06 1.139-.172 1.427-.319a3.5 3.5 0 0 0 1.53-1.53c.146-.287.257-.685.318-1.426.027-.337.043-.718.052-1.162H15c-2.8 0-4.2 0-5.27-.545a5 5 0 0 1-2.185-2.185C7 13.2 7 11.8 7 9v-.489Z" clip-rule="evenodd"/></svg>`,RETRY_ICON:Ee`<svg width="15" height="16" viewBox="0 0 15 16"><path d="M6.464 2.03A.75.75 0 0 0 5.403.97L2.08 4.293a1 1 0 0 0 0 1.414L5.403 9.03a.75.75 0 0 0 1.06-1.06L4.672 6.177a.25.25 0 0 1 .177-.427h2.085a4 4 0 1 1-3.93 4.746c-.077-.407-.405-.746-.82-.746-.414 0-.755.338-.7.748a5.501 5.501 0 1 0 5.45-6.248H4.848a.25.25 0 0 1-.177-.427L6.464 2.03Z" fill="#fff"/></svg>`,DESKTOP_ICON:Ee`<svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M0 5.98c0-1.85 0-2.775.394-3.466a3 3 0 0 1 1.12-1.12C2.204 1 3.13 1 4.98 1h6.04c1.85 0 2.775 0 3.466.394a3 3 0 0 1 1.12 1.12C16 3.204 16 4.13 16 5.98v1.04c0 1.85 0 2.775-.394 3.466a3 3 0 0 1-1.12 1.12C13.796 12 12.87 12 11.02 12H4.98c-1.85 0-2.775 0-3.466-.394a3 3 0 0 1-1.12-1.12C0 9.796 0 8.87 0 7.02V5.98ZM4.98 2.5h6.04c.953 0 1.568.001 2.034.043.446.04.608.108.69.154a1.5 1.5 0 0 1 .559.56c.046.08.114.243.154.69.042.465.043 1.08.043 2.033v1.04c0 .952-.001 1.568-.043 2.034-.04.446-.108.608-.154.69a1.499 1.499 0 0 1-.56.559c-.08.046-.243.114-.69.154-.466.042-1.08.043-2.033.043H4.98c-.952 0-1.568-.001-2.034-.043-.446-.04-.608-.108-.69-.154a1.5 1.5 0 0 1-.559-.56c-.046-.08-.114-.243-.154-.69-.042-.465-.043-1.08-.043-2.033V5.98c0-.952.001-1.568.043-2.034.04-.446.108-.608.154-.69a1.5 1.5 0 0 1 .56-.559c.08-.046.243-.114.69-.154.465-.042 1.08-.043 2.033-.043Z" fill="#fff"/><path d="M4 14.25a.75.75 0 0 1 .75-.75h6.5a.75.75 0 0 1 0 1.5h-6.5a.75.75 0 0 1-.75-.75Z" fill="#fff"/></svg>`,MOBILE_ICON:Ee`<svg width="16" height="16" viewBox="0 0 16 16"><path d="M6.75 5a1.25 1.25 0 1 0 0-2.5 1.25 1.25 0 0 0 0 2.5Z" fill="#fff"/><path fill-rule="evenodd" clip-rule="evenodd" d="M3 4.98c0-1.85 0-2.775.394-3.466a3 3 0 0 1 1.12-1.12C5.204 0 6.136 0 8 0s2.795 0 3.486.394a3 3 0 0 1 1.12 1.12C13 2.204 13 3.13 13 4.98v6.04c0 1.85 0 2.775-.394 3.466a3 3 0 0 1-1.12 1.12C10.796 16 9.864 16 8 16s-2.795 0-3.486-.394a3 3 0 0 1-1.12-1.12C3 13.796 3 12.87 3 11.02V4.98Zm8.5 0v6.04c0 .953-.001 1.568-.043 2.034-.04.446-.108.608-.154.69a1.499 1.499 0 0 1-.56.559c-.08.045-.242.113-.693.154-.47.042-1.091.043-2.05.043-.959 0-1.58-.001-2.05-.043-.45-.04-.613-.109-.693-.154a1.5 1.5 0 0 1-.56-.56c-.046-.08-.114-.243-.154-.69-.042-.466-.043-1.08-.043-2.033V4.98c0-.952.001-1.568.043-2.034.04-.446.108-.608.154-.69a1.5 1.5 0 0 1 .56-.559c.08-.045.243-.113.693-.154C6.42 1.501 7.041 1.5 8 1.5c.959 0 1.58.001 2.05.043.45.04.613.109.693.154a1.5 1.5 0 0 1 .56.56c.046.08.114.243.154.69.042.465.043 1.08.043 2.033Z" fill="#fff"/></svg>`,ARROW_DOWN_ICON:Ee`<svg width="14" height="14" viewBox="0 0 14 14"><path d="M2.28 7.47a.75.75 0 0 0-1.06 1.06l5.25 5.25a.75.75 0 0 0 1.06 0l5.25-5.25a.75.75 0 0 0-1.06-1.06l-3.544 3.543a.25.25 0 0 1-.426-.177V.75a.75.75 0 0 0-1.5 0v10.086a.25.25 0 0 1-.427.176L2.28 7.47Z" fill="#fff"/></svg>`,ARROW_UP_RIGHT_ICON:Ee`<svg width="15" height="14" fill="none"><path d="M4.5 1.75A.75.75 0 0 1 5.25 1H12a1.5 1.5 0 0 1 1.5 1.5v6.75a.75.75 0 0 1-1.5 0V4.164a.25.25 0 0 0-.427-.176L4.061 11.5A.75.75 0 0 1 3 10.44l7.513-7.513a.25.25 0 0 0-.177-.427H5.25a.75.75 0 0 1-.75-.75Z" fill="#fff"/></svg>`,ARROW_RIGHT_ICON:Ee`<svg width="6" height="14" viewBox="0 0 6 14"><path fill-rule="evenodd" clip-rule="evenodd" d="M2.181 1.099a.75.75 0 0 1 1.024.279l2.433 4.258a2.75 2.75 0 0 1 0 2.729l-2.433 4.257a.75.75 0 1 1-1.303-.744L4.335 7.62a1.25 1.25 0 0 0 0-1.24L1.902 2.122a.75.75 0 0 1 .28-1.023Z" fill="#fff"/></svg>`,QRCODE_ICON:Ee`<svg width="25" height="24" viewBox="0 0 25 24"><path d="M23.748 9a.748.748 0 0 0 .748-.752c-.018-2.596-.128-4.07-.784-5.22a6 6 0 0 0-2.24-2.24c-1.15-.656-2.624-.766-5.22-.784a.748.748 0 0 0-.752.748c0 .414.335.749.748.752 1.015.007 1.82.028 2.494.088.995.09 1.561.256 1.988.5.7.398 1.28.978 1.679 1.678.243.427.41.993.498 1.988.061.675.082 1.479.09 2.493a.753.753 0 0 0 .75.749ZM3.527.788C4.677.132 6.152.022 8.747.004A.748.748 0 0 1 9.5.752a.753.753 0 0 1-.749.752c-1.014.007-1.818.028-2.493.088-.995.09-1.561.256-1.988.5-.7.398-1.28.978-1.679 1.678-.243.427-.41.993-.499 1.988-.06.675-.081 1.479-.088 2.493A.753.753 0 0 1 1.252 9a.748.748 0 0 1-.748-.752c.018-2.596.128-4.07.784-5.22a6 6 0 0 1 2.24-2.24ZM1.252 15a.748.748 0 0 0-.748.752c.018 2.596.128 4.07.784 5.22a6 6 0 0 0 2.24 2.24c1.15.656 2.624.766 5.22.784a.748.748 0 0 0 .752-.748.753.753 0 0 0-.749-.752c-1.014-.007-1.818-.028-2.493-.089-.995-.089-1.561-.255-1.988-.498a4.5 4.5 0 0 1-1.679-1.68c-.243-.426-.41-.992-.499-1.987-.06-.675-.081-1.479-.088-2.493A.753.753 0 0 0 1.252 15ZM22.996 15.749a.753.753 0 0 1 .752-.749c.415 0 .751.338.748.752-.018 2.596-.128 4.07-.784 5.22a6 6 0 0 1-2.24 2.24c-1.15.656-2.624.766-5.22.784a.748.748 0 0 1-.752-.748c0-.414.335-.749.748-.752 1.015-.007 1.82-.028 2.494-.089.995-.089 1.561-.255 1.988-.498a4.5 4.5 0 0 0 1.679-1.68c.243-.426.41-.992.498-1.987.061-.675.082-1.479.09-2.493Z" fill="#fff"/><path fill-rule="evenodd" clip-rule="evenodd" d="M7 4a2.5 2.5 0 0 0-2.5 2.5v2A2.5 2.5 0 0 0 7 11h2a2.5 2.5 0 0 0 2.5-2.5v-2A2.5 2.5 0 0 0 9 4H7Zm2 1.5H7a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1ZM13.5 6.5A2.5 2.5 0 0 1 16 4h2a2.5 2.5 0 0 1 2.5 2.5v2A2.5 2.5 0 0 1 18 11h-2a2.5 2.5 0 0 1-2.5-2.5v-2Zm2.5-1h2a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-2a1 1 0 0 1-1-1v-2a1 1 0 0 1 1-1ZM7 13a2.5 2.5 0 0 0-2.5 2.5v2A2.5 2.5 0 0 0 7 20h2a2.5 2.5 0 0 0 2.5-2.5v-2A2.5 2.5 0 0 0 9 13H7Zm2 1.5H7a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1Z" fill="#fff"/><path d="M13.5 15.5c0-.465 0-.697.038-.89a2 2 0 0 1 1.572-1.572C15.303 13 15.535 13 16 13v2.5h-2.5ZM18 13c.465 0 .697 0 .89.038a2 2 0 0 1 1.572 1.572c.038.193.038.425.038.89H18V13ZM18 17.5h2.5c0 .465 0 .697-.038.89a2 2 0 0 1-1.572 1.572C18.697 20 18.465 20 18 20v-2.5ZM13.5 17.5H16V20c-.465 0-.697 0-.89-.038a2 2 0 0 1-1.572-1.572c-.038-.193-.038-.425-.038-.89Z" fill="#fff"/></svg>`,SCAN_ICON:Ee`<svg width="16" height="16" fill="none"><path fill="#fff" d="M10 15.216c0 .422.347.763.768.74 1.202-.064 2.025-.222 2.71-.613a5.001 5.001 0 0 0 1.865-1.866c.39-.684.549-1.507.613-2.709a.735.735 0 0 0-.74-.768.768.768 0 0 0-.76.732c-.009.157-.02.306-.032.447-.073.812-.206 1.244-.384 1.555-.31.545-.761.996-1.306 1.306-.311.178-.743.311-1.555.384-.141.013-.29.023-.447.032a.768.768 0 0 0-.732.76ZM10 .784c0 .407.325.737.732.76.157.009.306.02.447.032.812.073 1.244.206 1.555.384a3.5 3.5 0 0 1 1.306 1.306c.178.311.311.743.384 1.555.013.142.023.29.032.447a.768.768 0 0 0 .76.732.734.734 0 0 0 .74-.768c-.064-1.202-.222-2.025-.613-2.71A5 5 0 0 0 13.477.658c-.684-.39-1.507-.549-2.709-.613a.735.735 0 0 0-.768.74ZM5.232.044A.735.735 0 0 1 6 .784a.768.768 0 0 1-.732.76c-.157.009-.305.02-.447.032-.812.073-1.244.206-1.555.384A3.5 3.5 0 0 0 1.96 3.266c-.178.311-.311.743-.384 1.555-.013.142-.023.29-.032.447A.768.768 0 0 1 .784 6a.735.735 0 0 1-.74-.768c.064-1.202.222-2.025.613-2.71A5 5 0 0 1 2.523.658C3.207.267 4.03.108 5.233.044ZM5.268 14.456a.768.768 0 0 1 .732.76.734.734 0 0 1-.768.74c-1.202-.064-2.025-.222-2.71-.613a5 5 0 0 1-1.865-1.866c-.39-.684-.549-1.507-.613-2.709A.735.735 0 0 1 .784 10c.407 0 .737.325.76.732.009.157.02.306.032.447.073.812.206 1.244.384 1.555a3.5 3.5 0 0 0 1.306 1.306c.311.178.743.311 1.555.384.142.013.29.023.447.032Z"/></svg>`,CHECKMARK_ICON:Ee`<svg width="13" height="12" viewBox="0 0 13 12"><path fill-rule="evenodd" clip-rule="evenodd" d="M12.155.132a.75.75 0 0 1 .232 1.035L5.821 11.535a1 1 0 0 1-1.626.09L.665 7.21a.75.75 0 1 1 1.17-.937L4.71 9.867a.25.25 0 0 0 .406-.023L11.12.364a.75.75 0 0 1 1.035-.232Z" fill="#fff"/></svg>`,SEARCH_ICON:Ee`<svg width="20" height="21"><path fill-rule="evenodd" clip-rule="evenodd" d="M12.432 13.992c-.354-.353-.91-.382-1.35-.146a5.5 5.5 0 1 1 2.265-2.265c-.237.441-.208.997.145 1.35l3.296 3.296a.75.75 0 1 1-1.06 1.061l-3.296-3.296Zm.06-5a4 4 0 1 1-8 0 4 4 0 0 1 8 0Z" fill="#949E9E"/></svg>`,WALLET_PLACEHOLDER:Ee`<svg width="60" height="60" fill="none" viewBox="0 0 60 60"><g clip-path="url(#q)"><path id="wallet-placeholder-fill" fill="#fff" d="M0 24.9c0-9.251 0-13.877 1.97-17.332a15 15 0 0 1 5.598-5.597C11.023 0 15.648 0 24.9 0h10.2c9.252 0 13.877 0 17.332 1.97a15 15 0 0 1 5.597 5.598C60 11.023 60 15.648 60 24.9v10.2c0 9.252 0 13.877-1.97 17.332a15.001 15.001 0 0 1-5.598 5.597C48.977 60 44.352 60 35.1 60H24.9c-9.251 0-13.877 0-17.332-1.97a15 15 0 0 1-5.597-5.598C0 48.977 0 44.352 0 35.1V24.9Z"/><path id="wallet-placeholder-dash" stroke="#000" stroke-dasharray="4 4" stroke-width="1.5" d="M.04 41.708a231.598 231.598 0 0 1-.039-4.403l.75-.001L.75 35.1v-2.55H0v-5.1h.75V24.9l.001-2.204h-.75c.003-1.617.011-3.077.039-4.404l.75.016c.034-1.65.099-3.08.218-4.343l-.746-.07c.158-1.678.412-3.083.82-4.316l.713.236c.224-.679.497-1.296.827-1.875a14.25 14.25 0 0 1 1.05-1.585L3.076 5.9A15 15 0 0 1 5.9 3.076l.455.596a14.25 14.25 0 0 1 1.585-1.05c.579-.33 1.196-.603 1.875-.827l-.236-.712C10.812.674 12.217.42 13.895.262l.07.746C15.23.89 16.66.824 18.308.79l-.016-.75C19.62.012 21.08.004 22.695.001l.001.75L24.9.75h2.55V0h5.1v.75h2.55l2.204.001v-.75c1.617.003 3.077.011 4.404.039l-.016.75c1.65.034 3.08.099 4.343.218l.07-.746c1.678.158 3.083.412 4.316.82l-.236.713c.679.224 1.296.497 1.875.827a14.24 14.24 0 0 1 1.585 1.05l.455-.596A14.999 14.999 0 0 1 56.924 5.9l-.596.455c.384.502.735 1.032 1.05 1.585.33.579.602 1.196.827 1.875l.712-.236c.409 1.233.663 2.638.822 4.316l-.747.07c.119 1.264.184 2.694.218 4.343l.75-.016c.028 1.327.036 2.787.039 4.403l-.75.001.001 2.204v2.55H60v5.1h-.75v2.55l-.001 2.204h.75a231.431 231.431 0 0 1-.039 4.404l-.75-.016c-.034 1.65-.099 3.08-.218 4.343l.747.07c-.159 1.678-.413 3.083-.822 4.316l-.712-.236a10.255 10.255 0 0 1-.827 1.875 14.242 14.242 0 0 1-1.05 1.585l.596.455a14.997 14.997 0 0 1-2.824 2.824l-.455-.596c-.502.384-1.032.735-1.585 1.05-.579.33-1.196.602-1.875.827l.236.712c-1.233.409-2.638.663-4.316.822l-.07-.747c-1.264.119-2.694.184-4.343.218l.016.75c-1.327.028-2.787.036-4.403.039l-.001-.75-2.204.001h-2.55V60h-5.1v-.75H24.9l-2.204-.001v.75a231.431 231.431 0 0 1-4.404-.039l.016-.75c-1.65-.034-3.08-.099-4.343-.218l-.07.747c-1.678-.159-3.083-.413-4.316-.822l.236-.712a10.258 10.258 0 0 1-1.875-.827 14.252 14.252 0 0 1-1.585-1.05l-.455.596A14.999 14.999 0 0 1 3.076 54.1l.596-.455a14.24 14.24 0 0 1-1.05-1.585 10.259 10.259 0 0 1-.827-1.875l-.712.236C.674 49.188.42 47.783.262 46.105l.746-.07C.89 44.77.824 43.34.79 41.692l-.75.016Z"/><path fill="#fff" fill-rule="evenodd" d="M35.643 32.145c-.297-.743-.445-1.114-.401-1.275a.42.42 0 0 1 .182-.27c.134-.1.463-.1 1.123-.1.742 0 1.499.046 2.236-.05a6 6 0 0 0 5.166-5.166c.051-.39.051-.855.051-1.784 0-.928 0-1.393-.051-1.783a6 6 0 0 0-5.166-5.165c-.39-.052-.854-.052-1.783-.052h-7.72c-4.934 0-7.401 0-9.244 1.051a8 8 0 0 0-2.985 2.986C16.057 22.28 16.003 24.58 16 29 15.998 31.075 16 33.15 16 35.224A7.778 7.778 0 0 0 23.778 43H28.5c1.394 0 2.09 0 2.67-.116a6 6 0 0 0 4.715-4.714c.115-.58.115-1.301.115-2.744 0-1.31 0-1.964-.114-2.49a4.998 4.998 0 0 0-.243-.792Z" clip-rule="evenodd"/><path fill="#9EA9A9" fill-rule="evenodd" d="M37 18h-7.72c-2.494 0-4.266.002-5.647.126-1.361.122-2.197.354-2.854.728a6.5 6.5 0 0 0-2.425 2.426c-.375.657-.607 1.492-.729 2.853-.11 1.233-.123 2.777-.125 4.867 0 .7 0 1.05.097 1.181.096.13.182.181.343.2.163.02.518-.18 1.229-.581a6.195 6.195 0 0 1 3.053-.8H37c.977 0 1.32-.003 1.587-.038a4.5 4.5 0 0 0 3.874-3.874c.036-.268.039-.611.039-1.588 0-.976-.003-1.319-.038-1.587a4.5 4.5 0 0 0-3.875-3.874C38.32 18.004 37.977 18 37 18Zm-7.364 12.5h-7.414a4.722 4.722 0 0 0-4.722 4.723 6.278 6.278 0 0 0 6.278 6.278H28.5c1.466 0 1.98-.008 2.378-.087a4.5 4.5 0 0 0 3.535-3.536c.08-.397.087-.933.087-2.451 0-1.391-.009-1.843-.08-2.17a3.5 3.5 0 0 0-2.676-2.676c-.328-.072-.762-.08-2.108-.08Z" clip-rule="evenodd"/></g><defs><clipPath id="q"><path fill="#fff" d="M0 0h60v60H0z"/></clipPath></defs></svg>`,GLOBE_ICON:Ee`<svg width="16" height="16" fill="none" viewBox="0 0 16 16"><path fill="#fff" fill-rule="evenodd" d="M15.5 8a7.5 7.5 0 1 1-15 0 7.5 7.5 0 0 1 15 0Zm-2.113.75c.301 0 .535.264.47.558a6.01 6.01 0 0 1-2.867 3.896c-.203.116-.42-.103-.334-.32.409-1.018.691-2.274.797-3.657a.512.512 0 0 1 .507-.477h1.427Zm.47-2.058c.065.294-.169.558-.47.558H11.96a.512.512 0 0 1-.507-.477c-.106-1.383-.389-2.638-.797-3.656-.087-.217.13-.437.333-.32a6.01 6.01 0 0 1 2.868 3.895Zm-4.402.558c.286 0 .515-.24.49-.525-.121-1.361-.429-2.534-.83-3.393-.279-.6-.549-.93-.753-1.112a.535.535 0 0 0-.724 0c-.204.182-.474.513-.754 1.112-.4.859-.708 2.032-.828 3.393a.486.486 0 0 0 .49.525h2.909Zm-5.415 0c.267 0 .486-.21.507-.477.106-1.383.389-2.638.797-3.656.087-.217-.13-.437-.333-.32a6.01 6.01 0 0 0-2.868 3.895c-.065.294.169.558.47.558H4.04ZM2.143 9.308c-.065-.294.169-.558.47-.558H4.04c.267 0 .486.21.507.477.106 1.383.389 2.639.797 3.657.087.217-.13.436-.333.32a6.01 6.01 0 0 1-2.868-3.896Zm3.913-.033a.486.486 0 0 1 .49-.525h2.909c.286 0 .515.24.49.525-.121 1.361-.428 2.535-.83 3.394-.279.6-.549.93-.753 1.112a.535.535 0 0 1-.724 0c-.204-.182-.474-.513-.754-1.112-.4-.859-.708-2.033-.828-3.394Z" clip-rule="evenodd"/></svg>`},fT=ae`.wcm-toolbar-placeholder{top:0;bottom:0;left:0;right:0;width:100%;position:absolute;display:block;pointer-events:none;height:100px;border-radius:calc(var(--wcm-background-border-radius) * .9);background-color:var(--wcm-background-color);background-position:center;background-size:cover}.wcm-toolbar{height:38px;display:flex;position:relative;margin:5px 15px 5px 5px;justify-content:space-between;align-items:center}.wcm-toolbar img,.wcm-toolbar svg{height:28px;object-position:left center;object-fit:contain}#wcm-wc-logo path{fill:var(--wcm-accent-fill-color)}button{width:28px;height:28px;border-radius:var(--wcm-icon-button-border-radius);border:0;display:flex;justify-content:center;align-items:center;cursor:pointer;background-color:var(--wcm-color-bg-1);box-shadow:0 0 0 1px var(--wcm-color-overlay)}button:active{background-color:var(--wcm-color-bg-2)}button svg{display:block;object-position:center}button path{fill:var(--wcm-color-fg-1)}.wcm-toolbar div{display:flex}@media(hover:hover){button:hover{background-color:var(--wcm-color-bg-2)}}`;var pT=Object.defineProperty,gT=Object.getOwnPropertyDescriptor,mT=(t,e,r,n)=>{for(var i=n>1?void 0:n?gT(e,r):e,s=t.length-1,o;s>=0;s--)(o=t[s])&&(i=(n?o(e,r,i):o(i))||i);return n&&i&&pT(e,r,i),i};let Ah=class extends J{render(){return z`<div class="wcm-toolbar-placeholder"></div><div class="wcm-toolbar">${ue.WALLET_CONNECT_LOGO} <button @click="${Rn.close}">${ue.CROSS_ICON}</button></div>`}};Ah.styles=[re.globalCss,fT],Ah=mT([ne("wcm-modal-backcard")],Ah);const wT=ae`main{padding:20px;padding-top:0;width:100%}`;var yT=Object.defineProperty,bT=Object.getOwnPropertyDescriptor,vT=(t,e,r,n)=>{for(var i=n>1?void 0:n?bT(e,r):e,s=t.length-1,o;s>=0;s--)(o=t[s])&&(i=(n?o(e,r,i):o(i))||i);return n&&i&&yT(e,r,i),i};let Ch=class extends J{render(){return z`<main><slot></slot></main>`}};Ch.styles=[re.globalCss,wT],Ch=vT([ne("wcm-modal-content")],Ch);const ET=ae`footer{padding:10px;display:flex;flex-direction:column;align-items:inherit;justify-content:inherit;border-top:1px solid var(--wcm-color-bg-2)}`;var _T=Object.defineProperty,$T=Object.getOwnPropertyDescriptor,xT=(t,e,r,n)=>{for(var i=n>1?void 0:n?$T(e,r):e,s=t.length-1,o;s>=0;s--)(o=t[s])&&(i=(n?o(e,r,i):o(i))||i);return n&&i&&_T(e,r,i),i};let Ph=class extends J{render(){return z`<footer><slot></slot></footer>`}};Ph.styles=[re.globalCss,ET],Ph=xT([ne("wcm-modal-footer")],Ph);const IT=ae`header{display:flex;justify-content:center;align-items:center;padding:20px;position:relative}.wcm-border{border-bottom:1px solid var(--wcm-color-bg-2);margin-bottom:20px}header button{padding:15px 20px}header button:active{opacity:.5}@media(hover:hover){header button:hover{opacity:.5}}.wcm-back-btn{position:absolute;left:0}.wcm-action-btn{position:absolute;right:0}path{fill:var(--wcm-accent-color)}`;var OT=Object.defineProperty,ST=Object.getOwnPropertyDescriptor,uo=(t,e,r,n)=>{for(var i=n>1?void 0:n?ST(e,r):e,s=t.length-1,o;s>=0;s--)(o=t[s])&&(i=(n?o(e,r,i):o(i))||i);return n&&i&&OT(e,r,i),i};let kn=class extends J{constructor(){super(...arguments),this.title="",this.onAction=void 0,this.actionIcon=void 0,this.border=!1}backBtnTemplate(){return z`<button class="wcm-back-btn" @click="${be.goBack}">${ue.BACK_ICON}</button>`}actionBtnTemplate(){return z`<button class="wcm-action-btn" @click="${this.onAction}">${this.actionIcon}</button>`}render(){const t={"wcm-border":this.border},e=be.state.history.length>1,r=this.title?z`<wcm-text variant="big-bold">${this.title}</wcm-text>`:z`<slot></slot>`;return z`<header class="${Sr(t)}">${e?this.backBtnTemplate():null} ${r} ${this.onAction?this.actionBtnTemplate():null}</header>`}};kn.styles=[re.globalCss,IT],uo([Z()],kn.prototype,"title",2),uo([Z()],kn.prototype,"onAction",2),uo([Z()],kn.prototype,"actionIcon",2),uo([Z({type:Boolean})],kn.prototype,"border",2),kn=uo([ne("wcm-modal-header")],kn);const K={MOBILE_BREAKPOINT:600,WCM_RECENT_WALLET_DATA:"WCM_RECENT_WALLET_DATA",EXPLORER_WALLET_URL:"https://explorer.walletconnect.com/?type=wallet",getShadowRootElement(t,e){const r=t.renderRoot.querySelector(e);if(!r)throw new Error(`${e} not found`);return r},getWalletIcon({id:t,image_id:e}){const{walletImages:r}=Ot.state;return r?.[t]?r[t]:e?mt.getWalletImageUrl(e):""},getWalletName(t,e=!1){return e&&t.length>8?`${t.substring(0,8)}..`:t},isMobileAnimation(){return window.innerWidth<=K.MOBILE_BREAKPOINT},async preloadImage(t){const e=new Promise((r,n)=>{const i=new Image;i.onload=r,i.onerror=n,i.crossOrigin="anonymous",i.src=t});return Promise.race([e,V.wait(3e3)])},getErrorMessage(t){return t instanceof Error?t.message:"Unknown Error"},debounce(t,e=500){let r;return(...n)=>{function i(){t(...n)}r&&clearTimeout(r),r=setTimeout(i,e)}},handleMobileLinking(t,e="_self"){const{walletConnectUri:r}=Oe.state,{mobile:n,name:i}=t,s=n?.native,o=n?.universal;K.setRecentWallet(t);function a(c){if(s){const l=V.formatNativeUrl(s,c,i);V.openHref(l,e)}else if(o){const l=V.formatUniversalUrl(o,c,i);V.openHref(l,e)}}r&&a(r)},handleAndroidLinking(){const{walletConnectUri:t}=Oe.state;t&&(V.setWalletConnectAndroidDeepLink(t),V.openHref(t,V.isTelegram()?"_blank":"_self"))},async handleUriCopy(){const{walletConnectUri:t}=Oe.state;if(t)try{await navigator.clipboard.writeText(t),Jr.openToast("Link copied","success")}catch{Jr.openToast("Failed to copy","error")}},getCustomImageUrls(){const{walletImages:t}=Ot.state,e=Object.values(t??{});return Object.values(e)},truncate(t,e=8){return t.length<=e?t:`${t.substring(0,4)}...${t.substring(t.length-4)}`},setRecentWallet(t){try{localStorage.setItem(K.WCM_RECENT_WALLET_DATA,JSON.stringify(t))}catch{console.info("Unable to set recent wallet")}},getRecentWallet(){try{const t=localStorage.getItem(K.WCM_RECENT_WALLET_DATA);return t?JSON.parse(t):void 0}catch{console.info("Unable to get recent wallet")}},caseSafeIncludes(t,e){return t.toUpperCase().includes(e.toUpperCase())},openWalletExplorerUrl(){V.openHref(K.EXPLORER_WALLET_URL,"_blank")},getCachedRouterWalletPlatforms(){const{desktop:t,mobile:e}=V.getWalletRouterData(),r=!!t?.native,n=!!t?.universal,i=!!e?.native||!!e?.universal;return{isDesktop:r,isMobile:i,isWeb:n}},goToConnectingView(t){be.setData({Wallet:t});const e=V.isMobile(),{isDesktop:r,isWeb:n,isMobile:i}=K.getCachedRouterWalletPlatforms();e?i?(be.push("MobileConnecting"),!V.isAndroid()&&V.isTelegram()&&this.handleMobileLinking(t,"_blank")):n?be.push("WebConnecting"):be.push("InstallWallet"):r?be.push("DesktopConnecting"):n?be.push("WebConnecting"):i?be.push("MobileQrcodeConnecting"):be.push("InstallWallet")}},AT=ae`.wcm-router{overflow:hidden;will-change:transform}.wcm-content{display:flex;flex-direction:column}`;var CT=Object.defineProperty,PT=Object.getOwnPropertyDescriptor,Dh=(t,e,r,n)=>{for(var i=n>1?void 0:n?PT(e,r):e,s=t.length-1,o;s>=0;s--)(o=t[s])&&(i=(n?o(e,r,i):o(i))||i);return n&&i&&CT(e,r,i),i};let ho=class extends J{constructor(){super(),this.view=be.state.view,this.prevView=be.state.view,this.unsubscribe=void 0,this.oldHeight="0px",this.resizeObserver=void 0,this.unsubscribe=be.subscribe(t=>{this.view!==t.view&&this.onChangeRoute()})}firstUpdated(){this.resizeObserver=new ResizeObserver(([t])=>{const e=`${t.contentRect.height}px`;this.oldHeight!=="0px"&&Fn(this.routerEl,{height:[this.oldHeight,e]},{duration:.2}),this.oldHeight=e}),this.resizeObserver.observe(this.contentEl)}disconnectedCallback(){var t,e;(t=this.unsubscribe)==null||t.call(this),(e=this.resizeObserver)==null||e.disconnect()}get routerEl(){return K.getShadowRootElement(this,".wcm-router")}get contentEl(){return K.getShadowRootElement(this,".wcm-content")}viewTemplate(){switch(this.view){case"ConnectWallet":return z`<wcm-connect-wallet-view></wcm-connect-wallet-view>`;case"DesktopConnecting":return z`<wcm-desktop-connecting-view></wcm-desktop-connecting-view>`;case"MobileConnecting":return z`<wcm-mobile-connecting-view></wcm-mobile-connecting-view>`;case"WebConnecting":return z`<wcm-web-connecting-view></wcm-web-connecting-view>`;case"MobileQrcodeConnecting":return z`<wcm-mobile-qr-connecting-view></wcm-mobile-qr-connecting-view>`;case"WalletExplorer":return z`<wcm-wallet-explorer-view></wcm-wallet-explorer-view>`;case"Qrcode":return z`<wcm-qrcode-view></wcm-qrcode-view>`;case"InstallWallet":return z`<wcm-install-wallet-view></wcm-install-wallet-view>`;default:return z`<div>Not Found</div>`}}async onChangeRoute(){await Fn(this.routerEl,{opacity:[1,0],scale:[1,1.02]},{duration:.15,delay:.1}).finished,this.view=be.state.view,Fn(this.routerEl,{opacity:[0,1],scale:[.99,1]},{duration:.37,delay:.05})}render(){return z`<div class="wcm-router"><div class="wcm-content">${this.viewTemplate()}</div></div>`}};ho.styles=[re.globalCss,AT],Dh([wt()],ho.prototype,"view",2),Dh([wt()],ho.prototype,"prevView",2),ho=Dh([ne("wcm-modal-router")],ho);const DT=ae`div{height:36px;width:max-content;display:flex;justify-content:center;align-items:center;padding:9px 15px 11px;position:absolute;top:12px;box-shadow:0 6px 14px -6px rgba(10,16,31,.3),0 10px 32px -4px rgba(10,16,31,.15);z-index:2;left:50%;transform:translateX(-50%);pointer-events:none;backdrop-filter:blur(20px) saturate(1.8);-webkit-backdrop-filter:blur(20px) saturate(1.8);border-radius:var(--wcm-notification-border-radius);border:1px solid var(--wcm-color-overlay);background-color:var(--wcm-color-overlay)}svg{margin-right:5px}@-moz-document url-prefix(){div{background-color:var(--wcm-color-bg-3)}}.wcm-success path{fill:var(--wcm-accent-color)}.wcm-error path{fill:var(--wcm-error-color)}`;var TT=Object.defineProperty,RT=Object.getOwnPropertyDescriptor,Fw=(t,e,r,n)=>{for(var i=n>1?void 0:n?RT(e,r):e,s=t.length-1,o;s>=0;s--)(o=t[s])&&(i=(n?o(e,r,i):o(i))||i);return n&&i&&TT(e,r,i),i};let Za=class extends J{constructor(){super(),this.open=!1,this.unsubscribe=void 0,this.timeout=void 0,this.unsubscribe=Jr.subscribe(t=>{t.open?(this.open=!0,this.timeout=setTimeout(()=>Jr.closeToast(),2200)):(this.open=!1,clearTimeout(this.timeout))})}disconnectedCallback(){var t;(t=this.unsubscribe)==null||t.call(this),clearTimeout(this.timeout),Jr.closeToast()}render(){const{message:t,variant:e}=Jr.state,r={"wcm-success":e==="success","wcm-error":e==="error"};return this.open?z`<div class="${Sr(r)}">${e==="success"?ue.CHECKMARK_ICON:null} ${e==="error"?ue.CROSS_ICON:null}<wcm-text variant="small-regular">${t}</wcm-text></div>`:null}};Za.styles=[re.globalCss,DT],Fw([wt()],Za.prototype,"open",2),Za=Fw([ne("wcm-modal-toast")],Za);const NT=.1,kw=2.5,Ar=7;function Th(t,e,r){return t===e?!1:(t-e<0?e-t:t-e)<=r+NT}function BT(t,e){const r=Array.prototype.slice.call(so.create(t,{errorCorrectionLevel:e}).modules.data,0),n=Math.sqrt(r.length);return r.reduce((i,s,o)=>(o%n===0?i.push([s]):i[i.length-1].push(s))&&i,[])}const LT={generate(t,e,r){const n="#141414",i="#ffffff",s=[],o=BT(t,"Q"),a=e/o.length,c=[{x:0,y:0},{x:1,y:0},{x:0,y:1}];c.forEach(({x:f,y:g})=>{const m=(o.length-Ar)*a*f,w=(o.length-Ar)*a*g,y=.45;for(let E=0;E<c.length;E+=1){const _=a*(Ar-E*2);s.push(Ee`<rect fill="${E%2===0?n:i}" height="${_}" rx="${_*y}" ry="${_*y}" width="${_}" x="${m+a*E}" y="${w+a*E}">`)}});const l=Math.floor((r+25)/a),u=o.length/2-l/2,h=o.length/2+l/2-1,d=[];o.forEach((f,g)=>{f.forEach((m,w)=>{if(o[g][w]&&!(g<Ar&&w<Ar||g>o.length-(Ar+1)&&w<Ar||g<Ar&&w>o.length-(Ar+1))&&!(g>u&&g<h&&w>u&&w<h)){const y=g*a+a/2,E=w*a+a/2;d.push([y,E])}})});const p={};return d.forEach(([f,g])=>{p[f]?p[f].push(g):p[f]=[g]}),Object.entries(p).map(([f,g])=>{const m=g.filter(w=>g.every(y=>!Th(w,y,a)));return[Number(f),m]}).forEach(([f,g])=>{g.forEach(m=>{s.push(Ee`<circle cx="${f}" cy="${m}" fill="${n}" r="${a/kw}">`)})}),Object.entries(p).filter(([f,g])=>g.length>1).map(([f,g])=>{const m=g.filter(w=>g.some(y=>Th(w,y,a)));return[Number(f),m]}).map(([f,g])=>{g.sort((w,y)=>w<y?-1:1);const m=[];for(const w of g){const y=m.find(E=>E.some(_=>Th(w,_,a)));y?y.push(w):m.push([w])}return[f,m.map(w=>[w[0],w[w.length-1]])]}).forEach(([f,g])=>{g.forEach(([m,w])=>{s.push(Ee`<line x1="${f}" x2="${f}" y1="${m}" y2="${w}" stroke="${n}" stroke-width="${a/(kw/2)}" stroke-linecap="round">`)})}),s}},MT=ae`@keyframes fadeIn{0%{opacity:0}100%{opacity:1}}div{position:relative;user-select:none;display:block;overflow:hidden;aspect-ratio:1/1;animation:fadeIn ease .2s}.wcm-dark{background-color:#fff;border-radius:var(--wcm-container-border-radius);padding:18px;box-shadow:0 2px 5px #000}svg:first-child,wcm-wallet-image{position:absolute;top:50%;left:50%;transform:translateY(-50%) translateX(-50%)}wcm-wallet-image{transform:translateY(-50%) translateX(-50%)}wcm-wallet-image{width:25%;height:25%;border-radius:var(--wcm-wallet-icon-border-radius)}svg:first-child{transform:translateY(-50%) translateX(-50%) scale(.9)}svg:first-child path:first-child{fill:var(--wcm-accent-color)}svg:first-child path:last-child{stroke:var(--wcm-color-overlay)}`;var UT=Object.defineProperty,jT=Object.getOwnPropertyDescriptor,Yi=(t,e,r,n)=>{for(var i=n>1?void 0:n?jT(e,r):e,s=t.length-1,o;s>=0;s--)(o=t[s])&&(i=(n?o(e,r,i):o(i))||i);return n&&i&&UT(e,r,i),i};let Cr=class extends J{constructor(){super(...arguments),this.uri="",this.size=0,this.imageId=void 0,this.walletId=void 0,this.imageUrl=void 0}svgTemplate(){const e=Yr.state.themeMode==="light"?this.size:this.size-18*2;return Ee`<svg height="${e}" width="${e}">${LT.generate(this.uri,e,e/4)}</svg>`}render(){const t={"wcm-dark":Yr.state.themeMode==="dark"};return z`<div style="${`width: ${this.size}px`}" class="${Sr(t)}">${this.walletId||this.imageUrl?z`<wcm-wallet-image walletId="${at(this.walletId)}" imageId="${at(this.imageId)}" imageUrl="${at(this.imageUrl)}"></wcm-wallet-image>`:ue.WALLET_CONNECT_ICON_COLORED} ${this.svgTemplate()}</div>`}};Cr.styles=[re.globalCss,MT],Yi([Z()],Cr.prototype,"uri",2),Yi([Z({type:Number})],Cr.prototype,"size",2),Yi([Z()],Cr.prototype,"imageId",2),Yi([Z()],Cr.prototype,"walletId",2),Yi([Z()],Cr.prototype,"imageUrl",2),Cr=Yi([ne("wcm-qrcode")],Cr);const FT=ae`:host{position:relative;height:28px;width:80%}input{width:100%;height:100%;line-height:28px!important;border-radius:var(--wcm-input-border-radius);font-style:normal;font-family:-apple-system,system-ui,BlinkMacSystemFont,'Segoe UI',Roboto,Ubuntu,'Helvetica Neue',sans-serif;font-feature-settings:'case' on;font-weight:500;font-size:16px;letter-spacing:-.03em;padding:0 10px 0 34px;transition:.2s all ease;color:var(--wcm-color-fg-1);background-color:var(--wcm-color-bg-3);box-shadow:inset 0 0 0 1px var(--wcm-color-overlay);caret-color:var(--wcm-accent-color)}input::placeholder{color:var(--wcm-color-fg-2)}svg{left:10px;top:4px;pointer-events:none;position:absolute;width:20px;height:20px}input:focus-within{box-shadow:inset 0 0 0 1px var(--wcm-accent-color)}path{fill:var(--wcm-color-fg-2)}`;var kT=Object.defineProperty,qT=Object.getOwnPropertyDescriptor,qw=(t,e,r,n)=>{for(var i=n>1?void 0:n?qT(e,r):e,s=t.length-1,o;s>=0;s--)(o=t[s])&&(i=(n?o(e,r,i):o(i))||i);return n&&i&&kT(e,r,i),i};let Ya=class extends J{constructor(){super(...arguments),this.onChange=()=>null}render(){return z`<input type="text" @input="${this.onChange}" placeholder="Search wallets"> ${ue.SEARCH_ICON}`}};Ya.styles=[re.globalCss,FT],qw([Z()],Ya.prototype,"onChange",2),Ya=qw([ne("wcm-search-input")],Ya);const zT=ae`@keyframes rotate{100%{transform:rotate(360deg)}}@keyframes dash{0%{stroke-dasharray:1,150;stroke-dashoffset:0}50%{stroke-dasharray:90,150;stroke-dashoffset:-35}100%{stroke-dasharray:90,150;stroke-dashoffset:-124}}svg{animation:rotate 2s linear infinite;display:flex;justify-content:center;align-items:center}svg circle{stroke-linecap:round;animation:dash 1.5s ease infinite;stroke:var(--wcm-accent-color)}`;var HT=Object.defineProperty,VT=Object.getOwnPropertyDescriptor,WT=(t,e,r,n)=>{for(var i=n>1?void 0:n?VT(e,r):e,s=t.length-1,o;s>=0;s--)(o=t[s])&&(i=(n?o(e,r,i):o(i))||i);return n&&i&&HT(e,r,i),i};let Rh=class extends J{render(){return z`<svg viewBox="0 0 50 50" width="24" height="24"><circle cx="25" cy="25" r="20" fill="none" stroke-width="4" stroke="#fff"/></svg>`}};Rh.styles=[re.globalCss,zT],Rh=WT([ne("wcm-spinner")],Rh);const KT=ae`span{font-style:normal;font-family:var(--wcm-font-family);font-feature-settings:var(--wcm-font-feature-settings)}.wcm-xsmall-bold{font-family:var(--wcm-text-xsmall-bold-font-family);font-weight:var(--wcm-text-xsmall-bold-weight);font-size:var(--wcm-text-xsmall-bold-size);line-height:var(--wcm-text-xsmall-bold-line-height);letter-spacing:var(--wcm-text-xsmall-bold-letter-spacing);text-transform:var(--wcm-text-xsmall-bold-text-transform)}.wcm-xsmall-regular{font-family:var(--wcm-text-xsmall-regular-font-family);font-weight:var(--wcm-text-xsmall-regular-weight);font-size:var(--wcm-text-xsmall-regular-size);line-height:var(--wcm-text-xsmall-regular-line-height);letter-spacing:var(--wcm-text-xsmall-regular-letter-spacing);text-transform:var(--wcm-text-xsmall-regular-text-transform)}.wcm-small-thin{font-family:var(--wcm-text-small-thin-font-family);font-weight:var(--wcm-text-small-thin-weight);font-size:var(--wcm-text-small-thin-size);line-height:var(--wcm-text-small-thin-line-height);letter-spacing:var(--wcm-text-small-thin-letter-spacing);text-transform:var(--wcm-text-small-thin-text-transform)}.wcm-small-regular{font-family:var(--wcm-text-small-regular-font-family);font-weight:var(--wcm-text-small-regular-weight);font-size:var(--wcm-text-small-regular-size);line-height:var(--wcm-text-small-regular-line-height);letter-spacing:var(--wcm-text-small-regular-letter-spacing);text-transform:var(--wcm-text-small-regular-text-transform)}.wcm-medium-regular{font-family:var(--wcm-text-medium-regular-font-family);font-weight:var(--wcm-text-medium-regular-weight);font-size:var(--wcm-text-medium-regular-size);line-height:var(--wcm-text-medium-regular-line-height);letter-spacing:var(--wcm-text-medium-regular-letter-spacing);text-transform:var(--wcm-text-medium-regular-text-transform)}.wcm-big-bold{font-family:var(--wcm-text-big-bold-font-family);font-weight:var(--wcm-text-big-bold-weight);font-size:var(--wcm-text-big-bold-size);line-height:var(--wcm-text-big-bold-line-height);letter-spacing:var(--wcm-text-big-bold-letter-spacing);text-transform:var(--wcm-text-big-bold-text-transform)}:host(*){color:var(--wcm-color-fg-1)}.wcm-color-primary{color:var(--wcm-color-fg-1)}.wcm-color-secondary{color:var(--wcm-color-fg-2)}.wcm-color-tertiary{color:var(--wcm-color-fg-3)}.wcm-color-inverse{color:var(--wcm-accent-fill-color)}.wcm-color-accnt{color:var(--wcm-accent-color)}.wcm-color-error{color:var(--wcm-error-color)}`;var GT=Object.defineProperty,ZT=Object.getOwnPropertyDescriptor,Nh=(t,e,r,n)=>{for(var i=n>1?void 0:n?ZT(e,r):e,s=t.length-1,o;s>=0;s--)(o=t[s])&&(i=(n?o(e,r,i):o(i))||i);return n&&i&&GT(e,r,i),i};let fo=class extends J{constructor(){super(...arguments),this.variant="medium-regular",this.color="primary"}render(){const t={"wcm-big-bold":this.variant==="big-bold","wcm-medium-regular":this.variant==="medium-regular","wcm-small-regular":this.variant==="small-regular","wcm-small-thin":this.variant==="small-thin","wcm-xsmall-regular":this.variant==="xsmall-regular","wcm-xsmall-bold":this.variant==="xsmall-bold","wcm-color-primary":this.color==="primary","wcm-color-secondary":this.color==="secondary","wcm-color-tertiary":this.color==="tertiary","wcm-color-inverse":this.color==="inverse","wcm-color-accnt":this.color==="accent","wcm-color-error":this.color==="error"};return z`<span><slot class="${Sr(t)}"></slot></span>`}};fo.styles=[re.globalCss,KT],Nh([Z()],fo.prototype,"variant",2),Nh([Z()],fo.prototype,"color",2),fo=Nh([ne("wcm-text")],fo);const YT=ae`button{width:100%;height:100%;border-radius:var(--wcm-button-hover-highlight-border-radius);display:flex;align-items:flex-start}button:active{background-color:var(--wcm-color-overlay)}@media(hover:hover){button:hover{background-color:var(--wcm-color-overlay)}}button>div{width:80px;padding:5px 0;display:flex;flex-direction:column;align-items:center}wcm-text{width:100%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-align:center}wcm-wallet-image{height:60px;width:60px;transition:all .2s ease;border-radius:var(--wcm-wallet-icon-border-radius);margin-bottom:5px}.wcm-sublabel{margin-top:2px}`;var JT=Object.defineProperty,QT=Object.getOwnPropertyDescriptor,nn=(t,e,r,n)=>{for(var i=n>1?void 0:n?QT(e,r):e,s=t.length-1,o;s>=0;s--)(o=t[s])&&(i=(n?o(e,r,i):o(i))||i);return n&&i&&JT(e,r,i),i};let ur=class extends J{constructor(){super(...arguments),this.onClick=()=>null,this.name="",this.walletId="",this.label=void 0,this.imageId=void 0,this.installed=!1,this.recent=!1}sublabelTemplate(){return this.recent?z`<wcm-text class="wcm-sublabel" variant="xsmall-bold" color="tertiary">RECENT</wcm-text>`:this.installed?z`<wcm-text class="wcm-sublabel" variant="xsmall-bold" color="tertiary">INSTALLED</wcm-text>`:null}handleClick(){O1.click({name:"WALLET_BUTTON",walletId:this.walletId}),this.onClick()}render(){var t;return z`<button @click="${this.handleClick.bind(this)}"><div><wcm-wallet-image walletId="${this.walletId}" imageId="${at(this.imageId)}"></wcm-wallet-image><wcm-text variant="xsmall-regular">${(t=this.label)!=null?t:K.getWalletName(this.name,!0)}</wcm-text>${this.sublabelTemplate()}</div></button>`}};ur.styles=[re.globalCss,YT],nn([Z()],ur.prototype,"onClick",2),nn([Z()],ur.prototype,"name",2),nn([Z()],ur.prototype,"walletId",2),nn([Z()],ur.prototype,"label",2),nn([Z()],ur.prototype,"imageId",2),nn([Z({type:Boolean})],ur.prototype,"installed",2),nn([Z({type:Boolean})],ur.prototype,"recent",2),ur=nn([ne("wcm-wallet-button")],ur);const XT=ae`:host{display:block}div{overflow:hidden;position:relative;border-radius:inherit;width:100%;height:100%;background-color:var(--wcm-color-overlay)}svg{position:relative;width:100%;height:100%}div::after{content:'';position:absolute;top:0;bottom:0;left:0;right:0;border-radius:inherit;border:1px solid var(--wcm-color-overlay)}div img{width:100%;height:100%;object-fit:cover;object-position:center}#wallet-placeholder-fill{fill:var(--wcm-color-bg-3)}#wallet-placeholder-dash{stroke:var(--wcm-color-overlay)}`;var eR=Object.defineProperty,tR=Object.getOwnPropertyDescriptor,Ja=(t,e,r,n)=>{for(var i=n>1?void 0:n?tR(e,r):e,s=t.length-1,o;s>=0;s--)(o=t[s])&&(i=(n?o(e,r,i):o(i))||i);return n&&i&&eR(e,r,i),i};let Ji=class extends J{constructor(){super(...arguments),this.walletId="",this.imageId=void 0,this.imageUrl=void 0}render(){var t;const e=(t=this.imageUrl)!=null&&t.length?this.imageUrl:K.getWalletIcon({id:this.walletId,image_id:this.imageId});return z`${e.length?z`<div><img crossorigin="anonymous" src="${e}" alt="${this.id}"></div>`:ue.WALLET_PLACEHOLDER}`}};Ji.styles=[re.globalCss,XT],Ja([Z()],Ji.prototype,"walletId",2),Ja([Z()],Ji.prototype,"imageId",2),Ja([Z()],Ji.prototype,"imageUrl",2),Ji=Ja([ne("wcm-wallet-image")],Ji);var rR=Object.defineProperty,nR=Object.getOwnPropertyDescriptor,zw=(t,e,r,n)=>{for(var i=n>1?void 0:n?nR(e,r):e,s=t.length-1,o;s>=0;s--)(o=t[s])&&(i=(n?o(e,r,i):o(i))||i);return n&&i&&rR(e,r,i),i};let Bh=class extends J{constructor(){super(),this.preload=!0,this.preloadData()}async loadImages(t){try{t?.length&&await Promise.all(t.map(async e=>K.preloadImage(e)))}catch{console.info("Unsuccessful attempt at preloading some images",t)}}async preloadListings(){if(Ot.state.enableExplorer){await mt.getRecomendedWallets(),Oe.setIsDataLoaded(!0);const{recomendedWallets:t}=mt.state,e=t.map(r=>K.getWalletIcon(r));await this.loadImages(e)}else Oe.setIsDataLoaded(!0)}async preloadCustomImages(){const t=K.getCustomImageUrls();await this.loadImages(t)}async preloadData(){try{this.preload&&(this.preload=!1,await Promise.all([this.preloadListings(),this.preloadCustomImages()]))}catch(t){console.error(t),Jr.openToast("Failed preloading","error")}}};zw([wt()],Bh.prototype,"preload",2),Bh=zw([ne("wcm-explorer-context")],Bh);var iR=Object.defineProperty,sR=Object.getOwnPropertyDescriptor,oR=(t,e,r,n)=>{for(var i=n>1?void 0:n?sR(e,r):e,s=t.length-1,o;s>=0;s--)(o=t[s])&&(i=(n?o(e,r,i):o(i))||i);return n&&i&&iR(e,r,i),i};let Hw=class extends J{constructor(){super(),this.unsubscribeTheme=void 0,re.setTheme(),this.unsubscribeTheme=Yr.subscribe(re.setTheme)}disconnectedCallback(){var t;(t=this.unsubscribeTheme)==null||t.call(this)}};Hw=oR([ne("wcm-theme-context")],Hw);const aR=ae`@keyframes scroll{0%{transform:translate3d(0,0,0)}100%{transform:translate3d(calc(-70px * 9),0,0)}}.wcm-slider{position:relative;overflow-x:hidden;padding:10px 0;margin:0 -20px;width:calc(100% + 40px)}.wcm-track{display:flex;width:calc(70px * 18);animation:scroll 20s linear infinite;opacity:.7}.wcm-track svg{margin:0 5px}wcm-wallet-image{width:60px;height:60px;margin:0 5px;border-radius:var(--wcm-wallet-icon-border-radius)}.wcm-grid{display:grid;grid-template-columns:repeat(4,80px);justify-content:space-between}.wcm-title{display:flex;align-items:center;margin-bottom:10px}.wcm-title svg{margin-right:6px}.wcm-title path{fill:var(--wcm-accent-color)}wcm-modal-footer .wcm-title{padding:0 10px}wcm-button-big{position:absolute;top:50%;left:50%;transform:translateY(-50%) translateX(-50%);filter:drop-shadow(0 0 17px var(--wcm-color-bg-1))}wcm-info-footer{flex-direction:column;align-items:center;display:flex;width:100%;padding:5px 0}wcm-info-footer wcm-text{text-align:center;margin-bottom:15px}#wallet-placeholder-fill{fill:var(--wcm-color-bg-3)}#wallet-placeholder-dash{stroke:var(--wcm-color-overlay)}`;var cR=Object.defineProperty,lR=Object.getOwnPropertyDescriptor,uR=(t,e,r,n)=>{for(var i=n>1?void 0:n?lR(e,r):e,s=t.length-1,o;s>=0;s--)(o=t[s])&&(i=(n?o(e,r,i):o(i))||i);return n&&i&&cR(e,r,i),i};let Lh=class extends J{onGoToQrcode(){be.push("Qrcode")}render(){const{recomendedWallets:t}=mt.state,e=[...t,...t],r=V.RECOMMENDED_WALLET_AMOUNT*2;return z`<wcm-modal-header title="Connect your wallet" .onAction="${this.onGoToQrcode}" .actionIcon="${ue.QRCODE_ICON}"></wcm-modal-header><wcm-modal-content><div class="wcm-title">${ue.MOBILE_ICON}<wcm-text variant="small-regular" color="accent">WalletConnect</wcm-text></div><div class="wcm-slider"><div class="wcm-track">${[...Array(r)].map((n,i)=>{const s=e[i%e.length];return s?z`<wcm-wallet-image walletId="${s.id}" imageId="${s.image_id}"></wcm-wallet-image>`:ue.WALLET_PLACEHOLDER})}</div><wcm-button-big @click="${K.handleAndroidLinking}"><wcm-text variant="medium-regular" color="inverse">Select Wallet</wcm-text></wcm-button-big></div></wcm-modal-content><wcm-info-footer><wcm-text color="secondary" variant="small-thin">Choose WalletConnect to see supported apps on your device</wcm-text></wcm-info-footer>`}};Lh.styles=[re.globalCss,aR],Lh=uR([ne("wcm-android-wallet-selection")],Lh);const hR=ae`@keyframes loading{to{stroke-dashoffset:0}}@keyframes shake{10%,90%{transform:translate3d(-1px,0,0)}20%,80%{transform:translate3d(1px,0,0)}30%,50%,70%{transform:translate3d(-2px,0,0)}40%,60%{transform:translate3d(2px,0,0)}}:host{display:flex;flex-direction:column;align-items:center}div{position:relative;width:110px;height:110px;display:flex;justify-content:center;align-items:center;margin:40px 0 20px 0;transform:translate3d(0,0,0)}svg{position:absolute;width:110px;height:110px;fill:none;stroke:transparent;stroke-linecap:round;stroke-width:2px;top:0;left:0}use{stroke:var(--wcm-accent-color);animation:loading 1s linear infinite}wcm-wallet-image{border-radius:var(--wcm-wallet-icon-large-border-radius);width:90px;height:90px}wcm-text{margin-bottom:40px}.wcm-error svg{stroke:var(--wcm-error-color)}.wcm-error use{display:none}.wcm-error{animation:shake .4s cubic-bezier(.36,.07,.19,.97) both}.wcm-stale svg,.wcm-stale use{display:none}`;var dR=Object.defineProperty,fR=Object.getOwnPropertyDescriptor,Qi=(t,e,r,n)=>{for(var i=n>1?void 0:n?fR(e,r):e,s=t.length-1,o;s>=0;s--)(o=t[s])&&(i=(n?o(e,r,i):o(i))||i);return n&&i&&dR(e,r,i),i};let sn=class extends J{constructor(){super(...arguments),this.walletId=void 0,this.imageId=void 0,this.isError=!1,this.isStale=!1,this.label=""}svgLoaderTemplate(){var t,e;const s=(e=(t=Yr.state.themeVariables)==null?void 0:t["--wcm-wallet-icon-large-border-radius"])!=null?e:re.getPreset("--wcm-wallet-icon-large-border-radius");let o=0;s.includes("%")?o=88/100*parseInt(s,10):o=parseInt(s,10),o*=1.17;const a=317-o*1.57,c=425-o*1.8;return z`<svg viewBox="0 0 110 110" width="110" height="110"><rect id="wcm-loader" x="2" y="2" width="106" height="106" rx="${o}"/><use xlink:href="#wcm-loader" stroke-dasharray="106 ${a}" stroke-dashoffset="${c}"></use></svg>`}render(){const t={"wcm-error":this.isError,"wcm-stale":this.isStale};return z`<div class="${Sr(t)}">${this.svgLoaderTemplate()}<wcm-wallet-image walletId="${at(this.walletId)}" imageId="${at(this.imageId)}"></wcm-wallet-image></div><wcm-text variant="medium-regular" color="${this.isError?"error":"primary"}">${this.isError?"Connection declined":this.label}</wcm-text>`}};sn.styles=[re.globalCss,hR],Qi([Z()],sn.prototype,"walletId",2),Qi([Z()],sn.prototype,"imageId",2),Qi([Z({type:Boolean})],sn.prototype,"isError",2),Qi([Z({type:Boolean})],sn.prototype,"isStale",2),Qi([Z()],sn.prototype,"label",2),sn=Qi([ne("wcm-connector-waiting")],sn);const Xi={manualWallets(){var t,e;const{mobileWallets:r,desktopWallets:n}=Ot.state,i=(t=Xi.recentWallet())==null?void 0:t.id,s=V.isMobile()?r:n,o=s?.filter(a=>i!==a.id);return(e=V.isMobile()?o?.map(({id:a,name:c,links:l})=>({id:a,name:c,mobile:l,links:l})):o?.map(({id:a,name:c,links:l})=>({id:a,name:c,desktop:l,links:l})))!=null?e:[]},recentWallet(){return K.getRecentWallet()},recomendedWallets(t=!1){var e;const r=t||(e=Xi.recentWallet())==null?void 0:e.id,{recomendedWallets:n}=mt.state;return n.filter(s=>r!==s.id)}},on={onConnecting(t){K.goToConnectingView(t)},manualWalletsTemplate(){return Xi.manualWallets().map(e=>z`<wcm-wallet-button walletId="${e.id}" name="${e.name}" .onClick="${()=>this.onConnecting(e)}"></wcm-wallet-button>`)},recomendedWalletsTemplate(t=!1){return Xi.recomendedWallets(t).map(r=>z`<wcm-wallet-button name="${r.name}" walletId="${r.id}" imageId="${r.image_id}" .onClick="${()=>this.onConnecting(r)}"></wcm-wallet-button>`)},recentWalletTemplate(){const t=Xi.recentWallet();if(t)return z`<wcm-wallet-button name="${t.name}" walletId="${t.id}" imageId="${at(t.image_id)}" .recent="${!0}" .onClick="${()=>this.onConnecting(t)}"></wcm-wallet-button>`}},pR=ae`.wcm-grid{display:grid;grid-template-columns:repeat(4,80px);justify-content:space-between}.wcm-desktop-title,.wcm-mobile-title{display:flex;align-items:center}.wcm-mobile-title{justify-content:space-between;margin-bottom:20px;margin-top:-10px}.wcm-desktop-title{margin-bottom:10px;padding:0 10px}.wcm-subtitle{display:flex;align-items:center}.wcm-subtitle:last-child path{fill:var(--wcm-color-fg-3)}.wcm-desktop-title svg,.wcm-mobile-title svg{margin-right:6px}.wcm-desktop-title path,.wcm-mobile-title path{fill:var(--wcm-accent-color)}`;var gR=Object.defineProperty,mR=Object.getOwnPropertyDescriptor,wR=(t,e,r,n)=>{for(var i=n>1?void 0:n?mR(e,r):e,s=t.length-1,o;s>=0;s--)(o=t[s])&&(i=(n?o(e,r,i):o(i))||i);return n&&i&&gR(e,r,i),i};let Mh=class extends J{render(){const{explorerExcludedWalletIds:t,enableExplorer:e}=Ot.state,r=t!=="ALL"&&e,n=on.manualWalletsTemplate(),i=on.recomendedWalletsTemplate();let o=[on.recentWalletTemplate(),...n,...i];o=o.filter(Boolean);const a=o.length>4||r;let c=[];a?c=o.slice(0,3):c=o;const l=!!c.length;return z`<wcm-modal-header .border="${!0}" title="Connect your wallet" .onAction="${K.handleUriCopy}" .actionIcon="${ue.COPY_ICON}"></wcm-modal-header><wcm-modal-content><div class="wcm-mobile-title"><div class="wcm-subtitle">${ue.MOBILE_ICON}<wcm-text variant="small-regular" color="accent">Mobile</wcm-text></div><div class="wcm-subtitle">${ue.SCAN_ICON}<wcm-text variant="small-regular" color="secondary">Scan with your wallet</wcm-text></div></div><wcm-walletconnect-qr></wcm-walletconnect-qr></wcm-modal-content>${l?z`<wcm-modal-footer><div class="wcm-desktop-title">${ue.DESKTOP_ICON}<wcm-text variant="small-regular" color="accent">Desktop</wcm-text></div><div class="wcm-grid">${c} ${a?z`<wcm-view-all-wallets-button></wcm-view-all-wallets-button>`:null}</div></wcm-modal-footer>`:null}`}};Mh.styles=[re.globalCss,pR],Mh=wR([ne("wcm-desktop-wallet-selection")],Mh);const yR=ae`div{background-color:var(--wcm-color-bg-2);padding:10px 20px 15px 20px;border-top:1px solid var(--wcm-color-bg-3);text-align:center}a{color:var(--wcm-accent-color);text-decoration:none;transition:opacity .2s ease-in-out;display:inline}a:active{opacity:.8}@media(hover:hover){a:hover{opacity:.8}}`;var bR=Object.defineProperty,vR=Object.getOwnPropertyDescriptor,ER=(t,e,r,n)=>{for(var i=n>1?void 0:n?vR(e,r):e,s=t.length-1,o;s>=0;s--)(o=t[s])&&(i=(n?o(e,r,i):o(i))||i);return n&&i&&bR(e,r,i),i};let Uh=class extends J{render(){const{termsOfServiceUrl:t,privacyPolicyUrl:e}=Ot.state;return t??e?z`<div><wcm-text variant="small-regular" color="secondary">By connecting your wallet to this app, you agree to the app's ${t?z`<a href="${t}" target="_blank" rel="noopener noreferrer">Terms of Service</a>`:null} ${t&&e?"and":null} ${e?z`<a href="${e}" target="_blank" rel="noopener noreferrer">Privacy Policy</a>`:null}</wcm-text></div>`:null}};Uh.styles=[re.globalCss,yR],Uh=ER([ne("wcm-legal-notice")],Uh);const _R=ae`div{display:grid;grid-template-columns:repeat(4,80px);margin:0 -10px;justify-content:space-between;row-gap:10px}`;var $R=Object.defineProperty,xR=Object.getOwnPropertyDescriptor,IR=(t,e,r,n)=>{for(var i=n>1?void 0:n?xR(e,r):e,s=t.length-1,o;s>=0;s--)(o=t[s])&&(i=(n?o(e,r,i):o(i))||i);return n&&i&&$R(e,r,i),i};let jh=class extends J{onQrcode(){be.push("Qrcode")}render(){const{explorerExcludedWalletIds:t,enableExplorer:e}=Ot.state,r=t!=="ALL"&&e,n=on.manualWalletsTemplate(),i=on.recomendedWalletsTemplate();let o=[on.recentWalletTemplate(),...n,...i];o=o.filter(Boolean);const a=o.length>8||r;let c=[];a?c=o.slice(0,7):c=o;const l=!!c.length;return z`<wcm-modal-header title="Connect your wallet" .onAction="${this.onQrcode}" .actionIcon="${ue.QRCODE_ICON}"></wcm-modal-header>${l?z`<wcm-modal-content><div>${c} ${a?z`<wcm-view-all-wallets-button></wcm-view-all-wallets-button>`:null}</div></wcm-modal-content>`:null}`}};jh.styles=[re.globalCss,_R],jh=IR([ne("wcm-mobile-wallet-selection")],jh);const OR=ae`:host{all:initial}.wcm-overlay{top:0;bottom:0;left:0;right:0;position:fixed;z-index:var(--wcm-z-index);overflow:hidden;display:flex;justify-content:center;align-items:center;opacity:0;pointer-events:none;background-color:var(--wcm-overlay-background-color);backdrop-filter:var(--wcm-overlay-backdrop-filter)}@media(max-height:720px) and (orientation:landscape){.wcm-overlay{overflow:scroll;align-items:flex-start;padding:20px 0}}.wcm-active{pointer-events:auto}.wcm-container{position:relative;max-width:360px;width:100%;outline:0;border-radius:var(--wcm-background-border-radius) var(--wcm-background-border-radius) var(--wcm-container-border-radius) var(--wcm-container-border-radius);border:1px solid var(--wcm-color-overlay);overflow:hidden}.wcm-card{width:100%;position:relative;border-radius:var(--wcm-container-border-radius);overflow:hidden;box-shadow:0 6px 14px -6px rgba(10,16,31,.12),0 10px 32px -4px rgba(10,16,31,.1),0 0 0 1px var(--wcm-color-overlay);background-color:var(--wcm-color-bg-1);color:var(--wcm-color-fg-1)}@media(max-width:600px){.wcm-container{max-width:440px;border-radius:var(--wcm-background-border-radius) var(--wcm-background-border-radius) 0 0}.wcm-card{border-radius:var(--wcm-container-border-radius) var(--wcm-container-border-radius) 0 0}.wcm-overlay{align-items:flex-end}}@media(max-width:440px){.wcm-container{border:0}}`;var SR=Object.defineProperty,AR=Object.getOwnPropertyDescriptor,Fh=(t,e,r,n)=>{for(var i=n>1?void 0:n?AR(e,r):e,s=t.length-1,o;s>=0;s--)(o=t[s])&&(i=(n?o(e,r,i):o(i))||i);return n&&i&&SR(e,r,i),i};let es=class extends J{constructor(){super(),this.open=!1,this.active=!1,this.unsubscribeModal=void 0,this.abortController=void 0,this.unsubscribeModal=Rn.subscribe(t=>{t.open?this.onOpenModalEvent():this.onCloseModalEvent()})}disconnectedCallback(){var t;(t=this.unsubscribeModal)==null||t.call(this)}get overlayEl(){return K.getShadowRootElement(this,".wcm-overlay")}get containerEl(){return K.getShadowRootElement(this,".wcm-container")}toggleBodyScroll(t){if(document.querySelector("body"))if(t){const r=document.getElementById("wcm-styles");r?.remove()}else document.head.insertAdjacentHTML("beforeend",'<style id="wcm-styles">html,body{touch-action:none;overflow:hidden;overscroll-behavior:contain;}</style>')}onCloseModal(t){t.target===t.currentTarget&&Rn.close()}onOpenModalEvent(){this.toggleBodyScroll(!1),this.addKeyboardEvents(),this.open=!0,setTimeout(async()=>{const t=K.isMobileAnimation()?{y:["50vh","0vh"]}:{scale:[.98,1]},e=.1,r=.2;await Promise.all([Fn(this.overlayEl,{opacity:[0,1]},{delay:e,duration:r}).finished,Fn(this.containerEl,t,{delay:e,duration:r}).finished]),this.active=!0},0)}async onCloseModalEvent(){this.toggleBodyScroll(!0),this.removeKeyboardEvents();const t=K.isMobileAnimation()?{y:["0vh","50vh"]}:{scale:[1,.98]},e=.2;await Promise.all([Fn(this.overlayEl,{opacity:[1,0]},{duration:e}).finished,Fn(this.containerEl,t,{duration:e}).finished]),this.containerEl.removeAttribute("style"),this.active=!1,this.open=!1}addKeyboardEvents(){this.abortController=new AbortController,window.addEventListener("keydown",t=>{var e;t.key==="Escape"?Rn.close():t.key==="Tab"&&((e=t.target)!=null&&e.tagName.includes("wcm-")||this.containerEl.focus())},this.abortController),this.containerEl.focus()}removeKeyboardEvents(){var t;(t=this.abortController)==null||t.abort(),this.abortController=void 0}render(){const t={"wcm-overlay":!0,"wcm-active":this.active};return z`<wcm-explorer-context></wcm-explorer-context><wcm-theme-context></wcm-theme-context><div id="wcm-modal" class="${Sr(t)}" @click="${this.onCloseModal}" role="alertdialog" aria-modal="true"><div class="wcm-container" tabindex="0">${this.open?z`<wcm-modal-backcard></wcm-modal-backcard><div class="wcm-card"><wcm-modal-router></wcm-modal-router><wcm-modal-toast></wcm-modal-toast></div>`:null}</div></div>`}};es.styles=[re.globalCss,OR],Fh([wt()],es.prototype,"open",2),Fh([wt()],es.prototype,"active",2),es=Fh([ne("wcm-modal")],es);const CR=ae`div{display:flex;margin-top:15px}slot{display:inline-block;margin:0 5px}wcm-button{margin:0 5px}`;var PR=Object.defineProperty,DR=Object.getOwnPropertyDescriptor,po=(t,e,r,n)=>{for(var i=n>1?void 0:n?DR(e,r):e,s=t.length-1,o;s>=0;s--)(o=t[s])&&(i=(n?o(e,r,i):o(i))||i);return n&&i&&PR(e,r,i),i};let qn=class extends J{constructor(){super(...arguments),this.isMobile=!1,this.isDesktop=!1,this.isWeb=!1,this.isRetry=!1}onMobile(){V.isMobile()?be.replace("MobileConnecting"):be.replace("MobileQrcodeConnecting")}onDesktop(){be.replace("DesktopConnecting")}onWeb(){be.replace("WebConnecting")}render(){return z`<div>${this.isRetry?z`<slot></slot>`:null} ${this.isMobile?z`<wcm-button .onClick="${this.onMobile}" .iconLeft="${ue.MOBILE_ICON}" variant="outline">Mobile</wcm-button>`:null} ${this.isDesktop?z`<wcm-button .onClick="${this.onDesktop}" .iconLeft="${ue.DESKTOP_ICON}" variant="outline">Desktop</wcm-button>`:null} ${this.isWeb?z`<wcm-button .onClick="${this.onWeb}" .iconLeft="${ue.GLOBE_ICON}" variant="outline">Web</wcm-button>`:null}</div>`}};qn.styles=[re.globalCss,CR],po([Z({type:Boolean})],qn.prototype,"isMobile",2),po([Z({type:Boolean})],qn.prototype,"isDesktop",2),po([Z({type:Boolean})],qn.prototype,"isWeb",2),po([Z({type:Boolean})],qn.prototype,"isRetry",2),qn=po([ne("wcm-platform-selection")],qn);const TR=ae`button{display:flex;flex-direction:column;padding:5px 10px;border-radius:var(--wcm-button-hover-highlight-border-radius);height:100%;justify-content:flex-start}.wcm-icons{width:60px;height:60px;display:flex;flex-wrap:wrap;padding:7px;border-radius:var(--wcm-wallet-icon-border-radius);justify-content:space-between;align-items:center;margin-bottom:5px;background-color:var(--wcm-color-bg-2);box-shadow:inset 0 0 0 1px var(--wcm-color-overlay)}button:active{background-color:var(--wcm-color-overlay)}@media(hover:hover){button:hover{background-color:var(--wcm-color-overlay)}}.wcm-icons img{width:21px;height:21px;object-fit:cover;object-position:center;border-radius:calc(var(--wcm-wallet-icon-border-radius)/ 2);border:1px solid var(--wcm-color-overlay)}.wcm-icons svg{width:21px;height:21px}.wcm-icons img:nth-child(1),.wcm-icons img:nth-child(2),.wcm-icons svg:nth-child(1),.wcm-icons svg:nth-child(2){margin-bottom:4px}wcm-text{width:100%;text-align:center}#wallet-placeholder-fill{fill:var(--wcm-color-bg-3)}#wallet-placeholder-dash{stroke:var(--wcm-color-overlay)}`;var RR=Object.defineProperty,NR=Object.getOwnPropertyDescriptor,BR=(t,e,r,n)=>{for(var i=n>1?void 0:n?NR(e,r):e,s=t.length-1,o;s>=0;s--)(o=t[s])&&(i=(n?o(e,r,i):o(i))||i);return n&&i&&RR(e,r,i),i};let kh=class extends J{onClick(){be.push("WalletExplorer")}render(){const{recomendedWallets:t}=mt.state,e=Xi.manualWallets(),r=[...t,...e].reverse().slice(0,4);return z`<button @click="${this.onClick}"><div class="wcm-icons">${r.map(n=>{const i=K.getWalletIcon(n);if(i)return z`<img crossorigin="anonymous" src="${i}">`;const s=K.getWalletIcon({id:n.id});return s?z`<img crossorigin="anonymous" src="${s}">`:ue.WALLET_PLACEHOLDER})} ${[...Array(4-r.length)].map(()=>ue.WALLET_PLACEHOLDER)}</div><wcm-text variant="xsmall-regular">View All</wcm-text></button>`}};kh.styles=[re.globalCss,TR],kh=BR([ne("wcm-view-all-wallets-button")],kh);const LR=ae`.wcm-qr-container{width:100%;display:flex;justify-content:center;align-items:center;aspect-ratio:1/1}`;var MR=Object.defineProperty,UR=Object.getOwnPropertyDescriptor,Qa=(t,e,r,n)=>{for(var i=n>1?void 0:n?UR(e,r):e,s=t.length-1,o;s>=0;s--)(o=t[s])&&(i=(n?o(e,r,i):o(i))||i);return n&&i&&MR(e,r,i),i};let ts=class extends J{constructor(){super(),this.walletId="",this.imageId="",this.uri="",setTimeout(()=>{const{walletConnectUri:t}=Oe.state;this.uri=t},0)}get overlayEl(){return K.getShadowRootElement(this,".wcm-qr-container")}render(){return z`<div class="wcm-qr-container">${this.uri?z`<wcm-qrcode size="${this.overlayEl.offsetWidth}" uri="${this.uri}" walletId="${at(this.walletId)}" imageId="${at(this.imageId)}"></wcm-qrcode>`:z`<wcm-spinner></wcm-spinner>`}</div>`}};ts.styles=[re.globalCss,LR],Qa([Z()],ts.prototype,"walletId",2),Qa([Z()],ts.prototype,"imageId",2),Qa([wt()],ts.prototype,"uri",2),ts=Qa([ne("wcm-walletconnect-qr")],ts);var jR=Object.defineProperty,FR=Object.getOwnPropertyDescriptor,kR=(t,e,r,n)=>{for(var i=n>1?void 0:n?FR(e,r):e,s=t.length-1,o;s>=0;s--)(o=t[s])&&(i=(n?o(e,r,i):o(i))||i);return n&&i&&jR(e,r,i),i};let qh=class extends J{viewTemplate(){return V.isAndroid()&&!V.isTelegram()?z`<wcm-android-wallet-selection></wcm-android-wallet-selection>`:V.isMobile()?z`<wcm-mobile-wallet-selection></wcm-mobile-wallet-selection>`:z`<wcm-desktop-wallet-selection></wcm-desktop-wallet-selection>`}render(){return z`${this.viewTemplate()}<wcm-legal-notice></wcm-legal-notice>`}};qh.styles=[re.globalCss],qh=kR([ne("wcm-connect-wallet-view")],qh);const qR=ae`wcm-info-footer{flex-direction:column;align-items:center;display:flex;width:100%;padding:5px 0}wcm-text{text-align:center}`;var zR=Object.defineProperty,HR=Object.getOwnPropertyDescriptor,Vw=(t,e,r,n)=>{for(var i=n>1?void 0:n?HR(e,r):e,s=t.length-1,o;s>=0;s--)(o=t[s])&&(i=(n?o(e,r,i):o(i))||i);return n&&i&&zR(e,r,i),i};let Xa=class extends J{constructor(){super(),this.isError=!1,this.openDesktopApp()}onFormatAndRedirect(t){const{desktop:e,name:r}=V.getWalletRouterData(),n=e?.native,i=e?.universal;if(n){const s=V.formatNativeUrl(n,t,r);V.openHref(s,"_self")}else if(i){const s=V.formatUniversalUrl(i,t,r);V.openHref(s,"_blank")}}openDesktopApp(){const{walletConnectUri:t}=Oe.state,e=V.getWalletRouterData();K.setRecentWallet(e),t&&this.onFormatAndRedirect(t)}render(){const{name:t,id:e,image_id:r}=V.getWalletRouterData(),{isMobile:n,isWeb:i}=K.getCachedRouterWalletPlatforms();return z`<wcm-modal-header title="${t}" .onAction="${K.handleUriCopy}" .actionIcon="${ue.COPY_ICON}"></wcm-modal-header><wcm-modal-content><wcm-connector-waiting walletId="${e}" imageId="${at(r)}" label="${`Continue in ${t}...`}" .isError="${this.isError}"></wcm-connector-waiting></wcm-modal-content><wcm-info-footer><wcm-text color="secondary" variant="small-thin">${`Connection can continue loading if ${t} is not installed on your device`}</wcm-text><wcm-platform-selection .isMobile="${n}" .isWeb="${i}" .isRetry="${!0}"><wcm-button .onClick="${this.openDesktopApp.bind(this)}" .iconRight="${ue.RETRY_ICON}">Retry</wcm-button></wcm-platform-selection></wcm-info-footer>`}};Xa.styles=[re.globalCss,qR],Vw([wt()],Xa.prototype,"isError",2),Xa=Vw([ne("wcm-desktop-connecting-view")],Xa);const VR=ae`wcm-info-footer{flex-direction:column;align-items:center;display:flex;width:100%;padding:5px 0}wcm-text{text-align:center}wcm-button{margin-top:15px}`;var WR=Object.defineProperty,KR=Object.getOwnPropertyDescriptor,GR=(t,e,r,n)=>{for(var i=n>1?void 0:n?KR(e,r):e,s=t.length-1,o;s>=0;s--)(o=t[s])&&(i=(n?o(e,r,i):o(i))||i);return n&&i&&WR(e,r,i),i};let zh=class extends J{onInstall(t){t&&V.openHref(t,"_blank")}render(){const{name:t,id:e,image_id:r,homepage:n}=V.getWalletRouterData();return z`<wcm-modal-header title="${t}"></wcm-modal-header><wcm-modal-content><wcm-connector-waiting walletId="${e}" imageId="${at(r)}" label="Not Detected" .isStale="${!0}"></wcm-connector-waiting></wcm-modal-content><wcm-info-footer><wcm-text color="secondary" variant="small-thin">${`Download ${t} to continue. If multiple browser extensions are installed, disable non ${t} ones and try again`}</wcm-text><wcm-button .onClick="${()=>this.onInstall(n)}" .iconLeft="${ue.ARROW_DOWN_ICON}">Download</wcm-button></wcm-info-footer>`}};zh.styles=[re.globalCss,VR],zh=GR([ne("wcm-install-wallet-view")],zh);const ZR=ae`wcm-wallet-image{border-radius:var(--wcm-wallet-icon-large-border-radius);width:96px;height:96px;margin-bottom:20px}wcm-info-footer{display:flex;width:100%}.wcm-app-store{justify-content:space-between}.wcm-app-store wcm-wallet-image{margin-right:10px;margin-bottom:0;width:28px;height:28px;border-radius:var(--wcm-wallet-icon-small-border-radius)}.wcm-app-store div{display:flex;align-items:center}.wcm-app-store wcm-button{margin-right:-10px}.wcm-note{flex-direction:column;align-items:center;padding:5px 0}.wcm-note wcm-text{text-align:center}wcm-platform-selection{margin-top:-15px}.wcm-note wcm-text{margin-top:15px}.wcm-note wcm-text span{color:var(--wcm-accent-color)}`;var YR=Object.defineProperty,JR=Object.getOwnPropertyDescriptor,Ww=(t,e,r,n)=>{for(var i=n>1?void 0:n?JR(e,r):e,s=t.length-1,o;s>=0;s--)(o=t[s])&&(i=(n?o(e,r,i):o(i))||i);return n&&i&&YR(e,r,i),i};let ec=class extends J{constructor(){super(),this.isError=!1,this.openMobileApp()}onFormatAndRedirect(t,e=!1){const{mobile:r,name:n}=V.getWalletRouterData(),i=r?.native,s=r?.universal,o=V.isTelegram()?"_blank":"_self";if(t=V.isTelegram()&&V.isAndroid()?encodeURIComponent(t):t,i&&!e){const a=V.formatNativeUrl(i,t,n);V.openHref(a,o)}else if(s){const a=V.formatUniversalUrl(s,t,n);V.openHref(a,o)}}openMobileApp(t=!1){const{walletConnectUri:e}=Oe.state,r=V.getWalletRouterData();e&&this.onFormatAndRedirect(e,t),K.setRecentWallet(r)}onGoToAppStore(t){t&&V.openHref(t,"_blank")}render(){const{name:t,id:e,image_id:r,app:n,mobile:i}=V.getWalletRouterData(),{isWeb:s}=K.getCachedRouterWalletPlatforms(),o=n?.ios,a=i?.universal;return z`<wcm-modal-header title="${t}"></wcm-modal-header><wcm-modal-content><wcm-connector-waiting walletId="${e}" imageId="${at(r)}" label="Tap 'Open' to continue…" .isError="${this.isError}"></wcm-connector-waiting></wcm-modal-content><wcm-info-footer class="wcm-note"><wcm-platform-selection .isWeb="${s}" .isRetry="${!0}"><wcm-button .onClick="${()=>this.openMobileApp(!1)}" .iconRight="${ue.RETRY_ICON}">Retry</wcm-button></wcm-platform-selection>${a?z`<wcm-text color="secondary" variant="small-thin">Still doesn't work? <span tabindex="0" @click="${()=>this.openMobileApp(!0)}">Try this alternate link</span></wcm-text>`:null}</wcm-info-footer><wcm-info-footer class="wcm-app-store"><div><wcm-wallet-image walletId="${e}" imageId="${at(r)}"></wcm-wallet-image><wcm-text>${`Get ${t}`}</wcm-text></div><wcm-button .iconRight="${ue.ARROW_RIGHT_ICON}" .onClick="${()=>this.onGoToAppStore(o)}" variant="ghost">App Store</wcm-button></wcm-info-footer>`}};ec.styles=[re.globalCss,ZR],Ww([wt()],ec.prototype,"isError",2),ec=Ww([ne("wcm-mobile-connecting-view")],ec);const QR=ae`wcm-info-footer{flex-direction:column;align-items:center;display:flex;width:100%;padding:5px 0}wcm-text{text-align:center}`;var XR=Object.defineProperty,eN=Object.getOwnPropertyDescriptor,tN=(t,e,r,n)=>{for(var i=n>1?void 0:n?eN(e,r):e,s=t.length-1,o;s>=0;s--)(o=t[s])&&(i=(n?o(e,r,i):o(i))||i);return n&&i&&XR(e,r,i),i};let Hh=class extends J{render(){const{name:t,id:e,image_id:r}=V.getWalletRouterData(),{isDesktop:n,isWeb:i}=K.getCachedRouterWalletPlatforms();return z`<wcm-modal-header title="${t}" .onAction="${K.handleUriCopy}" .actionIcon="${ue.COPY_ICON}"></wcm-modal-header><wcm-modal-content><wcm-walletconnect-qr walletId="${e}" imageId="${at(r)}"></wcm-walletconnect-qr></wcm-modal-content><wcm-info-footer><wcm-text color="secondary" variant="small-thin">${`Scan this QR Code with your phone's camera or inside ${t} app`}</wcm-text><wcm-platform-selection .isDesktop="${n}" .isWeb="${i}"></wcm-platform-selection></wcm-info-footer>`}};Hh.styles=[re.globalCss,QR],Hh=tN([ne("wcm-mobile-qr-connecting-view")],Hh);var rN=Object.defineProperty,nN=Object.getOwnPropertyDescriptor,iN=(t,e,r,n)=>{for(var i=n>1?void 0:n?nN(e,r):e,s=t.length-1,o;s>=0;s--)(o=t[s])&&(i=(n?o(e,r,i):o(i))||i);return n&&i&&rN(e,r,i),i};let Vh=class extends J{render(){return z`<wcm-modal-header title="Scan the code" .onAction="${K.handleUriCopy}" .actionIcon="${ue.COPY_ICON}"></wcm-modal-header><wcm-modal-content><wcm-walletconnect-qr></wcm-walletconnect-qr></wcm-modal-content>`}};Vh.styles=[re.globalCss],Vh=iN([ne("wcm-qrcode-view")],Vh);const sN=ae`wcm-modal-content{height:clamp(200px,60vh,600px);display:block;overflow:scroll;scrollbar-width:none;position:relative;margin-top:1px}.wcm-grid{display:grid;grid-template-columns:repeat(4,80px);justify-content:space-between;margin:-15px -10px;padding-top:20px}wcm-modal-content::after,wcm-modal-content::before{content:'';position:fixed;pointer-events:none;z-index:1;width:100%;height:20px;opacity:1}wcm-modal-content::before{box-shadow:0 -1px 0 0 var(--wcm-color-bg-1);background:linear-gradient(var(--wcm-color-bg-1),rgba(255,255,255,0))}wcm-modal-content::after{box-shadow:0 1px 0 0 var(--wcm-color-bg-1);background:linear-gradient(rgba(255,255,255,0),var(--wcm-color-bg-1));top:calc(100% - 20px)}wcm-modal-content::-webkit-scrollbar{display:none}.wcm-placeholder-block{display:flex;justify-content:center;align-items:center;height:100px;overflow:hidden}.wcm-empty,.wcm-loading{display:flex}.wcm-loading .wcm-placeholder-block{height:100%}.wcm-end-reached .wcm-placeholder-block{height:0;opacity:0}.wcm-empty .wcm-placeholder-block{opacity:1;height:100%}wcm-wallet-button{margin:calc((100% - 60px)/ 3) 0}`;var oN=Object.defineProperty,aN=Object.getOwnPropertyDescriptor,go=(t,e,r,n)=>{for(var i=n>1?void 0:n?aN(e,r):e,s=t.length-1,o;s>=0;s--)(o=t[s])&&(i=(n?o(e,r,i):o(i))||i);return n&&i&&oN(e,r,i),i};const Wh=40;let zn=class extends J{constructor(){super(...arguments),this.loading=!mt.state.wallets.listings.length,this.firstFetch=!mt.state.wallets.listings.length,this.search="",this.endReached=!1,this.intersectionObserver=void 0,this.searchDebounce=K.debounce(t=>{t.length>=1?(this.firstFetch=!0,this.endReached=!1,this.search=t,mt.resetSearch(),this.fetchWallets()):this.search&&(this.search="",this.endReached=this.isLastPage(),mt.resetSearch())})}firstUpdated(){this.createPaginationObserver()}disconnectedCallback(){var t;(t=this.intersectionObserver)==null||t.disconnect()}get placeholderEl(){return K.getShadowRootElement(this,".wcm-placeholder-block")}createPaginationObserver(){this.intersectionObserver=new IntersectionObserver(([t])=>{t.isIntersecting&&!(this.search&&this.firstFetch)&&this.fetchWallets()}),this.intersectionObserver.observe(this.placeholderEl)}isLastPage(){const{wallets:t,search:e}=mt.state,{listings:r,total:n}=this.search?e:t;return n<=Wh||r.length>=n}async fetchWallets(){var t;const{wallets:e,search:r}=mt.state,{listings:n,total:i,page:s}=this.search?r:e;if(!this.endReached&&(this.firstFetch||i>Wh&&n.length<i))try{this.loading=!0;const o=(t=Oe.state.chains)==null?void 0:t.join(","),{listings:a}=await mt.getWallets({page:this.firstFetch?1:s+1,entries:Wh,search:this.search,version:2,chains:o}),c=a.map(l=>K.getWalletIcon(l));await Promise.all([...c.map(async l=>K.preloadImage(l)),V.wait(300)]),this.endReached=this.isLastPage()}catch(o){console.error(o),Jr.openToast(K.getErrorMessage(o),"error")}finally{this.loading=!1,this.firstFetch=!1}}onConnect(t){V.isAndroid()?K.handleMobileLinking(t):K.goToConnectingView(t)}onSearchChange(t){const{value:e}=t.target;this.searchDebounce(e)}render(){const{wallets:t,search:e}=mt.state,{listings:r}=this.search?e:t,n=this.loading&&!r.length,i=this.search.length>=3;let s=on.manualWalletsTemplate(),o=on.recomendedWalletsTemplate(!0);i&&(s=s.filter(({values:l})=>K.caseSafeIncludes(l[0],this.search)),o=o.filter(({values:l})=>K.caseSafeIncludes(l[0],this.search)));const a=!this.loading&&!r.length&&!o.length,c={"wcm-loading":n,"wcm-end-reached":this.endReached||!this.loading,"wcm-empty":a};return z`<wcm-modal-header><wcm-search-input .onChange="${this.onSearchChange.bind(this)}"></wcm-search-input></wcm-modal-header><wcm-modal-content class="${Sr(c)}"><div class="wcm-grid">${n?null:s} ${n?null:o} ${n?null:r.map(l=>z`${l?z`<wcm-wallet-button imageId="${l.image_id}" name="${l.name}" walletId="${l.id}" .onClick="${()=>this.onConnect(l)}"></wcm-wallet-button>`:null}`)}</div><div class="wcm-placeholder-block">${a?z`<wcm-text variant="big-bold" color="secondary">No results found</wcm-text>`:null} ${!a&&this.loading?z`<wcm-spinner></wcm-spinner>`:null}</div></wcm-modal-content>`}};zn.styles=[re.globalCss,sN],go([wt()],zn.prototype,"loading",2),go([wt()],zn.prototype,"firstFetch",2),go([wt()],zn.prototype,"search",2),go([wt()],zn.prototype,"endReached",2),zn=go([ne("wcm-wallet-explorer-view")],zn);const cN=ae`wcm-info-footer{flex-direction:column;align-items:center;display:flex;width:100%;padding:5px 0}wcm-text{text-align:center}`;var lN=Object.defineProperty,uN=Object.getOwnPropertyDescriptor,Kw=(t,e,r,n)=>{for(var i=n>1?void 0:n?uN(e,r):e,s=t.length-1,o;s>=0;s--)(o=t[s])&&(i=(n?o(e,r,i):o(i))||i);return n&&i&&lN(e,r,i),i};let tc=class extends J{constructor(){super(),this.isError=!1,this.openWebWallet()}onFormatAndRedirect(t){const{desktop:e,name:r}=V.getWalletRouterData(),n=e?.universal;if(n){const i=V.formatUniversalUrl(n,t,r);V.openHref(i,"_blank")}}openWebWallet(){const{walletConnectUri:t}=Oe.state,e=V.getWalletRouterData();K.setRecentWallet(e),t&&this.onFormatAndRedirect(t)}render(){const{name:t,id:e,image_id:r}=V.getWalletRouterData(),{isMobile:n,isDesktop:i}=K.getCachedRouterWalletPlatforms(),s=V.isMobile();return z`<wcm-modal-header title="${t}" .onAction="${K.handleUriCopy}" .actionIcon="${ue.COPY_ICON}"></wcm-modal-header><wcm-modal-content><wcm-connector-waiting walletId="${e}" imageId="${at(r)}" label="${`Continue in ${t}...`}" .isError="${this.isError}"></wcm-connector-waiting></wcm-modal-content><wcm-info-footer><wcm-text color="secondary" variant="small-thin">${`${t} web app has opened in a new tab. Go there, accept the connection, and come back`}</wcm-text><wcm-platform-selection .isMobile="${n}" .isDesktop="${s?!1:i}" .isRetry="${!0}"><wcm-button .onClick="${this.openWebWallet.bind(this)}" .iconRight="${ue.RETRY_ICON}">Retry</wcm-button></wcm-platform-selection></wcm-info-footer>`}};tc.styles=[re.globalCss,cN],Kw([wt()],tc.prototype,"isError",2),tc=Kw([ne("wcm-web-connecting-view")],tc);var hN=Object.freeze({__proto__:null,get WcmModal(){return es},get WcmQrCode(){return Cr}});Mt.EthereumProvider=N7,Mt.OPTIONAL_EVENTS=_1,Mt.OPTIONAL_METHODS=E1,Mt.REQUIRED_EVENTS=Oa,Mt.REQUIRED_METHODS=Ia,Mt.default=Ca,Object.defineProperty(Mt,"__esModule",{value:!0})});
//# sourceMappingURL=index.umd.js.map
